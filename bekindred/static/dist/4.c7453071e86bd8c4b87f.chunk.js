webpackJsonp([4],{1252:function(module,exports,__webpack_require__){"use strict";var core_1=__webpack_require__(1),router_1=__webpack_require__(22),users_list_1=__webpack_require__(598),loading_1=__webpack_require__(24),filter_1=__webpack_require__(589),profile_1=__webpack_require__(134),services_1=__webpack_require__(12),lodash_1=__webpack_require__(23),ConnectionsComponent=function(){function ConnectionsComponent(service,filterService,_router){var _this=this;this.service=service,this.filterService=filterService,this._router=_router,this.items=[],this.loading=!1,this.loadingInitial=!1,this.isListEmpty=!1,this.limit=12,this.filter=!0,this.next="",this.total_count=0,this.offset=0,this.profileViewActive=!1,this.selectedUser=null,this.currentIndex=0,this.onRefreshList=lodash_1.debounce(this.refreshList,300,{leading:!1,trailing:!0}),this.routerInstance=this._router.parent.subscribe(function(next){_this.closeProfile(!0)})}return ConnectionsComponent.prototype.setLocation=function(loc){window.history.pushState("","","/"+loc)},ConnectionsComponent.prototype.ngAfterViewInit=function(){setTimeout(function(){window.scrollTo(0,0)})},ConnectionsComponent.prototype.ngOnInit=function(){var _this=this;this.total_count=0,this.getList(),this.filterService.addObserver("connections"),this.filterService.observer("connections").subscribe(function(data){return _this.onRefreshList()},function(err){return console.log(err)})},ConnectionsComponent.prototype.ngOnDestroy=function(){this.filterService.observer("connections").unsubscribe(),this.filterService.removeObserver("connections"),this.serviceInstance&&this.serviceInstance.unsubscribe(),this.routerInstance.unsubscribe()},ConnectionsComponent.prototype.getList=function(){var _this=this;this.loading||(this.isListEmpty=!1,null!==this.next&&(this.loading=!0,""===this.next&&(this.loadingInitial=!0),this.serviceInstance=this.service.get(this.next,this.limit,this.filter).subscribe(function(data){_this.serviceInstance.unsubscribe(),_this.assignList(data)},function(err){console.log(err),_this.loading=!1,_this.loadingInitial=!1,_this.serviceInstance.unsubscribe()},function(){})))},ConnectionsComponent.prototype.refreshList=function(){this.serviceInstance&&this.serviceInstance.unsubscribe(),document.body.scrollTop=document.documentElement.scrollTop=0,this.items=[],this.total_count=0,this.currentIndex=0,this.isListEmpty=!1,this.next="",this.getList()},ConnectionsComponent.prototype.assignList=function(data){if(this.loading=!1,this.loadingInitial=!1,0===data.meta.total_count)return void(this.isListEmpty=!0);if(this.isListEmpty=!1,this.items.length>0){for(var more=data.objects,i=0;i<=more.length-1;i++)this.items.push(more[i]);this.total_count+=more.length}else this.items=data.objects,this.total_count=data.objects.length;this.next=data.meta.next,this.offset=data.meta.offset,null!==this.next?jQuery(window).bind("scroll",this.handleScrollEvent.bind(this)):jQuery(window).unbind("scroll")},ConnectionsComponent.prototype.viewFriendProfile=function(id){for(var i=this.items.length-1;i>=0;i--)this.items[i].id===id&&(this.selectedUser=this.items[i],this.currentIndex=lodash_1.findIndex(this.items,{id:this.selectedUser.id}),this.profileViewActive=!0,null===this.items[i].updated_at&&(this.items[i].updated_at="seen"),document.body.scrollTop=document.documentElement.scrollTop=0,this.setLocation(this.selectedUser.username))},ConnectionsComponent.prototype.closeProfile=function(event){this.profileViewActive=!1,this.selectedUser=null,this.setLocation("connections")},ConnectionsComponent.prototype.previousProfile=function(event){var currentIndex=lodash_1.findIndex(this.items,{id:this.selectedUser.id}),newIndex=currentIndex-1;0>newIndex||(this.items.length>0?(this.selectedUser=this.items[newIndex],this.setLocation(this.selectedUser.username)):(this.closeProfile(!0),this.isListEmpty=!0),this.currentIndex=newIndex)},ConnectionsComponent.prototype.nextProfile=function(event){var currentIndex=lodash_1.findIndex(this.items,{id:this.selectedUser.id}),newIndex=currentIndex+1;!this.loading&&newIndex>this.items.length-13&&this.next&&this.getList(),newIndex>this.items.length-1||(this.items.length>0?(this.selectedUser=this.items[newIndex],this.setLocation(this.selectedUser.username)):(this.closeProfile(!0),this.isListEmpty=!0),this.currentIndex=newIndex)},ConnectionsComponent.prototype.handleScrollEvent=function(event){var scrollOffset=jQuery(window).scrollTop(),threshold=jQuery(document).height()-jQuery(window).height()-60;this.next&&scrollOffset>threshold&&(this.loading||this.getList())},ConnectionsComponent=__decorate([core_1.Component({selector:"prs-connections",template:__webpack_require__(1295),directives:[filter_1.FilterDesktopComponent,users_list_1.UsersListComponent,loading_1.LoadingComponent,profile_1.ProfileFriendComponent],providers:[services_1.ConnectionsService]}),__metadata("design:paramtypes",[services_1.ConnectionsService,services_1.FilterService,router_1.Router])],ConnectionsComponent)}();exports.ConnectionsComponent=ConnectionsComponent},1295:function(module,exports){module.exports='<div class="layout layout--flush content" [ngClass]="{\'is-hidden\': profileViewActive}">\n  <div class="layout__item 3/4 extralarge-and-up-4/5">\n    <h3 *ngIf="!loading && emptyList">No results...</h3>\n    <prs-users-list [showButtons]="0" [users]="items" (onClicked)="viewFriendProfile($event)"></prs-users-list>\n    <prs-loading [status]="loading"></prs-loading>\n    <div class="no-results" *ngIf="isListEmpty" [ngClass]="{\'is-visible\': isListEmpty}">\n      <h2 class="no-results__title">Whoops!</h2>\n      <p class="no-results__par">No results found.\n        <br>Please broaden your search criteria</p>\n      <img src="/static/assets/images/polar-bear.png" alt="Polar Bear">\n    </div>\n  </div>\n  <div class="layout__item 1/4 extralarge-and-up-1/5 filter-place">\n    <prs-filters [type]="\'connections\'"></prs-filters>\n  </div>\n</div>\n<prs-profile-friend [currentIndex]="currentIndex" [count]="total_count" (previousEvent)="previousProfile($event)" (nextEvent)="nextProfile($event)" *ngIf="profileViewActive" [user]="selectedUser" (closeprofileEvent)="closeProfile($event)">\n</prs-profile-friend>\n'},595:function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])}__export(__webpack_require__(1252))}});
//# sourceMappingURL=4.c7453071e86bd8c4b87f.bundle.map