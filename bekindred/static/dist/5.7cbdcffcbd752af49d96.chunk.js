webpackJsonp([5],{776:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},core_1=__webpack_require__(3),router_1=__webpack_require__(37),profile_view_component_1=__webpack_require__(1148),profile_my_component_1=__webpack_require__(777),util_1=__webpack_require__(12),ProfileLoader=function(){function ProfileLoader(_loader,_el,_params){this._loader=_loader,this._el=_el,this._params=_params,this.username=util_1.CookieUtil.getValue("user_username"),this.usernameParam=this._params.get("username")}return ProfileLoader.prototype.ngOnInit=function(){var _this=this;this.username===this.usernameParam?this._loader.loadIntoLocation(profile_my_component_1.ProfileMyComponent,this._el,"child").then(function(res){}):this._loader.loadIntoLocation(profile_view_component_1.ProfileViewComponent,this._el,"child").then(function(res){res.instance.setUsername(_this.usernameParam)})},ProfileLoader=__decorate([core_1.Component({selector:"profile-loader",template:"<div #child></div>",directives:[profile_my_component_1.ProfileMyComponent,profile_view_component_1.ProfileViewComponent]}),__metadata("design:paramtypes",[core_1.DynamicComponentLoader,core_1.ElementRef,router_1.RouteParams])],ProfileLoader)}();exports.ProfileLoader=ProfileLoader},1148:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},core_1=__webpack_require__(3),router_1=__webpack_require__(37),http_1=__webpack_require__(81),profile_avatar_component_1=__webpack_require__(651),profile_about_component_1=__webpack_require__(650),profile_likes_component_1=__webpack_require__(654),profile_friends_component_1=__webpack_require__(652),profile_networks_component_1=__webpack_require__(655),profile_items_component_1=__webpack_require__(653),loading_component_1=__webpack_require__(42),profile_acceptpass_component_1=__webpack_require__(778),profile_gallery_component_1=__webpack_require__(768),profile_service_1=__webpack_require__(156),mutualfriends_service_1=__webpack_require__(125),friend_service_1=__webpack_require__(306),photos_service_1=__webpack_require__(93),history_service_1=__webpack_require__(94),connections_counter_service_1=__webpack_require__(92),dropdown_directive_1=__webpack_require__(766),remodal_directive_1=__webpack_require__(649),util_1=__webpack_require__(12),view=__webpack_require__(769),ProfileViewComponent=function(){function ProfileViewComponent(mutualfriendsService,profileService,friendService,photosService,historyService,http,counterService,_router){this.mutualfriendsService=mutualfriendsService,this.profileService=profileService,this.friendService=friendService,this.photosService=photosService,this.historyService=historyService,this.http=http,this.counterService=counterService,this._router=_router,this.count=0,this.friendsTitle="Mutual Connections",this.notFound=!1,this.profileType="friend",this.profileAge="",this.profileGender="",this.profileLocation="",this.profileScore="",this.profileName="",this.profileJob="",this.profileReligiousViews=[],this.profilePoliticalViews=[],this.profileActiveAgo="2h ago",this.profileDistance="",this.profileAbout="",this.profileAvatar="",this.profilePhotos=[],this.profilePhotosCount=0,this.profileKeywords=[],this.profileKeywordsCount=0,this.profileInterests=[],this.profileGoals=[],this.profileOffers=[],this.profileInterestsCount=0,this.profileGoalsCount=0,this.profileOffersCount=0,this.profileLikes=[],this.profileLikesCount=0,this.profileFriends={mutual_bk_friends:[],mutual_bk_friends_count:0,mutual_fb_friends:[],mutual_fb_friends_count:0,mutual_linkedin_connections:[],mutual_linkedin_connections_count:0,mutual_twitter_followers:[],mutual_twitter_followers_count:0,mutual_twitter_friends:[],mutual_twitter_friends_count:0},this.profileFriendsCount=0,this.profileNetworks={facebook:"",twitter:"",linkedin:""},this.loading=!1,this.loadingLikes=!1,this.loadingConnections=!1,this.loadingPhotos=!1,this.galleryActive=!1,this.galleryOptions=JSON.stringify({hashTracking:!1,closeOnOutsideClick:!0})}return ProfileViewComponent.prototype.setUsername=function(username){this.username=username},ProfileViewComponent.prototype.ngOnInit=function(){var _this=this;jQuery(document).on("closed",".remodal",function(e){_this.galleryActive=!1}),setTimeout(function(){window.scrollTo(0,0)}),this.profileServiceInstance=this.profileService.serviceObserver().subscribe(function(res){_this.user=res.data,_this.notFound=res.notFound,_this.loading=res.loading,Object.keys(res.data).length>0&&(_this.assignData(_this.user),setTimeout(function(){jQuery("#userprofile").focus(),window.scrollTo(0,0)}))}),this.profileService.loadProfile(this.username)},ProfileViewComponent.prototype.assignData=function(data){var _this=this;if(this.loadingConnections=!0,this.loadingLikes=!0,this.loadingPhotos=!0,this.profileType=data.connected===!0?"friend":"crowd","friend"===this.profileType&&null===data.updated_at){var url="/api/v1/new_connections/updated_at/?format=json&friend_id="+data.id;this.http.get(url).map(function(res){return res.json()}).subscribe(function(data){_this.counterService.refreshCounter()})}this.profileId=data.id,this.profileName=data.first_name,this.profileAge=data.age,this.profileGender="m"===data.gender?"Male":"Female",this.profileDistance=data.distance[0]+" "+data.distance[1],this.profileLocation=data.lives_in?data.lives_in:"",setTimeout(function(){_this.profileLikesCount=0,_this.profileLikes=[];var likes=data.likes;_this.profileLikes=likes,_this.profileLikesCount=_this.profileLikes.length,_this.loadingLikes=!1}),this.profileJob=data.position&&null!==data.position.job&&null!==data.position.company?data.position.job+" at "+data.position.company:"",this.profileAvatar=data.image,this.profileAbout=data.about,this.profileScore=data.score,this.profileNetworks.facebook="https://www.facebook.com/app_scoped_user_id/"+data.facebook_id,this.profileNetworks.linkedin=data.linkedin_provider&&null!==data.linkedin_provider?data.linkedin_provider:"",this.profileNetworks.twitter=data.twitter_provider&&null!==data.twitter_provider?"https://twitter.com/"+data.twitter_username:"",this.profileOffers=util_1.ObjectUtil.transformSorted(data.offers[0]),this.profileInterests=util_1.ObjectUtil.transformSorted(data.interests[0]),this.profileGoals=util_1.ObjectUtil.transformSorted(data.goals[0]),this.profileInterestsCount=util_1.ObjectUtil.count(data.interests[0]),this.profileOffersCount=util_1.ObjectUtil.count(data.offers[0]),this.profileGoalsCount=util_1.ObjectUtil.count(data.goals[0]);for(var religious_views=[],i=0;i<data.religious_views.length;++i)religious_views=religious_views.concat([{religious_view:data.religious_views[i]}]);this.profileReligiousViews=religious_views;for(var political_views=[],i=0;i<data.political_views.length;++i)political_views=political_views.concat([{political_view:data.political_views[i]}]);this.profilePoliticalViews=political_views,this.getMutualFriends(data.id),this.getPhotos(data.id)},ProfileViewComponent.prototype.getPhotos=function(id){var _this=this;this.photosService.get("",6,id).subscribe(function(data){return _this.assignPhotos(data)})},ProfileViewComponent.prototype.assignPhotos=function(data){var _this=this;this.profilePhotosCount=0,this.profilePhotos=[],setTimeout(function(){data.meta.total_count>0&&(_this.profilePhotos=util_1.ListUtil.orderBy(data.objects,["order"],["asc"]),_this.profilePhotosCount=_this.profilePhotos.length),_this.loadingPhotos=!1})},ProfileViewComponent.prototype.getMutualFriends=function(id){var _this=this;this.mutualfriendsService.get("",100,id).subscribe(function(data){return _this.assignMutualFriends(data)})},ProfileViewComponent.prototype.assignMutualFriends=function(data){var _this=this;this.profileFriendsCount=0,this.profileFriends.mutual_bk_friends=[],this.profileFriends.mutual_fb_friends=[],this.profileFriends.mutual_linkedin_connections=[],this.profileFriends.mutual_twitter_friends=[],this.profileFriends.mutual_twitter_followers=[],setTimeout(function(){if(data.meta.total_count>0){var items=data.objects[0];_this.profileFriendsCount+=parseInt(items.mutual_bk_friends_count,10),_this.profileFriendsCount+=parseInt(items.mutual_fb_friends_count,10),_this.profileFriendsCount+=parseInt(items.mutual_linkedin_connections_count,10),_this.profileFriendsCount+=parseInt(items.mutual_twitter_followers_count,10),_this.profileFriendsCount+=parseInt(items.mutual_twitter_friends_count,10),_this.profileFriends.mutual_bk_friends=items.mutual_bk_friends,_this.profileFriends.mutual_fb_friends=items.mutual_fb_friends,_this.profileFriends.mutual_linkedin_connections=items.mutual_linkedin_connections,_this.profileFriends.mutual_twitter_friends=items.mutual_twitter_friends,_this.profileFriends.mutual_twitter_followers=items.mutual_twitter_followers,_this.loadingConnections=!1}})},ProfileViewComponent.prototype.closeProfile=function(event){var uri=this.historyService.getPrev();""!==uri?this._router.parent.navigateByUrl(uri):this._router.parent.navigateByUrl("/")},ProfileViewComponent.prototype.acceptUser=function(event){var _this=this;this.friendService.saveFriendship(0,event.user).subscribe(function(data){_this.closeProfile(!0)})},ProfileViewComponent.prototype.passUser=function(event){var _this=this;this.friendService.saveFriendship(-1,event.user).subscribe(function(data){_this.closeProfile(!0)})},ProfileViewComponent.prototype.ngOnDestroy=function(){this.profileServiceInstance&&this.profileServiceInstance.unsubscribe(),jQuery(document).off("closed",".remodal")},ProfileViewComponent.prototype.eventHandler=function(key){switch(key){case 27:this.closeProfile(!0)}},ProfileViewComponent.prototype.openGallery=function(event){var remodal=jQuery("[data-remodal-id=modal-gallery]").remodal();remodal.open(),this.galleryActive=!0},ProfileViewComponent=__decorate([core_1.Component({selector:"profile-view",template:view,directives:[profile_avatar_component_1.ProfileAvatarComponent,profile_about_component_1.ProfileAboutComponent,profile_likes_component_1.ProfileLikesComponent,profile_friends_component_1.ProfileFriendsComponent,profile_networks_component_1.ProfileNetworksComponent,profile_items_component_1.ProfileItemsComponent,profile_acceptpass_component_1.ProfileAcceptPassComponent,loading_component_1.LoadingComponent,dropdown_directive_1.DropdownDirective,profile_gallery_component_1.ProfileGalleryComponent,remodal_directive_1.RemodalDirective,router_1.ROUTER_DIRECTIVES],providers:[profile_service_1.ProfileService,mutualfriends_service_1.MutualFriendsService,friend_service_1.FriendService,photos_service_1.PhotosService]}),__metadata("design:paramtypes",[mutualfriends_service_1.MutualFriendsService,profile_service_1.ProfileService,friend_service_1.FriendService,photos_service_1.PhotosService,history_service_1.HistoryService,http_1.Http,connections_counter_service_1.ConnectionsCounterService,router_1.Router])],ProfileViewComponent)}();exports.ProfileViewComponent=ProfileViewComponent}});
//# sourceMappingURL=5.7cbdcffcbd752af49d96.bundle.map