{"version":3,"sources":["webpack:///4.62bff12918cc283e4d5e.chunk.js","webpack:///./src/app/connections/connections.component.ts","webpack:///./src/app/connections/connections.html","webpack:///./src/app/connections/index.ts"],"names":["webpackJsonp",1220,"module","exports","__webpack_require__","__decorate","this","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__metadata","k","v","metadata","core_1","router_1","users_list_1","loading_1","filter_1","profile_1","services_1","lodash_1","ConnectionsComponent","service","filterService","_router","_this","items","loading","loadingInitial","isListEmpty","limit","filter","next","total_count","offset","profileViewActive","selectedUser","currentIndex","onRefreshList","debounce","refreshList","leading","trailing","routerInstance","parent","subscribe","closeProfile","prototype","setLocation","loc","window","history","pushState","ngAfterViewInit","setTimeout","scrollTo","ngOnInit","getList","addObserver","observer","data","err","console","log","ngOnDestroy","unsubscribe","removeObserver","serviceInstance","get","assignList","document","body","scrollTop","documentElement","meta","more","objects","push","jQuery","bind","handleScrollEvent","unbind","viewFriendProfile","id","findIndex","updated_at","username","event","previousProfile","newIndex","nextProfile","scrollOffset","threshold","height","Component","selector","template","directives","FilterDesktopComponent","UsersListComponent","LoadingComponent","ProfileFriendComponent","providers","ConnectionsService","FilterService","Router",1263,819,"__export","m","p","hasOwnProperty"],"mappings":"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","file":"4.62bff12918cc283e4d5e.chunk.js","sourcesContent":["webpackJsonp([4],{\n\n/***/ 1220:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n\t};\r\n\tvar __metadata = (this && this.__metadata) || function (k, v) {\r\n\t    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n\t};\r\n\tvar core_1 = __webpack_require__(3);\r\n\tvar router_1 = __webpack_require__(32);\r\n\tvar users_list_1 = __webpack_require__(822);\r\n\tvar loading_1 = __webpack_require__(40);\r\n\tvar filter_1 = __webpack_require__(813);\r\n\tvar profile_1 = __webpack_require__(563);\r\n\tvar services_1 = __webpack_require__(24);\r\n\tvar lodash_1 = __webpack_require__(23);\r\n\tvar ConnectionsComponent = (function () {\r\n\t    function ConnectionsComponent(service, filterService, _router) {\r\n\t        var _this = this;\r\n\t        this.service = service;\r\n\t        this.filterService = filterService;\r\n\t        this._router = _router;\r\n\t        this.items = [];\r\n\t        this.loading = false;\r\n\t        this.loadingInitial = false;\r\n\t        this.isListEmpty = false;\r\n\t        this.limit = 12;\r\n\t        this.filter = true;\r\n\t        this.next = '';\r\n\t        this.total_count = 0;\r\n\t        this.offset = 0;\r\n\t        this.profileViewActive = false;\r\n\t        this.selectedUser = null;\r\n\t        this.currentIndex = 0;\r\n\t        this.onRefreshList = lodash_1.debounce(this.refreshList, 300, { 'leading': false, 'trailing': true });\r\n\t        this.routerInstance = this._router.parent.subscribe(function (next) {\r\n\t            _this.closeProfile(true);\r\n\t        });\r\n\t    }\r\n\t    ConnectionsComponent.prototype.setLocation = function (loc) {\r\n\t        window.history.pushState('', '', '/' + loc);\r\n\t    };\r\n\t    ConnectionsComponent.prototype.ngAfterViewInit = function () {\r\n\t        setTimeout(function () {\r\n\t            window.scrollTo(0, 0);\r\n\t        });\r\n\t    };\r\n\t    ConnectionsComponent.prototype.ngOnInit = function () {\r\n\t        var _this = this;\r\n\t        this.total_count = 0;\r\n\t        this.getList();\r\n\t        //create new observer and subscribe\r\n\t        this.filterService.addObserver('connections');\r\n\t        this.filterService.observer('connections')\r\n\t            .subscribe(function (data) { return _this.onRefreshList(); }, function (err) { return console.log(err); });\r\n\t    };\r\n\t    ConnectionsComponent.prototype.ngOnDestroy = function () {\r\n\t        this.filterService.observer('connections').unsubscribe();\r\n\t        this.filterService.removeObserver('connections');\r\n\t        if (this.serviceInstance) {\r\n\t            this.serviceInstance.unsubscribe();\r\n\t        }\r\n\t        this.routerInstance.unsubscribe();\r\n\t    };\r\n\t    ConnectionsComponent.prototype.getList = function () {\r\n\t        var _this = this;\r\n\t        if (this.loading) {\r\n\t            return;\r\n\t        }\r\n\t        this.isListEmpty = false;\r\n\t        if (this.next === null)\r\n\t            return;\r\n\t        this.loading = true;\r\n\t        if (this.next === '') {\r\n\t            this.loadingInitial = true;\r\n\t        }\r\n\t        this.serviceInstance = this.service.get(this.next, this.limit, this.filter)\r\n\t            .subscribe(function (data) {\r\n\t            _this.serviceInstance.unsubscribe();\r\n\t            _this.assignList(data);\r\n\t        }, function (err) {\r\n\t            console.log(err);\r\n\t            _this.loading = false;\r\n\t            _this.loadingInitial = false;\r\n\t            _this.serviceInstance.unsubscribe();\r\n\t        }, function () {\r\n\t        });\r\n\t    };\r\n\t    ConnectionsComponent.prototype.refreshList = function () {\r\n\t        if (this.serviceInstance) {\r\n\t            this.serviceInstance.unsubscribe();\r\n\t        }\r\n\t        document.body.scrollTop = document.documentElement.scrollTop = 0;\r\n\t        this.items = [];\r\n\t        this.total_count = 0;\r\n\t        this.currentIndex = 0;\r\n\t        this.isListEmpty = false;\r\n\t        this.next = '';\r\n\t        this.getList();\r\n\t    };\r\n\t    ConnectionsComponent.prototype.assignList = function (data) {\r\n\t        this.loading = false;\r\n\t        this.loadingInitial = false;\r\n\t        if (data.meta.total_count === 0) {\r\n\t            this.isListEmpty = true;\r\n\t            return;\r\n\t        }\r\n\t        else {\r\n\t            this.isListEmpty = false;\r\n\t        }\r\n\t        if (this.items.length > 0) {\r\n\t            var more = data.objects;\r\n\t            for (var i = 0; i <= more.length - 1; i++) {\r\n\t                this.items.push(more[i]);\r\n\t            }\r\n\t            this.total_count += more.length;\r\n\t        }\r\n\t        else {\r\n\t            this.items = data.objects;\r\n\t            this.total_count = data.objects.length;\r\n\t        }\r\n\t        this.next = data.meta.next;\r\n\t        this.offset = data.meta.offset;\r\n\t        //bind to scroll event to load more data on bottom scroll\r\n\t        if (this.next !== null) {\r\n\t            jQuery(window).bind('scroll', this.handleScrollEvent.bind(this));\r\n\t        }\r\n\t        else {\r\n\t            jQuery(window).unbind('scroll');\r\n\t        }\r\n\t    };\r\n\t    ConnectionsComponent.prototype.viewFriendProfile = function (id) {\r\n\t        for (var i = this.items.length - 1; i >= 0; i--) {\r\n\t            if (this.items[i].id === id) {\r\n\t                this.selectedUser = this.items[i];\r\n\t                this.currentIndex = lodash_1.findIndex(this.items, { id: this.selectedUser.id });\r\n\t                this.profileViewActive = true;\r\n\t                if (this.items[i].updated_at === null) {\r\n\t                    this.items[i].updated_at = 'seen';\r\n\t                }\r\n\t                document.body.scrollTop = document.documentElement.scrollTop = 0;\r\n\t                this.setLocation(this.selectedUser.username);\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    ConnectionsComponent.prototype.closeProfile = function (event) {\r\n\t        this.profileViewActive = false;\r\n\t        this.selectedUser = null;\r\n\t        this.setLocation('connections');\r\n\t    };\r\n\t    ConnectionsComponent.prototype.previousProfile = function (event) {\r\n\t        var currentIndex = lodash_1.findIndex(this.items, { id: this.selectedUser.id });\r\n\t        var newIndex = currentIndex - 1;\r\n\t        if (newIndex < 0) {\r\n\t            return;\r\n\t        }\r\n\t        if (this.items.length > 0) {\r\n\t            this.selectedUser = this.items[newIndex];\r\n\t            this.setLocation(this.selectedUser.username);\r\n\t        }\r\n\t        else {\r\n\t            this.closeProfile(true);\r\n\t            this.isListEmpty = true;\r\n\t        }\r\n\t        this.currentIndex = newIndex;\r\n\t    };\r\n\t    ConnectionsComponent.prototype.nextProfile = function (event) {\r\n\t        var currentIndex = lodash_1.findIndex(this.items, { id: this.selectedUser.id });\r\n\t        var newIndex = currentIndex + 1;\r\n\t        if (!this.loading && newIndex > this.items.length - 13 && this.next) {\r\n\t            this.getList();\r\n\t        }\r\n\t        if (newIndex > this.items.length - 1) {\r\n\t            return;\r\n\t        }\r\n\t        if (this.items.length > 0) {\r\n\t            this.selectedUser = this.items[newIndex];\r\n\t            this.setLocation(this.selectedUser.username);\r\n\t        }\r\n\t        else {\r\n\t            this.closeProfile(true);\r\n\t            this.isListEmpty = true;\r\n\t        }\r\n\t        this.currentIndex = newIndex;\r\n\t    };\r\n\t    ConnectionsComponent.prototype.handleScrollEvent = function (event) {\r\n\t        var scrollOffset = jQuery(window).scrollTop();\r\n\t        var threshold = jQuery(document).height() - jQuery(window).height() - 60;\r\n\t        if (this.next && scrollOffset > threshold) {\r\n\t            if (!this.loading) {\r\n\t                this.getList();\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    ConnectionsComponent = __decorate([\r\n\t        core_1.Component({\r\n\t            selector: 'prs-connections',\r\n\t            template: __webpack_require__(1263),\r\n\t            directives: [\r\n\t                filter_1.FilterDesktopComponent,\r\n\t                users_list_1.UsersListComponent,\r\n\t                loading_1.LoadingComponent,\r\n\t                profile_1.ProfileFriendComponent\r\n\t            ],\r\n\t            providers: [\r\n\t                services_1.ConnectionsService\r\n\t            ]\r\n\t        }), \r\n\t        __metadata('design:paramtypes', [services_1.ConnectionsService, services_1.FilterService, router_1.Router])\r\n\t    ], ConnectionsComponent);\r\n\t    return ConnectionsComponent;\r\n\t}());\r\n\texports.ConnectionsComponent = ConnectionsComponent;\r\n\n\n/***/ },\n\n/***/ 1263:\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=\\\"layout layout--flush content\\\" [ngClass]=\\\"{'is-hidden': profileViewActive}\\\">\\n  <div class=\\\"layout__item 3/4 extralarge-and-up-4/5\\\">\\n    <h3 *ngIf=\\\"!loading && emptyList\\\">No results...</h3>\\n    <prs-users-list [showButtons]=\\\"0\\\" [users]=\\\"items\\\" (onClicked)=\\\"viewFriendProfile($event)\\\"></prs-users-list>\\n    <prs-loading [status]=\\\"loading\\\"></prs-loading>\\n    <div class=\\\"no-results\\\" *ngIf=\\\"isListEmpty\\\" [ngClass]=\\\"{'is-visible': isListEmpty}\\\">\\n      <h2 class=\\\"no-results__title\\\">Whoops!</h2>\\n      <p class=\\\"no-results__par\\\">No results found.\\n        <br>Please broaden your search criteria</p>\\n      <img src=\\\"/static/assets/images/polar-bear.png\\\" alt=\\\"Polar Bear\\\">\\n    </div>\\n  </div>\\n  <div class=\\\"layout__item 1/4 extralarge-and-up-1/5 filter-place\\\">\\n    <prs-filters [type]=\\\"'connections'\\\"></prs-filters>\\n  </div>\\n</div>\\n<prs-profile-friend [currentIndex]=\\\"currentIndex\\\" [count]=\\\"total_count\\\" (previousEvent)=\\\"previousProfile($event)\\\" (nextEvent)=\\\"nextProfile($event)\\\" *ngIf=\\\"profileViewActive\\\" [user]=\\\"selectedUser\\\" (closeprofileEvent)=\\\"closeProfile($event)\\\">\\n</prs-profile-friend>\\n\"\n\n/***/ },\n\n/***/ 819:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1220));\r\n\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** 4.62bff12918cc283e4d5e.chunk.js\n **/","import {Component, AfterViewInit, OnInit, OnDestroy} from 'angular2/core';\nimport {Router} from 'angular2/router';\n\nimport {UsersListComponent} from '../shared/components/users-list';\nimport {LoadingComponent} from '../shared/components/loading';\nimport {FilterDesktopComponent} from '../shared/components/filter';\nimport {ProfileFriendComponent} from '../profile';\n\nimport {ConnectionsService, FilterService} from '../shared/services';\n\nimport {findIndex, debounce} from 'lodash';\n\ndeclare var jQuery: any;\n\n@Component({\n  selector: 'prs-connections',\n  template: require('./connections.html'),\n  directives: [\n    FilterDesktopComponent,\n    UsersListComponent,\n    LoadingComponent,\n    ProfileFriendComponent\n  ],\n  providers: [\n    ConnectionsService\n  ]\n})\nexport class ConnectionsComponent implements OnInit, OnDestroy, AfterViewInit {\n  items: Array<any> = [];\n  loading: boolean = false;\n  loadingInitial: boolean = false;\n  isListEmpty: boolean = false;\n  limit: number = 12;\n  filter: boolean = true;\n  next: string = '';\n  total_count: number = 0;\n  offset: number = 0;\n  profileViewActive = false;\n  selectedUser = null;\n  currentIndex = 0;\n  serviceInstance;\n  routerInstance;\n  onRefreshList: Function;\n\n  constructor(\n    private service: ConnectionsService,\n    private filterService: FilterService,\n    private _router: Router\n    ) {\n    this.onRefreshList = debounce(this.refreshList, 300, { 'leading': false, 'trailing': true });\n    this.routerInstance = this._router.parent.subscribe(next => {\n      this.closeProfile(true);\n    });\n  }\n\n  setLocation(loc) {\n    window.history.pushState('', '', '/' + loc);\n  }\n\n  ngAfterViewInit() {\n    setTimeout(() => {\n      window.scrollTo(0, 0);\n    });\n  }\n\n  ngOnInit() {\n    this.total_count = 0;\n    this.getList();\n\n    //create new observer and subscribe\n    this.filterService.addObserver('connections');\n    this.filterService.observer('connections')\n      .subscribe(\n      (data) => this.onRefreshList(),\n      (err) => console.log(err)\n      );\n  }\n\n\n  ngOnDestroy() {\n    this.filterService.observer('connections').unsubscribe();\n    this.filterService.removeObserver('connections');\n    if (this.serviceInstance) {\n      this.serviceInstance.unsubscribe();\n    }\n    this.routerInstance.unsubscribe();\n  }\n\n  getList() {\n    if (this.loading) {\n      return;\n    }\n\n    this.isListEmpty = false;\n    if (this.next === null) return;\n    this.loading = true;\n    if (this.next === '') {\n      this.loadingInitial = true;\n    }\n    this.serviceInstance = this.service.get(this.next, this.limit, this.filter)\n      .subscribe(\n      data => {\n        this.serviceInstance.unsubscribe();\n        this.assignList(data);\n      },\n      (err) => {\n        console.log(err);\n        this.loading = false;\n        this.loadingInitial = false;\n        this.serviceInstance.unsubscribe();\n      },\n      () => {\n\n      });\n  }\n\n\n  refreshList() {\n    if (this.serviceInstance) {\n      this.serviceInstance.unsubscribe();\n    }\n    document.body.scrollTop = document.documentElement.scrollTop = 0;\n    this.items = [];\n    this.total_count = 0;\n    this.currentIndex = 0;\n    this.isListEmpty = false;\n    this.next = '';\n    this.getList();\n  }\n\n  assignList(data) {\n\n    this.loading = false;\n    this.loadingInitial = false;\n\n\n    if (data.meta.total_count === 0) {\n      this.isListEmpty = true;\n      return;\n    } else {\n      this.isListEmpty = false;\n    }\n\n\n    if (this.items.length > 0) {\n      let more = data.objects;\n      for (var i = 0; i <= more.length - 1; i++) {\n        this.items.push(more[i]);\n      }\n      this.total_count += more.length;\n    } else {\n      this.items = data.objects;\n      this.total_count = data.objects.length;\n    }\n\n    this.next = data.meta.next;\n    this.offset = data.meta.offset;\n\n\n    //bind to scroll event to load more data on bottom scroll\n    if (this.next !== null) {\n      jQuery(window).bind('scroll', this.handleScrollEvent.bind(this));\n    } else {\n      jQuery(window).unbind('scroll');\n    }\n\n\n  }\n\n  viewFriendProfile(id) {\n\n    for (var i = this.items.length - 1; i >= 0; i--) {\n      if (this.items[i].id === id) {\n        this.selectedUser = this.items[i];\n        this.currentIndex = findIndex(this.items, { id: this.selectedUser.id });\n        this.profileViewActive = true;\n        if (this.items[i].updated_at === null) {\n          this.items[i].updated_at = 'seen';\n        }\n        document.body.scrollTop = document.documentElement.scrollTop = 0;\n        this.setLocation(this.selectedUser.username);\n      }\n    }\n  }\n\n  closeProfile(event) {\n    this.profileViewActive = false;\n    this.selectedUser = null;\n    this.setLocation('connections');\n  }\n\n  previousProfile(event) {\n    let currentIndex = findIndex(this.items, { id: this.selectedUser.id });\n    let newIndex = currentIndex - 1;\n\n    if (newIndex < 0) {\n      return;\n    }\n    if (this.items.length > 0) {\n      this.selectedUser = this.items[newIndex];\n      this.setLocation(this.selectedUser.username);\n    } else {\n      this.closeProfile(true);\n      this.isListEmpty = true;\n    }\n    this.currentIndex = newIndex;\n  }\n\n  nextProfile(event) {\n    let currentIndex = findIndex(this.items, { id: this.selectedUser.id });\n    let newIndex = currentIndex + 1;\n\n    if (!this.loading && newIndex > this.items.length - 13 && this.next) {\n      this.getList();\n    }\n\n    if (newIndex > this.items.length - 1) {\n      return;\n    }\n    if (this.items.length > 0) {\n      this.selectedUser = this.items[newIndex];\n      this.setLocation(this.selectedUser.username);\n    } else {\n      this.closeProfile(true);\n      this.isListEmpty = true;\n    }\n    this.currentIndex = newIndex;\n  }\n\n\n  handleScrollEvent(event) {\n    let scrollOffset = jQuery(window).scrollTop();\n    let threshold = jQuery(document).height() - jQuery(window).height() - 60;\n\n    if (this.next && scrollOffset > threshold) {\n      if (!this.loading) {\n        this.getList();\n      }\n    }\n\n  }\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/connections/connections.component.ts\n **/","module.exports = \"<div class=\\\"layout layout--flush content\\\" [ngClass]=\\\"{'is-hidden': profileViewActive}\\\">\\n  <div class=\\\"layout__item 3/4 extralarge-and-up-4/5\\\">\\n    <h3 *ngIf=\\\"!loading && emptyList\\\">No results...</h3>\\n    <prs-users-list [showButtons]=\\\"0\\\" [users]=\\\"items\\\" (onClicked)=\\\"viewFriendProfile($event)\\\"></prs-users-list>\\n    <prs-loading [status]=\\\"loading\\\"></prs-loading>\\n    <div class=\\\"no-results\\\" *ngIf=\\\"isListEmpty\\\" [ngClass]=\\\"{'is-visible': isListEmpty}\\\">\\n      <h2 class=\\\"no-results__title\\\">Whoops!</h2>\\n      <p class=\\\"no-results__par\\\">No results found.\\n        <br>Please broaden your search criteria</p>\\n      <img src=\\\"/static/assets/images/polar-bear.png\\\" alt=\\\"Polar Bear\\\">\\n    </div>\\n  </div>\\n  <div class=\\\"layout__item 1/4 extralarge-and-up-1/5 filter-place\\\">\\n    <prs-filters [type]=\\\"'connections'\\\"></prs-filters>\\n  </div>\\n</div>\\n<prs-profile-friend [currentIndex]=\\\"currentIndex\\\" [count]=\\\"total_count\\\" (previousEvent)=\\\"previousProfile($event)\\\" (nextEvent)=\\\"nextProfile($event)\\\" *ngIf=\\\"profileViewActive\\\" [user]=\\\"selectedUser\\\" (closeprofileEvent)=\\\"closeProfile($event)\\\">\\n</prs-profile-friend>\\n\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/app/connections/connections.html\n ** module id = 1263\n ** module chunks = 4\n **/","export * from './connections.component';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/app/connections/index.ts\n **/"],"sourceRoot":""}