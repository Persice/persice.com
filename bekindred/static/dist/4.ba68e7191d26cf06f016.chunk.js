webpackJsonp([4,6],{426:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},core_1=__webpack_require__(2),router_1=__webpack_require__(19),http_1=__webpack_require__(58),profile_avatar_component_1=__webpack_require__(200),profile_about_component_1=__webpack_require__(199),profile_likes_component_1=__webpack_require__(203),profile_friends_component_1=__webpack_require__(201),profile_networks_component_1=__webpack_require__(204),profile_items_component_1=__webpack_require__(202),loading_component_1=__webpack_require__(24),profile_gallery_component_1=__webpack_require__(427),dropdown_directive_1=__webpack_require__(424),remodal_directive_1=__webpack_require__(197),mutualfriends_service_1=__webpack_require__(124),photos_service_1=__webpack_require__(83),religiousviews_service_1=__webpack_require__(60),politicalviews_service_1=__webpack_require__(59),connections_counter_service_1=__webpack_require__(82),util_1=__webpack_require__(10),view=__webpack_require__(428),ProfileFriendComponent=function(){function ProfileFriendComponent(mutualfriendsService,photosService,religiousviewsService,politicalviewsService,counterService,http){this.mutualfriendsService=mutualfriendsService,this.photosService=photosService,this.religiousviewsService=religiousviewsService,this.politicalviewsService=politicalviewsService,this.counterService=counterService,this.http=http,this.closeprofileEvent=new core_1.EventEmitter,this.nextEvent=new core_1.EventEmitter,this.previousEvent=new core_1.EventEmitter,this.friendsTitle="Mutual Connections",this.profileType="friend",this.profileAge="",this.profileGender="",this.profileLocation="",this.profileScore="",this.profileName="",this.profileJob="",this.profileReligiousViews=[],this.profilePoliticalViews=[],this.profileActiveAgo="2h ago",this.profileDistance="",this.profileAbout="",this.profileAvatar="",this.profilePhotos=[],this.profilePhotosCount=0,this.profileKeywords=[],this.profileKeywordsCount=0,this.profileInterests=[],this.profileGoals=[],this.profileOffers=[],this.profileInterestsCount=0,this.profileGoalsCount=0,this.profileOffersCount=0,this.profileLikes=[],this.profileLikesCount=0,this.profileFriends={mutual_bk_friends:[],mutual_bk_friends_count:0,mutual_fb_friends:[],mutual_fb_friends_count:0,mutual_linkedin_connections:[],mutual_linkedin_connections_count:0,mutual_twitter_followers:[],mutual_twitter_followers_count:0,mutual_twitter_friends:[],mutual_twitter_friends_count:0},this.profileFriendsCount=0,this.profileNetworks={facebook:"",twitter:"",linkedin:""},this.loading=!1,this.loadingLikes=!1,this.loadingConnections=!1,this.loadingPhotos=!1,this.galleryActive=!1,this.galleryOptions=JSON.stringify({hashTracking:!1,closeOnOutsideClick:!0})}return ProfileFriendComponent.prototype.ngOnDestroy=function(){jQuery(document).off("closed",".remodal")},ProfileFriendComponent.prototype.ngOnInit=function(){var _this=this;jQuery(document).on("closed",".remodal",function(e){_this.galleryActive=!1}),setTimeout(function(){jQuery("#userprofile").focus(),window.scrollTo(0,0)})},ProfileFriendComponent.prototype.ngOnChanges=function(values){values.user&&values.user.currentValue&&this.assignUser()},ProfileFriendComponent.prototype.assignUser=function(){var _this=this;this.galleryActive=!1,this.loadingConnections=!0,this.loadingPhotos=!0,this.loadingLikes=!0;var url="/api/v1/new_connections/updated_at/?format=json&friend_id="+this.user.id;this.http.get(url).map(function(res){return res.json()}).subscribe(function(data){_this.counterService.refreshCounter()}),this.profileId=this.user.id,this.profileName=this.user.first_name,this.profileAge=this.user.age,this.profileGender="m"===this.user.gender?"Male":"Female",this.profileDistance=this.user.distance[0]+" "+this.user.distance[1],this.profileLocation=this.user.lives_in?this.user.lives_in:"",setTimeout(function(){_this.profileLikesCount=0,_this.profileLikes=[];var likes=_this.user.likes;_this.profileLikes=likes,_this.profileLikesCount=_this.profileLikes.length,_this.loadingLikes=!1}),this.profileJob=this.user.position&&null!==this.user.position.job&&null!==this.user.position.company?this.user.position.job+" at "+this.user.position.company:"",this.profileAvatar=this.user.image,this.profileAbout=this.user.about,this.profileScore=this.user.score,this.profileNetworks.facebook="https://www.facebook.com/app_scoped_user_id/"+this.user.facebook_id,this.profileNetworks.linkedin=this.user.linkedin_provider&&null!==this.user.linkedin_provider?this.user.linkedin_provider:"",this.profileNetworks.twitter=this.user.twitter_provider&&null!==this.user.twitter_provider?"https://twitter.com/"+this.user.twitter_username:"",this.profileOffers=util_1.ObjectUtil.transformSorted(this.user.offers[0]),this.profileInterests=util_1.ObjectUtil.transformSorted(this.user.interests[0]),this.profileGoals=util_1.ObjectUtil.transformSorted(this.user.goals[0]),this.profileInterestsCount=util_1.ObjectUtil.count(this.user.interests[0]),this.profileOffersCount=util_1.ObjectUtil.count(this.user.offers[0]),this.profileGoalsCount=util_1.ObjectUtil.count(this.user.goals[0]),this.profileKeywords=this.user.keywords?this.user.keywords:[],this.profileKeywordsCount=this.user.keywords?this.user.keywords.length:0,this.getMutualFriends(this.user.id),this.getPhotos(this.user.id),this.getReligiousViews(this.user.id),this.getPoliticalViews(this.user.id)},ProfileFriendComponent.prototype.getMutualFriends=function(id){var _this=this;this.mutualfriendsService.get("",100,id).subscribe(function(data){return _this.assignMutualFriends(data)})},ProfileFriendComponent.prototype.getReligiousViews=function(id){var _this=this;this.religiousviewsService.getByUser("",100,id).subscribe(function(data){return _this.assignReligiousViews(data)})},ProfileFriendComponent.prototype.getPoliticalViews=function(id){var _this=this;this.politicalviewsService.getByUser("",100,id).subscribe(function(data){return _this.assignPoliticalViews(data)},function(err){return console.log("Error fetching political views")},function(){})},ProfileFriendComponent.prototype.getPhotos=function(id){var _this=this;this.photosService.get("",6,id).subscribe(function(data){return _this.assignPhotos(data)})},ProfileFriendComponent.prototype.assignPhotos=function(data){var _this=this;this.profilePhotosCount=0,this.profilePhotos=[],setTimeout(function(){data.meta.total_count>0&&(_this.profilePhotos=data.objects.reverse(),_this.profilePhotosCount=_this.profilePhotos.length),_this.loadingPhotos=!1})},ProfileFriendComponent.prototype.assignMutualFriends=function(data){var _this=this;this.profileFriendsCount=0,this.profileFriends.mutual_bk_friends=[],this.profileFriends.mutual_fb_friends=[],this.profileFriends.mutual_linkedin_connections=[],this.profileFriends.mutual_twitter_friends=[],this.profileFriends.mutual_twitter_followers=[],setTimeout(function(){if(data.meta.total_count>0){var items=data.objects[0];_this.profileFriendsCount+=parseInt(items.mutual_bk_friends_count,10),_this.profileFriendsCount+=parseInt(items.mutual_fb_friends_count,10),_this.profileFriendsCount+=parseInt(items.mutual_linkedin_connections_count,10),_this.profileFriendsCount+=parseInt(items.mutual_twitter_followers_count,10),_this.profileFriendsCount+=parseInt(items.mutual_twitter_friends_count,10),_this.profileFriends.mutual_bk_friends=items.mutual_bk_friends,_this.profileFriends.mutual_fb_friends=items.mutual_fb_friends,_this.profileFriends.mutual_linkedin_connections=items.mutual_linkedin_connections,_this.profileFriends.mutual_twitter_friends=items.mutual_twitter_friends,_this.profileFriends.mutual_twitter_followers=items.mutual_twitter_followers,_this.loadingConnections=!1}})},ProfileFriendComponent.prototype.assignReligiousViews=function(data){if(data.meta.total_count>0){var items=data.objects;this.profileReligiousViews=items}},ProfileFriendComponent.prototype.assignPoliticalViews=function(data){if(data.meta.total_count>0){var items=data.objects;this.profilePoliticalViews=items}},ProfileFriendComponent.prototype.closeProfile=function(event){this.closeprofileEvent.next(event)},ProfileFriendComponent.prototype.openMessages=function(event){console.log("open messages")},ProfileFriendComponent.prototype.eventHandler=function(key){switch(key){case 27:this.closeProfile(!0);break;case 37:this.previousEvent.next(!0);break;case 39:this.nextEvent.next(!0)}},ProfileFriendComponent.prototype.openGallery=function(event){var remodal=jQuery("[data-remodal-id=modal-gallery]").remodal();remodal.open(),this.galleryActive=!0},__decorate([core_1.Input(),__metadata("design:type",Object)],ProfileFriendComponent.prototype,"user",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ProfileFriendComponent.prototype,"count",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],ProfileFriendComponent.prototype,"currentIndex",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ProfileFriendComponent.prototype,"closeprofileEvent",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ProfileFriendComponent.prototype,"nextEvent",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],ProfileFriendComponent.prototype,"previousEvent",void 0),ProfileFriendComponent=__decorate([core_1.Component({selector:"profile-friend",template:view,directives:[profile_avatar_component_1.ProfileAvatarComponent,profile_about_component_1.ProfileAboutComponent,profile_likes_component_1.ProfileLikesComponent,profile_friends_component_1.ProfileFriendsComponent,profile_networks_component_1.ProfileNetworksComponent,profile_items_component_1.ProfileItemsComponent,dropdown_directive_1.DropdownDirective,loading_component_1.LoadingComponent,profile_gallery_component_1.ProfileGalleryComponent,remodal_directive_1.RemodalDirective,router_1.ROUTER_DIRECTIVES],providers:[photos_service_1.PhotosService,religiousviews_service_1.ReligiousViewsService]}),__metadata("design:paramtypes",[mutualfriends_service_1.MutualFriendsService,photos_service_1.PhotosService,religiousviews_service_1.ReligiousViewsService,politicalviews_service_1.PoliticalViewsService,connections_counter_service_1.ConnectionsCounterService,http_1.Http])],ProfileFriendComponent)}();exports.ProfileFriendComponent=ProfileFriendComponent},439:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(3>c?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(k,v):void 0},core_1=__webpack_require__(2),router_1=__webpack_require__(19),userslist_component_1=__webpack_require__(438),loading_component_1=__webpack_require__(24),filter_component_1=__webpack_require__(429),profile_friend_component_1=__webpack_require__(426),connections_service_1=__webpack_require__(127),filter_service_1=__webpack_require__(43),lodash_1=__webpack_require__(21),view=__webpack_require__(873),ConnectionsContainer=function(){function ConnectionsContainer(service,filterService,_router){var _this=this;this.service=service,this.filterService=filterService,this._router=_router,this.items=[],this.loading=!1,this.loadingInitial=!1,this.isListEmpty=!1,this.limit=12,this.filter=!0,this.next="",this.total_count=0,this.offset=0,this.profileViewActive=!1,this.selectedUser=null,this.currentIndex=0,this.onRefreshList=lodash_1.debounce(this.refreshList,300,{leading:!1,trailing:!0}),this.routerInstance=this._router.parent.subscribe(function(next){_this.closeProfile(!0)})}return ConnectionsContainer.prototype.setLocation=function(loc){window.history.pushState("","","/"+loc)},ConnectionsContainer.prototype.ngAfterViewInit=function(){setTimeout(function(){window.scrollTo(0,0)})},ConnectionsContainer.prototype.ngOnInit=function(){var _this=this;this.total_count=0,this.getList(),this.filterService.addObserver("connections"),this.filterService.observer("connections").subscribe(function(data){return _this.onRefreshList()},function(err){return console.log(err)})},ConnectionsContainer.prototype.ngOnDestroy=function(){this.filterService.observer("connections").unsubscribe(),this.filterService.removeObserver("connections"),this.serviceInstance&&this.serviceInstance.unsubscribe(),this.routerInstance.unsubscribe()},ConnectionsContainer.prototype.getList=function(){var _this=this;this.loading||(this.isListEmpty=!1,null!==this.next&&(this.loading=!0,""===this.next&&(this.loadingInitial=!0),this.serviceInstance=this.service.get(this.next,this.limit,this.filter).subscribe(function(data){_this.serviceInstance.unsubscribe(),_this.assignList(data)},function(err){console.log(err),_this.loading=!1,_this.loadingInitial=!1,_this.serviceInstance.unsubscribe()},function(){})))},ConnectionsContainer.prototype.refreshList=function(){this.serviceInstance&&this.serviceInstance.unsubscribe(),document.body.scrollTop=document.documentElement.scrollTop=0,this.items=[],this.total_count=0,this.currentIndex=0,this.isListEmpty=!1,this.next="",this.getList()},ConnectionsContainer.prototype.assignList=function(data){if(this.loading=!1,this.loadingInitial=!1,0===data.meta.total_count)return void(this.isListEmpty=!0);if(this.isListEmpty=!1,this.items.length>0){for(var more=data.objects,i=0;i<=more.length-1;i++)this.items.push(more[i]);this.total_count+=more.length}else this.items=data.objects,this.total_count=data.objects.length;this.next=data.meta.next,this.offset=data.meta.offset,null!==this.next?jQuery(window).bind("scroll",this.handleScrollEvent.bind(this)):jQuery(window).unbind("scroll")},ConnectionsContainer.prototype.viewFriendProfile=function(id){for(var i=this.items.length-1;i>=0;i--)this.items[i].id===id&&(this.selectedUser=this.items[i],this.currentIndex=lodash_1.findIndex(this.items,{id:this.selectedUser.id}),this.profileViewActive=!0,null===this.items[i].updated_at&&(this.items[i].updated_at="seen"),document.body.scrollTop=document.documentElement.scrollTop=0,this.setLocation(this.selectedUser.username))},ConnectionsContainer.prototype.closeProfile=function(event){this.profileViewActive=!1,this.selectedUser=null,this.setLocation("connections")},ConnectionsContainer.prototype.previousProfile=function(event){var currentIndex=lodash_1.findIndex(this.items,{id:this.selectedUser.id}),newIndex=currentIndex-1;0>newIndex||(this.items.length>0?(this.selectedUser=this.items[newIndex],this.setLocation(this.selectedUser.username)):(this.closeProfile(!0),this.isListEmpty=!0),this.currentIndex=newIndex)},ConnectionsContainer.prototype.nextProfile=function(event){var currentIndex=lodash_1.findIndex(this.items,{id:this.selectedUser.id}),newIndex=currentIndex+1;!this.loading&&newIndex>this.items.length-13&&this.next&&this.getList(),newIndex>this.items.length-1||(this.items.length>0?(this.selectedUser=this.items[newIndex],this.setLocation(this.selectedUser.username)):(this.closeProfile(!0),this.isListEmpty=!0),this.currentIndex=newIndex)},ConnectionsContainer.prototype.handleScrollEvent=function(event){var scrollOffset=jQuery(window).scrollTop(),threshold=jQuery(document).height()-jQuery(window).height()-60;this.next&&scrollOffset>threshold&&(this.loading||this.getList())},ConnectionsContainer=__decorate([core_1.Component({selector:"connections-page",template:view,directives:[filter_component_1.FilterComponent,userslist_component_1.UsersListComponent,loading_component_1.LoadingComponent,profile_friend_component_1.ProfileFriendComponent]}),__metadata("design:paramtypes",[connections_service_1.ConnectionsService,filter_service_1.FilterService,router_1.Router])],ConnectionsContainer)}();exports.ConnectionsContainer=ConnectionsContainer},873:function(module,exports){module.exports='<div class="layout layout--flush content" [ngClass]="{\'is-hidden\': profileViewActive}">\n  <div class="layout__item 3/4 extralarge-and-up-4/5">\n    <h3 *ngIf="!loading && emptyList">No results...</h3>\n    <users-list [showButtons]="0" [users]="items" (onClicked)="viewFriendProfile($event)"></users-list>\n    <loading [status]="loading"></loading>\n    <div class="no-results" *ngIf="isListEmpty" [ngClass]="{\'is-visible\': isListEmpty}">\n      <h2 class="no-results__title">Whoops!</h2>\n      <p class="no-results__par">No results found.\n        <br>Please broaden your search criteria</p>\n      <img src="/static/assets/images/polar-bear.png" alt="Polar Bear">\n    </div>\n  </div>\n  <div class="layout__item 1/4 extralarge-and-up-1/5 filter-place">\n    <filters [type]="\'connections\'"></filters>\n  </div>\n</div>\n<profile-friend [currentIndex]="currentIndex" [count]="total_count" (previousEvent)="previousProfile($event)" (nextEvent)="nextProfile($event)" *ngIf="profileViewActive" [user]="selectedUser" (closeprofileEvent)="closeProfile($event)">\n</profile-friend>\n'}});
//# sourceMappingURL=4.ba68e7191d26cf06f016.bundle.map