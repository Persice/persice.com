<div id="mycontroller">
  <div class="ui fixed borderless menu" id="headermenu">
    <a class="icon item" ui-sref="inbox"><i class="left chevron icon"></i></a>
    <h3 class="ui center aligned header">{{friend.first_name}}</h3>

  </div>

  <div class="ui fixed menu" id="submenu">
    <div class="3 fluid large ui buttons">
      <a ui-sref="conversations({ userId: friend.id })" ng-class="{'active': leftActive}" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a>
      <a ui-sref="friendprofile({ userId: friend.id })" class="ui button"><i class="fa fa-user icon"></i></a>
      <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i>
        <div class="menu" id="friendmenu">
          <div class="item">
            Get Introduced
          </div>
          <div class="item">
            Add to Group
          </div>
          <div class="item">
            Arrange Meetup
          </div>
          <div class="item">
            Flag as Inappropriate
          </div>
          <div class="item deleteconnection">
            Remove Connection
          </div>
        </div>
      </a>


    </div>
  </div>

  <div class="conversation-content basic ui segment" ng-class="{'loading': loadingMessages}" when-scrolled="loadMore()" scroll-bottom-on="status.loaded">

    <three-bounce-spinner class="page-spinner-bar" ng-show="status.loading"></three-bounce-spinner>
    <div class="repeat-animation" ng-repeat="message in messages track by $index">
     <h6>
      {{message.date}}
    </h6>
    <div ng-style="" class="repeat-animation" ng-class="{'bubbledLeft': msg.left, 'bubbledRight': !msg.left, 'lastMessage': $last}" ng-repeat="msg in message.contents | orderBy:'sent_at' track by $index">
      <p>
        {{msg.body}}
      </p>
      <span class="conversation-time">{{msg.sent_at | amDateFormat:'h:mm a'}}</span>
    </div>
  </div>

</div>

<!-- empty state -->
<div class="conversation-content ui segment" ng-if="messages.length === 0">

  <h3>
    There are no any messages
  </h3>
</div>



<div class="message-reply">
  <div class="ui fluid action input">
    <input ng-enter="sendNewMessage()" type="text" placeholder="" ng-model="newmessage">
    <div ng-click="sendNewMessage()" class="ui button" ng-class="{'loading': sendingMessage}">Send</div>
  </div>
</div>


<script>
  'use strict';

  $('.ui.dropdown')
  .dropdown({
    onShow:  function(){


      var scope = angular.element($("#submenu")).scope();
      scope.$apply(function(){
        scope.leftActive = false;
      });
    },
    onHide: function(){

      var scope = angular.element($("#submenu")).scope();
      setTimeout(function() {
        scope.$apply(function(){
          scope.leftActive = true;
        });
      }, 100);
    }
  })
  ;

  $('.basic.delete.modal')
  .modal({
    onDeny    : function(){
      console.log('cancel');
    },
    onApprove : function() {
      console.log('deleting user');

      angular.element(document.getElementById('mycontroller')).scope().unFriend();

    }
  })
  .modal('attach events', '.deleteconnection', 'show');

</script>

<!-- modals -->

<div class="ui basic delete modal">
  <i class="close icon"></i>
  <div class="header">
    Please Confirm
  </div>
  <div class="content">

    <div class="description">
      <p>Are you sure you want remove this connection?</p>
    </div>
  </div>
  <div class="actions">
    <div class="two fluid ui inverted buttons">
      <div class="ui red negative basic inverted button">
        <i class="remove icon"></i>
        No
      </div>
      <a class="ui green basic inverted button ok">
        <i class="checkmark icon"></i>
        Yes
      </a>
    </div>
  </div>
</div>

</div>




