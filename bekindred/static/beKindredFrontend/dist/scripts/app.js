"use strict";angular.module("beKindred",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","angular-spinkit","frontend.semantic.dimmer","truncate","ya.nouislider","ngDraggable","angucomplete-alt","angular-carousel","cgNotify","ngImgCrop","angularMoment","btford.socket-io","zInfiniteScroll","infinite-scroll","ngLodash"]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$resourceProvider",function(e,s,i,t){i.defaults.headers.patch={"Content-Type":"application/json;charset=utf-8"},t.defaults.stripTrailingSlashes=!1,i.defaults.xsrfCookieName="csrftoken",i.defaults.xsrfHeaderName="X-CSRFToken",i.defaults.headers.post={"Content-Type":"application/json;charset=utf-8"},e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl",data:{displayName:"BeKindred"},resolve:{}}).state("settings",{url:"/settings",templateUrl:"app/settings/settings.html",controller:"SettingsCtrl",data:{displayName:"Settings"},resolve:{}}).state("conversations",{url:"/conversation/:userId",data:{displayName:"Conversations"},resolve:{userId:["$stateParams",function(e){return e.userId}],UsersFactory:"UsersFactory",FRIEND:["UsersFactory","$stateParams",function(e,s){var i=s.userId;return e.get({userId:i,format:"json"}).$promise}],ConnectionsFactory:"ConnectionsFactory",Connection:["ConnectionsFactory","$stateParams",function(e,s){var i=s.userId;return e.query({friend:i,format:"json"}).$promise}]},templateUrl:"app/conversations/conversations.html",controller:"ConversationsCtrl"}).state("goalcreate",{url:"/create-goal",data:{displayName:"Create a goal"},templateUrl:"app/goalcreate/goalcreate.html",controller:"GoalCreateCtrl"}).state("finalstep",{url:"/final-step",data:{displayName:"Final Step"},resolve:{UsersFactory:"UsersFactory",User:["UsersFactory","USER_ID",function(e,s){var i=s;return e.get({userId:i,format:"json"}).$promise}]},templateUrl:"app/finalstep/finalstep.html",controller:"FinalStepController",controllerAs:"finalstep"}).state("selectinterests",{url:"/select-interests",data:{displayName:"What interests you?"},templateUrl:"app/interests/interests.html",controller:"InterestsController",controllerAs:"interest"}).state("offercreate",{url:"/create-offer",data:{displayName:"Post an offer"},templateUrl:"app/offercreate/offercreate.html",controller:"OfferCreateCtrl"}).state("matchfeed",{url:"/match-feed",data:{displayName:"Match Feed"},templateUrl:"app/matchfeed/matchfeed.html",controller:"MatchFeedCtrl"}).state("myconnections",{url:"/my-connections",data:{displayName:"Connections"},templateUrl:"app/myconnections/myconnections.html",controller:"MyConnectionsCtrl"}).state("friendprofile",{url:"/friend-profile/:userId",data:{displayName:"Connection"},resolve:{userId:["$stateParams",function(e){return e.userId}],ProfileFactory:"ProfileFactory",ConnectionsFactory:"ConnectionsFactory",User:["ProfileFactory","$stateParams",function(e,s){var i=s.userId;return e.get({user_id:i,format:"json"}).$promise}],Connection:["ConnectionsFactory","$stateParams",function(e,s){var i=s.userId;return e.query({friend:i,format:"json"}).$promise}]},templateUrl:"app/friendprofile/friendprofile.html",controller:"FriendProfileCtrl"}).state("myprofile",{url:"/my-profile",data:{displayName:"Profile"},templateUrl:"app/myprofile/myprofile.html",controller:"MyProfileCtrl"}).state("editmyprofile",{url:"/my-profile/edit",data:{displayName:"Edit profile"},templateUrl:"app/editmyprofile/editmyprofile.html",controller:"EditMyProfileCtrl"}).state("inbox",{url:"/messages",data:{displayName:"Messages"},templateUrl:"app/inbox/inbox.html",controller:"InboxController",controllerAs:"inbox"}),s.otherwise("/")}]).run(["$rootScope","$state","$stateParams","$timeout",function(e,s,i){e.$state=s,e.isState=function(e){return s.includes(e)},e.$stateParams=i,e.$on("$stateChangeStart",function(){$(".sidebar").sidebar("is visible")&&$(".sidebar").sidebar("hide")}),e.$on("$stateChangeSuccess",function(){}),e.$on("$stateChangeError",function(){})}]).value("noUiSliderConfig",{step:1}).directive("ngEnter",function(){return function(e,s,i){s.bind("keydown keypress",function(s){13===s.which&&(e.$apply(function(){e.$eval(i.ngEnter)}),s.preventDefault())})}}).directive("updateTitle",["$rootScope","$timeout",function(e,s){return{link:function(i,t){var n=function(e,i){var n="Kinred";i.data&&i.data.displayName&&(n=i.data.displayName),s(function(){t.text(n)})};e.$on("$stateChangeSuccess",n)}}}]).directive("endRepeat",["$timeout",function(e){return{restrict:"A",link:function(s){s.$last===!0&&e(function(){s.$emit("ngRepeatFinished")})}}}]).directive("endRepeatPhotos",["$timeout",function(e){return{restrict:"A",link:function(s){s.$last===!0&&e(function(){s.$emit("ngRepeatFinishedPhotos")})}}}]).filter("getByProperty",function(){return function(e,s,i){for(var t=0,n=i.length;n>t;t++)if(i[t][e]===s)return i[t];return null}}).filter("lastMessage",function(){return function(e){return null===e?"No messages.":e}}).filter("getIndexByProperty",function(){return function(e,s,i){for(var t=0,n=i.length;n>t;t++)if(i[t][e]===s)return t;return null}}).filter("getByPropertyExcept",function(){return function(e,s,i,t,n){for(var r=0,o=n.length;o>r;r++)if(n[r][e]===s&&n[r][i]!==t)return n[r];return null}}).directive("modal",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{model:"=ngModel"},template:'<div class="ui dimmer modals page transition" style="position: absolute;" ng-class="{ \'active visible\': model }"><div class="ui long test modal transition scrolling" style="top: 150px;" ng-class="{ \'active visible\': model }" ng-transclude></div></div>',link:function(){}}}).directive("ngChangeOnBlur",function(){return{restrict:"A",require:"ngModel",link:function(e,s,i){if("radio"!==i.type&&"checkbox"!==i.type){var t=i.ngChangeOnBlur,n=null;s.bind("focus",function(){e.$apply(function(){n=s.val()})}),s.bind("blur",function(){e.$apply(function(){var i=s.val();i!==n&&e.$eval(t)})})}}}}).factory("myIoSocket",["socketFactory",function(e){var s=io.connect("//"+window.location.hostname+":3000");return s=e({ioSocket:s}),s.forward("message"),s.forward("error"),s}]),angular.module("beKindred").controller("TopNavbarCtrl",["$scope",function(){}]),angular.module("beKindred").factory("FiltersFactory",["$resource",function(e){return e("/api/v1/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),angular.module("beKindred").controller("FilterController",["$scope","$rootScope","FiltersFactory","USER_ID","$log",function(e,s,i,t){e.distanceValue=1e4,e.distanceOptions={range:{min:1,max:1e4}},e.genders="",e.filtermessage="",e.defaultFilters={objects:[{distance:1e4,gender:"m,f",min_age:25,max_age:60,keyword:"",user:"/api/v1/auth/user/"+t+"/"}]},e.filters=e.defaultFilters.objects,e.showFilterMessage=!1,e.filterID=null,e.ageValues=[25,60],e.ageOptions={range:{min:18,max:115}},e.myKeywords=[],e.saveFilters=function(){i.query({format:"json"}).$promise.then(function(s){e.filters=s.objects,e.filterID=e.filters[0].id,e.newFilters={distance:e.distanceValue,gender:e.genders,min_age:e.ageValues[0],max_age:e.ageValues[1],keyword:e.myKeywords.join(),id:e.filterID,user:"/api/v1/auth/user/"+t+"/"},i.update({filterId:e.filterID},e.newFilters,function(){},function(){})})},e.getFilters=function(){i.query({format:"json"}).$promise.then(function(s){e.filters=s.objects,0===e.filters.length?i.update({},e.defaultFilters,function(){$(".ui.checkbox").checkbox("check")},function(e){console.log(e)}):(e.distanceValue=s.objects[0].distance,e.ageValues[0]=s.objects[0].min_age,e.ageValues[1]=s.objects[0].max_age,""!==s.objects[0].keyword&&(e.myKeywords=s.objects[0].keyword.split(",")),""===s.objects[0].gender&&$(".ui.checkbox").checkbox("uncheck"),"m,f"===s.objects[0].gender&&$(".ui.checkbox").checkbox("check"),"m"===s.objects[0].gender&&($("#male").checkbox("check"),$("#female").checkbox("uncheck")),"f"===s.objects[0].gender&&($("#female").checkbox("check"),$("#male").checkbox("uncheck")))})},e.getFilters(),e.removeKeyword=function(s){e.myKeywords.splice(s,1),e.saveFilters()},e.addKeyword=function(s){if(e.filtermessage="",""==s||void 0==s)e.filtermessage="Keyword must have at least 3 letters",e.showFilterMessage=!0;else if(e.myKeywords.length<5){e.existing=!1;for(var i=e.myKeywords.length-1;i>=0;i--)e.myKeywords[i]===s&&(e.existing=!0);e.existing===!1?(e.myKeywords.push(s),e.saveFilters(),e.newKeyword="",e.showFilterMessage=!1):(e.filtermessage="Keyword already exists",e.showFilterMessage=!0)}else e.filtermessage="You cannot add more than 5 keywords",e.showFilterMessage=!0}}]),function(){function e(){function e(){}var i={controller:s,controllerAs:"messages",bindToController:!0,scope:{},link:e,template:"{{messages.counter}}",restrict:"EA"};return i}function s(e,s,i){function t(){n.counter=s.getUnreadMessagesCounter()}var n=this;n.counter=0,n.refreshCounter=t,i.$on("refreshInboxMessages",function(){n.refreshCounter()}),n.refreshCounter()}angular.module("beKindred").directive("messagesCounter",e),s.$inject=["$scope","InboxRepository","$rootScope","$log"]}(),angular.module("beKindred").controller("LeftSidebarCtrl",["$scope",function(){}]),angular.module("frontend.semantic.dimmer",[]).directive("pageDimmer",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{show:"=?",model:"=ngModel"},template:'<div class="{{dimmer_class}}" ng-click="click_on_dimmer()"><div class="content"><div class="center" ng-transclude></div></div></div>',link:function(e){1==e.show?e.dimmer_class="ui page inverted active dimmer":(e.show=!1,e.dimmer_class="ui page inverted disable dimmer"),e.click_on_dimmer=function(){e.model=!0,e.show=!0,e.dimmer_class="ui page inverted active dimmer"},e.$watch("model",function(s){return 0==s||void 0==s?(e.show=!1,void(e.dimmer_class="ui page inverted disable dimmer")):void(e.dimmer_class="ui page inverted active dimmer")})}}}),angular.module("beKindred").controller("SettingsCtrl",["$rootScope","$scope","$log","$timeout","$window","$http",function(e,s,i,t,n,r){s.deleteUser=function(){i.info("delete user"),r({method:"POST",url:"/accounts/deactivate/",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),n.location.href="/accounts/logout",n.location.assign()}}]),angular.module("beKindred").controller("OfferCreateCtrl",["$scope","$state","$log","OffersFactory","SubjectsFactory","USER_ID","$filter",function(e,s,i,t,n,r){e.subject="",e.resourceUri=null,e.messageShow=!1,e.message="",e.userUri="/api/v1/auth/user/"+r+"/",e.inputChanged=function(s){e.subject=s},e.selectResult=function(s){void 0!==s?(e.subject=s.originalObject.description,e.resourceUri=s.originalObject.resource_uri):e.resourceUri=null},e.saveOffer=function(){var i={offer_subject:e.subject,user:e.userUri};t.save({},i,function(){s.go("finalstep")},function(s){e.resourceUri=null,e.messageShow=!0,e.message=s.data.offer?s.data.offer.error[0]:"There was an error when trying to save your offer."})},e.createOffer=function(){return e.messageShow=!1,e.message="",""===e.subject?(e.message="Entering your offer is required to continue.",e.messageShow=!0,!1):e.subject.length>300?(e.message="Offer cannot have more than 300 characters.",e.messageShow=!0,!1):void e.saveOffer()}}]),angular.module("beKindred").controller("MyProfileCtrl",["$scope","USER_ID","UsersFactory","InterestsFactory","GoalsFactory","OffersFactory","LikesFactory","PhotosFactory","USER_PHOTO","$log",function(e,s,i,t,n,r,o,a,l,c){e.twitter=null,e.linkedin=null,e.user={id:1,firstName:"",lastName:"",age:"",about_me:"",photos:[],goals:[],offers:[],likes:[],interests:[],mutual:{friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[]}},e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1,e.loadingInterests=!1,e.getUser=function(){e.loadingUser=!0,e.loadingGoals=!0,e.loadingOffers=!0,e.loadingLikes=!0,n.query({user_id:s,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.goals=s.objects),e.loadingGoals=!1},function(e){var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);c.error(i)}),r.query({user_id:s,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.offers=s.objects),e.loadingOffers=!1},function(e){var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);c.error(i)}),o.query({format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.likes=s.objects),e.loadingLikes=!1},function(e){var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);c.error(i)}),t.query({user_id:s,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.interests=s.objects),e.loadingInterests=!1},function(e){var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);c.error(i)}),i.get({format:"json"},{userId:s}).$promise.then(function(s){e.user.firstName=s.first_name,e.user.lastName=s.last_name,e.user.about_me=s.about_me,e.user.age=s.age,e.user.facebookId=s.facebook_id,e.user.facebookProfile=s.facebook_profile_url,e.twitter=s.twitter_provider,e.linkedin=s.linkedin_provider,e.loadingUser=!1},function(s){var i=(s.data,s.status),t=(s.header,s.config,"Error "+i);e.loadingUser=!1,c.error(t)})},e.getUser(),e.photosSlider=[],e.getPhotos=function(){a.query({format:"json"}).$promise.then(function(i){if(e.user.photos=i.objects,0===e.user.photos.length){var t={photo:l,cropped_photo:"",order:0,user:"/api/v1/auth/user/"+s+"/"};a.save({},t,function(s){c.info(s),c.info("New photo saved."),e.user.photos.push({photo:l,cropped_photo:"",order:0}),e.photosSlider=e.user.photos},function(e){c.info(e)})}else e.photosSlider=e.user.photos},function(e){var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);c.error(i)})},e.getPhotos()}]),angular.module("beKindred").controller("MyConnectionsCtrl",["$scope","FriendsFactory","USER_ID","$resource","ConnectionsFactory","$log",function(e,s,i,t,n,r){e.friends=[],e.q="",e.noConnections=!1,e.pok=!1,e.noResults=!1;e.loading=!1,e.loadingMore=!1,e.nextOffset=5,e.next=null,e.reset=function(){e.q="",e.getFriends()},e.getFriends=function(){e.nextOffset=5,e.next=null,e.loading=!0,n.query({format:"json",first_name:e.q,limit:5,offset:0}).$promise.then(function(s){if(e.friends=s.objects,e.next=s.meta.next,0===e.friends.length)e.pok?e.noResults=!0:(e.noConnections=!0,e.pok=!0);else{e.pok=!0,e.noResults=!1,e.noConnections=!1;for(var i in e.friends)e.friends[i].totalFriends=0,e.friends[i].totalFriends+=e.friends[i].mutual_bk_friends_count,e.friends[i].totalFriends+=e.friends[i].mutual_fb_friends_count,e.friends[i].totalFriends+=e.friends[i].mutual_linkedin_connections_count,e.friends[i].totalFriends+=e.friends[i].mutual_twitter_friends_count,e.friends[i].totalFriends+=e.friends[i].mutual_twitter_followers_count}e.loading=!1},function(s){var i=(s.data,s.status),t=(s.header,s.config,"Error "+i);r.error(t),e.loading=!1})},e.getFriends(),e.loadMoreFriends=function(){e.loadingMore||null!==e.next&&(e.loadingMore=!0,n.query({format:"json",limit:5,first_name:e.q,offset:e.nextOffset}).$promise.then(function(s){var i=s.objects;e.next=s.meta.next,e.nextOffset+=5;for(var t in i)i[t].totalFriends=0,i[t].totalFriends+=i[t].mutual_bk_friends_count,i[t].totalFriends+=i[t].mutual_fb_friends_count,i[t].totalFriends+=i[t].mutual_linkedin_connections_count,i[t].totalFriends+=i[t].mutual_twitter_friends_count,i[t].totalFriends+=i[t].mutual_twitter_followers_count,e.friends.push(i[t]);e.loadingMore=!1},function(s){var i=(s.data,s.status),t=(s.header,s.config,"Error "+i);r.error(t),e.loadingMore=!1}))}}]),angular.module("beKindred").factory("MatchFeedFactory",["$resource",function(e){return e("/api/v1/matchfeed/:matchId/:param",{matchId:"@matchId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),angular.module("beKindred").controller("MatchFeedCtrl",["$rootScope","$scope","$timeout","$filter","USER_ID","MatchFeedFactory","PhotosFactory","FriendsFactory","$log","MutualFriendsFactory",function(e,s,i,t,n,r,o,a,l,c){s.matchedUser=[],s.total=0,s.offset=0,s.previous=null,s.next=null,s.me="/api/v1/auth/user/"+n+"/",s.friendshipStatus=null,s.friendshipId=null,s.filtering=!0,s.photosSlider=[],s.loadingFeed=!1;var d=0;s.toggleSidebarFilters=function(){l.info("Toggle sidebar"),$("#filtersMenu").sidebar("toggle")},s.totalfriendscount=0,s.totalmatchingcount=0,s.loadMatches=function(){s.totalfriendscount=0,s.totalmatchingcount=0,0===d?(s.showDimmer=!0,e.hideTopMenu=!0,$("#filtersMenu").sidebar("hide"),s.matchedUser=[],r.query({format:"json",filter:s.filtering}).$promise.then(function(i){s.matchedUser=[],s.total=0,s.offset=0,s.previous=null,s.next=null;var n=i.objects;if(n.length>0){s.total=i.meta.total_count,s.matchedUser=i.objects[0],s.offset=i.meta.offset,s.total=i.meta.total_count,s.previous=i.meta.previous,s.next=i.meta.next;var r=[],a=s.matchedUser.goals[0];for(var d in a){var u={value:d,match:a[d]};r.push(u),1===u.match&&s.totalmatchingcount++}s.matchedUser.goals=r;var f=[],h=s.matchedUser.offers[0];for(var d in h){var g={value:d,match:h[d]};f.push(g),1===g.match&&s.totalmatchingcount++}s.matchedUser.offers=f;var m=[],v=s.matchedUser.interests[0];for(var d in v){var p={value:d,match:v[d]};m.push(p),1===p.match&&s.totalmatchingcount++}s.matchedUser.interests=m;var b=[],y=s.matchedUser.likes[0];for(var d in y){var w={value:d,match:y[d]};b.push(w),1===w.match&&s.totalmatchingcount++}s.matchedUser.likes=b,c.query({format:"json",user_id:s.matchedUser.id}).$promise.then(function(e){e.objects.length>0&&(s.matchedUser.friends=e.objects[0].mutual_bk_friends,s.matchedUser.facebookfriends=e.objects[0].mutual_fb_friends,s.matchedUser.linkedinconnections=e.objects[0].mutual_linkedin_connections,s.matchedUser.twitterfollowers=e.objects[0].mutual_twitter_followers,s.matchedUser.twitterfriends=e.objects[0].mutual_twitter_friends,s.totalfriendscount+=e.objects[0].mutual_bk_friends_count,s.totalfriendscount+=e.objects[0].mutual_fb_friends_count,s.totalfriendscount+=e.objects[0].mutual_linkedin_connections_count,s.totalfriendscount+=e.objects[0].mutual_twitter_followers_count,s.totalfriendscount+=e.objects[0].mutual_twitter_friends_count)}),s.defaultUserPhoto="//graph.facebook.com/"+s.matchedUser.facebook_id+"/picture?type=large",o.query({format:"json",user_id:s.matchedUser.user_id}).$promise.then(function(e){if(s.matchedUser.photos=e.objects,s.matchedUser.photos.length>0)s.photosSlider=s.matchedUser.photos;else{var i={photo:s.defaultUserPhoto,order:0,user:"/api/v1/auth/user/"+s.matchedUser.user_id+"/"};o.save({},i,function(e){l.info(e),l.info("New photo saved."),s.matchedUser.photos.push(e),s.photosSlider=s.matchedUser.photos},function(e){l.info(e)})}s.photosSlider=t("orderBy")(s.photosSlider,"order",!1)})}else s.matchedUser=[],s.total=0,s.offset=0,s.previous=null,s.next=null;s.showDimmer=!1,e.hideTopMenu=!1,s.filtering=!0},function(i){s.filtering=!0;var t=(i.data,i.status),n=(i.header,i.config,"Error "+t);l.error(n),s.matchedUser=[],s.total=0,s.offset=0,s.previous=null,s.next=null,s.showDimmer=!1,e.hideTopMenu=!1}),d=1):(s.showDimmer=!1,e.hideTopMenu=!1)},s.loadMatches(),e.showfullprofile=!1,e.$on("cancelMatchEvent",function(){s.cancelMatch()}),e.$on("confirmMatchEvent",function(){s.confirmMatch()}),e.$on("refreshMatchFeed",function(){d=0,s.filtering=!0,s.loadMatches()}),s.getNextMatch=function(){s.totalfriendscount=0,s.totalmatchingcount=0,s.loadingFeed=!0;var i=s.offset;i++,i===s.total&&(i=0),l.info(s.total),r.query({format:"json",offset:0,limit:1,filter:s.filtering}).$promise.then(function(e){var i=e.objects;if(i.length>0){l.info("more results"),l.info(i.length),s.matchedUser=e.objects[0],s.offset=e.meta.offset,s.total=e.meta.total_count,s.previous=e.meta.previous,s.next=e.meta.next;var n=[],r=s.matchedUser.goals[0];for(var a in r){var d={value:a,match:r[a]};n.push(d),1===d.match&&s.totalmatchingcount++}s.matchedUser.goals=n;var u=[],f=s.matchedUser.offers[0];for(var a in f){var h={value:a,match:f[a]};u.push(h),1===h.match&&s.totalmatchingcount++}s.matchedUser.offers=u;var g=[],m=s.matchedUser.interests[0];for(var a in m){var v={value:a,match:m[a]};g.push(v),1===v.match&&s.totalmatchingcount++}s.matchedUser.interests=g;var p=[],b=s.matchedUser.likes[0];for(var a in b){var y={value:a,match:b[a]};p.push(y),1===y.match&&s.totalmatchingcount++}s.matchedUser.likes=p,c.query({format:"json",user_id:s.matchedUser.id}).$promise.then(function(e){e.objects.length>0&&(s.matchedUser.friends=e.objects[0].mutual_bk_friends,s.matchedUser.facebookfriends=e.objects[0].mutual_fb_friends,s.matchedUser.linkedinconnections=e.objects[0].mutual_linkedin_connections,s.matchedUser.twitterfollowers=e.objects[0].mutual_twitter_followers,s.matchedUser.twitterfriends=e.objects[0].mutual_twitter_friends,s.totalfriendscount+=e.objects[0].mutual_bk_friends_count,s.totalfriendscount+=e.objects[0].mutual_fb_friends_count,s.totalfriendscount+=e.objects[0].mutual_linkedin_connections_count,s.totalfriendscount+=e.objects[0].mutual_twitter_followers_count,s.totalfriendscount+=e.objects[0].mutual_twitter_friends_count)}),s.defaultUserPhoto="//graph.facebook.com/"+s.matchedUser.facebook_id+"/picture?type=large",o.query({format:"json",user_id:s.matchedUser.user_id}).$promise.then(function(e){if(s.matchedUser.photos=e.objects,s.matchedUser.photos.length>0)s.photosSlider=s.matchedUser.photos;else{var i={photo:s.defaultUserPhoto,order:0,user:"/api/v1/auth/user/"+s.matchedUser.user_id+"/"};o.save({},i,function(e){l.info(e),l.info("New photo saved."),s.matchedUser.photos.push(e),s.photosSlider=s.matchedUser.photos},function(e){l.info(e)})}s.photosSlider=t("orderBy")(s.photosSlider,"order",!1)})}else s.matchedUser=[],s.total=0,s.offset=0,s.previous=null,s.next=null;s.loadingFeed=!1},function(i){var t=(i.data,i.status),n=(i.header,i.config,"Error "+t);l.error(n),s.matchedUser=[],s.total=0,s.offset=0,s.previous=null,s.next=null,s.showDimmer=!1,e.hideTopMenu=!1})},s.cancelMatch=function(){l.info("cancel match");var e={friend1:s.me,friend2:"/api/v1/auth/user/"+s.matchedUser.user_id+"/",status:-1};a.save(e,function(){s.getNextMatch()},function(){})},s.confirmMatch=function(){l.info("accept match");var e={friend1:s.me,friend2:"/api/v1/auth/user/"+s.matchedUser.user_id+"/",status:0};a.save(e,function(){s.getNextMatch()},function(){})},s.changeTopMenu=function(){e.hideTopMenu=!0,e.showfullprofile=!0,$(".horizontal.top.sidebar").sidebar("show")}}]),angular.module("beKindred").controller("MainCtrl",["$scope",function(){}]),function(){function e(e,s,i,t,n,r,o,a,l,c,d){function u(){p.counter>0?o.go("goalcreate"):i({messageTemplate:'<div class="notify-info-header">Warning</div><p>To continue please select at least one interest.</p>',scope:c,classes:"notify-info",icon:"warning circle"})}function f(){p.searchQuery="",p.getAllInterests(),p.noResults=!1,p.counter=0}function h(){p.nextOffset=30,p.next=null,p.noResults=!1,p.loadingInterests=!0,p.counter=0,p.allInterests.splice(0,p.allInterests.length),e.query({user_id:t,format:"json",limit:200,offset:0}).$promise.then(function(i){i.objects.length>0&&(p.userInterests=i.objects),e.query({format:"json",limit:p.limit,description__icontains:p.searchQuery,offset:0}).$promise.then(function(e){p.next=e.meta.next;var s=e.objects;if(s.length>0)for(var i=s.length-1;i>=0;i--){for(var t=p.userInterests.length-1;t>=0;t--)s[i].description===p.userInterests[t].description&&(s[i]=p.userInterests[t],p.counter++,s[i].active=!0);p.allInterests.push(s[i])}else p.allInterests.splice(0,p.allInterests.length),p.noResults=!0;p.loadingInterests=!1},function(e){var i=(e.data,e.status),t=(e.header,e.config,"Error "+i);s.error(t),p.loadingInterests=!1})},function(e){var i=(e.data,e.status),t=(e.header,e.config,"Error "+i);s.error(t),p.loadingInterests=!1})}function g(){var i=a.defer();return null!==p.next?e.query({user_id:t,format:"json",limit:200,offset:0}).$promise.then(function(t){t.objects.length>0&&(p.userInterests=t.objects),e.query({format:"json",description__icontains:p.searchQuery,offset:p.nextOffset,limit:30}).$promise.then(function(e){var s=e.objects;p.next=e.meta.next,p.nextOffset+=p.limit,e.objects.length>0&&(s=e.objects);for(var t=s.length-1;t>=0;t--){for(var n=p.userInterests.length-1;n>=0;n--)s[t].description===p.userInterests[n].description&&(s[t]=p.userInterests[n],p.counter++,s[t].active=!0);p.allInterests.push(s[t])}i.resolve()},function(e){var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);s.error(n),i.reject()})},function(e){var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);s.error(n),i.reject()}):i.resolve(),i.promise}function m(){if(!p.loadingMore&&!p.loadingInterests){p.loadingMore=!0;var e=p.loadMore();e.then(function(){p.loadingMore=!1},function(){p.loadingMore=!1})}}function v(t){var o=n("getByProperty")("id",t,p.allInterests);if(o)if(o.active){var a=r(o.resource_uri);o.loading=!0,a.delete().$promise.then(function(){o.active=!1,p.counter--,o.loading=!1},function(e){var i=(e.data,e.status),t=(e.header,e.config,"Error "+i);s.error(t),o.loading=!1,o.error=!0})}else if(p.counter>=10)i({messageTemplate:'<div class="notify-info-header">Warning</div><p>Please select up to 10 interests.</p>',scope:c,classes:"notify-info",icon:"warning circle"});else{var l={description:o.description,user:p.userUri};o.loading=!0,e.save({},l,function(e){s.info(o),o.loading=!1,o.error=!1,o.interest=e.interest,o.description=e.description,o.resource_uri=e.resource_uri,o.user=e.user,o.active=!0,o.id=e.id,p.counter++},function(e){o.errorMessage=e.data.interest.error[0],i({messageTemplate:'<div class="notify-info-header">Error</div><p>'+o.errorMessage+"</p>",scope:c,classes:"notify-info",icon:"warning circle"}),o.loading=!1,o.error=!0})}}var p=this;p.useInterest=v,p.getAllInterests=h,p.nextStep=u,p.searchQuery="",p.userUri="/api/v1/auth/user/"+t+"/",p.next=null,p.nextOffset=30,p.loadingMore=!1,p.noResults=!1,p.reset=f,p.limit=30,p.loadMore=g,p.resolveMore=m,p.allInterests=[],p.counter=0,p.loadingInterests=!1,p.userInterests=[];var b=angular.element(d);p.limit=45,b.width()>675&&(p.limit=200),p.getAllInterests()}angular.module("beKindred").controller("InterestsController",e),e.$inject=["InterestsFactory","$log","notify","USER_ID","$filter","$resource","$state","$q","lodash","$scope","$window"]}(),function(){function e(e,s,i,t){function n(){function n(e){a.inboxMessages.splice(0,a.inboxMessages.length);var s=e.objects,n=0;for(var r in s)null===s[r].read_at&&null!==s[r].last_message_body&&n++,a.inboxMessages.push({firstName:s[r].first_name,friendId:s[r].friend_id,facebookId:s[r].facebook_id,sentAt:i("amDateFormat")(s[r].sent_at,"h:mm a"),readAt:s[r].read_at,id:s[r].id,body:s[r].last_message_body});a.unreadMessagesCounter=n,t.$broadcast("refreshInboxMessages")}function r(e){a.inboxMessages.splice(0,a.inboxMessages.length);var i=(e.data,e.status),t=(e.header,e.config,"Error "+i);s.error(t)}return s.info("fetching inbox"),e.query({format:"json"}).$promise.then(n,r)}function r(){return a.unreadMessagesCounter}function o(){return a.inboxMessages}var a={getInboxMessages:n,getUnreadMessagesCounter:r,getAllMessages:o,unreadMessagesCounter:0,inboxMessages:[]};return a}angular.module("beKindred").factory("InboxRepository",e),e.$inject=["InboxFactory","$log","$filter","$rootScope"]}(),function(){function e(e,s,i,t){function n(){r.allMessages=t.getAllMessages()}var r=this;r.allMessages=[],r.loadInbox=n,r.loadingMessages=!1,r.q="",r.loadInbox(),s.$on("refreshInboxMessages",function(){r.loadInbox()})}angular.module("beKindred").controller("InboxController",e),e.$inject=["$scope","$rootScope","$log","InboxRepository"]}(),angular.module("beKindred").controller("GoalCreateCtrl",["$scope","$state","$log","GoalsFactory","SubjectsFactory","USER_ID",function(e,s,i,t,n,r){e.subject="",e.resourceUri=null,e.messageShow=!1,e.message="",e.userUri="/api/v1/auth/user/"+r+"/",e.inputChanged=function(s){e.subject=s},e.selectResult=function(s){void 0!==s?(e.subject=s.originalObject.description,e.resourceUri=s.originalObject.resource_uri):e.resourceUri=null},e.saveGoal=function(){var i={goal_subject:e.subject,user:e.userUri};t.save({},i,function(){s.go("offercreate")},function(s){e.resourceUri=null,e.messageShow=!0,e.message=s.data.offer?s.data.goal.error[0]:"There was an error when trying to save your goal."})},e.createGoal=function(){return e.messageShow=!1,e.message="",""===e.subject?(e.message="Entering your goal is required to continue.",e.messageShow=!0,!1):e.subject.length>300?(e.message="Goal cannot have more than 300 characters.",e.messageShow=!0,!1):void e.saveGoal()}}]),angular.module("beKindred").controller("FriendProfileCtrl",["$scope","User","UsersFactory","MutualFriendsFactory","InboxRepository","InterestsFactory","GoalsFactory","Connection","OffersFactory","LikesFactory","PhotosFactory","$log","$state","FriendsFactory",function(e,s,i,t,n,r,o,a,l,c,d,u,f,h){e.middleActive=!0,e.friendshipId=a.objects[0].id,e.user={id:s.objects[0].id,facebook_id:s.objects[0].facebook_id,firstName:s.objects[0].first_name,lastName:s.objects[0].last_name,age:s.objects[0].age,about_me:s.objects[0].about_me,photos:[],goals:[],offers:[],likes:[],interests:[],friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[],linkedin_provider:s.objects[0].linkedin_provider,twitter_provider:s.objects[0].twitter_provider},e.defaultUserPhoto="//graph.facebook.com/"+e.user.facebook_id+"/picture?type=large",e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1,e.loadingInterests=!1,e.getUser=function(){e.loadingUser=!0,e.loadingGoals=!0,e.loadingOffers=!0,e.loadingLikes=!0;var i=[],n=s.objects[0].goals[0];for(var r in n){var o={value:r,match:n[r]};i.push(o)}e.user.goals=i;var a=[],l=s.objects[0].offers[0];for(var r in l){var c={value:r,match:l[r]};a.push(c)}e.user.offers=a;var d=[],f=s.objects[0].interests[0];for(var r in f){var h={value:r,match:f[r]};d.push(h)}e.user.interests=d;var g=[],m=s.objects[0].likes[0];for(var r in m){var v={value:r,match:m[r]};g.push(v)}e.user.likes=g,t.query({format:"json",user_id:e.user.id}).$promise.then(function(s){s.objects.length>0&&(e.user.friends=s.objects[0].mutual_bk_friends,e.user.facebookfriends=s.objects[0].mutual_fb_friends,e.user.linkedinconnections=s.objects[0].mutual_linkedin_connections,e.user.twitterfollowers=s.objects[0].mutual_twitter_followers,e.user.twitterfriends=s.objects[0].mutual_twitter_friends,e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1,e.loadingInterests=!1)},function(s){var i=(s.data,s.status),t=(s.header,s.config,"Error "+i);u.error(t),e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1})},e.getUser(),e.photosSlider=[],e.getPhotos=function(){d.query({format:"json",user_id:e.user.id}).$promise.then(function(s){if(e.user.photos=s.objects,0===e.user.photos.length){var i={photo:e.defaultUserPhoto,order:0,user:"/api/v1/auth/user/"+e.user.id+"/"};d.save({},i,function(s){u.info(s),u.info("New photo saved."),e.user.photos.push({photo:e.defaultUserPhoto,cropped_photo:"",order:0}),e.photosSlider=e.user.photos},function(e){u.info(e)})}else e.photosSlider=e.user.photos},function(e){var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);u.error(i)})},e.getPhotos(),e.unFriend=function(){h.update({friendId:e.friendshipId},{status:-1},function(){n.getInboxMessages(),f.go("myconnections")},function(){})}}]),function(){function e(e,s,i,t){function n(e){var s=400,i=300,t=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,a=r/2-s/2+t,l=o/2-i/2+n,c="height="+i+",width="+s+",left="+a+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",d="/social/associate/"+e+"/?next=/goals/close_login_popup",u=window.open(d,"Connecting...",c);
window.focus&&u.focus()}function r(){o.loading=!0,i.get({format:"json"},{userId:s}).$promise.then(function(e){o.twitter=e.twitter_provider,o.linkedin=e.linkedin_provider,o.firstName=e.first_name,o.loading=!1})}var o=this;o.loading=!1,o.link=n,o.refreshUser=r,o.twitter=t.twitter_provider,o.linkedin=t.linkedin_provider,o.firstName=t.first_name}e.$inject=["$log","USER_ID","UsersFactory","User"],angular.module("beKindred").controller("FinalStepController",e)}(),angular.module("beKindred").controller("EditMyProfileCtrl",["$scope","$timeout","USER_ID","$q","$state","UsersFactory","GoalsFactory","LikesFactory","SubjectsFactory","OffersFactory","InterestsFactory","PhotosFactory","$log","$filter","$cookies","$http","FB_TOKEN","$location","$anchorScroll","$window","$resource","notify",function(e,s,i,t,n,r,o,a,l,c,d,u,f,h,g,m,v,p,b,y,w,k){e.twitter=null,e.linkedin=null,e.userUri="/api/v1/auth/user/"+i+"/",e.user={id:i,firstName:"",lastName:"",age:"",about_me:"",photos:[{id:0,order:0,photo:"",cropped_photo:""},{id:0,order:1,photo:"",cropped_photo:""},{id:0,order:2,photo:"",cropped_photo:""},{id:0,order:3,photo:"",cropped_photo:""},{id:0,order:4,photo:"",cropped_photo:""},{id:0,order:5,photo:"",cropped_photo:""}],goals:[],offers:[],likes:[],interests:[],mutual:{friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[]}},e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1,e.loadingInterests=!1,e.getUser=function(){e.loadingUser=!0,e.loadingGoals=!0,e.loadingOffers=!0,e.loadingLikes=!0,e.loadingInterests=!0,o.query({user_id:i,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.goals=s.objects),e.loadingGoals=!1}),c.query({user_id:i,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.offers=s.objects),e.loadingOffers=!1}),a.query({user_id:i,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.likes=s.objects),e.loadingLikes=!1}),d.query({user_id:i,format:"json"}).$promise.then(function(s){s.meta.total_count>0&&(e.user.interests=s.objects),e.loadingInterests=!1}),r.get({format:"json"},{userId:i}).$promise.then(function(s){e.user.firstName=s.first_name,e.user.lastName=s.last_name,e.user.about_me=s.about_me,e.user.age=s.age,e.user.facebookId=s.facebook_id,e.user.facebookProfile=s.facebook_profile_url,e.twitter=s.twitter_provider,e.linkedin=s.linkedin_provider,e.loadingUser=!1})},e.getUser(),e.link=function(e){var s=350,i=250,t=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,a=r/2-s/2+t,l=o/2-i/2+n,c="height="+i+",width="+s+",left="+a+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",d="/social/associate/"+e+"/?next=/goals/close_login_popup",u=window.open(d,"Connecting...",c);window.focus&&u.focus()},e.unlink=function(e){var s=350,i=250,t=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,a=r/2-s/2+t,l=o/2-i/2+n,c="height="+i+",width="+s+",left="+a+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",d="/social/disconnect/"+e+"/",u=window.open(d,"Disconnecting...",c);window.focus&&u.focus()},e.refreshUser=function(){r.get({format:"json"},{userId:i}).$promise.then(function(s){e.twitter=s.twitter_provider,e.linkedin=s.linkedin_provider})},e.loadingAbout=!1,e.saveAbout=function(){e.loadingAbout=!0,r.update({userId:i},{about_me:e.user.about_me},function(){e.loadingAbout=!1},function(e){f.info(e)})},e.apiPhotos=[],e.facebookPhotos=[],e.onDropComplete=function(s,i){var t=e.user.photos[s],n=e.user.photos.indexOf(i);e.user.photos[s]=i,e.user.photos[s].order=s,e.user.photos[n]=t,e.user.photos[n].order=n,0!==e.user.photos[s].id&&u.update({photoId:e.user.photos[s].id},{order:e.user.photos[s].order},function(){},function(e){f.info(e)}),0!==e.user.photos[n].id&&u.update({photoId:e.user.photos[n].id},{order:e.user.photos[n].order},function(){},function(e){f.info(e)})},e.getPhotos=function(){u.query({format:"json"}).$promise.then(function(s){e.apiPhotos=s.objects;for(var i in e.apiPhotos)for(var t in e.user.photos)e.user.photos[t].order===e.apiPhotos[i].order&&(e.user.photos[t].id=e.apiPhotos[i].id,e.user.photos[t].photo=e.apiPhotos[i].photo,e.user.photos[t].cropped_photo=e.apiPhotos[i].cropped_photo)})},e.getPhotos(),e.currentAlbum="",e.getFBPhotos=function(s,i){e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.hideAlbums=!0,e.currentAlbum=i,e.photosLoading=!0,m.get("https://graph.facebook.com/"+s+"?fields=photos{id,height,width,source}&access_token="+v).success(function(s){e.photosLoading=!1,e.facebookPhotos=s.photos.data}).error(function(){e.photosLoading=!1})},e.backToAlbums=function(){e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.currentAlbum="",e.hideAlbums=!e.hideAlbums,e.getFBAlbums()},e.facebookAlbums=[],e.hideAlbums=!1,e.getFBAlbums=function(){e.showModal=!0,e.albumsLoading=!0,m.get("https://graph.facebook.com/me/albums?fields=picture,name&access_token="+v).success(function(s){e.facebookAlbums=s.data,e.albumsLoading=!1}).error(function(){e.albumsLoading=!1})},e.deletePhoto=function(){var s=e.userPhotoDeleteIndex;u.delete({photoId:e.user.photos[s].id},function(){e.user.photos[s].photo="",e.user.photos[s].cropped_photo="",e.user.photos[s].id=0},function(e){f.info(e)})},e.closeModal=function(){e.showModal=!1,e.showPhotos=!0,e.myImage=null,e.photoIndex=null,s(function(){p.hash("my-profile-header-edit"),b()},600)},e.showModal=!1,e.albumsLoading=!1,e.photosLoading=!1,e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.myCroppedImage=null,e.showCrop=function(s){e.photoIndex=s,e.myImage=e.facebookPhotos[s].source,e.showPhotos=!1},e.myCroppedImage="",e.createPhoto=function(s){var t=e.photoIndex,n=e.facebookPhotos[t],r={cropped_photo:s,photo:n.source,order:e.newPhotoIndex,user:"/api/v1/auth/user/"+i+"/"};u.save({},r,function(s){var i=e.newPhotoIndex;e.user.photos[i].photo=s.photo,e.user.photos[i].cropped_photo=s.cropped_photo,e.user.photos[i].id=s.id,e.closeModal()},function(){})},e.$on("ngRepeatFinishedPhotos",function(){$("#deletePhotoModal").modal("attach events",".delete_photo","show")}),e.$on("ngRepeatFinished",function(){$(".ui.search.goals").search({apiSettings:{url:"api/v1/subject/?format=json&description__icontains={query}"},minCharacters:3,searchDelay:400,type:"standard",cache:!1,onSelect:function(s){var i=$(this).attr("rel");void 0!==s&&(e.user.goals[i].subject=s.description)}}),$(".ui.search.offers").search({apiSettings:{url:"api/v1/subject/?format=json&description__icontains={query}"},minCharacters:3,searchDelay:400,type:"standard",cache:!1,onSelect:function(s){var i=$(this).attr("rel");void 0!==s&&(e.user.offers[i].subject=s.description)}}),$(".ui.search.interests").search({apiSettings:{url:"api/v1/interest/?format=json&description__icontains={query}"},minCharacters:3,searchDelay:400,type:"standard",cache:!1,onSelect:function(s){var i=$(this).attr("rel");void 0!==s&&(e.user.interests[i].description=s.description)}})}),e.goalNeedSaving=function(s){e.user.goals[s].changed=!0},e.createNewGoal=function(){var s={id:0,subject:"",user:e.userUri,changed:!0};e.user.goals.push(s)},e.removeGoal=function(s){var i=w(e.user.goals[s].resource_uri);0===e.user.goals[s].id?e.user.goals.splice(s,1):i.delete().$promise.then(function(){e.user.goals.splice(s,1)})},e.saveCurrentGoal=function(s){var i=t.defer();if(e.user.goals[s].errorMessage="",e.user.goals[s].error=!1,e.user.goals[s].subject.length>300)return e.user.goals[s].error=!0,e.user.goals[s].errorMessage="Goal cannot have more than 300 characters.",i.reject(),i.promise;if(""===e.user.goals[s].subject)e.user.goals[s].error=!0,e.user.goals[s].errorMessage="Entering your goal is required.",i.reject();else if(0===e.user.goals[s].id){var n={goal_subject:e.user.goals[s].subject,user:e.userUri};e.user.goals[s].loading=!0,e.user.goals[s].error=!1,o.save({},n,function(t){e.user.goals[s].loading=!1,e.user.goals[s].error=!1,e.user.goals[s].id=t.id,e.user.goals[s].goal=t.goal,e.user.goals[s].goal_subject=t.goal_subject,e.user.goals[s].resource_uri=t.resource_uri,e.user.goals[s].user=t.user,e.user.goals[s].changed=!1,i.resolve()},function(t){e.user.goals[s].errorMessage=t.data.goal.error[0],e.user.goals[s].loading=!1,e.user.goals[s].error=!0,i.reject()})}else e.user.goals[s].error=!1,e.user.goals[s].loading=!0,o.update({goalId:e.user.goals[s].id},{goal_subject:e.user.goals[s].subject},function(t){e.user.goals[s].loading=!1,e.user.goals[s].error=!1,e.user.goals[s].goal=t.goal,e.user.goals[s].goal_subject=t.goal_subject,e.user.goals[s].resource_uri=t.resource_uri,e.user.goals[s].changed=!1,i.resolve()},function(t){e.user.goals[s].errorMessage=t.data.goal?t.data.goal.error[0]:"There was an error when trying to save this field.",e.user.goals[s].loading=!1,e.user.goals[s].error=!0,i.reject()});return i.promise},e.offerNeedSaving=function(s){e.user.offers[s].changed=!0},e.createNewOffer=function(){var s={id:0,subject:"",user:e.userUri,changed:!0};e.user.offers.push(s)},e.removeOffer=function(s){var i=w(e.user.offers[s].resource_uri);0===e.user.offers[s].id?e.user.offers.splice(s,1):i.delete().$promise.then(function(){e.user.offers.splice(s,1)})},e.saveCurrentOffer=function(s){var i=t.defer();if(e.user.offers[s].errorMessage="",e.user.offers[s].error=!1,e.user.offers[s].subject.length>300)return e.user.offers[s].error=!0,e.user.offers[s].errorMessage="Offer cannot have more than 300 characters.",i.reject(),i.promise;if(""===e.user.offers[s].subject)e.user.offers[s].error=!0,e.user.offers[s].errorMessage="Entering your offer is required.",i.reject();else if(0===e.user.offers[s].id){var n={offer_subject:e.user.offers[s].subject,user:e.userUri};e.user.offers[s].loading=!0,e.user.offers[s].error=!1,c.save({},n,function(t){e.user.offers[s].loading=!1,e.user.offers[s].error=!1,e.user.offers[s].id=t.id,e.user.offers[s].offer=t.offer,e.user.offers[s].offer_subject=t.offer_subject,e.user.offers[s].resource_uri=t.resource_uri,e.user.offers[s].user=t.user,e.user.offers[s].changed=!1,i.resolve()},function(t){e.user.offers[s].errorMessage=t.data.offer.error[0],e.user.offers[s].loading=!1,e.user.offers[s].error=!0,i.reject()})}else e.user.offers[s].error=!1,e.user.offers[s].loading=!0,c.update({offerId:e.user.offers[s].id},{offer_subject:e.user.offers[s].subject},function(t){e.user.offers[s].loading=!1,e.user.offers[s].error=!1,e.user.offers[s].offer=t.offer,e.user.offers[s].offer_subject=t.offer_subject,e.user.offers[s].resource_uri=t.resource_uri,e.user.offers[s].changed=!1,i.resolve()},function(t){e.user.offers[s].errorMessage=t.data.offer?t.data.offer.error[0]:"There was an error when trying to save this field.",e.user.offers[s].loading=!1,e.user.offers[s].error=!0,i.reject()});return i.promise},e.interestNeedSaving=function(s){e.user.interests[s].changed=!0},e.createNewInterest=function(){var s={id:0,description:"",user:e.userUri,changed:!0};e.user.interests.push(s)},e.removeInterest=function(s){var i=w(e.user.interests[s].resource_uri);0===e.user.interests[s].id?e.user.interests.splice(s,1):i.delete().$promise.then(function(){e.user.interests.splice(s,1)})},e.saveCurrentInterest=function(s){var i=t.defer();if(e.user.interests[s].errorMessage="",e.user.interests[s].error=!1,e.user.interests[s].description.length>100)return e.user.interests[s].error=!0,e.user.interests[s].errorMessage="Interest cannot have more than 100 characters.",i.reject(),i.promise;if(""===e.user.interests[s].description)e.user.interests[s].error=!0,e.user.interests[s].errorMessage="Entering your interest is required.",i.reject();else if(0===e.user.interests[s].id){var n={description:e.user.interests[s].description,user:e.userUri};e.user.interests[s].loading=!0,e.user.interests[s].error=!1,d.save({},n,function(t){e.user.interests[s].loading=!1,e.user.interests[s].error=!1,e.user.interests[s].id=t.id,e.user.interests[s].interest=t.interest,e.user.interests[s].description=t.description,e.user.interests[s].resource_uri=t.resource_uri,e.user.interests[s].user=t.user,e.user.interests[s].changed=!1,i.resolve()},function(t){e.user.interests[s].errorMessage=t.data.interest.error[0],e.user.interests[s].loading=!1,e.user.interests[s].error=!0,i.reject()})}else e.user.interests[s].error=!1,e.user.interests[s].loading=!0,d.update({interestId:e.user.interests[s].id},{description:e.user.interests[s].description},function(t){e.user.interests[s].loading=!1,e.user.interests[s].error=!1,e.user.interests[s].interest=t.interest,e.user.interests[s].description=t.description,e.user.interests[s].resource_uri=t.resource_uri,e.user.interests[s].changed=!1,i.resolve()},function(t){e.user.interests[s].errorMessage=t.data.interest?t.data.interest.error[0]:"There was an error when trying to save this field.",e.user.interests[s].loading=!1,e.user.interests[s].error=!0,i.reject()});return i.promise},e.savingAllChanges=!1,e.startSavingChanges=function(){var s=e.saveChanges();e.savingAllChanges=!0,s.then(function(){f.info("Success saving"),e.savingAllChanges=!1,k({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle"}),n.go("myprofile")},function(){f.info("Failed"),e.savingAllChanges=!1,k({messageTemplate:'<div class="notify-error-header">Could not save your profile changes.</div><p>There were some errors. Please see them below.</p>',scope:e,classes:"notify-error",icon:"warning circle"})},function(){})},e.saveChanges=function(){var s=t.defer(),i=0;for(var n in e.user.goals)e.user.goals[n].changed&&i++;for(var n in e.user.offers)e.user.offers[n].changed&&i++;for(var n in e.user.interests)e.user.interests[n].changed&&i++;if(i>0){for(var n in e.user.goals)e.user.goals[n].changed&&e.saveCurrentGoal(n).then(function(){i--,0===i&&s.resolve()},function(){s.reject()},function(){});for(var n in e.user.offers)e.user.offers[n].changed&&e.saveCurrentOffer(n).then(function(){i--,0===i&&s.resolve()},function(){s.reject()},function(){});for(var n in e.user.interests)e.user.interests[n].changed&&e.saveCurrentInterest(n).then(function(){i--,0===i&&s.resolve()},function(){s.reject()},function(){})}else s.resolve();return s.promise}}]),angular.module("beKindred").controller("ConversationsCtrl",["$rootScope","notify","$resource","$state","InboxRepository","myIoSocket","Connection","$q","$http","$scope","USER_ID","$log","$timeout","FRIEND","MessagesFactory","$filter","FriendsFactory",function(e,s,i,t,n,r,o,a,l,c,d,u,f,h,g,m,v){c.leftActive=!0,c.messages=[],c.friendshipId=o.objects[0].id,s.closeAll(),c.q="",c.newmessage="",c.nextOffset=20,c.next=null,c.friend=h,c.recipient="/api/v1/auth/user/"+c.friend.id+"/",c.sender="/api/v1/auth/user/"+d+"/",c.loadingMessages=!1,c.loadingOlderMessages=!1,c.sendingMessage=!1,c.scrollConversations=function(){f(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},1500)},100)},c.loadOlderMessages=function(){var e=a.defer();return c.loadingOlderMessages?e.reject():null!==c.next?(c.loadingOlderMessages=!0,f(function(){g.query({user_id:c.friend.id,offset:c.nextOffset,limit:10}).$promise.then(function(s){var i=s.objects;c.next=s.meta.next,m("orderBy")(i,"sent_at",!0),c.nextOffset+=10;for(var t in i){var n=m("amDateFormat")(i[t].sent_at,"dddd, MMMM D, YYYY"),r=m("amDateFormat")(i[t].sent_at,"L"),o=m("getIndexByProperty")("date",n,c.messages);null===o&&(c.messages.push({date:n,realDate:r,contents:[]}),o=c.messages.length-1),c.messages[o].contents.push(i[t].sender===c.sender?{body:i[t].body,sender:i[t].sender,recipient:i[t].recipient,date:r,sent_at:i[t].sent_at,left:!0}:{body:i[t].body,sender:i[t].sender,recipient:i[t].recipient,date:r,sent_at:i[t].sent_at,left:!1}),c.messages[o].contents=m("orderBy")(c.messages[o].contents,"sent_at",!0)}c.messages=m("orderBy")(c.messages,"realDate"),c.loadingOlderMessages=!1,e.resolve()},function(e){c.loadingOlderMessages=!1;var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);u.error(i)})},1500)):e.reject(),e.promise},c.getMessages=function(){c.messages=[],c.loadingMessages=!0,g.query({user_id:c.friend.id,limit:20,offset:0}).$promise.then(function(e){var s=e.objects;c.next=e.meta.next,m("orderBy")(s,"sent_at",!0);for(var i in s){var t=m("amDateFormat")(s[i].sent_at,"dddd, MMMM D, YYYY"),r=m("amDateFormat")(s[i].sent_at,"L"),o=m("getIndexByProperty")("date",t,c.messages);null===o&&(c.messages.push({date:t,realDate:r,contents:[]}),o=c.messages.length-1),c.messages[o].contents.push(s[i].sender===c.sender?{body:s[i].body,sender:s[i].sender,recipient:s[i].recipient,date:r,sent_at:s[i].sent_at,left:!0}:{body:s[i].body,sender:s[i].sender,recipient:s[i].recipient,date:r,sent_at:s[i].sent_at,left:!1}),c.messages[o].contents=m("orderBy")(c.messages[o].contents,"sent_at",!0)}c.messages=m("orderBy")(c.messages,"realDate"),c.messages.length>0&&(f(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},0)},100),l.get("/api/v1/inbox/reat_at/?sender_id="+c.friend.id).success(function(){n.getInboxMessages()}).error(function(){})),c.loadingMessages=!1},function(e){c.loadingMessages=!1;var s=(e.data,e.status),i=(e.header,e.config,"Error "+s);u.error(i)})},c.getMessages(),c.sendNewMessage=function(){if(""===c.newmessage)c.sendingMessage=!1;else{c.sendingMessage=!0;var e={};e={sender:c.sender,recipient:c.recipient,body:c.newmessage},g.save({},e,function(s){e.left=!0,e.sent_at=s.sent_at,e.sender=s.sender,e.recipient=s.recipient;var i=m("amDateFormat")(e.sent_at,"L"),t=m("amDateFormat")(e.sent_at,"dddd, MMMM D, YYYY"),n=m("getIndexByProperty")("date",t,c.messages);e.date=i,null===n&&(c.messages.push({date:t,realDate:i,contents:[]}),n=c.messages.length-1),c.messages[n].contents.push(e),c.newmessage="",u.info("New message saved."),c.sendingMessage=!1,c.scrollConversations()},function(e){c.sendingMessage=!1,u.info(e)})}},e.$on("receivedMessage",function(s,i){var t=JSON.parse(i);u.info("new message");var r=m("amDateFormat")(t.sent_at,"dddd, MMMM D, YYYY"),o=m("amDateFormat")(t.sent_at,"L"),a=m("getIndexByProperty")("date",r,c.messages);null===a&&(c.messages.push({date:r,realDate:o,contents:[]}),a=c.messages.length-1),c.messages[a].contents.push({body:t.body,sender:t.sender,recipient:t.recipient,date:o,sent_at:t.sent_at,left:!1}),e.notifications.push({body:t.body,sender:t.sender,recipient:t.recipient,date:o,sent_at:t.sent_at}),c.messages[a].contents=m("orderBy")(c.messages[a].contents,"sent_at",!0),c.messages=m("orderBy")(c.messages,"realDate"),l.get("/api/v1/inbox/reat_at/?sender_id="+c.friend.id).success(function(){n.getInboxMessages()}).error(function(){}),f(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},1500)},100)}),c.unFriend=function(){v.update({friendId:c.friendshipId},{status:-1},function(){n.getInboxMessages(),t.go("myconnections")},function(){})}}]),angular.module("beKindred").factory("GoalsFactory",["$resource",function(e){return e("/api/v1/goal/:goalId/:param",{goalId:"@goalId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("LikesFactory",["$resource",function(e){return e("/api/v1/likes/:likeId/:param",{likeId:"@likeId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("ProfileFactory",["$resource",function(e){return e("/api/v1/profile/:profileId/:param",{profileId:"@profileId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("ConnectionsFactory",["$resource",function(e){return e("/api/v1/connections/:connectionId/:param",{connectionId:"@connectionId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FriendsFactory",["$resource",function(e){return e("/api/v1/friends/:friendId/:param",{friendId:"@friendId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MutualFriendsFactory",["$resource",function(e){return e("/api/v1/mutual/friends/:friendId/:param",{friendId:"@friendId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("SubjectsFactory",["$resource",function(e){return e("/api/v1/subject/:subjectId/:param",{subjectId:"@subjectId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("OffersFactory",["$resource",function(e){return e("/api/v1/offer/:offerId/:param",{offerId:"@offerId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InterestsFactory",["$resource",function(e){return e("/api/v1/interest/:interestId/:param",{interestId:"@interestId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("UsersFactory",["$resource",function(e){return e("/api/v1/auth/user/:userId/:param",{userId:"@userId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MessagesFactory",["$resource",function(e){return e("/api/v1/messages/:messageId/:param",{messageId:"@messageId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InboxFactory",["$resource",function(e){return e("/api/v1/inbox/last/:inboxId/:param",{inboxId:"@inboxId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FiltersFactory",["$resource",function(e){return e("/api/v1/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("PhotosFactory",["$resource",function(e){return e("/api/v1/photo/:photoId/:param",{photoId:"@photoId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),angular.module("beKindred").controller("AppCtrl",["$rootScope","$scope","USER_ID","$timeout","$state","$window","myIoSocket","$filter","$log","notify","$resource","$cookies","InboxRepository",function(e,s,i,t,n,r,o,a,l,c,d,u,f){e.hideTopMenu=!1,u.userid=i,e.goBack=function(){e.hideTopMenu=!1,e.showfullprofile=!1,$(".horizontal.top.sidebar").sidebar("hide")},s.cancelMatch=function(){$(".dimmable").dimmer("hide"),e.hideTopMenu=!1,e.showfullprofile=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("cancelMatchEvent")},s.confirmMatch=function(){$(".dimmable").dimmer("hide"),e.hideTopMenu=!1,e.showfullprofile=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("confirmMatchEvent")},s.refreshMatchFeed=function(){$(".dimmable").dimmer("hide"),e.$broadcast("refreshMatchFeed")},f.getInboxMessages(),e.notifications=[],e.messages=[],s.$on("socket:message",function(i,t){if(e.isState("conversations"))e.$broadcast("receivedMessage",t);else{f.getInboxMessages();var r=JSON.parse(t),o=a("words")(r.body,10),l=a("amDateFormat")(r.sent_at,"h:mm a"),u=d(r.sender);u.get().$promise.then(function(e){s.gotoConversation=function(){n.go("conversations",{userId:e.id})};var i='<div class="notify-info-header"><a href="" ng-click="gotoConversation()">Received new message from '+e.first_name+"<br>"+l+' </a></div><p><a href="" ng-click="gotoConversation()">'+o+"</a></p>";c({messageTemplate:i,scope:s,classes:"notify-info",icon:"wechat"})})}})}]),angular.module("beKindred").run(["$templateCache",function(e){e.put("app/conversations/conversations.html",'<div id="mycontroller"><div class="ui fixed borderless menu" id="headermenu"><a class="icon item" ui-sref="inbox"><i class="left chevron icon"></i></a><h3 class="ui center aligned header">{{friend.first_name}}</h3></div><div class="ui fixed menu" id="submenu"><div class="3 fluid large ui buttons"><a ui-sref="conversations({ userId: friend.id })" ng-class="{\'active\': leftActive}" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friend.id })" class="ui button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div></div><div class="conversation-content ui segment" ng-class="{\'loading\': loadingMessages}" z-infinite-scroll="loadOlderMessages" inverse="true" body-scroll="false" scroll-threshold="1" time-threshold="800"><three-bounce-spinner class="page-spinner-bar" ng-show="loadingOlderMessages"></three-bounce-spinner><div class="repeat-animation" ng-repeat="message in messages track by $index"><h6>{{message.date}}</h6><div ng-style="" class="repeat-animation" ng-class="{\'bubbledLeft\': msg.left, \'bubbledRight\': !msg.left, \'lastMessage\': $last}" ng-repeat="msg in message.contents | orderBy:\'sent_at\' track by $index"><p>{{msg.body}}</p><span class="conversation-time">{{msg.sent_at | amDateFormat:\'h:mm a\'}}</span></div></div></div><div class="conversation-content ui segment" ng-if="messages.length === 0"><h3>There are no any messages</h3></div><div class="message-reply"><div class="ui fluid action input"><input ng-enter="sendNewMessage()" type="text" placeholder="" ng-model="newmessage"><div ng-click="sendNewMessage()" class="ui button" ng-class="{\'loading\': sendingMessage}">Send</div></div></div><script>\n  \'use strict\';\n\n  $(\'.ui.dropdown\')\n  .dropdown({\n    onShow:  function(){\n      $(\'#hideConversation\')\n      .dimmer(\'show\')\n      ;\n\n      var scope = angular.element($("#submenu")).scope();\n      scope.$apply(function(){\n        scope.leftActive = false;\n      });\n    },\n    onHide: function(){\n      $(\'#hideConversation\')\n      .dimmer(\'hide\')\n      ;\n      var scope = angular.element($("#submenu")).scope();\n      setTimeout(function() {\n        scope.$apply(function(){\n          scope.leftActive = true;\n        });\n      }, 100);\n    }\n  })\n  ;\n\n  $(\'.basic.delete.modal\')\n  .modal({\n    onDeny    : function(){\n      console.log(\'cancel\');\n    },\n    onApprove : function() {\n      console.log(\'deleting user\');\n\n      angular.element(document.getElementById(\'mycontroller\')).scope().unFriend();\n\n    }\n  })\n  .modal(\'attach events\', \'.deleteconnection\', \'show\');\n\n</script><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want remove this connection?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div></div><div id="hideConversation" class="ui dimmer"></div>'),e.put("app/editmyprofile/editmyprofile.html",'<div class="ui fixed borderless menu center" id="edittopmenu"><div class="left menu"><a class="ui item" ui-sref="myprofile"><i class="left chevron icon"></i></a></div><div class="header item">Edit Profile</div><div class="right menu"><a class="ui item" ng-click="startSavingChanges()" ng-class="{\'loading\': savingAllChanges}">Save</a></div></div><div class="segment" id="my-profile-header-edit" ng-hide="showModal || editInterest"><div class="container"><div class="ui segment"><div id="tiles" ng-cloak=""><div class="ui image tile" ng-class="{\'left floated medium tile-big\': $index === 0, \'left floated small tile-small\': $index === 1 || $index === 2 || $index === 4 || $index === 5, \'small tile-small\': $index === 3 }" ng-repeat="photo in user.photos track by $index" end-repeat-photos="" ng-drop="true" ng-drop-success="onDropComplete($index, $data,$event)"><a href="" ng-click="$parent.userPhotoDelete = photo; $parent.userPhotoDeleteIndex = $index;" class="ui right corner delete_photo label" ng-show="photo.photo !== \'\'"><i class="close icon"></i></a><div class="tile-content" ng-show="photo.photo === \'\'"><div class="content"><div class="center"><a href="" ng-click="$parent.newPhotoIndex = $index; getFBAlbums();" class="ui compact icon button add_photo"><i class="circle add icon"></i> Add Photo</a></div></div></div><div style="background-image: url(\'{{photo.photo}}\')" ng-if="photo.cropped_photo === \'\'" ng-drag="true" ng-drag-data="photo" class="img-bounding-box"></div><div style="background-image: url(\'{{photo.cropped_photo}}\')" ng-if="photo.cropped_photo !== \'\'" ng-drag="true" ng-drag-data="photo" class="img-bounding-box"></div></div></div></div></div></div><div class="body segment edit" id="my-profile-body" ng-hide="showModal || editInterest"><div class="container"><div class="ui attached segment" id="my-profile-title"><h3 class="ui left floated header">{{ user.firstName }}<span ng-hide="user.firstName === \'\'">,</span> {{ user.age }}</h3></div><div class="ui attached segment" ng-class="{loading: loadingGoals || loadingOffers || loadingUser || loadingLikes || loadingInterests }"><h4 class="ui header">Goals</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="goal in user.goals track by $index"><div class="content"><div class="description"><div class="ui fluid search goals" rel="{{$index}}" ng-class="{\'loading\': goal.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': goal.error}"><div class="ui removebutton icon circular button" ng-click="removeGoal($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="goal.subject" ng-change="goalNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="goal.error">{{goal.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewGoal()"><i class="plus icon"></i> Create new Goal</div><h4 class="ui header">Offers</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="offer in user.offers track by $index"><div class="content"><div class="description"><div class="ui fluid search offers" rel="{{$index}}" ng-class="{\'loading\': offer.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': offer.error}"><div class="ui removebutton icon circular button" ng-click="removeOffer($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="offer.subject" ng-change="offerNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="offer.error">{{offer.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewOffer()"><i class="plus icon"></i> Create new Offer</div><h4 class="ui header">About</h4><form class="ui form" ng-class="{loading: loadingAbout}"><div class="field"><label></label> <textarea rows="3" ng-model="user.about_me" ng-blur="saveAbout()"></textarea></div></form><h4 class="ui header">Activities &amp; Interests</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="interest in user.interests track by $index"><div class="content"><div class="description"><div class="ui fluid search interests" rel="{{$index}}" ng-class="{\'loading\': interest.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': interest.error}"><div class="ui removebutton icon circular button" ng-click="removeInterest($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="interest.description" ng-change="interestNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="interest.error">{{interest.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewInterest()"><i class="plus icon"></i> Create new Interest</div><h4 class="ui header">Likes</h4><div class="ui list likes"><div class="item" ng-repeat="like in user.likes | limitTo:5 track by $index"><div class="content"><div class="description">{{ like.name }}</div></div></div></div></div><div class="ui attached segment" id="socialaccounts"><h4 class="ui header">Social Accounts</h4><a ng-click="link(\'linkedin\')" class="ui icon linkedin labeled fluid button" ng-show="linkedin === null"><i class="linkedin icon"></i> Connect</a><div class="ui fluid buttons socialbuttons" ng-show="linkedin !== null"><a href="{{ linkedin }}" target="_new" class="ui social icon twitter labeled button"><i class="linkedin icon"></i> {{user.firstName}} <i class="check circle icon right"></i></a> <a ng-click="unlink(\'linkedin\')" class="ui right icon circular button disconnect"><i class="remove icon"></i></a></div><br><a ng-click="link(\'twitter\')" class="ui icon twitter labeled fluid button" ng-show="twitter === null"><i class="twitter icon"></i> Connect</a><div class="ui fluid buttons socialbuttons" ng-show="twitter !== null"><a href="https://twitter.com/{{ twitter }}" target="_new" class="ui social icon twitter labeled button"><i class="twitter icon"></i> {{twitter}} <i class="check circle icon right"></i></a> <a ng-click="unlink(\'twitter\')" class="ui right icon circular button disconnect"><i class="remove icon"></i></a></div><br><a href="{{ user.facebookProfile }}" target="_new" class="ui social icon facebook labeled fluid button" ng-if="user.facebookProfile !== \'\'"><i class="facebook icon"></i> {{user.firstName}} <i class="lock icon right"></i></a></div></div></div><div class="ui basic modal" id="deletePhotoModal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content" ng-cloak=""><img ng-src="{{userPhotoDelete.photo}}" class="ui image small" alt=""><div class="description"><p>Are you sure you want to delete your photo?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red basic inverted button"><i class="remove icon"></i> No</div><div ng-click="deletePhoto()" class="ui green basic inverted button"><i class="checkmark icon"></i> Yes</div></div></div></div><div class="body segment edit" id="my-profile-photos" ng-if="showModal" ng-cloak=""><div class="container"><div class="ui attached segment"><div class="ui fluid primary button" ng-click="closeModal()">Back to Edit Profile</div></div><div class="ui attached segment" ng-class="{loading: albumsLoading}"><div class="ui dividing header" ng-show="currentAlbum == \'\'">Choose Facebook Album</div><div class="ui dividing header" ng-show="currentAlbum != \'\' && showPhotos">Choose Photo</div><div class="ui selection list" ng-hide="hideAlbums"><div class="item" ng-click="getFBPhotos(fbAlbum.id, fbAlbum.name)" ng-repeat="fbAlbum in facebookAlbums track by $index"><img class="ui tiny image" ng-src="{{fbAlbum.picture.data.url}}"><div class="content"><div class="header">{{fbAlbum.name}}</div></div></div></div><div ng-show="hideAlbums" class="ui segment" ng-class="{loading: photosLoading}"><div class="fluid ui button" ng-click="backToAlbums()">Back to Albums</div><h3 ng-show="showPhotos" class="ui header">{{currentAlbum}}</h3><h3 ng-hide="showPhotos" class="ui header">Crop Photo</h3><div class="ui selection list" ng-show="showPhotos"><div ng-click="showCrop($index)" class="item button ok" ng-repeat="fbPhoto in facebookPhotos track by $index"><img class="ui small image" ng-src="{{fbPhoto.source}}"><div class="content"><div class="header"></div></div></div></div><div ng-hide="showPhotos"><div class="cropArea"><img-crop image="myImage" result-image="myCroppedImage" area-type="square"></img-crop></div><br><br><br><div class="ui fluid primary button" ng-click="createPhoto(myCroppedImage)">Save Photo</div></div></div></div></div></div><script type="text/javascript">\n\n  \'use strict\';\n  function refreshConnect() {\n    angular.element($(\'#socialaccounts\')).scope().refreshUser();\n  }\n</script>'),e.put("app/finalstep/finalstep.html",'<div id="finalstep"><div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">4</i></span> Final Step</div></div><div class="body segment"><div class="container"><h2 class="ui center aligned header withborder"><hr>Connect your LinkedIn and<br>Twitter accounts<hr></h2><div class="ui basic segment"><div class="ui center aligned grid"><div class="row"><div class="column"><div class="ui segment basic center alligend"><p>This will improve your match results within the Kindred community.</p><p><i class="icon lock"></i> Kindred will never share your information or post on your behalf.</p></div></div></div><div class="row"><div class="column"><div class="ui segment basic center alligend" ng-class="{\'loading\': finalstep.loading}"><a class="ui linkedin big button" ng-click="finalstep.link(\'linkedin\')" ng-show="finalstep.linkedin === null"><i class="linkedin icon"></i> Connect</a> <a href="{{ finalstep.linkedin }}" target="_new" class="ui social icon linkedin big labeled button" ng-show="finalstep.linkedin !== null"><i class="linkedin icon"></i> {{finalstep.firstName}} <i class="check circle icon right"></i></a><br><br><a class="ui twitter big button" ng-click="finalstep.link(\'twitter\')" ng-show="finalstep.twitter === null"><i class="twitter icon"></i> Connect</a> <a href="https://twitter.com/{{ finalstep.twitter }}" target="_new" class="ui social icon twitter labeled big button" ng-show="finalstep.twitter !== null"><i class="twitter icon"></i> {{finalstep.twitter}} <i class="check circle icon right"></i></a></div></div></div><div class="row"><div class="column"><div class="ui segment basic center aligned"><a class="ui" ui-sref="matchfeed" ng-show="finalstep.twitter === null && finalstep.linkedin === null">skip &raquo;</a> <a class="ui green big button" ui-sref="matchfeed" ng-show="finalstep.twitter !== null || finalstep.linkedin !== null">Next &raquo;</a></div></div></div></div></div></div></div><script type="text/javascript">\n\n    \'use strict\';\n    function refreshConnect() {\n      angular.element($(\'#finalstep\')).scope().finalstep.refreshUser();\n    }\n  </script></div>'),e.put("app/friendprofile/friendprofile.html",'<div id="connectionPage"><div class="ui fixed borderless menu" id="headermenu"><a class="icon item" ui-sref="myconnections"><i class="left chevron icon"></i></a><h3 class="ui center aligned header">{{ user.firstName }}</h3></div><div class="ui fixed menu" id="submenu"><div class="3 fluid large ui buttons"><a ui-sref="conversations({ userId: user.id })" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: user.id })" ng-class="{\'active\': middleActive}" class="ui button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div></div><div class="header segment with-menu" id="friendprofileheader"><div class="container" <div=""><div id="PhotoSlider" ng-if="photosSlider.length > 0"><ul rn-carousel="" rn-carousel-index="carouselIndex2"><li ng-repeat="item in photosSlider | orderBy:\'order\' track by $index"><img ng-show="item.cropped_photo === \'\'" class="img-bounding-box-full-width" ng-src="{{item.photo}}"> <img ng-show="item.cropped_photo !== \'\'" class="img-bounding-box-full-width" ng-src="{{item.cropped_photo}}"></li></ul><div class="carousel-indicators" rn-carousel-indicators="" ng-if="photosSlider.length > 1" slides="photosSlider" rn-carousel-index="carouselIndex2"></div></div></div></div></div><div class="body segment" id="matched-profile-body"><div class="container"><div class="ui top attached segment"><h3 class="ui left floated header">{{ user.firstName }}<span ng-hide="user.firstName === \'\'">,</span> {{ user.age }}</h3></div><div class="ui attached segment" ng-class="{loading: loadingGoals || loadingOffers || loadingUser || loadingLikes || loadingInterests}"><h4 class="ui header">Goals</h4><div class="ui list"><div class="item" ng-repeat="goal in user.goals | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': goal.match === 1, \'empty smallicon\': goal.match === 0 }"></i><div class="content"><div class="description">{{ goal.value }}</div></div></div><p ng-if="user.goals.length === 0">No goals yet.</p></div><h4 class="ui header">Offers</h4><div class="ui list"><div class="item" ng-repeat="offer in user.offers | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': offer.match === 1, \'empty smallicon\': offer.match === 0 }"></i><div class="content"><div class="description">{{ offer.value }}</div></div></div><p ng-if="user.offers.length === 0">No offers yet.</p></div><h4 class="ui header">About</h4><div class="ui list"><div class="item"><i class="empty icon"></i><div class="content"><div class="description"><span>{{user.about_me}}</span></div></div></div></div><h4 class="ui header">Activities &amp; Interests</h4><div class="ui list"><div class="item" ng-repeat="interest in user.interests | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': interest.match === 1, \'empty smallicon\': interest.match === 0 }"></i><div class="content"><div class="description">{{ interest.value }}</div></div></div><p ng-if="user.interests.length === 0">No interests yet.</p></div><h4 class="ui header">Likes</h4><div class="ui list likes"><div class="item" ng-repeat="like in user.likes | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': like.match === 1, \'empty smallicon\': like.match === 0 }"></i><div class="content"><div class="description">{{ like.value }}</div></div></div><p ng-if="user.likes.length === 0">No likes yet.</p></div><h4 ng-if="user.friends.length > 0" class="ui header">Mutual Friends</h4><div ng-if="user.friends.length > 0" class="ui selection list"><a ui-sref="friendprofile({ userId: friend.user_id })" class="item" ng-repeat="friend in user.friends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></a></div><h4 ng-if="user.facebookfriends.length > 0" class="ui header">Mutual Facebook Friends ({{ user.facebookfriends.length }})</h4><div ng-if="user.facebookfriends.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in user.facebookfriends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></div></div><h4 ng-if="user.twitterfriends.length > 0" class="ui header">Mutual Twitter Friends ({{ user.twitterfriends.length }})</h4><div ng-if="user.twitterfriends.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in user.twitterfriends track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="user.twitterfollowers.length > 0" class="ui header">Mutual Twitter Followers ({{ user.twitterfollowers.length }})</h4><div ng-if="user.twitterfollowers.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in user.twitterfollowers track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="user.linkedinconnections.length > 0" class="ui header">Mutual LinkedIn Connections ({{ user.linkedinconnections.length }})</h4><div ng-if="user.linkedinconnections.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in user.linkedinconnections track by $index"><img class="ui avatar image" ng-src="{{friend.pictureUrls.values[0]}}"><div class="content"><div class="header">{{ friend.firstName }}</div></div></div></div><h4 ng-if="user.linkedin_provider !== null || user.twitter_provider !== null" class="ui header">Social Profiles</h4><a ng-if="user.linkedin_provider !== null" href="{{user.linkedin_provider}}" target="_new" class="ui linkedin button"><i class="linkedin icon"></i> LinkedIn</a> <a ng-if="user.twitter_provider !== null" href="http://www.twitter.com/{{user.twitter_provider}}" target="_new" class="ui twitter button"><i class="twitter icon"></i> Twitter</a></div></div></div><script>\n    \'use strict\';\n    $(\'.ui.dropdown\')\n    .dropdown({\n        onShow:  function(){\n            $(\'#matched-profile-body\').dimmer(\'show\');\n            $(\'#friendprofileheader\').dimmer(\'show\');\n            var scope = angular.element($("#submenu")).scope();\n            scope.$apply(function(){\n                scope.middleActive = false;\n            });\n        },\n        onHide: function(){\n            $(\'#matched-profile-body\').dimmer(\'hide\');\n            $(\'#friendprofileheader\').dimmer(\'hide\');\n            var scope = angular.element($("#submenu")).scope();\n            setTimeout(function() {\n                scope.$apply(function(){\n                    scope.middleActive = true;\n                });\n            }, 100);\n        }\n    })\n    ;\n\n</script><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want remove this connection?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div><script>\n  \'use strict\';\n  $(\'.basic.delete.modal\')\n  .modal({\n    onDeny    : function(){\n      console.log(\'cancel\');\n  },\n  onApprove : function() {\n      console.log(\'deleting user\');\n      angular.element(document.getElementById(\'connectionPage\')).scope().unFriend();\n  }\n})\n  .modal(\'attach events\', \'.deleteconnection\', \'show\');\n\n\n</script>'),e.put("app/goalcreate/goalcreate.html",'<div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">2</i></span> Create a goal</div></div><div class="body segment"><div class="container"><h2 class="ui center aligned header withborder">My goal is to...<hr></h2><div class="ui attached warning message" id="warningmessage" ng-show="messageShow"><div class="header">Warning</div><p>{{message}}</p></div><div class="ui basic segment"><div class="ui center aligned grid"><div class="row"><div class="search-wrapper ui icon large left input"><i class="fa fa-search fa-lg"></i><div field-required="false" angucomplete-alt="" text-no-results="No existing goal found. Create new goal &raquo;" minlength="3" input-changed="inputChanged" match-class="highlight" selected-object="selectResult" description-field="description[3]" title-field="description" remote-url="/api/v1/subject/?format=json&description__icontains=" remote-url-data-field="objects" type="text" input-name="description" id="id_description" placeholder="enter your goal here"></div></div></div><div class="row" ng-hide="subject === \'\'"><a ng-click="createGoal()" class="ui button submit green big" role="button">Next &rarr;</a></div></div></div><div class="ui secondary segment" id="instructions" ng-hide="subject !== \'\'"><h4>This should be something you want other people to help you with.</h4><br><h4>For example:</h4><p><ul class="unstyled"><li>&quot;Learn to play tennis&quot;</li><li>&quot;Find a running partner&quot;</li><li>&quot;Hire a cat sitter&quot;</li><li>&quot;Move my sofa upstairs&quot;</li></ul></p></div></div></div>'),e.put("app/inbox/inbox.html",'<div class="segment" id="inbox-header"><div class="container"><div class="ui left icon input"><input type="text" ng-model="inbox.q" name="q" placeholder="Search"> <i class="circular search icon"></i></div></div></div><div class="body segment" id="inbox-body"><div class="container"><div class="ui selection divided list"><a ng-class="{\'unread\': message.readAt === null}" ui-sref="conversations({ userId: message.friendId })" class="item repeat-animation" ng-if="message.body !== null" ng-repeat="message in inbox.allMessages | filter:{firstName: inbox.q} track by message.id"><div class="ui circular tiny image img-bounding-box" ng-style="{\'background-image\': \'url(//graph.facebook.com/{{ message.facebookId }}/picture?type=large)\'}"></div><span class="message-time">{{message.sentAt}}</span><div class="content"><div class="header">{{message.firstName}}</div><div class="description">{{message.body | words: 8}}</div></div></a></div></div></div>'),e.put("app/interests/interests.html",'<div class="ui fixed borderless menu" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">1</i></span> What interests you?</div><div class="right menu"><a class="ui item" ng-click="interest.nextStep()">Next &raquo;</a></div></div><div class="segment" id="interests-header"><div class="container"><div class="ui left icon input"><input type="text" ng-model="interest.searchQuery" ng-change="interest.getAllInterests()" ng-model-options="{debounce:300}" placeholder="Search"> <i class="circular search icon"></i></div></div></div><div class="ui basic segment" id="interests" ng-class="{\'loading\': interest.loadingInterests}" z-infinite-scroll="interest.resolveMore" inverse="false" body-scroll="false" scroll-threshold="2" time-threshold="100"><div class="ui info message" ng-show="interest.noResults && !interest.loadingInterests"><p>No interests found.</p><p>Try with another search term or <a href="" ng-click="interest.reset()">reset your search</a>.</p></div><div ng-click="interest.useInterest(inter.id)" class="ui button toggle compact repeat-animation" ng-repeat="inter in interest.allInterests track by $index" ng-class="{\'active\': inter.active, \'loading\': interest.inter.loading}">{{inter.description}}</div><three-bounce-spinner class="page-spinner-bar" ng-show="interest.loadingMore"></three-bounce-spinner></div>'),e.put("app/main/main.html",'<div class="main" id="main-section" ng-controller="MainCtrl"><div class="ui huge header aligned center">Welcome to</div><div class="ui center aligned grid"><div class="wide column"><ul class="social-icon" id="intro-title"><li><h1>BeKindred</h1></li></ul><br><br><p><a ui-sref="selectinterests" class="ui green button huge">Start</a></p></div></div></div>'),e.put("app/matchfeed/matchfeed.html",'<div ng-if="total > 0"><three-bounce-spinner ng-show="loadingFeed" class="ui inverted dimmer transition visible active"></three-bounce-spinner><div ng-hide="showDimmer"><div class="dimmable"><div class="header segment with-menu" id="my-profile-header" ng-if="showfullprofile"><div class="container"><div class="pagination-container"><div id="PhotoSlider"><ul rn-carousel="" rn-carousel-index="carouselIndex2"><li ng-repeat="item in photosSlider | orderBy:\'order\' track by $index"><img ng-show="item.cropped_photo === \'\'" class="img-bounding-box-full-width" ng-src="{{item.photo}}"> <img ng-show="item.cropped_photo !== \'\'" class="img-bounding-box-full-width" ng-src="{{item.cropped_photo}}"></li></ul><div class="carousel-indicators" rn-carousel-indicators="" ng-if="photosSlider.length > 1" slides="photosSlider" rn-carousel-index="carouselIndex2"></div></div></div></div></div><div class="header segment" id="matched-profile-header" ng-hide="showfullprofile"><div class="container"><div class="ui segment" ng-click="changeTopMenu()"><div ng-show="photosSlider[0].cropped_photo === \'\'" class="ui circular middle aligned left floated small image img-bounding-box" style="background-image: url(\'{{photosSlider[0].photo}}\');"></div><div ng-show="photosSlider[0].cropped_photo !== \'\'" class="ui circular middle aligned left floated small image img-bounding-box" style="background-image: url(\'{{photosSlider[0].cropped_photo}}\');"></div><h2 class="ui header">{{ matchedUser.first_name }}, {{ matchedUser.age }}<div class="sub header">{{matchedUser.distance}} mi.</div></h2><div class="ui mini statistics"><div class="statistic"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{totalmatchingcount}}</div></div><div class="statistic"><div class="value"><i class="empty users usericon icon"></i></div><div class="label">{{totalfriendscount}}</div></div></div></div></div></div><div class="body segment" id="matched-profile-body"><div class="container"><div class="ui top attached segment" ng-show="showfullprofile"><h3 class="ui left floated header">{{ matchedUser.first_name }} {{ matchedUser.age }}</h3><h5 class="ui right floated header">{{matchedUser.distance}} mi.</h5></div><div class="ui attached segment"><h4 class="ui header" ng-if="matchedUser.goals.length > 0">Goals</h4><div class="ui list"><div ng-hide="!showfullprofile && $index > 2" class="item" ng-repeat="goal in matchedUser.goals | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': goal.match === 1, \'empty smallicon\': goal.match === 0 }"></i><div class="content"><div class="description">{{ goal.value }}</div></div></div></div><h4 class="ui header" ng-if="matchedUser.offers.length > 0">Offers</h4><div class="ui list"><div ng-hide="!showfullprofile && $index > 2" class="item" ng-repeat="offer in matchedUser.offers | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': offer.match === 1, \'empty smallicon\': offer.match === 0 }"></i><div class="content"><div class="description">{{ offer.value }}</div></div></div></div><h4 class="ui header" ng-show="showfullprofile" ng-if="matchedUser.about !== \'\'">About</h4><div class="ui list" ng-show="showfullprofile"><div class="item"><i class="empty icon"></i><div class="content"><div class="description"><span>{{matchedUser.about}}</span></div></div></div></div><h4 class="ui header" ng-if="matchedUser.interests.length > 0">Activities &amp; Interests</h4><div class="ui list"><div class="item" ng-hide="!showfullprofile && $index > 2" ng-repeat="interest in matchedUser.interests | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': interest.match === 1, \'empty smallicon\': interest.match === 0 }"></i><div class="content"><div class="description">{{ interest.value }}</div></div></div></div><h4 class="ui header" ng-if="matchedUser.likes.length > 0">Likes</h4><div class="ui list likes"><div class="item" ng-hide="!showfullprofile && $index > 2" ng-repeat="like in matchedUser.likes | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': like.match === 1, \'empty smallicon\': like.match === 0 }"></i><div class="content"><div class="description">{{ like.value }}</div></div></div></div><h4 ng-if="matchedUser.friends.length > 0" class="ui header" ng-show="showfullprofile">Mutual Friends</h4><div ng-if="matchedUser.friends.length > 0" class="ui selection list" ng-show="showfullprofile"><a ui-sref="friendprofile({ userId: friend.user_id })" class="item" ng-repeat="friend in matchedUser.friends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></a></div><h4 ng-if="matchedUser.facebookfriends.length > 0" class="ui header" ng-show="showfullprofile">Mutual Facebook Friends ({{ matchedUser.facebookfriends.length }})</h4><div ng-if="matchedUser.facebookfriends.length > 0" class="ui selection list" ng-show="showfullprofile"><div class="item" ng-repeat="friend in matchedUser.facebookfriends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></div></div><h4 ng-if="matchedUser.twitterfriends.length > 0" class="ui header" ng-show="showfullprofile">Mutual Twitter Friends ({{ matchedUser.twitterfriends.length }})</h4><div ng-if="matchedUser.twitterfriends.length > 0" class="ui selection list" ng-show="showfullprofile"><div class="item" ng-repeat="friend in matchedUser.twitterfriends track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="matchedUser.twitterfollowers.length > 0" class="ui header" ng-show="showfullprofile">Mutual Twitter Followers ({{ matchedUser.twitterfollowers.length }})</h4><div ng-if="matchedUser.twitterfollowers.length > 0" class="ui selection list" ng-show="showfullprofile"><div class="item" ng-repeat="friend in matchedUser.twitterfollowers track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="matchedUser.linkedinconnections.length > 0" class="ui header" ng-show="showfullprofile">Mutual LinkedIn Connections ({{ matchedUser.linkedinconnections.length }})</h4><div ng-if="matchedUser.linkedinconnections.length > 0" class="ui selection list" ng-show="showfullprofile"><div class="item" ng-repeat="friend in matchedUser.linkedinconnections track by $index"><img class="ui avatar image" ng-src="{{friend.pictureUrls.values[0]}}"><div class="content"><div class="header">{{ friend.firstName }}</div></div></div></div><h4 ng-show="showfullprofile" ng-if="matchedUser.linkedin_provider !== null || matchedUser.twitter_provider !== null" class="ui header">Social Profiles</h4><a ng-show="showfullprofile" ng-if="matchedUser.linkedin_provider !== null" href="{{matchedUser.linkedin_provider}}" target="_new" class="ui linkedin button"><i class="linkedin icon"></i> LinkedIn</a> <a ng-show="showfullprofile" ng-if="matchedUser.twitter_provider !== null" href="http://www.twitter.com/{{matchedUser.twitter_provider}}" target="_new" class="ui twitter button"><i class="twitter icon"></i> Twitter</a></div></div></div><div class="footer segment" id="matched-profile-footer" ng-hide="showfullprofile"><div class="container"><div class="ui grid one column aligned center"><div class="row"><div class="column"><div class="ui labeled icon menu"><a href="" ng-click="cancelMatch()" class="item" id="left_button"><i class="remove red circle icon"></i></a> <a href="" ng-click="confirmMatch()" class="item" id="accept_button"><i class="check green circle icon"></i></a></div></div></div></div><br></div></div></div></div></div><div class="body segment" ng-if="total === 0" style="height: 100vh;"><div class="container"><div class="ui info message"><div class="header">Sorry. Currently you don\'t have any matches.</div><p>Add more information to your profile. <a class="ui icon mini button blue" ui-sref="myprofile"><i class="angle double right icon"></i></a></p><p>Adjust your match filter to be less restrictive. <a class="ui icon mini button blue" ng-click="toggleSidebarFilters()" href=""><i class="angle double right icon"></i></a></p></div></div></div><page-dimmer ng-model="showDimmer" show="true"><h1 class="ui header">BeKindred</h1><h2 class="ui header">Locating people with similar goals...</h2><fading-circle-spinner></fading-circle-spinner></page-dimmer>'),e.put("app/myconnections/myconnections.html",'<div class="segment" id="friends-list-header" ng-show="pok && !noConnections"><div class="container"><div class="ui left icon input"><input type="text" ng-model="q" ng-change="getFriends()" placeholder="Search" ng-model-options="{debounce:300}"> <i class="circular search icon"></i></div></div></div><div class="body segment" ng-if="noConnections"><div class="container"><div class="ui info message"><p>You don\'t have any connections. Go to your Match Feed to find people with similar goals and interests.</p><p><a class="ui icon button blue" ui-sref="matchfeed">Match Feed</a></p></div></div></div><div class="body segment" id="friends-list-body"><div class="container"><div class="ui basic segment" ng-class="{\'loading\': loading}"><div class="ui info message" ng-show="noResults && !loading"><p>No connections found.</p><p>Try with another search term or <a href="" ng-click="reset()">reset your search</a>.</p></div><div class="ui divided selection list"><div ui-sref="friendprofile({ userId: friend.friend_id })" class="item repeat-animation" ng-repeat="friend in friends track by $index" infinite-scroll="loadMoreFriends()" infinite-scroll-disabled="loadingMore" infinite-scroll-distance="1"><div class="ui circular tiny image img-bounding-box" ng-style="{\'background-image\': \'url(//graph.facebook.com/{{ friend.facebook_id }}/picture?type=large)\'}"></div><div class="content"><div class="header">{{friend.first_name}}</div><div class="description"><div class="ui mini statistics"><div class="statistic"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{friend.common_goals_offers_interests}}</div></div><div class="statistic"><div class="value"><i class="empty users usericon icon"></i></div><div class="label">{{friend.totalFriends}}</div></div></div></div></div></div></div><three-bounce-spinner class="page-spinner-bar" ng-show="loadingMore"></three-bounce-spinner></div></div></div>'),e.put("app/myprofile/myprofile.html",'<div class="header segment with-menu" id="my-profile-header"><div class="container"><div class="pagination-container"><div id="PhotoSlider" ng-if="photosSlider.length > 0"><ul rn-carousel="" rn-carousel-index="carouselIndex2"><li ng-repeat="item in photosSlider | orderBy:\'order\' track by $index"><img ng-show="item.cropped_photo === \'\'" class="img-bounding-box-full-width" ng-src="{{item.photo}}"> <img ng-show="item.cropped_photo !== \'\'" class="img-bounding-box-full-width" ng-src="{{item.cropped_photo}}"></li></ul><div class="carousel-indicators" rn-carousel-indicators="" ng-if="photosSlider.length > 1" slides="photosSlider" rn-carousel-index="carouselIndex2"></div></div></div></div></div><div class="body segment" id="matched-profile-body"><div class="container"><div class="ui top attached segment"><h3 class="ui left floated header">{{ user.firstName }}<span ng-hide="user.firstName === \'\'">,</span> {{ user.age }}</h3><h5 class="ui right floated header"><a ui-sref="editmyprofile" class="ui tiny button blue">Edit</a></h5></div><div class="ui attached segment" ng-class="{loading: loadingGoals || loadingOffers || loadingUser || loadingLikes || loadingInterests}"><h4 class="ui header">Goals</h4><div class="ui list"><div class="item" ng-repeat="goal in user.goals track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ goal.subject }}</div></div></div><p ng-if="user.goals.length == 0">No goals yet.</p></div><h4 class="ui header">Offers</h4><div class="ui list"><div class="item" ng-repeat="offer in user.offers track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ offer.subject }}</div></div></div><p ng-if="user.offers.length == 0">No offers yet.</p></div><h4 class="ui header">About</h4><div class="ui list"><div class="item"><i class="empty icon"></i><div class="content"><div class="description"><span>{{user.about_me}}</span></div></div></div></div><h4 class="ui header">Activities &amp; Interests</h4><div class="ui list"><div class="item" ng-repeat="interest in user.interests | limitTo:5 track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ interest.description }}</div></div></div><p ng-if="user.interests.length == 0">No interests yet.</p></div><h4 class="ui header">Likes</h4><div class="ui list likes"><div class="item" ng-repeat="like in user.likes | limitTo:5 track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ like.name }}</div></div></div><p ng-if="user.likes.length == 0">No likes yet.</p></div><h4 class="ui header">Social Accounts</h4><a href="{{ linkedin }}" target="_new" class="ui social icon fluid linkedin labeled button" ng-show="linkedin !== null"><i class="linkedin icon"></i> {{user.firstName}} <i class="check circle icon right"></i></a><br ng-show="linkedin !== null"><a href="https://twitter.com/{{ twitter }}" target="_new" class="ui social fluid icon twitter labeled button" ng-show="twitter !== null"><i class="twitter icon"></i> {{twitter}} <i class="check circle icon right"></i></a><br ng-show="twitter !== null"><a href="{{ user.facebookProfile }}" class="ui social icon facebook labeled fluid button" ng-if="user.facebookProfile !== \'\'"><i class="facebook icon"></i> {{user.firstName}} <i class="lock icon right"></i></a></div></div></div>'),e.put("app/offercreate/offercreate.html",'<div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">3</i></span> Post an offer</div></div><div class="body segment"><div class="container"><h2 class="ui center aligned header withborder">I can help people...<hr></h2><div class="ui attached warning message" id="warningmessage" ng-show="messageShow"><div class="header">Warning</div><p>{{message}}</p></div><div class="ui basic segment"><div class="ui form"><div class="ui center aligned grid"><div class="row"><div class="search-wrapper ui icon large left input"><i class="fa fa-search fa-lg"></i><div field-required="false" angucomplete-alt="" minlength="3" text-no-results="No existing offer found. Create new offer &raquo;" input-changed="inputChanged" match-class="highlight" selected-object="selectResult" description-field="description[3]" title-field="description" remote-url="/api/v1/subject/?format=json&description__icontains=" remote-url-data-field="objects" type="text" input-name="description" id="id_description" placeholder="enter your offer here"></div></div></div><div class="row" ng-hide="subject === \'\'"><a ng-click="createOffer()" class="ui button submit green big" role="button">Next &rarr;</a></div></div></div></div><div class="ui secondary segment" id="instructions" ng-hide="subject !== \'\'"><h4>This should be something you\'re willing to help other people achieve.</h4><br><h4>For example:</h4><p><ul class="unstyled"><li>&quot;Learn to play the banjo&quot;</li><li>&quot;Find a great restaurant&quot;</li><li>&quot;Take care of their pets&quot;</li><li>&quot;Move their 500 lb sofa&quot;</li></ul></p></div></div></div>'),e.put("app/settings/settings.html",'<div id="settingsPage"><div class="body segment edit" id="settings-body"><div class="container"><div class="ui attached segment"><h4 class="ui header">Manage Account</h4><div class="ui deleteitem red fluid button"><i class="remove circle icon"></i> Delete Account</div><br><br><hr><a class="ui fluid button" ui-sref-ignore="" href="accounts/logout"><i class="fa fa-sign-out icon"></i> Sign out</a></div></div></div><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want to delete?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div><script>\n    \'use strict\';\n    $(\'.basic.delete.modal\')\n    .modal({\n      onDeny    : function(){\n        console.log(\'cancel\');\n      },\n      onApprove : function() {\n        console.log(\'deleting user\');\n        angular.element(document.getElementById(\'settingsPage\')).scope().deleteUser();\n      }\n    })\n    .modal(\'attach events\', \'.deleteitem\', \'show\');\n\n\n  </script></div>'),e.put("components/leftsidebar/leftsidebar.html",'<div class="ui vertical left inverted labeled sidebar menu" id="menu" ng-controller="LeftSidebarCtrl"><a ui-sref="home" class="item"><i class="fa fa-home"></i> Home</a> <a ui-sref="inbox" class="item"><i class="fa fa-envelope"></i> Inbox</a> <a ui-sref="matchfeed" class="item"><i class="fa fa-check-square-o"></i> Match Feed</a> <a ui-sref="myprofile" class="item"><i class="fa fa-user"></i> My Profile</a> <a ui-sref="myconnections" class="item"><i class="fa fa-plus"></i> My Connections</a> <a class="item"><i class="fa fa-sign-out icon"></i> Sign out</a><div class="item" id="side-menu-logo"><ul class="social-icon" id="intro-title"><li><a href="" class="facebook"><i class="fa fa-slideshare"></i></a></li><li><h1>Kindred</h1></li></ul></div></div>'),e.put("components/topnavbar/topnavbar.html",'<div class="ui inverted top fixed menu" ng-controller="TopNavbarCtrl"><div class="container"><a class="launch item"><i class="content icon"></i></a><div class="title item"><b>Kindred</b></div><div class="right menu" id="main-menu-right"><a ui-sref="home" class="item"><i class="fa fa-home"></i> Home</a> <a ui-sref="inbox" class="item"><i class="fa fa-envelope"></i> Inbox</a> <a ui-sref="matchfeed" class="item"><i class="fa fa-check-square-o"></i> Match Feed</a> <a ui-sref="myprofile" class="item"><i class="fa fa-user"></i> My Profile</a> <a ui-sref="myconnections" class="item"><i class="fa fa-plus"></i> My Connections</a><div class="item">Welcome, USER</div><div class="item"><a class="ui blue button">Sign out <i class="fa fa-sign-out"></i></a></div></div></div></div>')
}]);