"use strict";angular.module("persice",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","angular-spinkit","frontend.semantic.dimmer","frontend.semantic.modal.event.create","frontend.semantic.modal.event.view","truncate","ngDraggable","cgNotify","ngImgCrop","angularMoment","btford.socket-io","ngLodash","hj.gsapifyRouter","angular-flexslider","ngGeolocation","ezfb","frontend.ui.tooltips","frontend.ui.autocomplete","google.places","ngMask","rzModule"]).config(["$compileProvider","$stateProvider","$urlRouterProvider","APP_ID","$httpProvider","$resourceProvider","gsapifyRouterProvider","ezfbProvider",function(e,t,i,n,s,o,a,r){r.setInitParams({appId:n,version:"v2.3",status:!0,xfbml:!0}),s.defaults.headers.patch={"Content-Type":"application/json;charset=utf-8"},o.defaults.stripTrailingSlashes=!1,s.defaults.xsrfCookieName="csrftoken",s.defaults.xsrfHeaderName="X-CSRFToken",s.defaults.headers.post={"Content-Type":"application/json;charset=utf-8"},a.defaults={enter:"fadeIn",leave:"fadeOut"},a.transition("slideAbove",{duration:1,ease:"Quart.easeInOut",css:{y:"-100%"}}),a.transition("slideBelow",{duration:1,ease:"Quart.easeInOut",css:{y:"100%"}}),a.transition("slideLeft",{duration:1,ease:"Quint.easeInOut",css:{x:"-100%"}}),a.transition("slideRight",{duration:1,ease:"Quint.easeInOut",delay:.5,css:{x:"100%"}}),a.transition("fadeIn",{duration:.5,delay:.2,css:{opacity:0}}),a.transition("fadeOut",{duration:.2,css:{opacity:0}}),a.transition("scaleDown",{duration:.5,css:{scale:0,opacity:0}}),a.initialTransitionEnabled=!0,t.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl",data:{displayName:"persice"},resolve:{}}).state("settings",{url:"/settings",templateUrl:"app/settings/settings.html",controller:"SettingsController",controllerAs:"settings",data:{displayName:"Settings"},resolve:{}}).state("conversations",{url:"/conversation/:userId",data:{displayName:"Conversations"},resolve:{userId:["$stateParams",function(e){return e.userId}],UsersFactory:"UsersFactory",FRIEND:["UsersFactory","$stateParams",function(e,t){var i=t.userId;return e.get({userId:i,format:"json"}).$promise}],ConnectionsFactory:"ConnectionsFactory",Connection:["ConnectionsFactory","$stateParams",function(e,t){var i=t.userId;return e.query({friend:i,format:"json"}).$promise}]},templateUrl:"app/conversations/conversations.html",controller:"ConversationsCtrl"}).state("goalcreate",{url:"/create-goal",data:{displayName:"Create a goal"},templateUrl:"app/goalcreate/goalcreate.html",controller:"GoalCreateCtrl"}).state("finalstep",{url:"/final-step",data:{displayName:"Final Step"},resolve:{UsersFactory:"UsersFactory",User:["UsersFactory","USER_ID",function(e,t){var i=t;return e.get({userId:i,format:"json"}).$promise}]},templateUrl:"app/finalstep/finalstep.html",controller:"FinalStepController",controllerAs:"finalstep"}).state("selectinterests",{url:"/select-interests",data:{displayName:"What interests you?"},templateUrl:"app/interests/interests.html",controller:"InterestsController",controllerAs:"interest"}).state("offercreate",{url:"/create-offer",data:{displayName:"Post an offer"},templateUrl:"app/offercreate/offercreate.html",controller:"OfferCreateCtrl"}).state("matchfeed",{url:"/crowd",data:{displayName:"Crowd"},templateUrl:"app/matchfeed/matchfeed.html",controller:"MatchFeedController",controllerAs:"matchfeed"}).state("bigmatchfeed",{url:"/big-crowd",data:{displayName:"Crowd"},templateUrl:"app/bigmatchfeed/bigmatchfeed.html",controller:"BigMatchFeedCtrl"}).state("myconnections",{url:"/my-connections",data:{displayName:"Connections"},templateUrl:"app/myconnections/myconnections.html",controller:"MyConnectionsController",controllerAs:"myconnections"}).state("friendprofile",{url:"/friend-profile/:userId",data:{displayName:"Connection"},resolve:{userId:["$stateParams",function(e){return e.userId}],ConnectionsFactory:"ConnectionsFactory",UsersFactory:"UsersFactory",UserProfile:["UsersFactory","$stateParams",function(e,t){return e.query({userId:t.userId,format:"json"}).$promise}],Connection:["ConnectionsFactory","$stateParams",function(e,t){var i=t.userId;return e.query({friend:i,format:"json"}).$promise}]},templateUrl:"app/friendprofile/friendprofile.html",controller:"FriendProfileController",controllerAs:"friendprofile"}).state("myprofile",{url:"/my-profile",data:{displayName:"Profile"},templateUrl:"app/myprofile/myprofile.html",controller:"MyProfileController",controllerAs:"myprofile"}).state("editmyprofile",{url:"/my-profile/edit",data:{displayName:"Edit profile"},templateUrl:"app/editmyprofile/editmyprofile.html",controller:"EditMyProfileCtrl"}).state("inbox",{url:"/messages",data:{displayName:"Messages"},templateUrl:"app/inbox/inbox.html",controller:"InboxController",controllerAs:"inbox"}).state("events",{"abstract":!0,url:"/events",templateUrl:"app/events/events_page.html",controller:"EventsPageController",controllerAs:"eventspage",resolve:{},data:{displayName:""}}).state("events.mynetwork",{url:"/my-network",templateUrl:"app/events/events_mynetwork.html",data:{}}).state("events.myevents",{url:"/my-events",templateUrl:"app/events/events_myevents.html",data:{}}).state("events.allevents",{url:"/all-events",templateUrl:"app/events/events_allevents.html",data:{}}).state("events.map",{url:"/map",templateUrl:"app/events/events_map.html",data:{}}).state("event",{url:"/event","abstract":!0,templateUrl:"app/events/event.html",controller:"EventPageController",controllerAs:"eventpage",resolve:{},data:{displayName:"Event Details"}}).state("event.create",{url:"/create",templateUrl:"app/events/event_create.html",controller:"EventCreateController",controllerAs:"singleevent",data:{displayName:"Event Details"}}).state("event.edit",{url:"/edit/:eventId",templateUrl:"app/events/event_edit.html",controller:"EventEditController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Event Details"}}).state("event.invitations",{url:"/invitations/:eventId",templateUrl:"app/events/event_invitations.html",controller:"EventInvitationsController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Invitations"}}).state("event.attendees",{url:"/attendees/:eventId",templateUrl:"app/events/event_attendees.html",controller:"EventAttendeesController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Attendees"}}).state("event.details",{url:"/details/:eventId",templateUrl:"app/events/event_view.html",controller:"EventViewController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Event Details"}}),i.otherwise("/")}]).run(["$rootScope","$state","$stateParams","$timeout","ezfb",function(e,t,i,n,s){e.$state=t,e.isState=function(e){return t.includes(e)},e.$stateParams=i,e.$on("$stateChangeStart",function(e,t){$(".sidebar").sidebar("is visible")&&$(".sidebar").sidebar("hide")}),e.$on("$stateChangeSuccess",function(t,i,n,s,o){document.body.scrollTop=document.documentElement.scrollTop=0,e.previousState={name:s.name,params:o},"events.myevents"!==s.name&&"events.allevents"!==s.name&&"events.mynetwork"!==s.name||"event.details"!==i.name&&"event.create"!==i.name||(e.previousEventFeed=s.name)}),e.$on("$stateChangeError",function(e){})}]).value("noUiSliderConfig",{step:1}).directive("ngEnter",function(){return function(e,t,i){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(i.ngEnter)}),t.preventDefault())})}}).directive("updateTitle",["$rootScope","$timeout",function(e,t){return{link:function(i,n){var s=function(e,i,s,o,a){var r="persice";i.data&&i.data.displayName&&(r=i.data.displayName),t(function(){n.html(r)})};e.$on("$stateChangeSuccess",s)}}}]).directive("endRepeat",["$timeout",function(e){return{restrict:"A",link:function(t,i,n){t.$last===!0&&e(function(){t.$emit("ngRepeatFinished")})}}}]).directive("endRepeatPhotos",["$timeout",function(e){return{restrict:"A",link:function(t,i,n){t.$last===!0&&e(function(){t.$emit("ngRepeatFinishedPhotos")})}}}]).filter("getByProperty",function(){return function(e,t,i){for(var n=0,s=i.length;s>n;n++)if(i[n][e]===t)return i[n];return null}}).filter("lastMessage",function(){return function(e){return null===e?"No messages.":e}}).filter("getIndexByProperty",function(){return function(e,t,i){for(var n=0,s=i.length;s>n;n++)if(i[n][e]===t)return n;return null}}).filter("getByPropertyExcept",function(){return function(e,t,i,n,s){for(var o=0,a=s.length;a>o;o++)if(s[o][e]===t&&s[o][i]!==n)return s[o];return null}}).directive("modal",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{model:"=ngModel"},template:'<div class="ui dimmer modals page transition" style="position: absolute;" ng-class="{ \'active visible\': model }"><div class="ui long test modal transition scrolling" style="top: 150px;" ng-class="{ \'active visible\': model }" ng-transclude></div></div>',link:function(e,t,i){}}}).directive("ngChangeOnBlur",function(){return{restrict:"A",require:"ngModel",link:function(e,t,i,n){if("radio"!==i.type&&"checkbox"!==i.type){var s=i.ngChangeOnBlur,o=null;t.bind("focus",function(){e.$apply(function(){o=t.val()})}),t.bind("blur",function(){e.$apply(function(){var i=t.val();i!==o&&e.$eval(s)})})}}}}).factory("myIoSocket",["socketFactory",function(e){var t=io.connect("//"+window.location.hostname+":3000");return t=e({ioSocket:t}),t.forward("message"),t.forward("error"),t}]).directive("whenScrollEnds",function(){return{restrict:"A",link:function(e,t,i){var n=t.height(),s=100;t.scroll(function(){var o=t.prop("scrollHeight"),a=o-n;a-t.scrollTop()<=s&&e.$apply(i.whenScrollEnds)})}}}).directive("whenScrolled",["$timeout",function(e){return function(t,i,n){var s=i[0];i.bind("scroll",function(){if(s.scrollTop<=100){var i=s.scrollHeight;t.$apply(n.whenScrolled).then(function(){e(function(){s.scrollTop=s.scrollHeight-i})})}})}}]).directive("scrollBottomOn",["$timeout",function(e){return function(t,i,n){t.$watch(n.scrollBottomOn,function(t){t&&e(function(){i[0].scrollTop=i[0].scrollHeight})})}}]).directive("uicheckbox",function(){return{restrict:"E",replace:!0,transclude:!0,require:"ngModel",scope:{type:"@",value:"@",size:"@",checked:"@",change:"&",model:"=ngModel"},template:'<div class="{{checkbox_class}}"><input type="checkbox"><label ng-click="click_on_checkbox()" ng-transclude></label></div>',link:function(e,t,i){"standard"===e.type||void 0===e.type?(e.type="standard",e.checkbox_class="ui checkbox"):"slider"===e.type?(e.type="slider",e.checkbox_class="ui slider checkbox"):"toggle"===e.type?(e.type="toggle",e.checkbox_class="ui toggle checkbox"):(e.type="standard",e.checkbox_class="ui checkbox"),"large"===e.size?e.checkbox_class=e.checkbox_class+" large":"huge"===e.size&&(e.checkbox_class=e.checkbox_class+" huge"),"false"===e.checked||void 0===e.checked?e.checked=!1:(e.checked=!0,t.children()[0].setAttribute("checked","")),t.bind("click",function(){e.$apply(function(){e.checked===!0?(e.checked=!0,e.model=!1,t.children()[0].removeAttribute("checked")):(e.checked=!0,e.model=!0,t.children()[0].setAttribute("checked","true"))})}),e.$watch("model",function(i){void 0!==i&&(i===!0?(e.checked=!0,t.children()[0].setAttribute("checked","true"),e.change({value:e.value,checked:e.checked})):(e.checked=!1,t.children()[0].removeAttribute("checked"),e.change({value:e.value,checked:e.checked})))})}}}).directive("autoFocus",["$timeout",function(e){return{restrict:"AC",link:function(t,i){e(function(){i[0].focus()},0)}}}]),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"userprofile",bindToController:!0,scope:{id:"@id","class":"@class",header:"@header",body:"@body",person:"=person",type:"@type"},link:e,templateUrl:"components/userprofile/userprofile.template.html",restrict:"E"};return i}function t(e,t,i,n,s,o,a,r,l,c,d,u){function v(){$("#photoSlider").flexslider("next")}function m(){t.get({format:"json"},{userId:g.userId}).$promise.then(function(e){g.user.first_name=e.first_name,g.user.last_name=e.last_name,g.user.last_name=e.last_name,g.user.about_me=e.about_me,g.user.age=e.age,g.user.facebookId=e.facebook_id,null!==e.twitter_provider&&(g.social.twitter=e.twitter_username),null!==e.linkedin_provider&&(g.social.linkedin=e.linkedin_provider),null!==e.facebook_profile_url&&(g.social.facebook=e.facebook_profile_url),g.loadingUser=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);g.loadingUser=!1,d.error(i)})}function p(){"loggedInUser"===g.type&&g.getUserInfo(),"loggedInUser"===g.type&&(a.query({user_id:g.userId,format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.goals=e.objects),g.loadingGoals=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)}),r.query({user_id:g.userId,format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.offers=e.objects),g.loadingOffers=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)}),l.query({format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.likes=e.objects),g.loadingLikes=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)}),i.query({user_id:g.userId,format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.interests=e.objects),g.loadingInterests=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)})),"friend"===g.type&&(n.get({user_id:g.userId,format:"json"}).$promise.then(function(e){g.user.first_name=e.objects[0].first_name,g.user.last_name=e.objects[0].last_name,g.user.last_name=e.objects[0].last_name,g.user.about_me=e.objects[0].about_me,g.user.age=e.objects[0].age,g.user.facebookId=e.objects[0].facebook_id,null!==e.objects[0].twitter_provider&&(g.social.twitter=e.objects[0].twitter_username),null!==e.objects[0].linkedin_provider&&(g.social.linkedin=e.objects[0].linkedin_provider),null!==e.objects[0].facebook_id&&(g.social.facebook="https://www.facebook.com/app_scoped_user_id"+e.objects[0].facebook_id+"/");var t=[];g.user.distance=e.objects[0].distance;var i=e.objects[0].goals[0];for(var n in i){var s={value:n,match:i[n]};t.push(s)}g.user.goals=t;var o=[],a=e.objects[0].offers[0];for(var n in a){var r={value:n,match:a[n]};o.push(r)}g.user.offers=o;var l=[],c=e.objects[0].interests[0];for(var n in c){var d={value:n,match:c[n]};l.push(d)}g.user.interests=l;var u=[],v=e.objects[0].likes[0];for(var n in v){var m={value:n,match:v[n]};u.push(m)}g.user.likes=u},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)}),o.query({format:"json",user_id:g.userId}).$promise.then(function(e){e.objects.length>0&&(g.user.friends=e.objects[0].mutual_bk_friends,g.user.facebookfriends=e.objects[0].mutual_fb_friends,g.user.linkedinconnections=e.objects[0].mutual_linkedin_connections,g.user.twitterfollowers=e.objects[0].mutual_twitter_followers,g.user.twitterfriends=e.objects[0].mutual_twitter_friends)},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)}))}function f(){c.query({format:"json",user_id:g.userId}).$promise.then(function(e){if(g.user.photos=e.objects,0===g.user.photos.length){var t={photo:g.userPhoto,cropped_photo:"",order:0,user:"/api/v1/auth/user/"+g.userId+"/"};c.save({},t,function(e){d.info(e),d.info("New photo saved."),g.user.photos.push({photo:g.userPhoto,cropped_photo:"",order:0}),g.photosSlider=g.user.photos},function(e){d.info(e)})}else g.photosSlider=g.user.photos},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i)})}var g=this;g.userId=g.person.id,g.userPhoto=g.person.photo,g.getUser=p,g.getUserInfo=m,g.getPhotos=f,g.nextImage=v,g.showfullprofile=!0,g.social={twitter:"",linkedin:"",facebook:""},g.user={id:g.person.id,first_name:"",last_name:"",age:"",about_me:"",photos:[],goals:[],offers:[],likes:[],interests:[],friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[],distance:[]},g.photosSlider=[],g.getUser(),g.getPhotos()}angular.module("persice").directive("userProfile",e),t.$inject=["$scope","UsersFactory","InterestsFactory","ProfileFactory","MatchFeedFactory","MutualFriendsFactory","GoalsFactory","OffersFactory","LikesFactory","PhotosFactory","$log","lodash"]}(),function(){function e(e,t,i,n,s){function o(){function i(e){0===e.objects.length?(d.createSettings(c),d.settingsState=c):(d.settingId=e.objects[0].id,d.settingsState=e.objects[0])}function n(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),d.settingsState=c}return t.info("fetching settings"),e.query({format:"json"}).$promise.then(i,n)}function a(){return d.settingsState}function r(i){function n(e){d.settingsState=i}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("saving settings"),null!==d.settingId?e.update({settingId:d.settingId},i,n,s):void 0}function l(i){function n(e){t.info("new settings created"),d.settingId=e.id}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("creating settings"),e.save(i,n,s)}var c={distance_unit:"miles",user:"/api/v1/auth/user/"+s+"/"},d={settingsState:{distance_unit:"miles",user:"/api/v1/auth/user/"+s+"/"},settingId:null,getSettings:o,saveSettings:r,createSettings:l,getSettingState:a};return d}angular.module("persice").factory("SettingsRepository",e),e.$inject=["SettingsFactory","$log","$filter","$rootScope","USER_ID"]}(),angular.module("persice").factory("SettingsFactory",["$resource",function(e){return e("/api/v1/settings/:settingId/:param",{settingId:"@settingId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e,t,i,n,s,o){function a(){function t(e){var t=0;e.meta.total_count>0&&(t=e.objects[0].unread_counter),m.setTotalInbox(t)}function n(t){var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);e.error(n)}return i.query({format:"json",limit:1,offset:0}).$promise.then(t,n)}function r(){function t(e){var t=0;e.meta.total_count>0&&(t=e.objects[0].new_connection_counter),m.setTotalConnections(t)}function i(t){var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);e.error(n)}return n.query({format:"json",limit:1,offset:0}).$promise.then(t,i)}function l(e){m.totalInbox=e,m.total=m.totalInbox+m.totalConnections,s.$broadcast("refreshMessagesCounter"),s.$broadcast("refreshStateNotificationCircle")}function c(e){m.totalConnections=e,m.total=m.totalInbox+m.totalConnections,s.$broadcast("refreshConnectionsCounter"),s.$broadcast("refreshStateNotificationCircle")}function d(){return m.total}function u(){return m.totalInbox}function v(){return m.totalConnections}var m={total:0,totalInbox:0,totalConnections:0,getTotal:d,setTotalInbox:l,setTotalConnections:c,refreshTotalInbox:a,refreshTotalConnections:r,getTotalInbox:u,getTotalConnections:v};return m}angular.module("persice").factory("NotificationsRepository",e),e.$inject=["$log","$filter","InboxUnreadCounterFactory","NewConnectionsFactory","$rootScope","$q"]}(),function(){function e(){function e(e,t,i){}var i={controller:t,controllerAs:"notificationcircle",bindToController:!0,scope:{color:"@color"},link:e,template:'<mark class="notification {{notificationcircle.color}}"  ng-class="{\'hidden-notification\': notificationcircle.hideClass}"></mark>',restrict:"E",replace:!0};return i}function t(e,t,i){var n=this;n.hideClass=!0,n.counter=i.getTotal(),t.$on("displayNotificationCircle",function(e,t){n.hideClass=!1}),t.$on("hideNotificationCircle",function(e,t){n.hideClass=!0}),t.$on("refreshStateNotificationCircle",function(e,t){n.counter=i.getTotal(),n.hideClass=n.counter>0?!1:!0})}angular.module("persice").directive("notificationCircle",e),t.$inject=["$scope","$rootScope","NotificationsRepository"]}(),function(){function e(){function e(e,t,i,n){console.log("pero"),console.log(t),t.modal({onHide:function(){n.$setViewValue(!1)}}),e.$watch(function(){return n.$modelValue},function(e){t.modal("setting","transition","scale").modal("setting","closable",!1).modal(e?"show":"hide")})}var i={restrict:"E",replace:!0,transclude:!0,require:"ngModel",template:'<div class="ui modal" ng-transclude></div>',controller:t,controllerAs:"uimodal",bindToController:!0,link:e};return i}function t(e,t){}angular.module("frontend.semantic.modal",[]).directive("uiModal",e),t.$inject=["$scope","$log"]}(),function(){function e(e){function i(e,t,i,n){t.modal({onHide:function(){e.viewevent.show=!1,e.viewevent.selection="view",e.viewevent.eventNotFound=!1,e.viewevent.header="Event Details",e.viewevent.modalId="viewEventsModal"},onHidden:function(){e.viewevent.show=!1,e.viewevent.selection="view",e.viewevent.eventNotFound=!1,e.viewevent.header="Event Details",e.viewevent.modalId="viewEventsModal"}}),t.modal({onShow:function(){e.viewevent.selection="view",e.viewevent.eventNotFound=!1,e.viewevent.header="Event Details",e.viewevent.modalId="viewEventsModal",t.addClass("small")}}),e.viewevent.getActiveClass=function(){return"invitations"===e.viewevent.selection?"":"small"},e.$watch("viewevent.show",function(e){t.modal("setting","transition","scale").modal("setting","closable",!1).modal("setting","allowMultiple",!0).modal(e?"show":"hide")})}var n={restrict:"E",replace:!0,transclude:!1,scope:{show:"=show",eventid:"=eventid"},templateUrl:"components/modal/modalview.html",controller:t,controllerAs:"viewevent",bindToController:!0,link:i};return n}function t(e,t,i,n,s,o,a,r,l,c,d,u,v,m,p,f){function g(e){U.connections[e].is_invited||(U.connections[e].selected=!U.connections[e].selected,U.connections[e].selected?U.counterNewInvites++:U.counterNewInvites--)}function h(e){var t=v("getIndexByProperty")("friend_id",U.invitedPeople[e].friend_id,U.connections);d["delete"]({memberId:U.connections[t].member_id},function(i){U.connections[t].is_invited=!1,U.connections[t].selected=!1,U.invitedPeople.splice(e,1),U.counterNewInvites>0&&U.counterNewInvites--},function(e){o.info(e)})}function b(){if(U.counterNewInvites>0){if(U.loadingInvitesSave)return;U.loadingInvitesSave=!0;for(var t=[],i=U.connections.length-1;i>=0;i--)if(U.connections[i].selected&&!U.connections[i].is_invited){var n={event:"/api/v1/event/"+U.eventid+"/",is_invited:!1,user:"/api/v1/auth/user/"+U.connections[i].friend_id+"/"};t.push(d.save({},n))}f.all(t).then(function(e){angular.forEach(e,function(e){o.info(e);var t=v("getIndexByProperty")("user",e.user,U.connections);U.connections[t].member_id=e.id,U.connections[t].is_invited=!0,U.connections[t].rsvp="",U.invitedPeople.push(U.connections[t])})}).then(function(t){o.info("Sending invites finished."),U.counterNewInvites=0,U.loadingInvitesSave=!1,c({messageTemplate:'<div class="notify-info-header">Success</div><p>All event invitations have been successfully sent.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),e.$emit("invitesSent")})}else c({messageTemplate:'<div class="notify-error-header">Warning</div><p>Please select connections to invite.</p>',classes:"notify-error",icon:"remove circle",duration:4e3})}function w(){U.connections=[],U.friends=[],U.invitedPeople=[],U.counterNewInvites=0,U.nextOffset=10,U.next=null,U.loadingConnections=!0,p.query({format:"json",first_name:U.connectionFirstName,limit:10,offset:0}).$promise.then(y,_)}function y(e){U.friends=e.objects,U.next=e.meta.next;for(var t=U.friends.length-1;t>=0;t--){for(var i=null===U.friends[t].mutual_friends_count?0:U.friends[t].mutual_friends_count,n=null===U.friends[t].common_goals_offers_interests?0:U.friends[t].common_goals_offers_interests,s={first_name:U.friends[t].first_name,age:U.friends[t].age,common_goals_offers_interests:n,mutual_friends_count:i,tagline:U.friends[t].tagline,facebook_id:U.friends[t].facebook_id,friend_id:U.friends[t].friend_id,user:"/api/v1/auth/user/"+U.friends[t].friend_id+"/",is_invited:!1,member_id:null,rsvp:"",selected:!1,event:parseInt(U.eventid),image:"//graph.facebook.com/"+U.friends[t].facebook_id+"/picture?type=square"},o=U.friends[t].events.length-1;o>=0;o--)U.friends[t].events[o].event===s.event&&(s.is_invited=!0,s.rsvp=U.friends[t].events[o].rsvp,s.selected=!0,s.member_id=U.friends[t].events[o].id,U.invitedPeople.push(s));U.connections.push(s)}U.loadingConnections=!1}function _(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);o.error(i),U.loadingConnetions=!1}function k(){U.selection="invitations",U.header="Invitations",U.getConnections()}function E(){U.selection="edit",U.header="Event Details"}function x(){U.selection="attendees",U.header="Attendees"}function I(){U.selection="view",U.header="Event Details"}function M(e){var i={event:"/api/v1/event/"+U.event.id+"/",rsvp:e,user:"/api/v1/auth/user/"+t+"/"};U.eventRsvp.status!==e&&(U.memberExists?(U.eventRsvp.status=e,d.update({memberId:U.memberId},i,function(i){for(var n=U.event.members.length-1;n>=0;n--)U.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(U.event.members[n].rsvp=e)},function(e){})):(U.eventRsvp.status=e,d.save({},i,function(e){U.memberExists=!0,U.event.members.push(e),U.memberId=e.id},function(e){})))}function F(){U.showError=!1,i["delete"]({eventId:U.eventEdit.id},function(e){U.showError=!1,c({messageTemplate:'<div class="notify-info-header">Success</div><p>Event has been successfully deleted.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),s.$broadcast("refreshEventFeed"),U.closeEventModal()},function(e){U.errorMessage=[],U.showError=!0,e.data.event&&(U.errorMessage=["Event could not be deleted."])})}function S(){U.selection="view",U.pok=0,U.loadingEvent=!0,i.query({format:"json"},{eventId:U.eventid}).$promise.then(function(e){if(U.eventNotFound=!1,U.event=e,U.eventLocation="",U.mapurlTrue=!1,U.mapurl="","0,0"!==U.event.location?(U.eventLocation=""!==U.event.full_address&&null!==U.event.full_address?U.event.full_address:U.event.street+" "+U.event.city+" "+U.event.zipcode+" "+U.event.state,U.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(U.eventLocation)+"/@"+U.event.location+",15z",U.mapurlTrue=!0):(U.mapurlTrue=!1,U.mapurl="",U.eventLocation=U.event.location_name),U.isHost=!1,U.eventRsvp={status:""},U.memberExists=!1,U.memberId=null,U.event.members.length>0)for(var i=U.event.members.length-1;i>=0;i--)U.event.members[i].is_organizer===!0?U.event.members[i].user==="/api/v1/auth/user/"+t+"/"&&(U.isHost=!0):U.event.members[i].user==="/api/v1/auth/user/"+t+"/"&&(U.memberId=U.event.members[i].id,null!==U.event.members[i].rsvp&&(U.eventRsvp.status=U.event.members[i].rsvp),U.memberExists=!0);U.starts_on_date=r.utc(U.event.starts_on,r.ISO_8601).local().format("dddd, MMMM D, YYYY"),U.ends_on_date=r.utc(U.event.ends_on,r.ISO_8601).local().format("dddd, MMMM D, YYYY"),U.starts_on_time=r.utc(U.event.starts_on,r.ISO_8601).local().format("h:mm A"),U.ends_on_time=r.utc(U.event.ends_on,r.ISO_8601).local().format("h:mm A ")+r.tz(l.timezone).format("z"),U.ends_on_date!==U.starts_on_date?(U.firstrow=U.starts_on_date+" "+U.starts_on_time,U.secondrow=U.ends_on_date+" "+U.ends_on_time):(U.firstrow=U.starts_on_date,U.secondrow=U.starts_on_time+" to "+U.ends_on_time),U.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;U.loadingEvent=!1,U.eventNotFound=!0})}function T(){U.loadingInvitesSave=!1,U.show=!1}function C(){""!==U.mapurl&&a.open(U.mapurl)}function P(){return U.startsTimeError=!1,U.endsTimeError=!1,r(U.eventEdit.starts_on).unix()<r().unix()?(U.showError=!0,U.errorMessage=["Please select a Starts Date that is not set in past."],void(U.startsTimeError=!0)):(U.showError=!1,U.errorMessage=[],U.startsTimeError=!1,r(U.eventEdit.ends_on).unix()<r().unix()?(U.showError=!0,U.errorMessage=["Please select an Ends Date that is not set in past."],void(U.endsTimeError=!0)):r(U.eventEdit.ends_on).unix()>r().unix()&&r(U.eventEdit.starts_on).unix()>r().unix()&&r(U.eventEdit.starts_on).unix()>r(U.eventEdit.ends_on).unix()?(U.showError=!0,U.errorMessage=["Ends Date must be greater or equal to Starts Date."],U.endsTimeError=!0,void(U.startsTimeError=!0)):(U.showError=!1,U.errorMessage=[],U.startsTimeError=!1,U.endsTimeError=!1,void 0))}function A(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function D(){if(null!==U.eventLocation&&"object"==typeof U.eventLocation&&U.eventLocation.hasOwnProperty("address_components")&&U.eventLocation.hasOwnProperty("geometry")){var e=U.eventLocation.address_components;U.eventEdit.street=U.extractFromAddress(e,"route","long_name")+" "+U.extractFromAddress(e,"street_number","long_name"),U.eventEdit.zipcode=U.extractFromAddress(e,"postal_code","long_name"),""===U.eventEdit.zipcode&&(U.eventEdit.zipcode=null),U.eventEdit.location_name=U.eventLocation.name,U.eventEdit.full_address=U.eventLocation.formatted_address,U.eventEdit.state=U.extractFromAddress(e,"administrative_area_level_1","short_name"),U.eventEdit.country=U.extractFromAddress(e,"country","short_name"),U.eventEdit.state.length>3&&(U.eventEdit.state=U.eventEdit.country),U.eventEdit.city=U.extractFromAddress(e,"locality","long_name"),U.eventEdit.location=U.eventLocation.geometry.location.A+","+U.eventLocation.geometry.location.F,U.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(U.eventLocation.formatted_address)+"/@"+U.eventEdit.location+",15z",U.mapurlTrue=!0}else U.pok>2?(U.eventEdit.address=U.eventLocation,U.eventEdit.full_address="",U.eventEdit.location_name=U.eventLocation,U.eventEdit.location="0,0"):U.pok++}function j(e){var t=parseInt(e.substr(0,2));return-1!=e.indexOf("AM")&&12==t&&(e=e.replace("12","0")),-1!=e.indexOf("PM")&&12>t&&(e=e.replace(t,t+12)),e.replace(/(AM|PM)/,"")}function L(e){if(U[e+"_date"]&&U[e+"_time"]){{var t=U[e+"_date"].split("/"),i=[t[2],t[0],t[1]],n=j(U[e+"_time"]).split(":");6e4*(new Date).getTimezoneOffset()}i&&n&&(i[1]-=1,U.eventEdit[e]=r(i.concat(n)).toISOString())}}function N(){U.showError=!1,U.showSuccess=!1,U.errorMessage=[],U.endsTimeError=!1,U.startsTimeError=!1,U.eventEdit=angular.copy(U.event),U.starts_on_date=r.utc(U.event.starts_on,r.ISO_8601).local().format("MM/DD/YYYY"),U.ends_on_date=r.utc(U.event.ends_on,r.ISO_8601).local().format("MM/DD/YYYY"),U.starts_on_time=r.utc(U.event.starts_on,r.ISO_8601).local().format("h:mm A"),U.ends_on_time=r.utc(U.event.ends_on,r.ISO_8601).local().format("h:mm A"),U.modalId="createEventsModal",U.selection="edit"}function O(){U.showError=!1,U.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]},starts_on_date:{identifier:"starts_on_date",rules:[{type:"empty",prompt:"Please enter Starts Date"}]},starts_on_time:{identifier:"starts_on_time",rules:[{type:"empty",prompt:"Please enter Starts Time"}]},ends_on_date:{identifier:"ends_on_date",rules:[{type:"empty",prompt:"Please enter Ends Date"}]},ends_on_time:{identifier:"ends_on_time",rules:[{type:"empty",prompt:"Please enter Ends Time"}]}}}),$(".ui.form").form("validate form"),""===U.eventEdit.description||""===U.eventEdit.ends_on||""===U.eventEdit.location||""===U.eventEdit.name||""===U.eventEdit.starts_on||""===U.eventEdit.repeat?((""===U.eventEdit.starts_on||null===U.eventEdit.starts_on)&&(U.startsTimeError=!0),(""===U.eventEdit.ends_on||null===U.eventEdit.ends_on)&&(U.endsTimeError=!0),U.showError=!0,U.errorMessage=["Please enter all required fields."]):(U.validateDates(),U.showSuccess=!1,U.showError||i.update({eventId:U.eventEdit.id},U.eventEdit,function(e){U.showError=!1,U.modalId="viewEventsModal",U.selection="view",c({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),s.$broadcast("refreshEventFeed"),U.getEvent()},function(e){U.errorMessage=[],
U.showError=!0,e.data.event&&(U.errorMessage=e.data.event.error)}))}var U=this;U.showMobile=!1,U.closeEventModal=T,U.getEvent=S,U.openMap=C,U.deleteEvent=F,U.event={},U.invitationsMode=!1,U.header="Event Details",U.showError=!1,U.showSuccess=!1,U.errorMessage=[],U.endsTimeError=!1,U.startsTimeError=!1,U.modalId="viewEventsModal",U.eventRsvp={status:""},U.changeRsvpStatus=M,U.extractFromAddress=A,U.parseLocation=D,U.combineDateTime=L,U.validateDates=P,U.saveEvent=O,U.openInvitations=k,U.closeInvitations=E,U.openAttendees=x,U.closeAttendees=I,U.selection="view",U.editEvent=N,U.isHost=!1,U.loadingEvent=!1,U.placeholder={name:"",starts:"Date",startsTime:"Time",ends:"Date",endsTime:"Time",repeat:"",repeatUntil:"Until date",description:"",location:"",costs:"",invitations:"",attachments:""},U.$geolocation=u,u.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){U.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),U.autocompleteOptions={location:"0,0",radius:5e4},U.memberExists=!1,e.$watch(angular.bind(this,function(e){return U.show}),function(e){e&&U.getEvent()}),U.loadingInvitesSave=!1,U.counterNewInvites=0,U.markSelected=g,U.removeInvite=h,U.sendInvites=b,U.getConnections=w,U.nextOffset=10,U.loadingConnections=!1,U.connectionFirstName="",U.invitationsOptions={attendingPref:"private",guestInvite:!0},U.friends=[],U.connections=[],U.invitedPeople=[],U.connectionsYes=[{id:1,rsvp:"",first_name:"Lena",age:35,invited:!1,selected:!1,mutual_friends:10,match_score:4,tagline:"Creative designer & hiker"},{id:3,rsvp:"",first_name:"Charlie",age:39,invited:!1,selected:!1,mutual_friends:10,match_score:4,tagline:"Hacker, Guitaris, and veteran Burner"}],U.connectionsNo=[{id:2,rsvp:"YES",first_name:"Brian",age:31,invited:!0,selected:!0,mutual_friends:10,match_score:4,tagline:"Engineer kiteboarding chess geek"}],U.connectionsMaybe=[{id:4,rsvp:"",first_name:"Daniel",age:25,invited:!1,selected:!1,mutual_friends:10,match_score:4,tagline:"Grad student from London"}],U.eventEdit={starts_on:"",ends_on:"",address:""},e.$watch(angular.bind(this,function(e){return U.starts_on_date}),function(e){U.combineDateTime("starts_on"),U.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return U.starts_on_time}),function(e){U.combineDateTime("starts_on"),U.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return U.ends_on_date}),function(e){U.combineDateTime("starts_on"),U.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return U.ends_on_time}),function(e){U.combineDateTime("starts_on"),U.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return U.eventLocation}),function(e){U.parseLocation()}),U.pok=0}angular.module("frontend.semantic.modal.event.view",[]).directive("uiEventViewModal",e),e.$inject=["$log"],t.$inject=["$scope","USER_ID","EventsFactory","$state","$rootScope","$log","$window","moment","angularMomentConfig","notify","MembersFactory","$geolocation","$filter","$timeout","EventsConnections","$q"]}(),function(){function e(){function e(e,t,i,n){t.modal({onHide:function(){e.singleevent.show=!1,e.singleevent.resetForm()}}),e.$watch("singleevent.show",function(e){t.modal("setting","transition","scale").modal("setting","closable",!1).modal(e?"show":"hide")})}var i={restrict:"E",replace:!0,transclude:!1,scope:{show:"=show"},templateUrl:"components/modal/modalcreate.html",controller:t,controllerAs:"singleevent",bindToController:!0,link:e};return i}function t(e,t,i,n,s,o,a,r,l){function c(){b.show=!1}function d(){return b.startsTimeError=!1,b.endsTimeError=!1,r(b.event.starts_on).unix()<r().unix()?(b.showError=!0,b.errorMessage=["Please select a Starts Date that is not set in past."],void(b.startsTimeError=!0)):(b.showError=!1,b.errorMessage=[],b.startsTimeError=!1,r(b.event.ends_on).unix()<r().unix()?(b.showError=!0,b.errorMessage=["Please select an Ends Date that is not set in past."],void(b.endsTimeError=!0)):r(b.event.ends_on).unix()>r().unix()&&r(b.event.starts_on).unix()>r().unix()&&r(b.event.starts_on).unix()>r(b.event.ends_on).unix()?(b.showError=!0,b.errorMessage=["Ends Date must be greater or equal to Starts Date."],b.endsTimeError=!0,void(b.startsTimeError=!0)):(b.showError=!1,b.errorMessage=[],b.startsTimeError=!1,b.endsTimeError=!1,void 0))}function u(){b.showError=!1,b.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]},starts_on_date:{identifier:"starts_on_date",rules:[{type:"empty",prompt:"Please enter Starts Date"}]},starts_on_time:{identifier:"starts_on_time",rules:[{type:"empty",prompt:"Please enter Starts Time"}]},ends_on_date:{identifier:"ends_on_date",rules:[{type:"empty",prompt:"Please enter Ends Date"}]},ends_on_time:{identifier:"ends_on_time",rules:[{type:"empty",prompt:"Please enter Ends Time"}]}}}),$(".ui.form").form("validate form"),""===b.event.description||""===b.event.ends_on||""===b.event.location||""===b.event.name||""===b.event.starts_on||""===b.event.repeat?((""===b.event.starts_on||null===b.event.starts_on)&&(b.startsTimeError=!0),(""===b.event.ends_on||null===b.event.ends_on)&&(b.endsTimeError=!0),b.showError=!0,b.errorMessage=["Please enter all required fields."]):(b.validateDates(),b.showSuccess=!1,b.showError||i.save({},b.event,function(e){b.showError=!1,s.$broadcast("closeModalCreateEvent"),b.resetForm()},function(e){b.errorMessage=[],b.showError=!0,e.data.event&&(b.errorMessage=e.data.event.error)}))}function v(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function m(){if(b.mapurl="",b.mapurlTrue=!1,null!==b.eventLocation&&"object"==typeof b.eventLocation&&b.eventLocation.hasOwnProperty("address_components")&&b.eventLocation.hasOwnProperty("geometry")){var e=b.eventLocation.address_components;b.event.street=b.extractFromAddress(e,"route","long_name")+" "+b.extractFromAddress(e,"street_number","long_name"),b.event.zipcode=b.extractFromAddress(e,"postal_code","long_name"),""===b.event.zipcode&&(b.event.zipcode=null),b.event.location_name=b.eventLocation.name,b.event.full_address=b.eventLocation.formatted_address,b.event.state=b.extractFromAddress(e,"administrative_area_level_1","short_name"),b.event.country=b.extractFromAddress(e,"country","short_name"),b.event.state.length>3&&(b.event.state=b.event.country),b.event.city=b.extractFromAddress(e,"locality","long_name"),b.event.location=b.eventLocation.geometry.location.A+","+b.eventLocation.geometry.location.F,b.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(b.eventLocation.formatted_address)+"/@"+b.event.location+",15z",b.mapurlTrue=!0}else b.event.address=b.eventLocation,b.event.full_address="",b.event.location_name=b.eventLocation,b.event.location="0,0"}function p(){""!==b.mapurl&&a.open(b.mapurl)}function f(){$(".ui.form").trigger("reset"),$(".ui.form .field.error").removeClass("error"),$(".ui.form.error").removeClass("error"),b.starts_on_date=null,b.starts_on_time=null,b.ends_on_date=null,b.ends_on_time=null,b.showError=!1,b.showSuccess=!1,b.errorMessage=[],b.mapurl="",b.mapurlTrue=!1,b.eventLocation="",b.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:""}}function g(e){var t=parseInt(e.substr(0,2));return-1!=e.indexOf("AM")&&12==t&&(e=e.replace("12","0")),-1!=e.indexOf("PM")&&12>t&&(e=e.replace(t,t+12)),e.replace(/(AM|PM)/,"")}function h(e){if(b[e+"_date"]&&b[e+"_time"]){{var t=b[e+"_date"].split("/"),i=[t[2],t[0],t[1]],n=g(b[e+"_time"]).split(":");6e4*(new Date).getTimezoneOffset()}i&&n&&(i[1]-=1,b.event[e]=r(i.concat(n)).utc().format("YYYY-MM-DDTHH:mm:ss"))}}var b=this;b.mapurl="",b.mapurlTrue=!1,b.eventLocation="",b.showMobile=!1,b.endsTimeError=!1,b.startsTimeError=!1,b.placeholder={name:"",starts:"Date",startsTime:"Time",ends:"Date",endsTime:"Time",repeat:"",repeatUntil:"Until date",description:"",location:"",costs:"",invitations:"",attachments:""},b.$geolocation=l,l.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){b.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),b.autocompleteOptions={location:"0,0",radius:5e4},b.starts_on_date="",b.starts_on_time="",b.ends_on_date="",b.ends_on_time="",b.showError=!1,b.showSuccess=!1,b.errorMessage=[],b.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:""},b.saveEvent=u,b.openMap=p,b.resetForm=f,b.extractFromAddress=v,b.parseLocation=m,b.combineDateTime=h,b.closeEventModal=c,b.validateDates=d,s.$on("saveEvent",function(){b.saveEvent()}),e.$watch(angular.bind(this,function(e){return b.eventLocation}),function(e){b.parseLocation()}),e.$watch(angular.bind(this,function(e){return b.starts_on_date}),function(e){b.combineDateTime("starts_on"),b.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return b.starts_on_time}),function(e){b.combineDateTime("starts_on"),b.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return b.ends_on_date}),function(e){b.combineDateTime("starts_on"),b.combineDateTime("ends_on")}),e.$watch(angular.bind(this,function(e){return b.ends_on_time}),function(e){b.combineDateTime("starts_on"),b.combineDateTime("ends_on")})}angular.module("frontend.semantic.modal.event.create",[]).directive("uiEventCreateModal",e),t.$inject=["$scope","USER_ID","EventsFactory","$state","$rootScope","$log","$window","moment","$geolocation"]}(),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"userprofile",bindToController:!0,scope:{id:"@id","class":"@class",header:"@header",body:"@body",person:"=person",type:"@type"},link:e,templateUrl:"components/matchfeedprofile/matchfeedprofile.template.html",restrict:"E"};return i}function t(e,t,i,n,s,o,a,r,l,c,d){function u(){_.totalfriendscount=0,_.totalmatchingcount=0,_.showDimmer=!0,_.showfullprofile=!1,n.hideTopMenu=!0,$("#filtersMenu").sidebar("hide"),_.user=[],_.total=0,_.social={twitter:"",linkedin:"",facebook:""},_.loadUser()}function v(){_.loadingFeed=!0,a.query({format:"json",filter:!0,offset:0,limit:1}).$promise.then(function(e){_.user=[],_.total=0;var t=e.objects;if(t.length>0){_.total=e.meta.total_count,_.user=e.objects[0],null!==_.user.twitter_provider&&(_.social.twitter=_.user.twitter_provider),null!==_.user.linkedin_provider&&(_.social.linkedin=_.user.linkedin_provider),null!==_.user.facebook_id&&(_.social.facebook="https://www.facebook.com/app_scoped_user_id/"+_.user.facebook_id);var i=[],s=_.user.goals[0];for(var o in s){var a={value:o,match:s[o]};i.push(a)}_.user.goals=i;var r=[],l=_.user.offers[0];for(var o in l){var c={value:o,match:l[o]};r.push(c)}_.user.offers=r;var d=[],u=_.user.interests[0];for(var o in u){var v={value:o,match:u[o]};d.push(v)}_.user.interests=d;var m=[],p=_.user.likes[0];for(var o in p){var f={value:o,match:p[o]};m.push(f)}_.user.likes=m,_.totalmatchingcount=_.user.score,_.getMutualFriends(),_.getPhotos()}else _.user=[],_.total=0;_.showDimmer=!1,n.hideTopMenu=!1,_.loadingFeed=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i),_.user=[],_.showDimmer=!1,n.hideTopMenu=!1,_.loadingFeed=!1})}function m(){_.defaultUserPhoto="//graph.facebook.com/"+_.user.facebook_id+"/picture?type=large",l.query({format:"json",user_id:_.user.user_id}).$promise.then(function(e){if(_.user.photos=e.objects,_.user.photos.length>0)_.photosSlider=_.user.photos;else{var t={photo:_.defaultUserPhoto,order:0,user:"/api/v1/auth/user/"+_.user.user_id+"/"};l.save({},t,function(e){c.info(e),c.info("New photo saved."),_.user.photos.push(e),_.photosSlider=_.user.photos},function(e){c.info(e)})}_.photosSlider=i("orderBy")(_.photosSlider,"order",!1)})}function p(){r.query({format:"json",user_id:_.user.id}).$promise.then(function(e){e.objects.length>0&&(_.user.friends=e.objects[0].mutual_bk_friends,_.user.facebookfriends=e.objects[0].mutual_fb_friends,_.user.linkedinconnections=e.objects[0].mutual_linkedin_connections,_.user.twitterfollowers=e.objects[0].mutual_twitter_followers,_.user.twitterfriends=e.objects[0].mutual_twitter_friends,_.totalfriendscount+=e.objects[0].mutual_bk_friends_count,_.totalfriendscount+=e.objects[0].mutual_fb_friends_count,_.totalfriendscount+=e.objects[0].mutual_linkedin_connections_count,_.totalfriendscount+=e.objects[0].mutual_twitter_followers_count,_.totalfriendscount+=e.objects[0].mutual_twitter_friends_count)})}function f(){_.totalfriendscount=0,_.totalmatchingcount=0,_.showfullprofile=!1,n.hideTopMenu=!0,_.loadingFeed=!0,_.loadUser()}function g(){c.info("cancel match");var e={friend1:_.me,friend2:"/api/v1/auth/user/"+_.user.user_id+"/",status:-1};o.save(e,function(e){_.getNextMatch()},function(e){})}function h(){n.hideTopMenu=!1,_.showfullprofile=!1,_.cancelMatch()}function b(){n.hideTopMenu=!1,_.showfullprofile=!1,_.confirmMatch()}function w(){var e={friend1:_.me,friend2:"/api/v1/auth/user/"+_.user.user_id+"/",status:0};o.save(e,function(e){_.getNextMatch()},function(e){})}function y(){_.showfullprofile||(n.hideTopMenu=!0,_.showfullprofile=!0,$("#MatchMenu").sidebar("toggle"))}var _=this;_.social={twitter:"",linkedin:"",facebook:""},t(function(){n.filtersChanged=!1},1e3),_.user=[],_.total=0,_.offset=0,_.previous=null,_.next=null,_.me="/api/v1/auth/user/"+s+"/",_.friendshipStatus=null,_.friendshipId=null,_.showfullprofile=!1,n.$on("cancelMatchEvent",function(){_.cancelMatch()}),n.$on("confirmMatchEvent",function(){_.confirmMatch()}),n.$on("refreshMatchFeed",function(){_.initloadMatches()}),n.$emit("triggerRefreshFilters"),_.nextImage=function(){$("#photoSlider").flexslider("next")},_.photosSlider=[],_.loadingFeed=!1,_.totalfriendscount=0,_.totalmatchingcount=0,_.initloadMatches=u,_.loadUser=v,_.getNextMatch=f,_.cancelMatch=g,_.cancelMatchDesktop=h,_.confirmMatch=w,_.confirmMatchDesktop=b,_.changeTopMenu=y,_.getMutualFriends=p,_.getPhotos=m,_.initloadMatches(),n.$on("showFullProfile",function(){_.showfullprofile=!1})}angular.module("persice").directive("matchfeedProfile",e),t.$inject=["$scope","$timeout","$filter","$rootScope","USER_ID","FriendsFactory","MatchFeedFactory","MutualFriendsFactory","PhotosFactory","$log","lodash"]}(),function(){function e(){function e(e,t,i){}var i={controller:t,controllerAs:"messages",bindToController:!0,scope:{},link:e,template:'<div ng-class="{\'hiddencounter\': messages.hideClass}" class="ui label">{{messages.counter}}</div>',restrict:"E",replace:!0};return i}function t(e,t,i,n){function s(){o.counter=n.getTotalInbox(),o.hideClass=o.counter>0?!1:!0}var o=this;o.counter=0,o.hideClass=!0,o.refreshCounter=s,t.$on("refreshMessagesCounter",function(e,t){o.refreshCounter()}),o.refreshCounter()}angular.module("persice").directive("messagesCounter",e),t.$inject=["$scope","$rootScope","$log","NotificationsRepository"]}(),angular.module("google.places",[]).factory("googlePlacesApi",["$window",function(e){if(!e.google)throw"Global `google` var missing. Did you forget to include the places API script?";return e.google}]).directive("googlePlacesAutocomplete",["$parse","$compile","$timeout","$document","googlePlacesApi",function(e,t,i,n,s){return{restrict:"A",require:"^ngModel",scope:{model:"=ngModel",options:"=?",forceSelection:"=?",attach:"=?",customPlaces:"=?",refreshLocation:"&refreshLocation"},controller:["$scope",function(e){}],link:function(e,i,o,a){function r(){i.bind("keydown",d),i.bind("blur",u),i.bind("submit",u),e.$watch("selected",v)}function l(){{var i,s=angular.element('<div class="gplacesautocomplete" g-places-autocomplete-drawer></div>');angular.element(n[0].body)}s.attr({input:"input",query:"query",predictions:"predictions",active:"active",selected:"selected"}),i=t(s)(e),$("#"+e.attach).append(i),e.$on("$destroy",function(){i.remove()})}function c(){a.$parsers.push(m),a.$formatters.push(p),a.$render=f}function d(t){0!==e.predictions.length&&-1!==_(I,t.which)&&(t.preventDefault(),t.which===x.down?(e.active=(e.active+1)%e.predictions.length,e.$digest()):t.which===x.up?(e.active=(e.active?e.active:e.predictions.length)-1,e.$digest()):13===t.which||9===t.which?(e.forceSelection&&(e.active=-1===e.active?0:e.active),e.$apply(function(){e.selected=e.active,-1===e.selected&&g()})):27===t.which&&(t.stopPropagation(),g(),e.$digest()))}function u(t){if(0!==e.predictions.length)e.forceSelection&&(e.selected=-1===e.selected?0:e.selected),e.$digest(),e.$apply(function(){-1===e.selected&&g()});else if(e.forceSelection){var i=e.$root.$$phase,n=function(){e.model=""};"$apply"===i||"$digest"===i?n():e.$apply(n)}}function v(){var t;t=e.predictions[e.selected],t&&(t.is_custom?(e.model=t.place,e.$emit("g-places-autocomplete:select",t.place)):F.getDetails({placeId:t.place_id},function(t,i){i===s.maps.places.PlacesServiceStatus.OK&&e.$apply(function(){e.model=t,e.$emit("g-places-autocomplete:select",t),e.refreshLocation()})}),g())}function m(t){var i;return t&&w(t)?(e.query=t,i=angular.extend({input:t},e.options),M.getPlacePredictions(i,function(t,i){e.$apply(function(){var n;g(),e.customPlaces&&(n=h(e.query),e.predictions.push.apply(e.predictions,n)),i===s.maps.places.PlacesServiceStatus.OK&&e.predictions.push.apply(e.predictions,t),e.predictions.length>5&&(e.predictions.length=5)})}),t):t}function p(e){var t="";return w(e)?t=e:y(e)&&(t=e.formatted_address),t}function f(){return i.val(a.$viewValue)}function g(){e.active=-1,e.selected=-1,e.predictions=[]}function h(t){var i,n,s,o=[];for(s=0;s<e.customPlaces.length;s++)i=e.customPlaces[s],n=b(t,i),n.matched_substrings.length>0&&o.push({is_custom:!0,custom_prediction_label:i.custom_prediction_label||"(Custom Non-Google Result)",description:i.formatted_address,place:i,matched_substrings:n.matched_substrings,terms:n.terms});return o}function b(e,t){var i,n,s,o=e+"",a=[],r=[];for(n=t.formatted_address.split(","),s=0;s<n.length;s++)i=n[s].trim(),o.length>0&&(i.length>=o.length?(k(i,o)&&r.push({length:o.length,offset:s}),o=""):k(o,i)?(r.push({length:i.length,offset:s}),o=o.replace(i,"").trim()):o=""),a.push({value:i,offset:t.formatted_address.indexOf(i)});return{matched_substrings:r,terms:a}}function w(e){return"[object String]"===Object.prototype.toString.call(e)}function y(e){return"[object Object]"===Object.prototype.toString.call(e)}function _(e,t){var i,n;if(null===e)return-1;for(n=e.length,i=0;n>i;i++)if(e[i]===t)return i;return-1}function k(e,t){return 0===E(e).lastIndexOf(E(t),0)}function E(e){return null===e?"":e.toLowerCase()}var x={tab:9,enter:13,esc:27,up:38,down:40},I=[x.tab,x.enter,x.esc,x.up,x.down],M=new s.maps.places.AutocompleteService,F=new s.maps.places.PlacesService(i[0]);!function(){e.query="",e.predictions=[],e.input=i,e.options=e.options||{},l(),r(),c()}()}}}]).directive("gPlacesAutocompleteDrawer",["$window","$document",function(e,t){var i=['<div class="pac-container" ng-if="isOpen()" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">','  <div class="pac-item" g-places-autocomplete-prediction index="$index" prediction="prediction" query="query"','       ng-repeat="prediction in predictions track by $index" ng-class="{\'pac-item-selected\': isActive($index) }"','       ng-mouseenter="selectActive($index)" ng-click="selectPrediction($index)" role="option" id="{{prediction.id}}">',"  </div>","</div>"];return{restrict:"A",scope:{input:"=",query:"=",predictions:"=",active:"=",selected:"="},template:i.join(""),link:function(i,n){function s(i){var n=i[0],s=n.getBoundingClientRect(),o=t[0].documentElement,a=t[0].body,r=e.pageYOffset||o.scrollTop||a.scrollTop,l=e.pageXOffset||o.scrollLeft||a.scrollLeft;return{width:s.width,height:s.height,top:s.top+s.height+r,left:s.left+l}}n.bind("mousedown",function(e){e.preventDefault()}),i.isOpen=function(){return i.predictions.length>0},i.isActive=function(e){return i.active===e},i.selectActive=function(e){i.active=e},i.selectPrediction=function(e){i.selected=e},i.$watch("predictions",function(){i.position=s(i.input)},!0)}}}]).directive("gPlacesAutocompletePrediction",[function(){var e=['<span class="pac-icon pac-icon-marker"></span>','<span class="pac-item-query" ng-bind-html="prediction | highlightMatched"></span>','<span ng-repeat="term in prediction.terms | unmatchedTermsOnly:prediction">{{term.value | trailingComma:!$last}}&nbsp;</span>','<span class="custom-prediction-label" ng-if="prediction.is_custom">&nbsp;{{prediction.custom_prediction_label}}</span>'];return{restrict:"A",scope:{index:"=",prediction:"=",query:"="},template:e.join("")}}]).filter("highlightMatched",["$sce",function(e){return function(t){var i,n="",s="";return t.matched_substrings.length>0&&t.terms.length>0&&(i=t.matched_substrings[0],n=t.terms[0].value.substr(i.offset,i.length),s=t.terms[0].value.substr(i.offset+i.length)),e.trustAsHtml('<span class="pac-matched">'+n+"</span>"+s)}}]).filter("unmatchedTermsOnly",[function(){return function(e,t){var i,n,s=[];for(i=0;i<e.length;i++)n=e[i],t.matched_substrings.length>0&&n.offset>t.matched_substrings[0].length&&s.push(n);return s}}]).filter("trailingComma",[function(){return function(e,t){return t?e+",":e}}]),function(){function e(e,t,i,n,s){function o(e){n.distance_unit=e,v.filterState.distance_unit=e}function a(){return v.filterState.distance_unit}function r(){function i(e){0===e.objects.length?(v.createFilters(u),v.filterState=u):(v.filterId=e.objects[0].id,v.filterState=e.objects[0],t.info("from service"),t.info(e.objects[0].distance_unit),n.$broadcast("distanceUnitChanged",e.objects[0].distance_unit),n.distance_unit=v.filterState.distance_unit,n.$broadcast("refreshFilters"))}function s(e){var i=(e.data,e.status),s=(e.header,e.config,"Error "+i);t.error(s),v.filterState=u,n.$broadcast("refreshFilters")}return t.info("fetching filters"),e.query({format:"json"}).$promise.then(i,s)}function l(){return v.filterState}function c(i){function s(e){v.filterState=i,n.$broadcast("refreshFilters")}function o(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("saving filters"),null!==v.filterId?e.update({filterId:v.filterId},i,s,o):void 0}function d(i){function n(e){t.info("new filters created"),v.filterId=e.id}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("creating filters"),e.save(i,n,s)}var u={distance:1e4,gender:"m,f",min_age:25,max_age:60,keyword:"",distance_unit:"miles",order_criteria:"match_score",user:"/api/v1/auth/user/"+s+"/"},v={filterState:{distance:1e4,gender:"m,f",min_age:25,max_age:60,order_criteria:"match_score",keyword:"",distance_unit:"miles",user:"/api/v1/auth/user/"+s+"/"},filterId:null,getFilters:r,saveFilters:c,createFilters:d,getFilterState:l,setDistanceUnit:o,getDistanceUnit:a};return v}angular.module("persice").factory("FilterRepository",e),e.$inject=["FiltersFactory","$log","$filter","$rootScope","USER_ID"]}(),angular.module("persice").factory("FiltersFactory",["$resource",function(e){return e("/api/v1/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e){function i(e,t,i,n){}var n={controller:t,controllerAs:"filter",bindToController:!0,scope:{id:"@id","class":"@class"},link:i,templateUrl:"components/filter/matchfeedFilter.directive.html",restrict:"E"};return n}function t(e,t,i,n,s,o,a,r,l,c){function d(){i.$emit("triggerRefreshMatchfeed"),i.$emit("filtersChanged")}function u(){g.currentFilters=a.getFilterState(),g.distanceValue=g.currentFilters.distance,g.distanceUnit=i.distance_unit,g.ageSlider.min=g.currentFilters.min_age,g.ageSlider.max=g.currentFilters.max_age,""!==g.currentFilters.keyword&&void 0!==g.currentFilters.keyword?g.myKeywords=g.currentFilters.keyword.split(","):g.myKeywords.splice(0,g.myKeywords.length),""===g.currentFilters.gender&&(g.male=!1,g.female=!1),"m,f"===g.currentFilters.gender&&(g.male=!0,g.female=!0),"m"===g.currentFilters.gender&&(g.male=!0,g.female=!1),"f"===g.currentFilters.gender&&(g.male=!1,g.female=!0),i.filtersChanged=!0,e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender")}function v(e,t){if(t===!0)g.gendersArr.push(e);else{var i=g.gendersArr.indexOf(e);g.gendersArr.splice(i,1)}g.gendersArr.sort().reverse(),g.genders=g.gendersArr.join(","),g.saveFiltersDebounce()}function m(){g.newFilters={distance:g.distanceValue,gender:g.genders,order_criteria:g.orderBy,min_age:g.ageSlider.min,max_age:g.ageSlider.max,keyword:0===g.myKeywords.length?"":g.myKeywords.join(),user:"/api/v1/auth/user/"+r+"/"},i.filtersChanged=!0,a.saveFilters(g.newFilters),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender")}function p(e){g.myKeywords.splice(e,1),g.saveFilters()}function f(e){if(g.filtermessage="",""===e||void 0===e)g.filtermessage="Keyword must have at least 3 letters",g.showFilterMessage=!0;else if(g.myKeywords.length<5){g.existing=!1;for(var t=g.myKeywords.length-1;t>=0;t--)g.myKeywords[t]===e&&(g.existing=!0);g.existing===!1?(g.myKeywords.push(e),g.saveFilters(),g.newKeyword="",g.showFilterMessage=!1):(g.filtermessage="Keyword already exists",g.showFilterMessage=!0)}else g.filtermessage="You cannot add more than 5 keywords",g.showFilterMessage=!0}var g=this;i.filtersChanged=!1,t(function(){i.filtersChanged=!1,g.changed=!1},2e3),i.$watch("filtersChanged",function(e,t){g.changed=e}),g.toggleGender=v,g.saveFilters=m,g.saveFiltersDebounce=l.debounce(m,500),g.getFilters=u,g.removeKeyword=p,g.addKeyword=f,g.refreshMatchFeed=d,g.orderByValues=[{name:"Match score",value:"match_score"},{name:"Distance",value:"distance"},{name:"Mutual friends",value:"mutual_friends"}],g.orderBy="match_score",g.distanceValue=1e4,g.distanceUnit="miles",g.male=!1,g.female=!1,g.checkedmale=!1,g.checkedfemale=!1,g.genders="",g.filtermessage="",g.currentFilters=null,g.showFilterMessage=!1,g.ageValues=[25,60],g.ageSlider={min:25,max:60,ceil:115,floor:18},e.$watch(angular.bind(this,function(e){return g.distanceValue}),function(e){g.saveFiltersDebounce()}),e.$watch(angular.bind(this,function(e){return g.ageSlider.min}),function(e){g.saveFiltersDebounce()}),e.$watch(angular.bind(this,function(e){return g.ageSlider.max}),function(e){g.saveFiltersDebounce()}),g.myKeywords=[],g.gendersArr=[],g.getFilters(),i.$on("refreshFilters",function(){g.getFilters()}),i.$on("filtersChanged",function(){i.filtersChanged=!1}),i.$on("distanceUnitChanged",function(e,t){g.distanceUnit=t})}angular.module("persice").directive("matchfeedFilter",e),e.$inject=["$rootScope"],t.$inject=["$scope","$timeout","$rootScope","$window","SettingsRepository","FiltersFactory","FilterRepository","USER_ID","lodash","$log"]}(),function(){function e(e,t,i,n,s){function o(){function i(e){0===e.objects.length?(d.createFilters(c),d.filterState=c):(d.filterId=e.objects[0].id,d.filterState=e.objects[0],n.$broadcast("refreshEventsFilters"))}function s(e){var i=(e.data,e.status),s=(e.header,e.config,"Error "+i);t.error(s),d.filterState=c,n.$broadcast("refreshEventsFilters")}return t.info("fetching events filters"),e.query({format:"json"}).$promise.then(i,s)}function a(){return d.filterState}function r(i){function s(e){d.filterState=i,n.$broadcast("refreshEventsFilters")}function o(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("saving filters"),null!==d.filterId?e.update({filterId:d.filterId},i,s,o):void 0}function l(i){function n(e){t.info("new events filters created"),d.filterId=e.id}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("creating filters"),e.save(i,n,s)}var c={distance:1e4,keyword:"",user:"/api/v1/auth/user/"+s+"/"},d={filterState:{distance:1e4,keyword:"",user:"/api/v1/auth/user/"+s+"/"},filterId:null,getFilters:o,saveFilters:r,createFilters:l,getFilterState:a};return d}angular.module("persice").factory("EventsFilterRepository",e),e.$inject=["EventsFiltersFactory","$log","$filter","$rootScope","USER_ID"]}(),angular.module("persice").factory("EventsFiltersFactory",["$resource",function(e){return e("/api/v1/events/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e){function i(e,t,i,n){}var n={controller:t,controllerAs:"filter",bindToController:!0,scope:{id:"@id","class":"@class"},link:i,templateUrl:"components/filterEvents/filterEvents.template.html",restrict:"E"};return n}function t(e,t,i,n,s,o,a,r,l,c){function d(){i.$emit("refreshEventFeed"),i.$emit("eventsFiltersChanged")}function u(){f.currentFilters=a.getFilterState(),f.distanceValue=f.currentFilters.distance,f.distanceUnit=i.distance_unit,""!==f.currentFilters.keyword&&void 0!==f.currentFilters.keyword?f.myKeywords=f.currentFilters.keyword.split(","):f.myKeywords.splice(0,f.myKeywords.length),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender"),i.eventsFiltersChanged=!0}function v(){f.newFilters={distance:f.distanceValue,keyword:0===f.myKeywords.length?"":f.myKeywords.join(),user:"/api/v1/auth/user/"+r+"/"},i.eventsFiltersChanged=!0,a.saveFilters(f.newFilters),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender")}function m(e){f.myKeywords.splice(e,1),f.saveFilters()}function p(e){if(f.filtermessage="",""===e||void 0===e)f.filtermessage="Keyword must have at least 3 letters",f.showFilterMessage=!0;else if(f.myKeywords.length<5){f.existing=!1;for(var t=f.myKeywords.length-1;t>=0;t--)f.myKeywords[t]===e&&(f.existing=!0);f.existing===!1?(f.myKeywords.push(e),f.saveFilters(),f.newKeyword="",f.showFilterMessage=!1):(f.filtermessage="Keyword already exists",f.showFilterMessage=!0)}else f.filtermessage="You cannot add more than 5 keywords",f.showFilterMessage=!0}var f=this;i.eventsFiltersChanged=!1,t(function(){i.eventsFiltersChanged=!1,f.changed=!1},2e3),i.$watch("eventsFiltersChanged",function(e,t){f.changed=e}),f.saveFilters=v,f.saveFiltersDebounce=l.debounce(v,500),f.getFilters=u,f.removeKeyword=m,f.addKeyword=p,f.refreshEventsFeed=d,f.distanceValue=1e4,f.distanceUnit="miles",f.filtermessage="",f.currentFilters=null,f.showFilterMessage=!1,f.myKeywords=[],f.getFilters(),i.$on("refreshEventsFilters",function(){f.getFilters()}),e.$watch(angular.bind(this,function(e){return f.distanceValue}),function(e){f.saveFiltersDebounce()}),i.$on("eventsFiltersChanged",function(){i.eventsFiltersChanged=!1}),i.$on("distanceUnitChanged",function(e,t){f.distanceUnit=t})}angular.module("persice").directive("eventsFilter",e),e.$inject=["$rootScope"],t.$inject=["$scope","$timeout","$rootScope","$window","SettingsRepository","EventsFiltersFactory","EventsFilterRepository","USER_ID","lodash","$log"]}(),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"eventsfeed",bindToController:!0,scope:{id:"@id","class":"@class",header:"@header",body:"@body",type:"@type"},link:e,templateUrl:"components/eventsfeed/eventsfeed.directive.html",restrict:"E"};return i}function t(e,t,i,n,s,o,a,r,l,c,d,u,v,m,p){function f(){b.nextOffset=10,b.next=null,b.loading=!0,b.noEvents=!1,"events.mynetwork"===b.type&&(b.EventsFeed=a("/api/v1/feed/events/friends/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),"events.allevents"===b.type&&(b.EventsFeed=a("/api/v1/feed/events/all/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"
}})),"events.myevents"===b.type&&(b.EventsFeed=a("/api/v1/feed/events/my/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),b.EventsFeed.query({format:"json",limit:10,offset:0,filter:!0}).$promise.then(function(e){var t=e.objects;b.events=[],u("orderBy")(t,"starts_on",!0),b.next=e.meta.next,0===e.objects.length&&(b.noEvents=!0);for(var i in t){var n=u("amDateFormat")(t[i].starts_on,"dddd, MMMM Do YYYY"),s=m().format("dddd, MMMM Do YYYY");r.info(s),n===s&&(n="Today");var o=u("amDateFormat")(t[i].starts_on,"L"),a=u("getIndexByProperty")("date",n,b.events);null===a&&(b.events.push({date:n,realDate:o,items:[]}),a=b.events.length-1),b.events[a].items.push({id:t[i].id,name:t[i].name,street:t[i].street,city:t[i].city,state:t[i].state,zipcode:t[i].zipcode,description:t[i].description,location:t[i].location,starts_on:t[i].starts_on,ends_on:t[i].ends_on,full_address:t[i].full_address,location_name:t[i].location_name,country:t[i].country,repeat:t[i].repeat,friend_attendees_count:t[i].friend_attendees_count,cumulative_match_score:t[i].cumulative_match_score,distance:t[i].distance}),b.events[a].items=u("orderBy")(b.events[a].items,"starts_on",!0)}b.events=u("orderBy")(b.events,"starts_on",!0),b.loading=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);r.error(i),b.noEvents=!0,b.loading=!1})}function g(){var e=c.defer();return null===b.next?(e.reject(),e.promise):(b.loadingMore?e.reject():(b.loadingMore=!0,b.EventsFeed.query({format:"json",limit:10,offset:b.nextOffset}).$promise.then(function(t){var i=t.objects;b.nextOffset+=10,u("orderBy")(i,"starts_on",!0),b.next=t.meta.next;for(var n in i){var s=u("amDateFormat")(i[n].starts_on,"dddd, MMMM Do YYYY"),o=m().format("dddd, MMMM Do YYYY");r.info(o),s===o&&(s="Today");var a=u("amDateFormat")(i[n].starts_on,"L"),l=u("getIndexByProperty")("date",s,b.events);null===l&&(b.events.push({date:s,realDate:a,items:[]}),l=b.events.length-1),b.events[l].items.push({id:i[n].id,name:i[n].name,street:i[n].street,city:i[n].city,state:i[n].state,zipcode:i[n].zipcode,description:i[n].description,location:i[n].location,full_address:i[n].full_address,location_name:i[n].location_name,country:i[n].country,starts_on:i[n].starts_on,ends_on:i[n].ends_on,repeat:i[n].repeat,friend_attendees_count:i[n].friend_attendees_count,cumulative_match_score:i[n].cumulative_match_score,distance:i[n].distance}),b.events[l].items=u("orderBy")(b.events[l].items,"starts_on",!0)}b.events=u("orderBy")(b.events,"starts_on",!0),b.loadingMore=!1,e.resolve()},function(t){e.reject();var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);r.error(n),b.loadingMore=!1,e.reject()})),e.promise)}function h(e){var t=angular.element(p);t.width()>767?i.$broadcast("openViewEventModal",e):v.go("event.details",{eventId:e})}var b=this;b.noEvents=!1,b.pok=!1,b.noResults=!1,b.noEvents=!1,b.loading=!1,b.loadingMore=!1,b.nextOffset=10,b.next=null,b.getEvents=f,b.loadMoreEvents=g,b.gotoEvent=h,b.events=[],b.getEvents(),i.$on("refreshEventFeed",function(e,t){$(".right.sidebar.eventsfeedfilter").sidebar("hide"),r.info(v.current.name),b.type===v.current.name&&b.getEvents()})}angular.module("persice").directive("eventsFeed",e),t.$inject=["$scope","USER_ID","$rootScope","FeedEventsFriendsFactory","FeedEventsAllFactory","FeedEventsMyFactory","$resource","$log","$timeout","$q","$http","$filter","$state","moment","$window"]}(),angular.module("frontend.semantic.dropdown",[]).controller("DropDownController",["$scope",function(e){e.items=[],this.add_item=function(t){return e.items.push(t),e.items},this.remove_item=function(t){var i=e.items.indexOf(t);-1!==i&&e.items.splice(i,1)},this.update_title=function(t){for(var i in e.items)e.items[i].title=t}}]).directive("dropdown",function(){return{restrict:"E",replace:!0,transclude:!0,controller:"DropDownController",scope:{title:"@",open:"@",model:"=ngModel"},template:'<div class="{{ dropdown_class }}"><div class="default text">{{ title }}</div><i class="dropdown icon"></i><div class="{{ menu_class }}"  ng-transclude></div></div>',link:function(e,t,i,n){e.dropdown_class="ui selection dropdown",e.menu_class="menu transition hidden",e.original_title=e.title,"true"===e.open?(e.is_open=!0,e.dropdown_class=e.dropdown_class+" active visible",e.menu_class=e.menu_class+" visible"):e.is_open=!1,n.add_item(e),e.$watch("title",function(t,i){void 0!==t&&t!==i&&t!==e.original_title&&(e.model=t)}),e.$watch("model",function(t){e.model=t,n.update_title(t||e.original_title)}),t.bind("click",function(){e.is_open===!1?e.$apply(function(){e.dropdown_class="ui selection dropdown active visible",e.menu_class="menu transition visible"}):(e.title!==e.original_title&&(e.model=e.title),e.$apply(function(){e.dropdown_class="ui selection dropdown",e.menu_class="menu transition hidden"})),e.is_open=!e.is_open})}}}).directive("dropdownGroup",function(){return{restrict:"AE",replace:!0,transclude:!0,require:"^dropdown",scope:{title:"=title"},template:'<div class="item" ng-transclude >{{ item_title }}</div>',link:function(e,t,i,n){e.item_title=void 0===e.title?t.children()[0].innerHTML:e.title,t.bind("click",function(){n.update_title(e.item_title)})}}}),angular.module("frontend.semantic.dimmer",[]).directive("pageDimmer",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{show:"=?",model:"=ngModel"},template:'<div class="{{dimmer_class}}" ng-click="click_on_dimmer()"><div class="content"><div class="center" ng-transclude></div></div></div>',link:function(e,t,i,n){1==e.show?e.dimmer_class="ui page inverted active dimmer":(e.show=!1,e.dimmer_class="ui page inverted disable dimmer"),e.click_on_dimmer=function(){e.model=!0,e.show=!0,e.dimmer_class="ui page inverted active dimmer"},e.$watch("model",function(t){return 0==t||void 0==t?(e.show=!1,void(e.dimmer_class="ui page inverted disable dimmer")):void(e.dimmer_class="ui page inverted active dimmer")})}}}),function(){function e(){function e(e,t,i){}var i={controller:t,controllerAs:"connections",bindToController:!0,scope:{},link:e,template:'<div ng-class="{\'hiddencounter\': connections.hideClass}" class="ui label">{{connections.counter}}</div>',restrict:"E",replace:!0};return i}function t(e,t,i){function n(){s.counter=0,s.counter=i.getTotalConnections(),s.hideClass=s.counter>0?!1:!0}var s=this;s.counter=0,s.hideClass=!0,s.refreshCounter=n,t.$on("refreshConnectionsCounter",function(e,t){s.refreshCounter()}),s.refreshCounter()}angular.module("persice").directive("connectionsCounter",e),t.$inject=["$scope","$rootScope","NotificationsRepository"]}(),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(window,function(e){e.module("frontend.ui.autocomplete",[]).directive("autocompleteUi",["$q","$parse","$http","$sce","$timeout","$templateCache",function(e,t,i,n,s,o){var a=40,r=39,l=38,c=37,d=27,u=13,v=9,m=3,p=524288,f=500,g=200,h="autocomplete-required",b="Searching...",w="No results found",y="/autocomplete-alt/index.html";return o.put(y,'<div class="autocomplete-holder ui left icon input" ng-class="{\'autocomplete-dropdown-visible\': showDropdown, \'loading\': searching}">  <input id="{{id}}_value" name={{inputName}} ng-class="{\'autocomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"/> <i class="icon circular search" ng-show="!searching"></i>   <div id="{{id}}_dropdown" class="autocomplete-dropdown" ng-show="showDropdown">    <div class="autocomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>    <div class="autocomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'autocomplete-selected-row\': $index == currentIndex}">      <div ng-if="imageField" class="autocomplete-image-holder">        <img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="autocomplete-image"/>        <div ng-if="!result.image && result.image != \'\'" class="autocomplete-image-default"></div>      </div>      <div class="autocomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>      <div class="autocomplete-title" ng-if="!matchClass">{{ result.title }}</div>      <div ng-if="matchClass && result.description && result.description != \'\'" class="autocomplete-description" ng-bind-html="result.description"></div>      <div ng-if="!matchClass && result.description && result.description != \'\'" class="autocomplete-description">{{result.description}}</div>    </div>  </div></div>'),{restrict:"EA",require:"^?form",scope:{selectedObject:"=",disableInput:"=",initialValue:"=",localData:"=",remoteUrlRequestFormatter:"=",remoteUrlRequestWithCredentials:"@",remoteUrlResponseFormatter:"=",remoteUrlErrorCallback:"=",remoteApiHandler:"=",id:"@",type:"@",placeholder:"@",remoteUrl:"@",remoteUrlDataField:"@",titleField:"@",descriptionField:"@",imageField:"@",inputClass:"@",pause:"@",searchFields:"@",minlength:"@",matchClass:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"@",fieldRequiredClass:"@",inputChanged:"=",autoMatch:"@",focusOut:"&",focusIn:"&",inputName:"@"},templateUrl:function(e,t){return t.templateUrl||y},link:function(t,o,y,_){function k(e){ce=null,t.hideResults(e),document.body.removeEventListener("click",k)}function E(e){return e.which?e.which:e.keyCode}function $(e){"function"==typeof t.selectedObject?t.selectedObject(e):t.selectedObject=e,T(e?!0:!1)}function x(e){return function(i){return t[e]?t[e](i):i}}function I(e){$({originalObject:e}),t.clearSelected&&(t.searchStr=null),z()}function M(e){return t.titleField.split(",").map(function(t){return F(e,t)}).join(" ")}function F(e,t){var i,n;if(t){i=t.split("."),n=e;for(var s=0;s<i.length;s++)n=n[i[s]]}else n=e;return n}function S(e,i){var s,o,a;return a=new RegExp(i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),e?(o=e.match(a),s=o?e.replace(a,'<span class="'+t.matchClass+'">'+o[0]+"</span>"):e,n.trustAsHtml(s)):void 0}function T(e){t.notEmpty=e,oe=t.searchStr,t.fieldRequired&&_&&_.$setValidity(se,e)}function C(e){var i=E(e);if(i!==c&&i!==r)if(i===l||i===u)e.preventDefault();else if(i===a)e.preventDefault(),!t.showDropdown&&t.searchStr&&t.searchStr.length>=ie&&(G(),t.searching=!0,W(t.searchStr));else if(i===d)z(),t.$apply(function(){te.val(t.searchStr)});else{if(0===ie&&!t.searchStr)return;t.searchStr&&""!==t.searchStr?t.searchStr.length>=ie&&(G(),ne&&s.cancel(ne),t.searching=!0,ne=s(function(){W(t.searchStr)},t.pause)):t.showDropdown=!1,oe&&oe!==t.searchStr&&!t.clearSelected&&t.$apply(function(){$()})}}function P(e){!t.overrideSuggestions||t.selectedObject&&t.selectedObject.originalObject===t.searchStr||(e&&e.preventDefault(),I(t.searchStr))}function A(e){var t=getComputedStyle(e);return e.offsetHeight+parseInt(t.marginTop,10)+parseInt(t.marginBottom,10)}function D(){return re.getBoundingClientRect().top+parseInt(getComputedStyle(re).maxHeight,10)}function j(){return o[0].querySelectorAll(".autocomplete-row")[t.currentIndex]}function L(){return j().getBoundingClientRect().top-(re.getBoundingClientRect().top+parseInt(getComputedStyle(re).paddingTop,10))}function N(e){re.scrollTop=re.scrollTop+e}function O(){var e=t.results[t.currentIndex];te.val(t.matchClass?M(e.originalObject):e.title)}function U(e){var i=E(e),n=null,s=null;i===u&&t.results?(t.currentIndex>=0&&t.currentIndex<t.results.length?(e.preventDefault(),t.selectResult(t.results[t.currentIndex])):(P(e),z()),t.$apply()):i===a&&t.results?(e.preventDefault(),t.currentIndex+1<t.results.length&&t.showDropdown&&(t.$apply(function(){t.currentIndex++,O()}),le&&(n=j(),D()<n.getBoundingClientRect().bottom&&N(A(n))))):i===l&&t.results?(e.preventDefault(),t.currentIndex>=1?(t.$apply(function(){t.currentIndex--,O()}),le&&(s=L(),0>s&&N(s-1))):0===t.currentIndex&&t.$apply(function(){t.currentIndex=-1,te.val(t.searchStr)})):i===v&&(t.results&&t.results.length>0&&t.showDropdown?-1===t.currentIndex&&t.overrideSuggestions?P():(-1===t.currentIndex&&(t.currentIndex=0),t.selectResult(t.results[t.currentIndex]),t.$digest()):t.searchStr&&t.searchStr.length>0&&P())}function q(e){return function(i,n,s,o){n||s||o||(i=i.data),t.searching=!1,J(F(Z(i),t.remoteUrlDataField),e)}}function R(e,i,n,s){i||n||s||(i=e.status),0!==i&&(t.remoteUrlErrorCallback?t.remoteUrlErrorCallback(e,i,n,s):console&&console.error&&console.error("http error"))}function Y(){ae&&ae.resolve()}function H(n){var s={},o=t.remoteUrl+encodeURIComponent(n);t.remoteUrlRequestFormatter&&(s={params:t.remoteUrlRequestFormatter(n)},o=t.remoteUrl),t.remoteUrlRequestWithCredentials&&(s.withCredentials=!0),Y(),ae=e.defer(),s.timeout=ae.promise,i.get(o,s).success(q(n)).error(R)}function B(i){Y(),ae=e.defer(),t.remoteApiHandler(i,ae.promise).then(q(i))["catch"](R)}function z(){t.showDropdown=!1,t.results=[],re&&(re.scrollTop=0)}function G(){t.showDropdown=!0,t.currentIndex=-1,t.results=[]}function K(e){var i,n,s,o,a=t.searchFields.split(","),r=[];for(i=0;i<t.localData.length;i++){for(n=!1,s=0;s<a.length;s++)o=F(t.localData[i],a[s])||"",n=n||o.toLowerCase().indexOf(e.toLowerCase())>=0;n&&(r[r.length]=t.localData[i])}t.searching=!1,J(r,e)}function V(e,i,n){if(n)for(var s in i)if(i[s].toLowerCase()===n.toLowerCase())return void t.selectResult(e)}function W(e){!e||e.length<ie||(t.localData?t.$apply(function(){K(e)}):t.remoteApiHandler?B(e):H(e))}function J(e,i){var n,s,o,a,r,l;if(e&&e.length>0)for(t.results=[],n=0;n<e.length;n++)t.titleField&&""!==t.titleField&&(a=r=M(e[n])),s="",t.descriptionField&&(s=l=F(e[n],t.descriptionField)),o="",t.imageField&&(o=F(e[n],t.imageField)),t.matchClass&&(r=S(a,i),l=S(s,i)),t.results[t.results.length]={title:r,description:l,image:o,originalObject:e[n]},t.autoMatch&&V(t.results[t.results.length-1],{title:a,desc:s||""},t.searchStr);else t.results=[]}function Q(){t.localData?J(t.localData,""):t.remoteApiHandler?B(""):H("")}var X,Z,ee,te=o.find("input"),ie=m,ne=null,se=h,oe=null,ae=null,re=o[0].querySelector(".autocomplete-dropdown"),le=!1,ce=null;o.on("mousedown",function(e){e.target.id?(ce=e.target.id,ce===t.id+"_dropdown"&&document.body.addEventListener("click",k)):ce=e.target.className}),t.currentIndex=null,t.searching=!1,ee=t.$watch("initialValue",function(e,i){e&&(ee(),"object"==typeof e?(t.searchStr=M(e),$({originalObject:e})):"string"==typeof e&&e.length>0?t.searchStr=e:console&&console.error&&console.error("Tried to set initial value of autocomplete to",e,"which is an invalid value"),T(!0))}),t.$on("autocomplete-alt:clearInput",function(e,i){i&&i!==t.id||(t.searchStr=null,$(),T(!1),z())}),t.onFocusHandler=function(){t.focusIn&&t.focusIn(),0!==ie||t.searchStr&&0!==t.searchStr.length||(t.showDropdown=!0,Q())},t.hideResults=function(e){ce&&(ce===t.id+"_dropdown"||ce.indexOf("autocomplete")>=0)?ce=null:(X=s(function(){z(),t.$apply(function(){t.searchStr&&t.searchStr.length>0&&te.val(t.searchStr)})},g),Y(),t.focusOut&&t.focusOut(),t.overrideSuggestions&&t.searchStr&&t.searchStr.length>0&&-1===t.currentIndex&&P())},t.resetHideResults=function(){X&&s.cancel(X)},t.hoverRow=function(e){t.currentIndex=e},t.selectResult=function(e){t.matchClass&&(e.title=M(e.originalObject),e.description=F(e.originalObject,t.descriptionField)),t.searchStr=t.clearSelected?null:e.title,$(e),z()},t.inputChangeHandler=function(e){return e.length<ie?z():0===e.length&&0===ie&&(t.searching=!1,Q()),t.inputChanged&&(e=t.inputChanged(e)),e},t.fieldRequiredClass&&""!==t.fieldRequiredClass&&(se=t.fieldRequiredClass),t.minlength&&""!==t.minlength&&(ie=parseInt(t.minlength,10)),t.pause||(t.pause=f),t.clearSelected||(t.clearSelected=!1),t.overrideSuggestions||(t.overrideSuggestions=!1),t.fieldRequired&&_&&T(t.initialValue?!0:!1),t.inputType=y.type?y.type:"text",t.textSearching=y.textSearching?y.textSearching:b,t.textNoResults=y.textNoResults?y.textNoResults:w,t.maxlength=y.maxlength?y.maxlength:p,te.on("keydown",U),te.on("keyup",C),Z=x("remoteUrlResponseFormatter"),t.$on("$destroy",function(){T(!0)}),s(function(){var e=getComputedStyle(re);le=e.maxHeight&&"auto"===e.overflowY})}}}])}),function(e){e.module("frontend.ui.tooltips",[]).directive("tooltips",["$window","$compile","$timeout",function(t,i,n){var s=8,o=9,a=10,r="_720kb-tooltip-";return{restrict:"A",scope:{},link:function(l,c,d){var u,v,m,p,f,g,h,b,w=!1,y=e.element(c[0]),_=e.element(t.document.getElementsByTagName("body")[0]),k=d.tooltipTimeout||0,E=d.tooltipTitle||d.title||"",$=d.tooltipContent||"",x=d.tooltipShowTrigger||"mouseover",I=d.tooltipHideTrigger||"mouseleave",M=d.tooltipSide||"top",F=M,S=d.tooltipSize||"medium",T="undefined"!=typeof d.tooltipTry&&null!==d.tooltipTry?l.$eval(d.tooltipTry):!0,C=d.tooltipClass||"",P=(d.tooltipSpeed||"medium").toLowerCase(),A="undefined"!=typeof d.tooltipLazy&&null!==d.tooltipLazy?l.$eval(d.tooltipLazy):!0,D='<div class="_720kb-tooltip '+r+S+'"><div class="'+r+'title"> '+E+"</div>"+$+' <span class="'+r+'caret"></span></div>';l.parseSpeed=function(){switch(P){case"fast":P=100;break;case"medium":P=450;break;case"slow":P=800;break;default:P=Number(P)}},u=i(D)(l),u.addClass(C),_.append(u),l.isTooltipEmpty=function(){return E||$?void 0:!0},l.initTooltip=function(e){l.isTooltipEmpty()||(f=y[0].offsetHeight,g=y[0].offsetWidth,h=l.getRootOffsetTop(y[0],0),b=l.getRootOffsetLeft(y[0],0),v=u[0].offsetHeight,m=u[0].offsetWidth,l.parseSpeed(),l.tooltipPositioning(e))},l.getRootOffsetTop=function(e,t){return null===e.offsetParent?t+e.offsetTop:l.getRootOffsetTop(e.offsetParent,t+e.offsetTop)},l.getRootOffsetLeft=function(e,t){return null===e.offsetParent?t+e.offsetLeft:l.getRootOffsetLeft(e.offsetParent,t+e.offsetLeft)},y.bind(x,function(){A&&w||(w=!0,l.initTooltip(F)),T&&l.tooltipTryPosition(),l.showTooltip()}),y.bind(I,function(){l.hideTooltip()}),l.showTooltip=function(){u.addClass(r+"open"),u.css("transition","opacity "+P+"ms linear"),k>0&&n(function(){l.hideTooltip()},k)},l.hideTooltip=function(){u.css("transition","opacity "+P),u.removeClass(r+"open")},l.removePosition=function(){u.removeClass(r+"left").removeClass(r+"right").removeClass(r+"top").removeClass(r+"bottom ")},l.tooltipPositioning=function(e){l.removePosition();var t,i;"small"===S?p=s:"medium"===S?p=o:"large"===S&&(p=a),"left"===e&&(t=h+f/2-v/2,i=b-(m+p),u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"left")),"right"===e&&(t=h+f/2-v/2,i=b+g+p,u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"right")),"top"===e&&(t=h-p-v,i=b+g/2-m/2,u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"top")),"bottom"===e&&(t=h+f+p,i=b+g/2-m/2,u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"bottom"))},l.tooltipTryPosition=function(){var e=u[0].offsetHeight,i=u[0].offsetWidth,n=u[0].offsetTop,s=u[0].offsetLeft,o=t.outerWidth,a=t.outerHeight,r=o-(i+s),c=a-(e+n),d=y[0].offsetHeight,v=y[0].offsetWidth,m=y[0].offsetLeft,p=y[0].offsetTop,f=o-(m+v),g=a-(d+p),h={left:s,top:n,bottom:c,right:r},b={left:m,right:f,top:p,bottom:g},w=Object.keys(b).reduce(function(e,t){return b[e]>b[t]?e:t}),_=Object.keys(h).reduce(function(e,t){return h[e]<h[t]?e:t});h[_]<5&&(F=w,l.initTooltip(w))},e.element(t).bind("resize",function(){l.hideTooltip(),l.initTooltip(M)})}}}])}(angular),function(){function e(e,t,i,n,s,o,a,r,l){function c(e){v.distanceUnit=e}function d(){l({method:"POST",url:"/accounts/deactivate/",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),r.location.href="/accounts/logout",r.location.assign()}function u(){function e(e){i.setDistanceUnit(v.distanceUnit),v.loadingSave=!1,v.userSettingsChanged=!1}function s(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);o.error(i),v.loadingSave=!1,v.userSettingsChanged=!0}v.loadingSave=!0,t.update({filterId:v.filterId},{distance_unit:v.distanceUnit,user:"/api/v1/auth/user/"+n+"/"},e,s)}var v=this;v.userSettingsChanged=!1,a(function(){v.filterId=i.filterId,v.userSettingsChanged=!1},1e3),v.setUnit=c,v.saveSettings=u,v.deleteUser=d,v.loadingSave=!1;var m=!1;v.distanceUnit=e.distance_unit,e.$on("distanceUnitChanged",function(e,t){v.distanceUnit=t,o.info("from controller"),o.info(t),v.userSettingsChanged=!1}),s.$watch(angular.bind(v,function(e){return v.distanceUnit}),function(e,t){o.info("from watch"),o.info(e),m===!1?m=!0:v.userSettingsChanged=!0})}angular.module("persice").controller("SettingsController",e),e.$inject=["$rootScope","FiltersFactory","FilterRepository","USER_ID","$scope","$log","$timeout","$window","$http"]}(),angular.module("persice").controller("OfferCreateCtrl",["$scope","$http","$rootScope","APP_ID","$state","$log","OffersFactory","SubjectsFactory","USER_ID","$filter",function(e,t,i,n,s,o,a,r,l,c){e.subject="",e.resourceUri=null,e.messageShow=!1,e.message="",e.userUri="/api/v1/auth/user/"+l+"/",e.inputChanged=function(t){e.subject=t},e.selectResult=function(t){void 0!==t?(e.subject=t.originalObject.description,e.resourceUri=t.originalObject.resource_uri):e.resourceUri=null},e.saveOffer=function(){var r={offer_subject:e.subject,user:e.userUri};a.save({},r,function(e){var a="https://graph.facebook.com/v2.3/"+n+"/activities?access_token="+i.fbAuth.accessToken,r=Math.round(+new Date/1e3),l={event:"CUSTOM_APP_EVENTS",application_tracking_enabled:1,advertiser_tracking_enabled:0,custom_events:[{_eventName:"Onboarding flow user created offer",_appVersion:"0.0.1",_logTime:r,fb_content_type:"Onboarding flow"}]};t.post(a,l).success(function(e,t,i,n){o.info("FB activity post success")}).error(function(e,t,i,n){o.error("FB activity post failure")}),s.go("finalstep")},function(t){e.resourceUri=null,e.messageShow=!0,e.message=t.data.offer?t.data.offer.error[0]:"There was an error when trying to save your offer."})},e.createOffer=function(){return e.messageShow=!1,e.message="",""===e.subject?(e.message="Entering your offer is required to continue.",e.messageShow=!0,!1):e.subject.length>300?(e.message="Offer cannot have more than 300 characters.",e.messageShow=!0,!1):void e.saveOffer()}}]),function(){function e(e,t,i,n){var s=this;s.user={id:t,photo:i}}angular.module("persice").controller("MyProfileController",e),e.$inject=["$scope","USER_ID","USER_PHOTO","$log"]}(),function(){function e(e,t,i,n,s,o,a,r,l,c,d,u){function v(){g.q="",g.getFriends()}function m(){g.nextOffset=10,g.next=null,g.loading=!0,s.query({format:"json",first_name:g.q,limit:10,offset:0}).$promise.then(function(e){if(g.friends=e.objects,g.next=e.meta.next,0===g.friends.length)g.pok?g.noResults=!0:(g.noConnections=!0,g.pok=!0);else{g.pok=!0,g.noResults=!1,g.noConnections=!1;for(var t in g.friends)g.friends[t].totalFriends=0,g.friends[t].totalFriends+=g.friends[t].mutual_bk_friends_count,g.friends[t].totalFriends+=g.friends[t].mutual_fb_friends_count,g.friends[t].totalFriends+=g.friends[t].mutual_linkedin_connections_count,g.friends[t].totalFriends+=g.friends[t].mutual_twitter_friends_count,g.friends[t].totalFriends+=g.friends[t].mutual_twitter_followers_count}g.loading=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);o.error(i),g.noConnections=!0,g.loading=!1})}function p(){var e=r.defer();return null===g.next?(e.reject(),e.promise):(g.loadingMore?e.reject():(g.loadingMore=!0,s.query({format:"json",limit:10,first_name:g.q,offset:g.nextOffset}).$promise.then(function(t){var i=t.objects;g.next=t.meta.next,g.nextOffset+=10;for(var n in i)i[n].totalFriends=0,i[n].totalFriends+=i[n].mutual_bk_friends_count,i[n].totalFriends+=i[n].mutual_fb_friends_count,i[n].totalFriends+=i[n].mutual_linkedin_connections_count,i[n].totalFriends+=i[n].mutual_twitter_friends_count,i[n].totalFriends+=i[n].mutual_twitter_followers_count,g.friends.push(i[n]);g.loadingMore=!1,e.resolve()},function(t){e.reject();var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);o.error(n),g.loadingMore=!1})),e.promise)}function f(e){null===g.friends[e].updated_at?l.get("/api/v1/new_connections/updated_at/?format=json&friend_id="+g.friends[e].friend_id).success(function(t,i,n,s){u.refreshTotalConnections(),d.go("friendprofile",{userId:g.friends[e].friend_id})}).error(function(t,i,n,s){d.go("friendprofile",{userId:g.friends[e].friend_id})}):d.go("friendprofile",{userId:g.friends[e].friend_id})}var g=this;g.friends=[],g.q="",g.noConnections=!1,g.pok=!1,g.noResults=!1,g.loading=!1,g.loadingMore=!1,g.nextOffset=10,g.next=null,g.getFriends=m,g.loadMoreFriends=p,g.gotoConnection=f,g.reset=v,g.getFriends()}angular.module("persice").controller("MyConnectionsController",e),e.$inject=["$scope","FriendsFactory","USER_ID","$resource","ConnectionsFactory","$log","$timeout","$q","$http","$filter","$state","NotificationsRepository"]}(),angular.module("persice").factory("MatchFeedFactory",["$resource",function(e){return e("/api/v1/matchfeed/:matchId/:param",{matchId:"@matchId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e,t,i){}angular.module("persice").controller("MatchFeedController",e),e.$inject=["$scope","$log","$timeout"]}(),angular.module("persice").controller("MainCtrl",["$scope",function(e){e.greetingMessage="Welcome to"}]),function(){function e(e,t,i,n,s,o,a,r,l,c,d,u,v,m,p,f){function g(){if(_.counter>0){var e="https://graph.facebook.com/v2.3/"+n+"/activities?access_token="+t.fbAuth.accessToken,s=Math.round(+new Date/1e3),r={event:"CUSTOM_APP_EVENTS",application_tracking_enabled:1,advertiser_tracking_enabled:0,custom_events:[{_eventName:"Onboarding flow user created interests",_appVersion:"0.0.1",_logTime:s,fb_content_type:"Onboarding flow"}]};i.post(e,r).success(function(e,t,i,n){o.info("FB activity post success")}).error(function(e,t,i,n){o.error("FB activity post failure")}),u.go("goalcreate")}else a({messageTemplate:'<div class="notify-info-header">Warning</div><p>To continue please select at least one interest.</p>',scope:p,classes:"notify-info",icon:"warning circle",duration:4e3})}function h(){_.searchQuery="",_.getAllInterests(),_.noResults=!1}function b(){_.userInterests=[],k.width()>400&&(_.limit=400),_.nextOffset=100,_.next=null,_.noResults=!1,_.loadingInterests=!0,_.allInterests.splice(0,_.allInterests.length),e.query({user_id:r,format:"json",limit:200,offset:0}).$promise.then(function(e){_.counter=e.meta.total_count,e.objects.length>0&&(_.userInterests=e.objects),s.query({format:"json",limit:_.limit,description__icontains:_.searchQuery,offset:0}).$promise.then(function(e){_.next=e.meta.next;var t=e.objects;if(t.length>0)for(var i=t.length-1;i>=0;i--){t[i].active=!1,t[i].interest_resource=null;for(var n=_.userInterests.length-1;n>=0;n--)t[i].resource_uri===_.userInterests[n].interest&&(t[i].interest_resource=_.userInterests[n].resource_uri,t[i].active=!0);_.allInterests.push(t[i])}else _.allInterests.splice(0,_.allInterests.length),_.noResults=!0;_.loadingInterests=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);o.error(i),_.loadingInterests=!1})},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);o.error(i),_.loadingInterests=!1})}function w(){var t=v.defer();return _.loadingMore?t.reject():null!==_.next?(_.loadingMore=!0,c(function(){e.query({user_id:r,format:"json",limit:200,offset:0}).$promise.then(function(e){_.counter=e.meta.total_count,e.objects.length>0&&(_.userInterests=e.objects),s.query({format:"json",description__icontains:_.searchQuery,offset:_.nextOffset,limit:30}).$promise.then(function(e){var i=e.objects;_.next=e.meta.next,_.nextOffset+=30,e.objects.length>0&&(i=e.objects);for(var n=i.length-1;n>=0;n--){i[n].active=!1,i[n].interest_resource=null;for(var s=_.userInterests.length-1;s>=0;s--)i[n].resource_uri===_.userInterests[s].interest&&(i[n].interest_resource=_.userInterests[s].resource_id,i[n].active=!0);_.allInterests.push(i[n])}_.loadingMore=!1,t.resolve()},function(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);o.error(n),_.loadingMore=!1,t.reject()})},function(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);o.error(n),t.reject()})},400)):t.reject(),t.promise}function y(t){var i=_.allInterests[t];if(i)if(i.active){var n=d(i.interest_resource);i.loading=!0,n["delete"]().$promise.then(function(e){i.active=!1,i.interest_resource=null,_.counter--,i.loading=!1},function(e){var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);o.error(n),i.loading=!1,i.error=!0})}else if(_.counter>=10)a({messageTemplate:'<div class="notify-info-header">Warning</div><p>Please select up to 10 interests.</p>',scope:p,classes:"notify-info",icon:"warning circle"});else{var s={interest_subject:i.description,user:_.userUri};i.loading=!0,e.save({},s,function(e){i.loading=!1,i.error=!1,i.interest_resource=e.resource_uri,i.active=!0,_.counter++},function(e){i.errorMessage=e.data.interest.error[0],a({messageTemplate:'<div class="notify-info-header">Error</div><p>'+i.errorMessage+"</p>",scope:p,classes:"notify-info",icon:"warning circle"}),i.loading=!1,i.error=!0})}}var _=this;_.useInterest=y,_.getAllInterests=b,_.nextStep=g,_.searchQuery="",_.userUri="/api/v1/auth/user/"+r+"/",_.next=null,_.nextOffset=100,_.loadingMore=!1,_.noResults=!1,_.reset=h,_.loadMoreInterests=w,_.allInterests=[],_.counter=0,_.loadingInterests=!1,_.userInterests=[];var k=angular.element(f);_.limit=100,_.getAllInterests()}angular.module("persice").controller("InterestsController",e),e.$inject=["InterestsFactory","$rootScope","$http","APP_ID","InterestSubjectFactory","$log","notify","USER_ID","$filter","$timeout","$resource","$state","$q","lodash","$scope","$window"]}(),function(){function e(e,t,i,n,s,o){function a(){function t(e){v.inboxMessages.splice(0,v.inboxMessages.length),v.next=e.meta.next,v.total=e.meta.total,v.nextOffset=10;var t=e.objects,i=0;for(var s in t)null===t[s].read_at&&null!==t[s].last_message_body&&i++,v.inboxMessages.push({firstName:t[s].first_name,friendId:t[s].friend_id,facebookId:t[s].facebook_id,sentAt:n("amDateFormat")(t[s].sent_at,"h:mm a"),readAt:t[s].read_at,id:t[s].id,body:t[s].last_message_body});v.unreadMessagesCounter=i}function s(e){v.inboxMessages.splice(0,v.inboxMessages.length);var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);i.error(n)}return i.info("fetching inbox"),e.query({format:"json",limit:v.limit,offset:0}).$promise.then(t,s)}function r(){return v.unreadMessagesCounter}function l(){return v.inboxMessages}function c(e){v.next=e.meta.next,v.nextOffset+=v.pageSize;var t=e.objects,i=0;for(var s in t)null===t[s].read_at&&null!==t[s].last_message_body&&i++,v.inboxMessages.push({firstName:t[s].first_name,friendId:t[s].friend_id,facebookId:t[s].facebook_id,sentAt:n("amDateFormat")(t[s].sent_at,"h:mm a"),readAt:t[s].read_at,id:t[s].id,body:t[s].last_message_body});v.unreadMessagesCounter+=i,v.loadingMore=!1,deferred.resolve()}function d(e){var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);i.error(n),v.loadingMore=!1,deferred.reject()}function u(){console.log("loading more messages in inbox");var t=o.defer();return null===v.next?(t.reject(),t.promise):(v.loadingMore?t.reject():(v.loadingMore=!0,e.query({format:"json",limit:10,offset:v.nextOffset}).$promise.then(c,d)),t.promise)}var v={getInboxMessages:a,getUnreadMessagesCounter:r,getAllMessages:l,loadMore:u,unreadMessagesCounter:0,inboxMessages:[],limit:10,offset:0,nextOffset:10,next:null,total:0,pageSize:10,loadingMore:!1};return v}angular.module("persice").factory("InboxRepository",e),e.$inject=["InboxFactory","NotificationsRepository","$log","$filter","$rootScope","$q"]}(),function(){function e(e,t,i,n,s){function o(){function e(e){l.loadingMessages=!1,l.loadInbox()}function t(e){l.loadingMessages=!1}l.loadingMessages=!0,n.getInboxMessages().then(e,t)}function a(){l.allMessages=n.getAllMessages()}function r(){function e(e){l.loadingMore=!1}function t(e){
l.loadingMore=!1}l.loadingMore=!0,n.loadMore().then(e,t)}var l=this;l.allMessages=[],l.loadInbox=a,l.loadMore=r,l.refresh=o,l.loadingMessages=!1,l.loadingMore=!1,l.q="",l.refresh()}angular.module("persice").controller("InboxController",e),e.$inject=["$scope","$rootScope","$log","InboxRepository","$q"]}(),angular.module("persice").controller("GoalCreateCtrl",["$scope","$http","$rootScope","APP_ID","$state","$log","GoalsFactory","SubjectsFactory","USER_ID",function(e,t,i,n,s,o,a,r,l){e.subject="",e.resourceUri=null,e.messageShow=!1,e.message="",e.userUri="/api/v1/auth/user/"+l+"/",e.inputChanged=function(t){e.subject=t},e.selectResult=function(t){void 0!==t?(e.subject=t.originalObject.description,e.resourceUri=t.originalObject.resource_uri):e.resourceUri=null},e.saveGoal=function(){var r={goal_subject:e.subject,user:e.userUri};a.save({},r,function(e){var a="https://graph.facebook.com/v2.3/"+n+"/activities?access_token="+i.fbAuth.accessToken,r=Math.round(+new Date/1e3),l={event:"CUSTOM_APP_EVENTS",application_tracking_enabled:1,advertiser_tracking_enabled:0,custom_events:[{_eventName:"Onboarding flow user created goal",_appVersion:"0.0.1",_logTime:r,fb_content_type:"Onboarding flow"}]};t.post(a,l).success(function(e,t,i,n){o.info("FB activity post success")}).error(function(e,t,i,n){o.error("FB activity post failure")}),s.go("offercreate")},function(t){e.resourceUri=null,e.messageShow=!0,e.message=t.data.goal?t.data.goal.error[0]:"There was an error when trying to save your goal."})},e.createGoal=function(){return e.messageShow=!1,e.message="",""===e.subject?(e.message="Entering your goal is required to continue.",e.messageShow=!0,!1):e.subject.length>300?(e.message="Goal cannot have more than 300 characters.",e.messageShow=!0,!1):void e.saveGoal()}}]),function(){function e(e,t,i,n,s,o,a){function r(){a.update({friendId:l.friendshipId},{status:-1},function(e){InboxRepository.getInboxMessages(),o.go("myconnections")},function(e){})}var l=this;s.info(n),l.userInfo={id:t,first_name:n.first_name,photo:"//graph.facebook.com/"+n.facebook_id+"/picture?type=large"},l.middleActive=!0,l.friendshipId=i.objects[0].id,l.unFriend=r}angular.module("persice").controller("FriendProfileController",e),e.$inject=["$scope","userId","Connection","UserProfile","$log","$state","FriendsFactory"]}(),function(){function e(e,t,i,n){function s(e){var t=400,i=300,n=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,r=o/2-t/2+n,l=a/2-i/2+s,c="height="+i+",width="+t+",left="+r+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",d="/social/associate/"+e+"/?next=/goals/close_login_popup",u=window.open(d,"Connecting...",c);window.focus&&u.focus()}function o(){a.loading=!0,i.get({format:"json"},{userId:t}).$promise.then(function(e){null!==e.linkedin_provider&&(a.linkedin=e.linkedin_provider),null!==e.twitter_provider&&(a.twitter=e.twitter_username),a.firstName=e.first_name,a.loading=!1})}var a=this;a.loading=!1,a.link=s,a.refreshUser=o,a.twitter="",a.linkedin="",a.firstName=n.first_name,null!==n.linkedin_provider&&(a.linkedin=n.linkedin_provider),null!==n.twitter_provider&&(a.twitter=n.twitter_username)}e.$inject=["$log","USER_ID","UsersFactory","User"],angular.module("persice").controller("FinalStepController",e)}(),function(){function e(e,t,i,n,s,o,a,r,l,c){function d(){n.go("event.attendees",{eventId:s})}function u(){n.go("event.edit",{eventId:s})}function v(e){var i={event:"/api/v1/event/"+f.event.id+"/",rsvp:e,user:"/api/v1/auth/user/"+t+"/"};f.eventRsvp.status!==e&&(f.memberExists?(f.eventRsvp.status=e,c.update({memberId:f.memberId},i,function(i){for(var n=f.event.members.length-1;n>=0;n--)f.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(f.event.members[n].rsvp=e)},function(e){})):(f.eventRsvp.status=e,c.save({},i,function(e){f.memberExists=!0,f.event.members.push(e),f.memberId=e.id},function(e){})))}function m(){f.loadingEvent=!0,i.query({format:"json"},{eventId:s}).$promise.then(function(i){if(f.eventNotFound=!1,f.event=i,f.eventLocation="",f.mapurlTrue=!1,f.mapurl="","0,0"!==f.event.location?(f.eventLocation=""!==f.event.full_address&&null!==f.event.full_address?f.event.full_address:f.event.street+" "+f.event.city+" "+f.event.zipcode+" "+f.event.state,f.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(f.eventLocation)+"/@"+f.event.location+",15z",f.mapurlTrue=!0):(f.mapurlTrue=!1,f.mapurl="",f.eventLocation=f.event.location_name),f.starts_on_date=moment.utc(f.event.starts_on,moment.ISO_8601).local().format("dddd, MMMM D, YYYY"),f.ends_on_date=moment.utc(f.event.ends_on,moment.ISO_8601).local().format("dddd, MMMM D, YYYY"),f.starts_on_time=moment.utc(f.event.starts_on,moment.ISO_8601).local().format("h:mm A"),f.ends_on_time=moment.utc(f.event.ends_on,moment.ISO_8601).local().format("h:mm A ")+moment.tz(l.timezone).format("z"),f.ends_on_date!==f.starts_on_date?(f.firstrow=f.starts_on_date+" "+f.starts_on_time,f.secondrow=f.ends_on_date+" "+f.ends_on_time):(f.firstrow=f.starts_on_date,f.secondrow=f.starts_on_time+" to "+f.ends_on_time),f.isHost=!1,e.eventpage.isHost.option=!1,e.eventpage.eventId=f.event.id,f.eventRsvp={status:""},f.memberExists=!1,f.memberId=null,f.event.members.length>0)for(var n=f.event.members.length-1;n>=0;n--)f.event.members[n].is_organizer===!0?f.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(f.isHost=!0,e.eventpage.isHost.option=!0):f.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(f.memberId=f.event.members[n].id,null!==f.event.members[n].rsvp&&(f.eventRsvp.status=f.event.members[n].rsvp),f.memberExists=!0);f.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;f.loadingEvent=!1,f.eventNotFound=!0})}function p(){""!==f.mapurl&&r.open(f.mapurl)}var f=this;f.showMobile=!0,f.mapurl="",f.mapurlTrue=!1,f.event={},f.eventNotFound=!1,f.editEvent=u,f.eventLocation="",e.eventpage.header="Event Details",f.placeholder={name:"Event Name",starts:"Starts",ends:"Ends",repeat:"Repeat",location:"Location",description:"Description",costs:"Costs",invitations:"Invitations",attachments:"Attachments"},f.eventRsvp={status:""},f.changeRsvpStatus=v,f.openMap=p,f.getEvent=m,f.openAttendees=d,e.$on("goBackEvents",function(){n.go(void 0!==o.previousEventFeed?o.previousEventFeed:"events.myevents")}),f.isHost=null,f.getEvent()}angular.module("persice").controller("EventViewController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","eventId","$rootScope","$log","$window","angularMomentConfig","MembersFactory"]}(),function(){function e(e,t,i,n,s){function o(){c.showModal=!0}function a(){c.showModal=!1}function r(){c.showViewModal=!0}function l(){c.showViewModal=!1}var c=this;$(".ui.dimmer.modals").remove(),c.viewEvent=null,c.showModal=!1,c.showViewModal=!1,c.showEventModal=o,c.closeEventModal=a,c.showEventViewModal=r,c.closeEventViewModal=l,t.$on("closeModalCreateEvent",function(e,i){c.closeEventModal(),n.is("events.myevents")?t.$broadcast("refreshEventFeed"):n.go("events.myevents")}),t.$on("openViewEventModal",function(e,t){c.viewEvent=t,c.showEventViewModal()})}angular.module("persice").controller("EventsPageController",e),e.$inject=["$scope","$rootScope","$log","$state","$timeout"]}(),function(){function e(e,t,i,n){function s(){"event.edit"===n.current.name&&e.$broadcast("saveChangedEvent"),"event.create"===n.current.name&&e.$broadcast("saveEvent"),"event.details"===n.current.name&&n.go("event.edit",{eventId:a.eventId}),"event.invitations"===n.current.name&&e.$broadcast("sendInvites")}function o(){e.$broadcast("goBackEvents")}var a=this;a.eventId=null,a.isHost={option:!1},a.header="Event Details",$(".ui.dimmer.modals").remove(),a.makeactionEvent=s,a.gotoPreviousState=o}angular.module("persice").controller("EventPageController",e),e.$inject=["$scope","$rootScope","$log","$state"]}(),function(){function e(e,t,i,n,s,o,a,r,l,c,d,u,v){function m(e){w.connections[e].is_invited||(w.connections[e].selected=!w.connections[e].selected,w.connections[e].selected?w.counterNewInvites++:w.counterNewInvites--)}function p(e){var t=u("getIndexByProperty")("friend_id",w.invitedPeople[e].friend_id,w.connections);n["delete"]({memberId:w.connections[t].member_id},function(i){w.connections[t].is_invited=!1,w.connections[t].selected=!1,w.invitedPeople.splice(e,1),w.counterNewInvites>0&&w.counterNewInvites--},function(e){d.info(e)})}function f(){if(w.counterNewInvites>0){if(w.loadingInvitesSave)return;w.loadingInvitesSave=!0;for(var t=[],i=w.connections.length-1;i>=0;i--)if(w.connections[i].selected&&!w.connections[i].is_invited){var o={event:"/api/v1/event/"+l+"/",is_invited:!1,user:"/api/v1/auth/user/"+w.connections[i].friend_id+"/"};t.push(n.save({},o))}s.all(t).then(function(e){angular.forEach(e,function(e){d.info(e);var t=u("getIndexByProperty")("user",e.user,w.connections);w.connections[t].member_id=e.id,w.connections[t].is_invited=!0,w.connections[t].rsvp="",w.invitedPeople.push(w.connections[t])})}).then(function(t){d.info("Sending invites finished."),w.counterNewInvites=0,w.loadingInvitesSave=!1,v({messageTemplate:'<div class="notify-info-header">Success</div><p>All event invitations have been successfully sent.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),e.$emit("invitesSent")})}else v({messageTemplate:'<div class="notify-error-header">Warning</div><p>Please select connections to invite.</p>',classes:"notify-error",icon:"remove circle",duration:4e3})}function g(){w.connections=[],w.friends=[],w.invitedPeople=[],w.counterNewInvites=0,w.nextOffset=10,w.next=null,w.loadingConnections=!0,o.query({format:"json",first_name:w.connectionFirstName,limit:10,offset:0}).$promise.then(h,b)}function h(e){w.friends=e.objects,w.next=e.meta.next;for(var t=w.friends.length-1;t>=0;t--){for(var i=null===w.friends[t].mutual_friends_count?0:w.friends[t].mutual_friends_count,n=null===w.friends[t].common_goals_offers_interests?0:w.friends[t].common_goals_offers_interests,s={first_name:w.friends[t].first_name,age:w.friends[t].age,common_goals_offers_interests:n,mutual_friends_count:i,tagline:w.friends[t].tagline,facebook_id:w.friends[t].facebook_id,friend_id:w.friends[t].friend_id,user:"/api/v1/auth/user/"+w.friends[t].friend_id+"/",is_invited:!1,member_id:null,rsvp:"",selected:!1,event:parseInt(l),image:"//graph.facebook.com/"+w.friends[t].facebook_id+"/picture?type=square"},o=w.friends[t].events.length-1;o>=0;o--)w.friends[t].events[o].event===s.event&&(s.is_invited=!0,s.rsvp=w.friends[t].events[o].rsvp,s.selected=!0,s.member_id=w.friends[t].events[o].id,w.invitedPeople.push(s));w.connections.push(s)}w.loadingConnections=!1}function b(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i),w.loadingConnetions=!1}var w=this;w.loadingInvitesSave=!1,w.counterNewInvites=0,w.markSelected=m,w.removeInvite=p,w.sendInvites=f,w.getConnections=g,w.nextOffset=10,w.loadingConnections=!1,w.connectionFirstName="",w.invitationsOptions={attendingPref:"private",guestInvite:!0},e.eventpage.header="Invitations",e.$on("goBackEvents",function(){a.go("event.edit",{eventId:l})}),w.friends=[],w.connections=[],w.invitedPeople=[],w.getConnections(),e.$on("sendInvites",function(){d.info("sendInvites Event"),w.sendInvites()})}e.$inject=["$scope","USER_ID","EventsFactory","MembersFactory","$q","EventsConnections","$state","$timeout","eventId","$rootScope","$log","$filter","notify"],angular.module("persice").controller("EventInvitationsController",e)}(),function(){function e(e,t,i,n,s,o,a,r,l,c,d,u){function v(){n.go("event.invitations",{eventId:k.eventEdit.id})}function m(){k.showError=!1,i["delete"]({eventId:k.eventEdit.id},function(e){k.showError=!1,d({messageTemplate:'<div class="notify-info-header">Success</div><p>Event has been successfully deleted.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),n.go(void 0!==o.previousEventFeed?o.previousEventFeed:"events.myevents")},function(e){k.errorMessage=[],k.showError=!0,e.data.event&&(k.errorMessage=["Event could not be deleted."])})}function p(){k.pok=0,k.loadingEvent=!0,i.query({format:"json"},{eventId:s}).$promise.then(function(i){if(k.eventEdit=i,k.eventLocation="",k.mapurlTrue=!1,k.mapurl="","0,0"!==k.eventEdit.location?(k.eventLocation=""!==k.eventEdit.full_address&&null!==k.eventEdit.full_address?k.eventEdit.full_address:k.eventEdit.street+" "+k.eventEdit.city+" "+k.eventEdit.zipcode+" "+k.eventEdit.state,k.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(k.eventLocation)+"/@"+k.eventEdit.location+",15z",k.mapurlTrue=!0):(k.mapurlTrue=!1,k.mapurl="",k.eventLocation=k.eventEdit.location_name),k.eventEdit.starts_on=l.utc(k.eventEdit.starts_on,l.ISO_8601).local().toDate(),k.eventEdit.ends_on=l.utc(k.eventEdit.ends_on,l.ISO_8601).local().toDate(),k.isHost=!1,e.eventpage.isHost.option=!1,k.eventEdit.members.length>0)for(var n=k.eventEdit.members.length-1;n>=0;n--)k.eventEdit.members[n].is_organizer===!0&&k.eventEdit.members[n].user==="/api/v1/auth/user/"+t+"/"&&(k.isHost=!0,e.eventpage.isHost.option=!0);k.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;k.loadingEvent=!1})}function f(){return""===k.eventEdit.ends_on||null===k.eventEdit.ends_on?void(k.eventEdit.ends_on=l(k.eventEdit.starts_on).add(1,"hour").toDate()):void(l(k.eventEdit.ends_on)>=l(k.eventEdit.starts_on)&&(k.eventEdit.ends_on=l(k.eventEdit.starts_on).add(1,"hour").toDate()))}function g(){return""===k.eventEdit.starts_on||null===k.eventEdit.starts_on?void(k.eventEdit.starts_on=l(k.eventEdit.ends_on).subtract(1,"hour").toDate()):void 0}function h(){return k.startsTimeError=!1,k.endsTimeError=!1,l(k.eventEdit.starts_on).unix()<l().unix()?(k.showError=!0,k.errorMessage=["Please select a Starts Date that is not set in past."],void(k.startsTimeError=!0)):(k.showError=!1,k.errorMessage=[],k.startsTimeError=!1,l(k.eventEdit.ends_on).unix()<l().unix()?(k.showError=!0,k.errorMessage=["Please select an Ends Date that is not set in past."],void(k.endsTimeError=!0)):l(k.eventEdit.ends_on).unix()>l().unix()&&l(k.eventEdit.starts_on).unix()>l().unix()&&l(k.eventEdit.starts_on).unix()>l(k.eventEdit.ends_on).unix()?(k.showError=!0,k.errorMessage=["Ends Date must be greater or equal to Starts Date."],k.endsTimeError=!0,void(k.startsTimeError=!0)):(k.showError=!1,k.errorMessage=[],k.startsTimeError=!1,k.endsTimeError=!1,void 0))}function b(){k.showError=!1,k.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]}}}),$(".ui.form").form("validate form"),""===k.eventEdit.description||""===k.eventEdit.ends_on||null===k.eventEdit.ends_on||null===k.eventEdit.starts_on||""===k.eventEdit.location||""===k.eventEdit.name||""===k.eventEdit.starts_on||""===k.eventEdit.repeat?(k.showError=!0,(""===k.eventEdit.starts_on||null===k.eventEdit.starts_on)&&(k.startsTimeError=!0),(""===k.eventEdit.ends_on||null===k.eventEdit.ends_on)&&(k.endsTimeError=!0),k.errorMessage=["Please enter all required fields."]):(k.showError=!1,k.validateDates(),k.showSuccess=!1,k.showError||i.update({eventId:k.eventEdit.id},k.eventEdit,function(e){k.showError=!1,d({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),n.go("event.details",{eventId:k.eventEdit.id})},function(e){k.errorMessage=[],k.showError=!0,e.data.event&&(k.errorMessage=e.data.event.error)}))}function w(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function y(){if(null!==k.eventLocation&&"object"==typeof k.eventLocation&&k.eventLocation.hasOwnProperty("address_components")&&k.eventLocation.hasOwnProperty("geometry")){var e=k.eventLocation.address_components;k.eventEdit.street=k.extractFromAddress(e,"route","long_name")+" "+k.extractFromAddress(e,"street_number","long_name"),k.eventEdit.zipcode=k.extractFromAddress(e,"postal_code","long_name"),""===k.eventEdit.zipcode&&(k.eventEdit.zipcode=null),k.eventEdit.location_name=k.eventLocation.name,k.eventEdit.full_address=k.eventLocation.formatted_address,k.eventEdit.state=k.extractFromAddress(e,"administrative_area_level_1","short_name"),k.eventEdit.country=k.extractFromAddress(e,"country","short_name"),k.eventEdit.city=k.extractFromAddress(e,"locality","long_name"),k.eventEdit.state.length>3&&(k.eventEdit.state=k.eventEdit.country),k.eventEdit.location=k.eventLocation.geometry.location.A+","+k.eventLocation.geometry.location.F,k.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(k.eventLocation.formatted_address)+"/@"+k.eventEdit.location+",15z",k.mapurlTrue=!0}else{if(!(k.pok>2))return void k.pok++;k.eventEdit.full_address="",k.eventEdit.location_name=k.eventLocation,k.eventEdit.location="0,0",k.eventEdit.address=k.eventLocation}}function _(){""!==k.mapurl&&r.open(k.mapurl)}var k=this;k.showError=!1,k.showMobile=!0,k.showSuccess=!1,k.errorMessage=[],k.mapurl="",k.mapurlTrue=!1,k.endsTimeError=!1,k.startsTimeError=!1,k.eventEdit={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:""},k.eventLocation="",e.eventpage.header="Event Details",k.placeholder={name:"Event Name",starts:"Starts",ends:"Ends",repeat:"Repeat",location:"Location",description:"Description",costs:"Costs",invitations:"Invitations",attachments:"Attachments"},k.$geolocation=u,u.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){k.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),k.autocompleteOptions={location:"0,0",radius:5e4},k.saveEvent=b,k.deleteEvent=m,k.openMap=_,k.extractFromAddress=w,k.parseLocation=y,k.validateDates=h,k.getEvent=p,k.openInvitations=v,k.getEvent(),e.$on("saveChangedEvent",function(){k.saveEvent()}),e.$on("goBackEvents",function(){n.go("event.details",{eventId:k.eventEdit.id})}),k.checkDatesStarts=f,k.checkDatesEnds=g,e.$watch(angular.bind(this,function(e){return k.eventLocation}),function(e){k.parseLocation()}),k.pok=0}angular.module("persice").controller("EventEditController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","eventId","$rootScope","$log","$window","moment","angularMomentConfig","notify","$geolocation"]}(),function(){function e(e,t,i,n,s,o,a,r,l){function c(){return""===h.event.ends_on||null===h.event.ends_on?void(h.event.ends_on=r(h.event.starts_on).add(1,"hour").toDate()):void(r(h.event.ends_on)>=r(h.event.starts_on)&&(h.event.ends_on=r(h.event.starts_on).add(1,"hour").toDate()))}function d(){return""===h.event.starts_on||null===h.event.starts_on?void(h.event.starts_on=r(h.event.ends_on).subtract(1,"hour").toDate()):void 0}function u(){return h.startsTimeError=!1,h.endsTimeError=!1,r(h.event.starts_on).unix()<r().unix()?(h.showError=!0,h.errorMessage=["Please select a Starts Date that is not set in past."],void(h.startsTimeError=!0)):(h.showError=!1,h.errorMessage=[],h.startsTimeError=!1,r(h.event.ends_on).unix()<r().unix()?(h.showError=!0,h.errorMessage=["Please select an Ends Date that is not set in past."],void(h.endsTimeError=!0)):r(h.event.ends_on).unix()>r().unix()&&r(h.event.starts_on).unix()>r().unix()&&r(h.event.starts_on).unix()>r(h.event.ends_on).unix()?(h.showError=!0,h.errorMessage=["Ends Date must be greater or equal to Starts Date."],h.endsTimeError=!0,void(h.startsTimeError=!0)):(h.showError=!1,h.errorMessage=[],h.startsTimeError=!1,h.endsTimeError=!1,void 0))}function v(){h.showError=!1,h.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]},starts_on_date:{identifier:"starts_on_date",rules:[{type:"empty",prompt:"Please enter Starts Date"}]},starts_on_time:{identifier:"starts_on_time",rules:[{type:"empty",prompt:"Please enter Starts Time"}]},ends_on_date:{identifier:"ends_on_date",rules:[{type:"empty",prompt:"Please enter Ends Date"}]},ends_on_time:{identifier:"ends_on_time",rules:[{type:"empty",prompt:"Please enter Ends Time"}]}}}),$(".ui.form").form("validate form"),""===h.event.description||""===h.event.ends_on||null===h.event.ends_on||null===h.event.starts_on||""===h.event.location||""===h.event.name||""===h.event.starts_on||""===h.event.repeat?(h.showError=!0,(""===h.event.starts_on||null===h.event.starts_on)&&(h.startsTimeError=!0),(""===h.event.ends_on||null===h.event.ends_on)&&(h.endsTimeError=!0),h.errorMessage=["Please enter all required fields."]):(h.showError=!1,h.validateDates(),h.showSuccess=!1,h.showError||i.save({},h.event,function(e){h.showError=!1,n.go("events.myevents")},function(e){h.errorMessage=[],h.showError=!0,e.data.event&&(h.errorMessage=e.data.event.error)}))}function m(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function p(){if(h.mapurl="",h.mapurlTrue=!1,null!==h.eventLocation&&"object"==typeof h.eventLocation&&h.eventLocation.hasOwnProperty("address_components")&&h.eventLocation.hasOwnProperty("geometry")){var e=h.eventLocation.address_components;h.event.street=h.extractFromAddress(e,"route","long_name")+" "+h.extractFromAddress(e,"street_number","long_name"),h.event.zipcode=h.extractFromAddress(e,"postal_code","long_name"),""===h.event.zipcode&&(h.event.zipcode=null),h.event.location_name=h.eventLocation.name,h.event.full_address=h.eventLocation.formatted_address,h.event.state=h.extractFromAddress(e,"administrative_area_level_1","short_name"),h.event.country=h.extractFromAddress(e,"country","short_name"),h.event.city=h.extractFromAddress(e,"locality","long_name"),h.event.state.length>3&&(h.event.state=h.event.country),h.event.location=h.eventLocation.geometry.location.A+","+h.eventLocation.geometry.location.F,h.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(h.eventLocation.formatted_address)+"/@"+h.event.location+",15z",h.mapurlTrue=!0}else h.event.address=h.eventLocation,h.event.full_address="",h.event.location_name=h.eventLocation,h.event.location="0,0"}function f(){""!==h.mapurl&&a.open(h.mapurl)}function g(){h.showError=!1,h.showSuccess=!1,h.errorMessage=[],h.mapurl="",h.mapurlTrue=!1,h.eventLocation="",h.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:""}}var h=this;h.showError=!1,h.showMobile=!0,h.showSuccess=!1,h.errorMessage=[],h.mapurl="",h.mapurlTrue=!1,h.endsTimeError=!1,h.startsTimeError=!1,h.$geolocation=l,l.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){h.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),h.autocompleteOptions={location:"0,0",radius:5e4},h.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:""},h.eventLocation="",h.placeholder={name:"Event Name",starts:"Starts",ends:"Ends",repeat:"Repeat",location:"Location",description:"Description",costs:"Costs",invitations:"Invitations",attachments:"Attachments"},h.saveEvent=v,h.openMap=f,h.resetForm=g,h.extractFromAddress=m,h.parseLocation=p,h.validateDates=u,e.$on("saveEvent",function(){h.saveEvent()}),e.$on("goBackEvents",function(){n.go(void 0!==s.previousEventFeed?s.previousEventFeed:"events.myevents")}),h.checkDatesStarts=c,h.checkDatesEnds=d,e.$watch(angular.bind(this,function(e){return h.eventLocation}),function(e){h.parseLocation()})}angular.module("persice").controller("EventCreateController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","$rootScope","$log","$window","moment","$geolocation"]}(),function(){function e(e,t,i,n,s,o,a,r,l,c){var d=this;d.connectionsYes=[{id:1,rsvp:"",first_name:"Lena",age:35,invited:!1,selected:!1,mutual_friends:10,match_score:4,tagline:"Creative designer & hiker"},{id:3,rsvp:"",first_name:"Charlie",age:39,invited:!1,selected:!1,mutual_friends:10,match_score:4,tagline:"Hacker, Guitaris, and veteran Burner"}],d.connectionsNo=[{id:2,rsvp:"YES",first_name:"Brian",age:31,invited:!0,selected:!0,mutual_friends:10,match_score:4,tagline:"Engineer kiteboarding chess geek"}],d.connectionsMaybe=[{id:4,rsvp:"",first_name:"Daniel",age:25,invited:!1,selected:!1,mutual_friends:10,match_score:4,tagline:"Grad student from London"}],e.eventpage.header="Attendees",e.$on("goBackEvents",function(){n.go("event.details",{eventId:s})})}angular.module("persice").controller("EventAttendeesController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","eventId","$rootScope","$log","$window","angularMomentConfig","MembersFactory"]}(),angular.module("persice").controller("EditMyProfileCtrl",["$scope","$timeout","USER_ID","$q","$state","UsersFactory","GoalsFactory","LikesFactory","SubjectsFactory","OffersFactory","InterestsFactory","PhotosFactory","$log","$filter","$cookies","$http","FB_TOKEN","$location","$anchorScroll","$window","$resource","notify",function(e,t,i,n,s,o,a,r,l,c,d,u,v,m,p,f,g,h,b,w,y,_){e.social={twitter:"",linkedin:""},e.userUri="/api/v1/auth/user/"+i+"/",e.user={id:i,firstName:"",lastName:"",age:"",about_me:"",photos:[{id:0,order:0,photo:"",cropped_photo:""},{id:0,order:1,photo:"",cropped_photo:""},{id:0,order:2,photo:"",cropped_photo:""},{id:0,order:3,photo:"",cropped_photo:""},{id:0,order:4,photo:"",cropped_photo:""},{id:0,order:5,photo:"",cropped_photo:""}],goals:[],offers:[],likes:[],interests:[],mutual:{friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[]}},e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1,e.loadingInterests=!1,e.getUser=function(){e.loadingUser=!0,e.loadingGoals=!0,e.loadingOffers=!0,e.loadingLikes=!0,e.loadingInterests=!0,a.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.goals=t.objects),e.loadingGoals=!1}),c.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.offers=t.objects),e.loadingOffers=!1}),r.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.likes=t.objects),e.loadingLikes=!1}),d.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.interests=t.objects),e.loadingInterests=!1}),o.get({format:"json"},{userId:i}).$promise.then(function(t){e.user.firstName=t.first_name,e.user.lastName=t.last_name,e.user.about_me=t.about_me,e.user.age=t.age,e.user.facebookId=t.facebook_id,e.user.facebookProfile=t.facebook_profile_url,null!==t.twitter_provider&&(e.social.twitter=t.twitter_username),null!==t.linkedin_provider&&(e.social.linkedin=t.linkedin_provider),e.loadingUser=!1})},e.getUser(),e.link=function(e){var t=350,i=250,n=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,r=o/2-t/2+n,l=a/2-i/2+s,c="height="+i+",width="+t+",left="+r+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",d="/social/associate/"+e+"/?next=/goals/close_login_popup",u=window.open(d,"Connecting...",c);window.focus&&u.focus()},e.unlink=function(e){var t=350,i=250,n=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,r=o/2-t/2+n,l=a/2-i/2+s,c="height="+i+",width="+t+",left="+r+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",d="/social/disconnect/"+e+"/",u=window.open(d,"Disconnecting...",c);window.focus&&u.focus()},e.refreshUser=function(){o.get({format:"json"},{userId:i}).$promise.then(function(t){e.social.twitter=null===t.twitter_provider?"":t.twitter_username,e.social.linkedin=null===t.linkedin_provider?"":t.linkedin_provider})},e.loadingAbout=!1,e.saveAbout=function(){e.loadingAbout=!0,o.update({userId:i},{about_me:e.user.about_me},function(t){e.loadingAbout=!1},function(e){v.info(e)})},e.apiPhotos=[],e.facebookPhotos=[],e.onDropComplete=function(t,i,n){var s=e.user.photos[t],o=e.user.photos.indexOf(i);e.user.photos[t]=i,e.user.photos[t].order=t,e.user.photos[o]=s,e.user.photos[o].order=o,0!==e.user.photos[t].id&&u.update({photoId:e.user.photos[t].id},{order:e.user.photos[t].order},function(e){},function(e){v.info(e)}),0!==e.user.photos[o].id&&u.update({photoId:e.user.photos[o].id},{order:e.user.photos[o].order},function(e){},function(e){v.info(e)})},e.getPhotos=function(){u.query({format:"json"}).$promise.then(function(t){e.apiPhotos=t.objects;for(var i in e.apiPhotos)for(var n in e.user.photos)e.user.photos[n].order===e.apiPhotos[i].order&&(e.user.photos[n].id=e.apiPhotos[i].id,e.user.photos[n].photo=e.apiPhotos[i].photo,e.user.photos[n].cropped_photo=e.apiPhotos[i].cropped_photo)})},e.getPhotos(),e.currentAlbum="",e.getFBPhotos=function(t,i){e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.hideAlbums=!0,e.currentAlbum=i,e.photosLoading=!0,f.get("https://graph.facebook.com/"+t+"?fields=photos{id,height,width,source}&access_token="+g).success(function(t,i,n,s){e.photosLoading=!1,e.facebookPhotos=t.photos.data}).error(function(t,i,n,s){e.photosLoading=!1})},e.backToAlbums=function(){e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.currentAlbum="",e.hideAlbums=!e.hideAlbums,e.getFBAlbums()},e.facebookAlbums=[],e.hideAlbums=!1,e.getFBAlbums=function(){e.showModal=!0,e.albumsLoading=!0,f.get("https://graph.facebook.com/me/albums?fields=picture,name&access_token="+g).success(function(t,i,n,s){e.facebookAlbums=t.data,e.albumsLoading=!1}).error(function(t,i,n,s){e.albumsLoading=!1})},e.deletePhoto=function(){var t=e.userPhotoDeleteIndex;u["delete"]({photoId:e.user.photos[t].id},function(i){e.user.photos[t].photo="",e.user.photos[t].cropped_photo="",e.user.photos[t].id=0},function(e){v.info(e)})},e.closeModal=function(){e.showModal=!1,e.showPhotos=!0,e.myImage=null,e.photoIndex=null,t(function(){h.hash("my-profile-header-edit"),b()},600)},e.showModal=!1,e.albumsLoading=!1,e.photosLoading=!1,e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.myCroppedImage=null,e.showCrop=function(t){e.photoIndex=t,e.myImage=e.facebookPhotos[t].source,e.showPhotos=!1},e.myCroppedImage="",e.createPhoto=function(t){var n=e.photoIndex,s=e.facebookPhotos[n],o={cropped_photo:t,photo:s.source,order:e.newPhotoIndex,user:"/api/v1/auth/user/"+i+"/"};u.save({},o,function(t){var i=e.newPhotoIndex;e.user.photos[i].photo=t.photo,e.user.photos[i].cropped_photo=t.cropped_photo,e.user.photos[i].id=t.id,e.closeModal()},function(e){})},e.$on("ngRepeatFinishedPhotos",function(){$("#deletePhotoModal").modal("attach events",".delete_photo","show")}),e.$on("ngRepeatFinished",function(){
$(".ui.search.goals").search({apiSettings:{url:"api/v1/subject/?format=json&description__icontains={query}",onResponse:function(e){var t={results:[]};return $.each(e.objects,function(e,i){t.results.push({title:i.description})}),t}},minCharacters:3,searchDelay:300,type:"standard",cache:!1,onSelect:function(t,i){var n=$(this).attr("rel");void 0!==t&&(e.user.goals[n].subject=t.title)}}),$(".ui.search.offers").search({apiSettings:{url:"api/v1/subject/?format=json&description__icontains={query}",onResponse:function(e){var t={results:[]};return $.each(e.objects,function(e,i){t.results.push({title:i.description})}),t}},minCharacters:3,searchDelay:400,type:"standard",cache:!1,onSelect:function(t,i){var n=$(this).attr("rel");void 0!==t&&(e.user.offers[n].subject=t.description)}}),$(".ui.search.interests").search({apiSettings:{url:"api/v1/interest_subject/?format=json&description__icontains={query}",onResponse:function(e){var t={results:[]};return $.each(e.objects,function(e,i){t.results.push({title:i.description})}),t}},minCharacters:3,searchDelay:400,type:"standard",cache:!1,onSelect:function(t,i){var n=$(this).attr("rel");void 0!==t&&(e.user.interests[n].interest_subject=t.description)}})}),e.goalNeedSaving=function(t){e.user.goals[t].changed=!0},e.createNewGoal=function(){var t={id:0,subject:"",user:e.userUri,changed:!0};e.user.goals.push(t)},e.removeGoal=function(t){var i=y(e.user.goals[t].resource_uri);0===e.user.goals[t].id?e.user.goals.splice(t,1):i["delete"]().$promise.then(function(i){e.user.goals.splice(t,1)})},e.saveCurrentGoal=function(t){var i=n.defer();if(e.user.goals[t].errorMessage="",e.user.goals[t].error=!1,e.user.goals[t].subject.length>300)return e.user.goals[t].error=!0,e.user.goals[t].errorMessage="Goal cannot have more than 300 characters.",i.reject(),i.promise;if(""===e.user.goals[t].subject)e.user.goals[t].error=!0,e.user.goals[t].errorMessage="Entering your goal is required.",i.reject();else if(0===e.user.goals[t].id){var s={goal_subject:e.user.goals[t].subject,user:e.userUri};e.user.goals[t].loading=!0,e.user.goals[t].error=!1,a.save({},s,function(n){e.user.goals[t].loading=!1,e.user.goals[t].error=!1,e.user.goals[t].id=n.id,e.user.goals[t].goal=n.goal,e.user.goals[t].goal_subject=n.goal_subject,e.user.goals[t].resource_uri=n.resource_uri,e.user.goals[t].user=n.user,e.user.goals[t].changed=!1,i.resolve()},function(n){e.user.goals[t].errorMessage=n.data.goal.error[0],e.user.goals[t].loading=!1,e.user.goals[t].error=!0,i.reject()})}else e.user.goals[t].error=!1,e.user.goals[t].loading=!0,a.update({goalId:e.user.goals[t].id},{goal_subject:e.user.goals[t].subject},function(n){e.user.goals[t].loading=!1,e.user.goals[t].error=!1,e.user.goals[t].goal=n.goal,e.user.goals[t].goal_subject=n.goal_subject,e.user.goals[t].resource_uri=n.resource_uri,e.user.goals[t].changed=!1,i.resolve()},function(n){e.user.goals[t].errorMessage=n.data.goal?n.data.goal.error[0]:"There was an error when trying to save this field.",e.user.goals[t].loading=!1,e.user.goals[t].error=!0,i.reject()});return i.promise},e.offerNeedSaving=function(t){e.user.offers[t].changed=!0},e.createNewOffer=function(){var t={id:0,subject:"",user:e.userUri,changed:!0};e.user.offers.push(t)},e.removeOffer=function(t){var i=y(e.user.offers[t].resource_uri);0===e.user.offers[t].id?e.user.offers.splice(t,1):i["delete"]().$promise.then(function(i){e.user.offers.splice(t,1)})},e.saveCurrentOffer=function(t){var i=n.defer();if(e.user.offers[t].errorMessage="",e.user.offers[t].error=!1,e.user.offers[t].subject.length>300)return e.user.offers[t].error=!0,e.user.offers[t].errorMessage="Offer cannot have more than 300 characters.",i.reject(),i.promise;if(""===e.user.offers[t].subject)e.user.offers[t].error=!0,e.user.offers[t].errorMessage="Entering your offer is required.",i.reject();else if(0===e.user.offers[t].id){var s={offer_subject:e.user.offers[t].subject,user:e.userUri};e.user.offers[t].loading=!0,e.user.offers[t].error=!1,c.save({},s,function(n){e.user.offers[t].loading=!1,e.user.offers[t].error=!1,e.user.offers[t].id=n.id,e.user.offers[t].offer=n.offer,e.user.offers[t].offer_subject=n.offer_subject,e.user.offers[t].resource_uri=n.resource_uri,e.user.offers[t].user=n.user,e.user.offers[t].changed=!1,i.resolve()},function(n){e.user.offers[t].errorMessage=n.data.offer.error[0],e.user.offers[t].loading=!1,e.user.offers[t].error=!0,i.reject()})}else e.user.offers[t].error=!1,e.user.offers[t].loading=!0,c.update({offerId:e.user.offers[t].id},{offer_subject:e.user.offers[t].subject},function(n){e.user.offers[t].loading=!1,e.user.offers[t].error=!1,e.user.offers[t].offer=n.offer,e.user.offers[t].offer_subject=n.offer_subject,e.user.offers[t].resource_uri=n.resource_uri,e.user.offers[t].changed=!1,i.resolve()},function(n){e.user.offers[t].errorMessage=n.data.offer?n.data.offer.error[0]:"There was an error when trying to save this field.",e.user.offers[t].loading=!1,e.user.offers[t].error=!0,i.reject()});return i.promise},e.interestNeedSaving=function(t){e.user.interests[t].changed=!0},e.createNewInterest=function(){var t={id:0,interest_subject:"",interest:null,user:e.userUri,changed:!0};e.user.interests.push(t)},e.removeInterest=function(t){var i=y(e.user.interests[t].resource_uri);0===e.user.interests[t].id?e.user.interests.splice(t,1):i["delete"]().$promise.then(function(i){e.user.interests.splice(t,1)})},e.saveCurrentInterest=function(t){var i=n.defer();if(e.user.interests[t].errorMessage="",e.user.interests[t].error=!1,e.user.interests[t].interest_subject.length>100)return e.user.interests[t].error=!0,e.user.interests[t].errorMessage="Interest cannot have more than 100 characters.",i.reject(),i.promise;if(""===e.user.interests[t].interest_subject)e.user.interests[t].error=!0,e.user.interests[t].errorMessage="Entering your interest is required.",i.reject();else if(0===e.user.interests[t].id){var s={interest_subject:e.user.interests[t].interest_subject,user:e.userUri};e.user.interests[t].loading=!0,e.user.interests[t].error=!1,d.save({},s,function(n){e.user.interests[t].loading=!1,e.user.interests[t].error=!1,e.user.interests[t].id=n.id,e.user.interests[t].interest=n.interest,e.user.interests[t].interest_subject=n.interest_subject,e.user.interests[t].resource_uri=n.resource_uri,e.user.interests[t].user=n.user,e.user.interests[t].changed=!1,i.resolve()},function(n){e.user.interests[t].errorMessage=n.data.interest.error[0],e.user.interests[t].loading=!1,e.user.interests[t].error=!0,i.reject()})}else e.user.interests[t].error=!1,e.user.interests[t].loading=!0,d.update({interestId:e.user.interests[t].id},{interest_subject:e.user.interests[t].interest_subject},function(n){e.user.interests[t].loading=!1,e.user.interests[t].error=!1,e.user.interests[t].interest=n.interest,e.user.interests[t].interest_subject=n.interest_subject,e.user.interests[t].resource_uri=n.resource_uri,e.user.interests[t].changed=!1,i.resolve()},function(n){e.user.interests[t].errorMessage=n.data.interest?n.data.interest.error[0]:"There was an error when trying to save this field.",e.user.interests[t].loading=!1,e.user.interests[t].error=!0,i.reject()});return i.promise},e.savingAllChanges=!1,e.startSavingChanges=function(){var t=e.saveChanges();e.savingAllChanges=!0,t.then(function(t){v.info("Success saving"),e.savingAllChanges=!1,_({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),s.go("myprofile")},function(t){v.info("Failed"),e.savingAllChanges=!1,_({messageTemplate:'<div class="notify-error-header">Could not save your profile changes.</div><p>There were some errors. Please see them below.</p>',scope:e,classes:"notify-error",icon:"warning circle",duration:4e3})},function(e){})},e.saveChanges=function(){var t=n.defer(),i=0;for(var s in e.user.goals)e.user.goals[s].changed&&i++;for(var s in e.user.offers)e.user.offers[s].changed&&i++;for(var s in e.user.interests)e.user.interests[s].changed&&i++;if(i>0){for(var s in e.user.goals)e.user.goals[s].changed&&e.saveCurrentGoal(s).then(function(e){i--,0===i&&t.resolve()},function(e){t.reject()},function(e){});for(var s in e.user.offers)e.user.offers[s].changed&&e.saveCurrentOffer(s).then(function(e){i--,0===i&&t.resolve()},function(e){t.reject()},function(e){});for(var s in e.user.interests)e.user.interests[s].changed&&e.saveCurrentInterest(s).then(function(e){i--,0===i&&t.resolve()},function(e){t.reject()},function(e){})}else t.resolve();return t.promise}}]),angular.module("persice").controller("ConversationsCtrl",["$rootScope","notify","$resource","$window","$state","NotificationsRepository","InboxRepository","myIoSocket","Connection","$q","$http","$scope","USER_ID","$log","$timeout","FRIEND","MessagesFactory","$filter","FriendsFactory",function(e,t,i,n,s,o,a,r,l,c,d,u,v,m,p,f,g,h,b){u.leftActive=!0,u.messages=[],u.friendshipId=l.objects[0].id,u.friendImage="//graph.facebook.com/"+l.objects[0].facebook_id+"/picture?type=square",t.closeAll(),u.status={loading:!1,loaded:!1},u.q="",u.newmessage="",u.nextOffset=20,u.next=null,u.friend=f,u.recipient="/api/v1/auth/user/"+u.friend.id+"/",u.sender="/api/v1/auth/user/"+v+"/",u.loadingMessages=!1,u.loadingOlderMessages=!1,u.sendingMessage=!1,u.scrollConversations=function(){p(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},1500)},100)},u.loadMore=function(){var e=c.defer();return null===u.next?(e.reject(),e.promise):(u.status.loading?e.reject():(u.status.loading=!0,p(function(){g.query({user_id:u.friend.id,offset:u.nextOffset,limit:10}).$promise.then(function(t){var i=t.objects;u.next=t.meta.next,h("orderBy")(i,"sent_at",!0),u.nextOffset+=10;for(var n in i){var s=h("amDateFormat")(i[n].sent_at,"dddd, MMMM D, YYYY"),o=h("amDateFormat")(i[n].sent_at,"L"),a=h("getIndexByProperty")("date",s,u.messages);null===a&&(u.messages.push({date:s,realDate:o,contents:[]}),a=u.messages.length-1),u.messages[a].contents.push(i[n].sender===u.sender?{body:i[n].body,sender:i[n].sender,recipient:i[n].recipient,date:o,sent_at:i[n].sent_at,left:!0}:{body:i[n].body,sender:i[n].sender,recipient:i[n].recipient,date:o,sent_at:i[n].sent_at,left:!1}),u.messages[a].contents=h("orderBy")(u.messages[a].contents,"sent_at",!0)}u.messages=h("orderBy")(u.messages,"realDate"),u.status.loading=!1,u.status.loaded=!0,e.resolve()},function(t){e.reject(),u.status.loading=!1;var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);m.error(n)})},400)),e.promise)},u.getMessages=function(){u.messages=[],u.loadingMessages=!0,u.status.loaded=!1,g.query({user_id:u.friend.id,limit:20,offset:0}).$promise.then(function(e){var t=e.objects;u.next=e.meta.next,h("orderBy")(t,"sent_at",!0),u.status.loaded=!0;for(var i in t){var n=h("amDateFormat")(t[i].sent_at,"dddd, MMMM D, YYYY"),s=h("amDateFormat")(t[i].sent_at,"L"),r=h("getIndexByProperty")("date",n,u.messages);null===r&&(u.messages.push({date:n,realDate:s,contents:[]}),r=u.messages.length-1),u.messages[r].contents.push(t[i].sender===u.sender?{body:t[i].body,sender:t[i].sender,recipient:t[i].recipient,date:s,sent_at:t[i].sent_at,left:!0}:{body:t[i].body,sender:t[i].sender,recipient:t[i].recipient,date:s,sent_at:t[i].sent_at,left:!1}),u.messages[r].contents=h("orderBy")(u.messages[r].contents,"sent_at",!0)}u.messages=h("orderBy")(u.messages,"realDate"),u.messages.length>0&&(p(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},0)},100),d.get("/api/v1/inbox/reat_at/?sender_id="+u.friend.id).success(function(e,t,i,n){a.getInboxMessages(),o.refreshTotalInbox()}).error(function(e,t,i,n){})),u.loadingMessages=!1},function(e){u.loadingMessages=!1;var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);m.error(i)})},u.getMessages(),u.sendNewMessage=function(){if(""===u.newmessage)u.sendingMessage=!1;else{u.sendingMessage=!0;var e={};e={sender:u.sender,recipient:u.recipient,body:u.newmessage},g.save({},e,function(t){e.left=!0,e.sent_at=t.sent_at,e.sender=t.sender,e.recipient=t.recipient;var i=h("amDateFormat")(e.sent_at,"L"),n=h("amDateFormat")(e.sent_at,"dddd, MMMM D, YYYY"),s=h("getIndexByProperty")("date",n,u.messages);e.date=i,null===s&&(u.messages.push({date:n,realDate:i,contents:[]}),s=u.messages.length-1),u.messages[s].contents.push(e),u.newmessage="",m.info("New message saved."),u.sendingMessage=!1,u.scrollConversations()},function(e){u.sendingMessage=!1,m.info(e)})}},e.$on("receivedMessage",function(t,i){var n=JSON.parse(i);if(n.sender===u.recipient){m.info("new message");var s=h("amDateFormat")(n.sent_at,"dddd, MMMM D, YYYY"),r=h("amDateFormat")(n.sent_at,"L"),l=h("getIndexByProperty")("date",s,u.messages);null===l&&(u.messages.push({date:s,realDate:r,contents:[]}),l=u.messages.length-1),u.messages[l].contents.push({body:n.body,sender:n.sender,recipient:n.recipient,date:r,sent_at:n.sent_at,left:!1}),e.notifications.push({body:n.body,sender:n.sender,recipient:n.recipient,date:r,sent_at:n.sent_at}),u.messages[l].contents=h("orderBy")(u.messages[l].contents,"sent_at",!0),u.messages=h("orderBy")(u.messages,"realDate"),d.get("/api/v1/inbox/reat_at/?sender_id="+u.friend.id).success(function(e,t,i,n){a.getInboxMessages(),o.refreshTotalInbox()}).error(function(e,t,i,n){}),p(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},1500)},100),p(function(){angular.element("#desktop-conversation-content").filter(":not(:animated)").animate({scrollTop:0},1500)},100)}else a.getInboxMessages(),o.refreshTotalInbox()}),u.unFriend=function(){b.update({friendId:u.friendshipId},{status:-1},function(e){a.getInboxMessages(),s.go("myconnections")},function(e){})}}]),angular.module("persice").controller("BigMatchFeedCtrl",function(){}),angular.module("persice").factory("GoalsFactory",["$resource",function(e){return e("/api/v1/goal/:goalId/:param",{goalId:"@goalId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("NewConnectionsFactory",["$resource",function(e){return e("/api/v1/new_connections/counter/:newConnectionId/:param",{goalId:"@newConnectionId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("LikesFactory",["$resource",function(e){return e("/api/v1/likes/:likeId/:param",{likeId:"@likeId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("ProfileFactory",["$resource",function(e){return e("/api/v1/profile/:profileId/:param",{profileId:"@profileId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("LocationFactory",["$resource",function(e){return e("/api/v1/location/:locationId/:param",{locationId:"@locationId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("ConnectionsFactory",["$resource",function(e){return e("/api/v1/connections/:connectionId/:param",{connectionId:"@connectionId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FriendsFactory",["$resource",function(e){return e("/api/v1/friends/:friendId/:param",{friendId:"@friendId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MutualFriendsFactory",["$resource",function(e){return e("/api/v1/mutual/friends/:friendId/:param",{friendId:"@friendId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("SubjectsFactory",["$resource",function(e){return e("/api/v1/subject/:subjectId/:param",{subjectId:"@subjectId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("OffersFactory",["$resource",function(e){return e("/api/v1/offer/:offerId/:param",{offerId:"@offerId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InterestsFactory",["$resource",function(e){return e("/api/v1/interest/:interestId/:param",{interestId:"@interestId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InterestSubjectFactory",["$resource",function(e){return e("/api/v1/interest_subject/:interestId/:param",{interestId:"@interestId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("UsersFactory",["$resource",function(e){return e("/api/v1/auth/user/:userId/:param",{userId:"@userId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MessagesFactory",["$resource",function(e){return e("/api/v1/messages/:messageId/:param",{messageId:"@messageId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InboxFactory",["$resource",function(e){return e("/api/v1/inbox/last/:inboxId/:param",{inboxId:"@inboxId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FiltersFactory",["$resource",function(e){return e("/api/v1/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("PhotosFactory",["$resource",function(e){return e("/api/v1/photo/:photoId/:param",{photoId:"@photoId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InboxUnreadCounterFactory",["$resource",function(e){return e("/api/v1/inbox/unread_counter/:unreadId/:param",{unreadId:"@unreadId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("EventsFactory",["$resource",function(e){return e("/api/v1/event/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE"}})}]).factory("MembersFactory",["$resource",function(e){return e("/api/v1/member/:memberId/:param",{memberId:"@memberId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE"}})}]).factory("FeedEventsFriendsFactory",["$resource",function(e){return e("/api/v1/feed/events/friends/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FeedEventsMyFactory",["$resource",function(e){return e("/api/v1/feed/events/my/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FeedEventsAllFactory",["$resource",function(e){return e("/api/v1/feed/events/all/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("EventsConnections",["$resource",function(e){return e("/api/v1/events/connections/:connectionId/:param",{connectionId:"@connectionId"},{query:{method:"GET",isArray:!1,cache:!1}})}]).factory("EventsAttendees",["$resource",function(e){return e("/api/v1/attendees/:attendeeId/:param",{attendeeId:"@attendeeId"},{query:{method:"GET",isArray:!1,cache:!1}})}]),angular.module("persice").controller("AppCtrl",["$rootScope","APP_ID","USER_PHOTO_SMALL","NotificationsRepository","$http","LocationFactory","$geolocation","ezfb","$scope","USER_ID","FilterRepository","EventsFilterRepository","USER_FIRSTNAME","USER_PHOTO","$timeout","$state","$window","myIoSocket","$filter","$log","notify","$resource","$cookies","InboxRepository","moment","angularMomentConfig",function(e,t,i,n,s,o,a,r,l,c,d,u,v,m,p,f,g,h,b,w,y,_,k,E,x,I){e.hideTopMenu=!1,l.checkLogin=function(){r.getLoginStatus().then(function(t){e.fbAuth=t.authResponse,r.api("/me",function(t){e.apiMe=t})})},l.checkLogin(),n.refreshTotalInbox(),n.refreshTotalConnections(),l.$geolocation=a,a.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){l.location=e,l.saveLocation(l.location.coords)}),l.saveLocation=function(e){o.query({format:"json"}).$promise.then(function(t){var i={user:"/api/v1/auth/user/"+c+"/",position:e.latitude+","+e.longitude,speed:e.speed,heading:e.heading,altitude:e.altitude,altitude_accuracy:e.altitudeAccuracy};t.meta.total_count>0?(l.serverLocation=t.objects[0],o.update({locationId:l.serverLocation.id},i,function(e){w.info("New location updated.")},function(e){w.error("Error updating location."),w.error(e)})):o.save({},i,function(e){w.info("New location created.")},function(e){w.error("Error creating location."),w.error(e)})},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);w.error(i)})},e.userImg=i,e.userName=v,k.userid=c,d.getFilters(),e.$on("triggerRefreshFilters",function(){d.getFilters()}),u.getFilters(),e.$on("triggerRefreshEventsFilters",function(){u.getFilters()}),e.goBack=function(){e.hideTopMenu=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("showFullProfile")},l.cancelMatch=function(){$(".dimmable").dimmer("hide"),e.hideTopMenu=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("cancelMatchEvent")},l.confirmMatch=function(){$(".dimmable").dimmer("hide"),e.hideTopMenu=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("confirmMatchEvent")},e.$on("triggerRefreshMatchfeed",function(){e.showfullprofile=!1,e.hideTopMenu=!0,l.refreshMatchFeed()}),l.refreshMatchFeed=function(){$(".dimmable").dimmer("hide"),e.$broadcast("refreshMatchFeed")},E.getInboxMessages(),e.notifications=[],e.messages=[],l.$on("socket:message",function(t,i){var s=JSON.parse(i);if(w.info(s),s.type==="event_deleted."+c){var o=JSON.parse(s.message),a=x.utc(o.event_start_date).local().format("dddd, MMMM D, YYYY H:mm A ");a+=x.tz(I.timezone).format("z");var r="The event "+o.event_name+" on "+a+" has been cancelled by "+o.event_organizer_name+", the event host. <br>We apologize for any inconvenience. (This is an automated message.)",d=b("amDateFormat")(Date.now(),"h:mm a"),u='<div class="notify-info-header">Event is cancelled <br>'+d+" </div><p>"+r+"</p>";y({messageTemplate:u,scope:l,classes:"notify-info",icon:"calendar",duration:8e3})}if(s.type==="connection."+c){var v=JSON.parse(i),m=JSON.parse(v.message),d=b("amDateFormat")(Date.now(),"h:mm a"),p="/api/v1/auth/user/"+c+"/";if(p===m.friend1)var g=_(m.friend2);if(p===m.friend2)var g=_(m.friend1);g.get().$promise.then(function(e){n.refreshTotalConnections();var t='<div class="notify-info-header"><a ui-sref="myconnections">New connection<br>'+d+' </a></div><p><a ui-sref="myconnections">You and '+e.first_name+" are now friends.</a></p>";y({messageTemplate:t,scope:l,classes:"notify-info",icon:"user",duration:4e3})})}if(s.type==="message."+c)if(e.isState("conversations"))e.$broadcast("receivedMessage",s.message);else{E.getInboxMessages(),n.refreshTotalInbox();var s=JSON.parse(i),h=JSON.parse(s.message),k=b("words")(h.body,10),d=b("amDateFormat")(h.sent_at,"h:mm a"),$=_(h.sender);$.get().$promise.then(function(e){l.gotoConversation=function(){f.go("conversations",{userId:e.id})};var t='<div class="notify-info-header"><a href="" ng-click="gotoConversation()">Received new message from '+e.first_name+"<br>"+d+' </a></div><p><a href="" ng-click="gotoConversation()">'+k+"</a></p>";y({messageTemplate:t,scope:l,classes:"notify-info",icon:"wechat",duration:4e3})})}})}]),angular.module("persice").run(["$templateCache",function(e){e.put("app/bigmatchfeed/bigmatchfeed.html",'<div style="float: right;"><div class="ui text main menu"><div class="text item" style="margin-right: 0px;">15 Results &nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;Sort By</div><div class="ui pointing dropdown link item" style="padding-left: 0px;margin-left: 0px;"><span class="text">Most Relevant</span> <i class="dropdown icon"></i><div class="menu"><div class="header">Categories</div><div class="item"><i class="dropdown icon"></i> <span class="text">Clothing</span><div class="menu"><div class="header">Mens</div><div class="item">Shirts</div><div class="item">Pants</div><div class="item">Jeans</div><div class="item">Shoes</div><div class="divider"></div><div class="header">Womens</div><div class="item">Dresses</div><div class="item">Shoes</div><div class="item">Bags</div></div></div><div class="item">Home Goods</div><div class="item">Bedroom</div><div class="divider"></div><div class="header">Order</div><div class="item">Status</div><div class="item">Cancellations</div></div></div></div></div><div class="ui grid"><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">John Stevens</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">I am a 55 year old doctor and I’m supposed to give a presentation at a local university in 3 weeks, but I don’t know how to use PowerPoint. I need someone to show me how to use the software, and to help cre- ate the content of my slides (i.e. copy, images, video).</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div></div><script>\n\'use strict\';\n\n$(\'.ui.dropdown\')\n    .dropdown();\n</script>'),
e.put("app/conversations/conversations.html",'<div id="mycontroller"><div class="ui fixed borderless menu" id="headermenu"><a class="icon item" ui-sref="inbox"><i class="left chevron icon"></i></a><h3 class="ui center aligned header">{{friend.first_name}}</h3></div><div class="ui fixed menu" id="submenu"><div class="3 fluid large ui buttons"><a ui-sref="conversations({ userId: friend.id })" ng-class="{\'active\': leftActive}" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friend.id })" class="ui button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div></div><div id="desktop-conversation-header" class="ui dividing header large"><div class="content">Conversation with <a ui-sref="friendprofile({ userId: friend.id })">{{friend.first_name}}</a></div></div><div id="desktop-conversation-reply"><div class="ui form"><div class="field"><label></label> <textarea ng-enter="sendNewMessage()" placeholder="Add your message here." ng-model="newmessage"></textarea></div><div ng-click="sendNewMessage()" ng-class="{\'loading\': sendingMessage}" class="ui submit green button">Send Message</div></div></div><div id="desktop-conversation-content" class="basic ui segment" ng-class="{\'loading\': loadingMessages}" when-scroll-ends="loadMore()"><h3 class="ui center aligned header" ng-if="messages.length === 0">There are no any messages</h3><div class="repeat-animation" ng-repeat="message in messages | orderBy:\'-realDate\' track by $index"><div ng-style="" class="repeat-animation quote" ng-class="{\'left\': msg.left, \'right\': !msg.left, \'lastMessage\': $last}" ng-repeat="msg in message.contents | orderBy:\'-sent_at\' track by $index"><img class="round-avatar" ng-src="{{ msg.left && userImg || !msg.left && friendImage}}"><div class="speech-bubble"><blockquote>{{msg.body}}</blockquote></div><span class="time-ago">{{message.date}} {{msg.sent_at | amDateFormat:\'h:mm a\'}}</span></div></div><three-bounce-spinner class="page-spinner-bar" ng-show="status.loading"></three-bounce-spinner></div><div id="mobile-conversation-content" class="conversation-content basic ui segment" ng-class="{\'loading\': loadingMessages}" when-scrolled="loadMore()" scroll-bottom-on="status.loaded"><three-bounce-spinner class="page-spinner-bar" ng-show="status.loading"></three-bounce-spinner><div class="repeat-animation" ng-repeat="message in messages track by $index"><h6>{{message.date}}</h6><div ng-style="" class="repeat-animation" ng-class="{\'bubbledLeft\': msg.left, \'bubbledRight\': !msg.left, \'lastMessage\': $last}" ng-repeat="msg in message.contents | orderBy:\'sent_at\' track by $index"><p>{{msg.body}}</p><span class="conversation-time">{{msg.sent_at | amDateFormat:\'h:mm a\'}}</span></div></div></div><div id="mobile-no-messages" class="conversation-content ui segment" ng-if="messages.length === 0"><h3>There are no any messages</h3></div><div id="mobile-conversation-reply" class="message-reply"><div class="ui fluid action input"><input ng-enter="sendNewMessage()" type="text" placeholder="" ng-model="newmessage"><div ng-click="sendNewMessage()" class="ui button" ng-class="{\'loading\': sendingMessage}">Send</div></div></div><script>\n    \'use strict\';\n\n    $(\'.ui.dropdown\')\n        .dropdown({\n            onShow: function() {\n\n\n                var scope = angular.element($("#submenu")).scope();\n                scope.$apply(function() {\n                    scope.leftActive = false;\n                });\n            },\n            onHide: function() {\n\n                var scope = angular.element($("#submenu")).scope();\n                setTimeout(function() {\n                    scope.$apply(function() {\n                        scope.leftActive = true;\n                    });\n                }, 100);\n            }\n        });\n\n    $(\'.basic.delete.modal\')\n        .modal({\n            onDeny: function() {\n                console.log(\'cancel\');\n            },\n            onApprove: function() {\n                console.log(\'deleting user\');\n\n                angular.element(document.getElementById(\'mycontroller\')).scope().unFriend();\n\n            }\n        })\n        .modal(\'attach events\', \'.deleteconnection\', \'show\');\n    </script><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want remove this connection?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div></div>'),e.put("app/editmyprofile/editmyprofile.html",'<div class="ui fixed borderless menu center" id="edittopmenu"><div class="main container"><div class="left menu"><a class="ui item" ui-sref="myprofile" ng-hide="showModal">Cancel</a></div><div class="header item">Edit Profile</div><div class="right menu"><a class="ui item" ng-click="startSavingChanges()" ng-hide="showModal" ng-class="{\'loading\': savingAllChanges}">Save</a></div></div></div><div class="segment" id="my-profile-header-edit" ng-hide="showModal || editInterest"><div class="ui segment"><div id="tiles" ng-cloak=""><div class="ui image tile" ng-class="{\'left floated medium tile-big\': $index === 0, \'left floated small tile-small\': $index === 1 || $index === 2 || $index === 4 || $index === 5, \'small tile-small\': $index === 3 }" ng-repeat="photo in user.photos track by $index" end-repeat-photos="" ng-drop="true" ng-drop-success="onDropComplete($index, $data,$event)"><a href="" ng-click="$parent.userPhotoDelete = photo; $parent.userPhotoDeleteIndex = $index;" class="ui right corner delete_photo label" ng-show="photo.photo !== \'\'"><i class="close icon"></i></a><div class="tile-content" ng-show="photo.photo === \'\'"><div class="content"><div class="center"><a href="" ng-click="$parent.newPhotoIndex = $index; getFBAlbums();" class="ui compact icon button add_photo"><i class="circle add icon"></i> Add Photo</a></div></div></div><div style="background-image: url(\'{{photo.photo}}\')" ng-if="photo.cropped_photo === \'\'" ng-drag="true" ng-drag-data="photo" class="img-bounding-box"></div><div style="background-image: url(\'{{photo.cropped_photo}}\')" ng-if="photo.cropped_photo !== \'\'" ng-drag="true" ng-drag-data="photo" class="img-bounding-box"></div></div></div></div></div><div class="body segment edit" id="my-profile-body" ng-hide="showModal || editInterest"><div class="ui attached segment" id="my-profile-title"><h3 class="ui left floated header">{{ user.firstName }}<span ng-hide="user.firstName === \'\'">,</span> {{ user.age }}</h3></div><div class="ui attached segment" ng-class="{loading: loadingGoals || loadingOffers || loadingUser || loadingLikes || loadingInterests }"><h4 class="ui header">Goals</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="goal in user.goals track by $index"><div class="content"><div class="description"><div class="ui fluid search goals" rel="{{$index}}" ng-class="{\'loading\': goal.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': goal.error}"><div class="ui removebutton icon circular button" ng-click="removeGoal($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="goal.subject" ng-change="goalNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="goal.error">{{goal.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewGoal()"><i class="plus icon"></i> Create new Goal</div><h4 class="ui header">Offers</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="offer in user.offers track by $index"><div class="content"><div class="description"><div class="ui fluid search offers" rel="{{$index}}" ng-class="{\'loading\': offer.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': offer.error}"><div class="ui removebutton icon circular button" ng-click="removeOffer($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="offer.subject" ng-change="offerNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="offer.error">{{offer.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewOffer()"><i class="plus icon"></i> Create new Offer</div><h4 class="ui header">About</h4><form class="ui form" ng-class="{loading: loadingAbout}"><div class="field"><label></label> <textarea rows="3" ng-model="user.about_me" ng-blur="saveAbout()"></textarea></div></form><h4 class="ui header">Activities &amp; Interests</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="interest in user.interests track by $index"><div class="content"><div class="description"><div class="ui fluid search interests" rel="{{$index}}" ng-class="{\'loading\': interest.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': interest.error}"><div class="ui removebutton icon circular button" ng-click="removeInterest($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="interest.interest_subject" ng-change="interestNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="interest.error">{{interest.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewInterest()"><i class="plus icon"></i> Create new Interest</div><h4 class="ui header">Likes</h4><div class="ui list likes"><div class="item" ng-repeat="like in user.likes | limitTo:5 track by $index"><div class="content"><div class="description">{{ like.name }}</div></div></div></div></div><div class="ui attached segment" id="socialaccounts"><h4 class="ui header">Social Accounts</h4><br><a ng-click="link(\'linkedin\')" class="ui icon linkedin labeled fluid button notconnected" ng-if="social.linkedin.length === 0"><i class="linkedin icon"></i> Connect</a><div class="ui fluid buttons socialbuttons" ng-if="social.linkedin.length > 0"><a href="{{ social.linkedin }}" target="_new" class="ui social icon twitter labeled button"><i class="linkedin icon"></i> {{user.firstName}} <i class="check circle icon right"></i></a> <a ng-click="unlink(\'linkedin\')" class="ui right icon circular button disconnect"><i class="remove icon"></i></a></div><br><a ng-click="link(\'twitter\')" class="ui icon twitter labeled fluid button notconnected" ng-if="social.twitter.length === 0"><i class="twitter icon"></i> Connect</a><div class="ui fluid buttons socialbuttons" ng-if="social.twitter.length > 0"><a href="https://twitter.com/{{ social.twitter }}" target="_new" class="ui social icon twitter labeled button"><i class="twitter icon"></i> {{social.twitter}} <i class="check circle icon right"></i></a> <a ng-click="unlink(\'twitter\')" class="ui right icon circular button disconnect"><i class="remove icon"></i></a></div><br><a href="{{ user.facebookProfile }}" target="_new" class="ui social icon facebook labeled fluid button" ng-if="user.facebookProfile !== \'\'"><i class="facebook icon"></i> {{user.firstName}} <i class="lock icon right"></i></a></div></div><div class="ui basic modal" id="deletePhotoModal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content" ng-cloak=""><img ng-src="{{userPhotoDelete.photo}}" class="ui image small" alt=""><div class="description"><p>Are you sure you want to delete your photo?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red basic inverted button"><i class="remove icon"></i> No</div><div ng-click="deletePhoto()" class="ui green basic inverted button"><i class="checkmark icon"></i> Yes</div></div></div></div><div class="body basic segment edit" id="my-profile-photos" ng-if="showModal" ng-cloak=""><div class="ui attached segment" ng-class="{loading: albumsLoading}"><div class="ui dividing header"><span ng-show="currentAlbum != \'\' && showPhotos">Choose Photo</span> <span ng-show="currentAlbum == \'\'">Choose Facebook Album</span> <span ng-show="currentAlbum != \'\' && !showPhotos">Crop Photo</span></div><div class="ui selection list" ng-hide="hideAlbums"><div class="item" ng-click="getFBPhotos(fbAlbum.id, fbAlbum.name)" ng-repeat="fbAlbum in facebookAlbums track by $index"><img class="ui tiny image" ng-src="{{fbAlbum.picture.data.url}}"><div class="content"><div class="header">{{fbAlbum.name}}</div></div></div></div><div ng-show="hideAlbums" class="ui basic segment" ng-class="{loading: photosLoading}"><button class="ui labeled fluid button backButton" ng-click="backToAlbums()"><i class="angle left big icon"></i>Back to Albums</button><h3 ng-show="showPhotos" class="ui header">{{currentAlbum}}</h3><div class="ui selection list" ng-show="showPhotos"><div ng-click="showCrop($index)" class="item button ok" ng-repeat="fbPhoto in facebookPhotos track by $index"><img class="ui small image" ng-src="{{fbPhoto.source}}"><div class="content"><div class="header"></div></div></div></div><div ng-hide="showPhotos"><div class="ui vertically divided centered relaxed grid"><div class="sixteen wide column"><div class="cropArea"><img-crop image="myImage" result-image="myCroppedImage" area-type="square"></img-crop></div></div><div class="center aligned one column row"><div class="sixteen wide column"><div class="ui segment basic center aligned"><button class="ui button" ng-click="closeModal()">Cancel</button> <button class="ui primary button" ng-click="createPhoto(myCroppedImage)">Save Photo</button></div></div></div></div></div></div></div></div><script type="text/javascript">\n    \'use strict\';\n\n    function refreshConnect() {\n        angular.element($(\'#socialaccounts\')).scope().refreshUser();\n    }\n</script>'),e.put("app/events/event.html",'<div class="ui fixed borderless menu center" id="edittopmenu"><div class="left menu"><a class="ui item" ng-click="eventpage.gotoPreviousState();"><i class="left chevron icon"></i></a></div><div class="header item">{{eventpage.header}}</div><div class="right menu"><a class="ui item" ng-click="eventpage.makeactionEvent();"><span ng-show="isState(\'event.create\') || (isState(\'event.edit\') && eventpage.isHost.option)">Save</span> <span ng-show="isState(\'event.details\') && eventpage.isHost.option">Edit</span> <span ng-show="isState(\'event.invitations\')">Done</span></a></div></div><div ui-view=""></div>'),e.put("app/events/event_attendees.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventattendees.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_create.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/event.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_edit.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventedit.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_invitations.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventinvitations.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_view.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventview.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/events_allevents.html",'<events-feed type="events.allevents"></events-feed>'),e.put("app/events/events_map.html","Map"),e.put("app/events/events_myevents.html",'<events-feed type="events.myevents"></events-feed>'),e.put("app/events/events_mynetwork.html",'<events-feed type="events.mynetwork"></events-feed>'),e.put("app/events/events_page.html",'<div class="ui grid"><div class="row"><div class="wide column"><div class="ui fluid secondary menu center-aligned" id="eventsMobileNav"><a class="item" ui-sref="events.myevents" ng-class="{\'active\': isState(\'events.myevents\')}">MY EVENTS</a> <a class="item" ui-sref="events.mynetwork" ng-class="{\'active\': isState(\'events.mynetwork\')}">MY NETWORK</a> <a class="item" ui-sref="events.allevents" ng-class="{\'active\': isState(\'events.allevents\')}">ALL EVENTS</a></div><div class="ui secondary pointing menu" id="eventsDesktopNav"><a class="item" ui-sref="events.myevents" ng-class="{\'active\': isState(\'events.myevents\')}">MY EVENTS</a> <a class="item" ui-sref="events.mynetwork" ng-class="{\'active\': isState(\'events.mynetwork\')}">MY NETWORK</a> <a class="item" ui-sref="events.allevents" ng-class="{\'active\': isState(\'events.allevents\')}">ALL EVENTS</a><div class="right menu"><a class="ui button small labeled green icon" ng-click="eventspage.showEventModal()"><i class="fa fa-plus-circle icon"></i> Create</a></div></div><div class="ui secondary pointing menu" id="eventsDesktopSubNav"><div class="item"></div><div class="right menu"><a class="item icon active" ng-class="{\'active\': isState(\'events.myevents\') || isState(\'events.mynetwork\') || isState(\'events.allevents\')}"><i class="fa large fa-list icon"></i></a> <a class="item icon"><i class="fa large fa-calendar icon"></i></a> <a class="item" ui-sref="events.map" ng-class="{\'active\': isState(\'events.map\')}"><i class="fa large fa-map-marker icon"></i></a></div></div></div></div></div><div ui-view=""></div><ui-event-create-modal show="eventspage.showModal"></ui-event-create-modal><ui-event-view-modal show="eventspage.showViewModal" eventid="eventspage.viewEvent"></ui-event-view-modal>'),e.put("app/finalstep/finalstep.html",'<div id="finalstep"><div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">4</i></span> Final Step</div><div class="right menu"><div class="ui item" id="nextButton"><a ui-sref="matchfeed" class="ui button small green"><span ng-if="finalstep.twitter === \'\' && finalstep.linkedin === \'\'">Skip</span><span ng-if="finalstep.twitter !== \'\' || finalstep.linkedin !== \'\'">Next</span> &raquo;</a></div></div></div><div class="ui grid fullheight"><div class="row"><div class="wide column"><div class="body segment"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">4</i></span><div class="content">Final Step</div><a ui-sref="matchfeed" id="nextButtonDesktop" class="ui button small green"><span ng-if="finalstep.twitter === \'\' && finalstep.linkedin === \'\'">Skip</span><span ng-if="finalstep.twitter !== \'\' || finalstep.linkedin !== \'\'">Next</span> &raquo;</a></h2><h2 class="ui center aligned header withborder"><hr>Connect your LinkedIn and<br>Twitter accounts<hr></h2><div class="ui basic segment"><div class="ui center aligned grid"><div class="row"><div class="column"><div class="ui segment basic center alligend"><p>This will improve your match results within the persice community.</p><p><i class="icon lock"></i> persice will never share your information or post on your behalf.</p></div></div></div><div class="row"><div class="column"><div class="ui segment basic center alligend" ng-class="{\'loading\': finalstep.loading}"><a class="ui linkedin big button" ng-click="finalstep.link(\'linkedin\')" ng-show="finalstep.linkedin === \'\'"><i class="linkedin icon"></i> Connect</a> <a href="{{ finalstep.linkedin }}" target="_new" class="ui social icon linkedin big labeled button" ng-show="finalstep.linkedin !== \'\'"><i class="linkedin icon"></i> {{finalstep.firstName}} <i class="check circle icon right"></i></a><br><br><a class="ui twitter big button" ng-click="finalstep.link(\'twitter\')" ng-show="finalstep.twitter === \'\'"><i class="twitter icon"></i> Connect</a> <a href="https://twitter.com/{{ finalstep.twitter }}" target="_new" class="ui social icon twitter labeled big button" ng-show="finalstep.twitter !== \'\'"><i class="twitter icon"></i> {{finalstep.twitter}} <i class="check circle icon right"></i></a></div></div></div></div></div></div></div></div></div><script type="text/javascript">\n    \'use strict\';\n\n    function refreshConnect() {\n        angular.element($(\'#finalstep\')).scope().finalstep.refreshUser();\n    }\n    </script></div>'),e.put("app/friendprofile/friendprofile.html",'<div id="connectionPage" ng-cloak=""><div class="ui fixed borderless menu" id="headermenu"><a class="icon item" ui-sref="myconnections"><i class="left chevron icon"></i></a><h3 class="ui center aligned header">{{ friendprofile.userInfo.first_name }}</h3></div><div class="ui fixed menu friendsubmenu" id="submenu"><div class="3 fluid large ui buttons"><a ui-sref="conversations({ userId: friendprofile.userInfo.id })" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friendprofile.userInfo.id })" ng-class="{\'active\': friendprofile.middleActive}" class="ui button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div></div><div class="3 fluid large ui buttons friendsubmenu" id="desktopsubmenu"><a ui-sref="conversations({ userId: friendprofile.userInfo.id })" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friendprofile.userInfo.id })" ng-class="{\'active\': friendprofile.middleActive}" class="ui middle button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div><user-profile person="friendprofile.userInfo" type="friend" header="friendprofileheader" body="matched-profile-body"></user-profile></div><script>\n    \'use strict\';\n    $(\'.ui.dropdown\')\n    .dropdown({\n        onShow:  function(){\n            var scope = angular.element($(".friendsubmenu")).scope();\n            scope.$apply(function(){\n                scope.friendprofile.middleActive = false;\n            });\n        },\n        onHide: function(){\n            var scope = angular.element($(".friendsubmenu")).scope();\n            setTimeout(function() {\n                scope.$apply(function(){\n                    scope.friendprofile.middleActive = true;\n                });\n            }, 100);\n        }\n    })\n    ;\n\n</script><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want remove this connection?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div><script>\n  \'use strict\';\n  $(\'.basic.delete.modal\')\n  .modal({\n    onDeny    : function(){\n      console.log(\'cancel\');\n  },\n  onApprove : function() {\n      console.log(\'deleting user\');\n      angular.element(document.getElementById(\'connectionPage\')).scope().friendprofile.unFriend();\n  }\n})\n  .modal(\'attach events\', \'.deleteconnection\', \'show\');\n\n\n</script>'),e.put("app/goalcreate/goalcreate.html",'<div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">2</i></span> Create a goal</div><div class="right menu"><div class="ui item" id="nextButton"><div ng-click="createGoal()" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></div></div></div><div class="ui grid fullheight"><div class="row"><div class="wide column"><div class="body segment"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">2</i></span><div class="content">Create a goal</div><div ng-click="createGoal()" id="nextButtonDesktop" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></h2><h2 class="ui center aligned header withborder">My goal is to...<hr></h2><div class="ui attached warning message" id="warningmessage" ng-show="messageShow"><div class="header">Warning</div><p>{{message}}</p></div><div class="ui basic segment"><div class="ui center aligned grid"><div class="row"><div class="search-wrapper"><div field-required="false" autocomplete-ui="" input-class="ui input fluid" text-no-results="No existing goal found. Create new goal &raquo;" minlength="3" input-changed="inputChanged" match-class="highlight" selected-object="selectResult" description-field="description[3]" title-field="description" remote-url="/api/v1/subject/?format=json&description__icontains=" remote-url-data-field="objects" type="text" input-name="description" id="id_description" placeholder="enter your goal here"></div></div></div></div></div><div class="ui secondary segment" id="instructions" ng-hide="subject !== \'\'"><h4>This should be something you want other people to help you with.</h4><br><h4>For example:</h4><p><ul class="unstyled"><li>&quot;Learn to play tennis&quot;</li><li>&quot;Find a running partner&quot;</li><li>&quot;Hire a cat sitter&quot;</li><li>&quot;Move my sofa upstairs&quot;</li></ul></p></div></div></div></div></div>'),e.put("app/inbox/inbox.html",'<div id="search-header"><div class="ui left icon input"><input type="text" ng-model="inbox.q" name="q" placeholder="Search"> <i class="circular search icon"></i></div></div><div id="inbox-body" class="basic ui segment" ng-class="{\'loading\': inbox.loadingMessages}" when-scroll-ends="inbox.loadMore()"><div class="ui selection divided list"><a ng-class="{\'unread\': message.readAt === null}" ui-sref="conversations({ userId: message.friendId })" class="item repeat-animation" ng-if="message.body !== null" ng-repeat="message in inbox.allMessages | filter:{firstName: inbox.q} track by message.id"><div class="ui circular tiny image img-bounding-box" ng-style="{\'background-image\': \'url(//graph.facebook.com/{{ message.facebookId }}/picture?type=large)\'}"></div><span class="message-time">{{message.sentAt}}</span><div class="content"><div class="header">{{message.firstName}}</div><div class="description">{{message.body | words: 8}}</div></div></a></div><three-bounce-spinner class="page-spinner-bar" ng-show="inbox.loadingMore"></three-bounce-spinner></div>'),e.put("app/interests/interests.html",'<div class="ui top fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">1</i></span> What interests you?</div><div class="right menu"><div class="ui item" id="nextButton"><div ng-click="interest.nextStep()" ng-class="{\'disabled\': interest.counter === 0}" class="ui button green">Next &raquo;</div></div></div></div><div id="interests-header"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">1</i></span><div class="content">What interests you?</div><div ng-click="interest.nextStep()" id="nextButtonDesktopInterests" ng-class="{\'disabled\': interest.counter === 0}" class="ui small button green">Next &raquo;</div></h2><div class="ui left icon input"><input type="text" ng-model="interest.searchQuery" ng-change="interest.getAllInterests()" ng-model-options="{debounce:300}" placeholder="Search"> <i class="circular search icon"></i></div></div><div id="interests" class="basic ui segment" ng-class="{\'loading\': interest.loadingInterests}" when-scroll-ends="interest.loadMoreInterests()"><div ng-click="interest.useInterest($index)" class="ui button toggle compact repeat-animation" ng-repeat="inter in interest.allInterests track by $index" ng-class="{\'active\': inter.active, \'loading\': interest.inter.loading}">{{inter.description}}</div><div class="ui info message" ng-show="interest.noResults && !interest.loadingInterests"><p>No interests found.</p><p>Try with another search term or <a href="" ng-click="interest.reset()">reset your search</a>.</p></div><three-bounce-spinner class="page-spinner-bar" ng-show="interest.loadingMore"></three-bounce-spinner></div>'),e.put("app/main/main.html",'<div class="ui center aligned grid fullheight" id="homepage"><div class="row"><div class="wide column"><div class="ui huge header aligned center">{{greetingMessage}} Persice</div></div></div><div class="row"><div class="wide column"><div class="ui small header" id="main-info">Persice connects people with similar goals<br>and interests.</div><br><p><a ui-sref="selectinterests" class="ui green button huge">Start</a></p></div></div></div>'),e.put("app/matchfeed/matchfeed.html",'<matchfeed-profile type="matchfeed"></matchfeed-profile>'),e.put("app/myconnections/myconnections.html",'<div id="search-header"><div class="ui left icon input"><input type="text" ng-model="myconnections.q" ng-change="myconnections.getFriends()" placeholder="Search" ng-model-options="{debounce:300}"> <i class="circular search icon"></i></div></div><div id="friends-list-body" class="basic ui segment" ng-class="{\'loading\': myconnections.loading}" when-scroll-ends="myconnections.loadMoreFriends()"><div class="ui basic segment notice" ng-if="myconnections.noConnections"><div class="ui info message"><p>You don\'t have any connections. Go to your Match Feed to find people with similar goals and interests.</p><p><a class="ui icon button blue" ui-sref="matchfeed">Match Feed</a></p></div></div><div class="ui divided selection list"><div class="ui info message" ng-show="myconnections.noResults && !myconnections.loading && !myconnections.noConnections"><p>No connections found.</p><p>Try with another search term or <a href="" ng-click="myconnections.reset()">reset your search</a>.</p></div><div ng-click="myconnections.gotoConnection($index)" ng-class="{\'unread\': friend.updated_at === null}" class="item repeat-animation" ng-repeat="friend in myconnections.friends track by $index"><div class="ui circular tiny image img-bounding-box" ng-style="{\'background-image\': \'url(//graph.facebook.com/{{ friend.facebook_id }}/picture?type=large)\'}"></div><div class="content"><div class="header">{{friend.first_name}}</div><div class="description"><div class="ui mini statistics"><div class="statistic" tooltips="" tooltip-speed="fast" tooltip-title="Match score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{friend.common_goals_offers_interests}}</div></div><div class="statistic" tooltips="" tooltip-speed="fast" tooltip-title="Mutual friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{friend.totalFriends}}</div></div></div></div></div></div></div><three-bounce-spinner class="page-spinner-bar" ng-show="myconnections.loadingMore"></three-bounce-spinner></div>'),
e.put("app/myprofile/myprofile.html",'<user-profile person="myprofile.user" type="loggedInUser" header="my-profile-header" body="matched-profile-body"></user-profile>'),e.put("app/offercreate/offercreate.html",'<div class="ui top menu fixed borderless" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">3</i></span> Post an offer</div><div class="right menu"><div class="ui item" id="nextButton"><div ng-click="createOffer()" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></div></div></div><div class="ui grid fullheight"><div class="row"><div class="wide column"><div class="body segment"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">3</i></span><div class="content">Post an offer</div><div ng-click="createOffer()" id="nextButtonDesktop" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></h2><h2 class="ui center aligned header withborder">I can help people...<hr></h2><div class="ui attached warning message" id="warningmessage" ng-show="messageShow"><div class="header">Warning</div><p>{{message}}</p></div><div class="ui basic segment"><div class="ui form"><div class="ui center aligned grid"><div class="row"><div class="search-wrapper"><div field-required="false" autocomplete-ui="" minlength="3" input-class="ui input" text-no-results="No existing offer found. Create new offer &raquo;" input-changed="inputChanged" match-class="highlight" selected-object="selectResult" description-field="description[3]" title-field="description" remote-url="/api/v1/subject/?format=json&description__icontains=" remote-url-data-field="objects" type="text" input-name="description" id="id_description" placeholder="enter your offer here"></div></div></div></div></div></div><div class="ui secondary segment" id="instructions" ng-hide="subject !== \'\'"><h4>This should be something you\'re willing to help other people achieve.</h4><br><h4>For example:</h4><p><ul class="unstyled"><li>&quot;Learn to play the banjo&quot;</li><li>&quot;Find a great restaurant&quot;</li><li>&quot;Take care of their pets&quot;</li><li>&quot;Move their 500 lb sofa&quot;</li></ul></p></div></div></div></div></div>'),e.put("app/settings/settings.html",'<div class="ui grid fullheight" id="settingsPage"><div class="row"><div class="wide column"><div class="ui basic segment"><h4 class="ui header dividing">Settings</h4><form class="ui form"><div class="inline fields"><label for="fruit">Distance units:</label><div class="field"><div class="customradio"><input type="radio" ng-model="settings.distanceUnit" value="miles"> <label ng-click="settings.setUnit(\'miles\')">miles</label></div></div><div class="field"><div class="customradio"><input type="radio" ng-model="settings.distanceUnit" value="km"> <label ng-click="settings.setUnit(\'km\')">km</label></div></div></div><div class="ui divider"></div><div ng-click="settings.saveSettings()" class="ui green button" ng-class="{\'disabled\': !settings.userSettingsChanged, \'loading\': settings.loadingSave}">Save</div></form></div><br><br><div class="ui basic segment"><h4 class="ui header dividing">Manage Account</h4><a class="ui icon labeled button" ui-sref-ignore="" href="accounts/logout"><i class="sign out icon"></i> Sign out</a></div><br><br><br><br><br><br><div class="ui basic segment"><h4 class="ui header dividing"></h4><div class="ui deleteitem red icon labeled button" id="deleteAccountButton"><i class="remove circle icon"></i> Delete Account</div></div></div></div></div><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want to delete your account?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div><script>\n\'use strict\';\n$(\'.basic.delete.modal\')\n    .modal({\n        onDeny: function() {},\n        onApprove: function() {\n            angular.element($(\'#settingsPage\')).scope().settings.deleteUser();\n        }\n    })\n    .modal(\'attach events\', \'.deleteitem\', \'show\');\n</script>'),e.put("components/event/event.tpl.html",'<div class="ui basic segment"><form class="ui form"><div class="ui positive message" ng-show="singleevent.showSuccess"><div class="header">New event was successfully created.</div></div><div class="ui negative message" ng-show="singleevent.showError"><div class="header">Warning</div><p ng-repeat="errormsg in singleevent.errorMessage track by $index">{{errormsg}}</p></div><div class="ui large form segment first" id="FirstSegment"><div class="field"><label>Event Name</label> <input autocomplete="off" class="border-bottom" ng-model="singleevent.event.name" placeholder="{{::singleevent.placeholder.name}}" type="text" name="name"></div><div class="field"><label>Location</label><div class="ui action input" id="locationInput"><input autocomplete="off" name="location" attach="\'locationInput\'" google-places-autocomplete="" options="singleevent.autocompleteOptions" placeholder="{{::singleevent.placeholder.location}}" ng-model="singleevent.eventLocation" type="text"> <button ng-class="{\'active\': singleevent.mapurlTrue, \'disabled\': !singleevent.mapurlTrue}" ng-click="singleevent.openMap()" class="ui right icon button location"><i class="marker large icon"></i></button></div></div></div><div class="ui large form segment" id="datePair"><div class="field" ng-class="{\'error\': singleevent.startsTimeError}"><label>Starts</label><div class="ui icon input" id="desktopStartsAt"><input autocomplete="off" class="date start" ng-model="singleevent.starts_on_date" placeholder="{{::singleevent.placeholder.starts}}" type="text" name="starts_on_date"> <i class="calendar icon"></i></div><input name="starts_on" autocomplete="off" ng-change="singleevent.checkDatesStarts()" ng-class="{\'fulldisplay\': singleevent.event.starts_on !== \'\' && singleevent.event.starts_on !== null}" ng-if="singleevent.showMobile" id="startsAtDate" class="border-bottom" placeholder="Starts" step="7200" type="datetime-local" ng-model="singleevent.event.starts_on"> <input autocomplete="off" id="startsAtTime" class="time start" placeholder="{{::singleevent.placeholder.startsTime}}" type="text" ng-model="singleevent.starts_on_time" name="starts_on_time"></div><div class="field" ng-class="{\'error\': singleevent.endsTimeError}"><label>Ends</label><div class="ui icon input" id="desktopEndsAt"><input autocomplete="off" class="date end" ng-model="singleevent.ends_on_date" placeholder="{{::singleevent.placeholder.ends}}" type="text" name="ends_on_date"> <i class="calendar icon"></i></div><input name="ends_on" autocomplete="off" ng-change="singleevent.checkDatesEnds()" ng-class="{\'fulldisplay\': singleevent.event.ends_on !== \'\' && singleevent.event.ends_on !== null}" ng-if="singleevent.showMobile" id="endsAtDate" class="ui border-bottom" placeholder="Ends" step="7200" type="datetime-local" ng-model="singleevent.event.ends_on"> <input autocomplete="off" id="endsAtTime" class="time end" placeholder="{{::singleevent.placeholder.endsTime}}" type="text" ng-model="singleevent.ends_on_time" name="ends_on_time"></div><div class="field"><label>Repeat</label> <input autocomplete="off" name="repeat" id="repeat" placeholder="{{::singleevent.placeholder.repeat}}" type="text" ng-model="singleevent.event.repeat"><div class="ui icon input" id="desktopRepeatUntil"><input autocomplete="off" class="simpledate" ng-model="singleevent.event.repeatUntil" placeholder="{{::singleevent.placeholder.repeatUntil}}" type="text"> <i class="calendar icon"></i></div></div></div><div class="ui large form segment icon-segment"><div class="field button"><label>Costs</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> {{::singleevent.placeholder.costs}}</div></div></div><div class="ui large form segment icon-segment"><div class="field button"><label>Invitations</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> {{::singleevent.placeholder.invitations}}</div></div></div><div class="ui large form segment icon-segment"><div class="field" id="attachmentsDesc"><label>Attachments</label><div class="fluid ui right labeled icon button with-left-icon"><i class="fa-paperclip fa icon large left-icon"></i> <i class="fa-angle-right fa icon large"></i> {{::singleevent.placeholder.attachments}}</div></div><div class="ui divider" id="last-section"></div><div class="field"><label>Description</label> <textarea autocomplete="off" name="description" rows="4" class="border-bottom" placeholder="{{::singleevent.placeholder.description}}" ng-model="singleevent.event.description"></textarea></div></div></form></div><script>\n\'use strict\';\n\n\n// initialize input widgets first\n$(\'#datePair .time\').timepicker({\n    \'showDuration\': true,\n    \'timeFormat\': \'h:i A\',\n    \'scrollDefaultNow\': true\n});\n\n$(\'#datePair .date\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n$(\'#datePair .simpledate\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n\n// initialize datepair\n$(\'#datePair\').datepair({\n    defaultTimeDelta: 3600000,\n});\n</script>'),e.put("components/event/eventattendees.tpl.html",'<div class="ui basic segment" id="event-attendees"><form class="ui form"><div class="fields"><div class="eight wide field attendees"><div class="field-section"><div class="label">Open to: <span class="label number">Public (all Persice users)</span></div><div class="ui divider"></div><div class="label">Guest can invite friends <span class="label number">YES</span></div></div></div><div class="eight wide field attendees"><div class="field-section"><div class="label">Max. attendees <span class="label number">10</span></div><div class="ui divider"></div><div class="label">Spots remaining <span class="label number">2</span></div></div></div></div></form><br><div class="ui header">Attending:</div><div class="ui top attached tabular menu" id="attendeesTabsMenu"><a class="item active withicons" data-tab="first">Yes <span class="ui circular label">2</span></a> <a class="item withicons" data-tab="second">Maybe <span class="ui circular label">1</span></a> <a class="item withicons" data-tab="third">No <span class="ui circular label">1</span></a></div><div class="ui bottom attached tab segment active" data-tab="first"><table class="ui very basic unstackable table attendees-people"><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder=""> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th></tr></thead><tbody><tr ng-repeat="connection in viewevent.connectionsYes track by connection.id"><td><h4 class="ui image header"><img src="http://lorempixel.com/32/32" class="ui circular image"><div class="content">{{::connection.first_name}}, {{::connection.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::connection.tagline}}</div></td><td class="desktopview">{{::connection.match_score}}</td><td class="desktopview">{{::connection.mutual_friends}}</td></tr></tbody></table></div><div class="ui bottom attached tab segment" data-tab="second"><table class="ui very basic unstackable table attendees-people"><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder=""> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th></tr></thead><tbody><tr ng-repeat="connection in viewevent.connectionsNo track by connection.id"><td><h4 class="ui image header"><img src="http://lorempixel.com/32/32" class="ui circular image"><div class="content">{{::connection.first_name}}, {{::connection.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::connection.tagline}}</div></td><td class="desktopview">{{::connection.match_score}}</td><td class="desktopview">{{::connection.mutual_friends}}</td></tr></tbody></table></div><div class="ui bottom attached tab segment" data-tab="third"><table class="ui very basic unstackable table attendees-people"><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder=""> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th></tr></thead><tbody><tr ng-repeat="connection in viewevent.connectionsMaybe track by connection.id"><td><h4 class="ui image header"><img src="http://lorempixel.com/32/32" class="ui circular image"><div class="content">{{::connection.first_name}}, {{::connection.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::connection.tagline}}</div></td><td class="desktopview">{{::connection.match_score}}</td><td class="desktopview">{{::connection.mutual_friends}}</td></tr></tbody></table></div><br></div><script>\n    \'use strict\';\n    $(\'.menu .item\')\n    .tab();\n</script>'),e.put("components/event/eventedit.tpl.html",'<div class="ui basic segment"><form class="ui form" ng-class="{\'loading\': viewevent.loadingEvent}"><div class="ui positive message" ng-show="viewevent.showSuccess"><div class="header">New event was successfully created.</div></div><div class="ui negative message" ng-show="viewevent.showError"><div class="header">Warning</div><p ng-repeat="errormsg in viewevent.errorMessage track by $index">{{errormsg}}</p></div><div class="ui large form segment first" id="FirstSegment"><div class="field"><label>Event Name</label> <input autocomplete="off" class="border-bottom" ng-model="viewevent.eventEdit.name" placeholder="{{::viewevent.placeholder.name}}" type="text" name="name"></div><div class="field"><label>Location</label><div class="ui action input" id="locationInput2"><input autocomplete="off" name="location" attach="\'locationInput2\'" google-places-autocomplete="" options="viewevent.autocompleteOptions" placeholder="{{::viewevent.placeholder.location}}" ng-model="viewevent.eventLocation" type="text"> <button ng-class="{\'active\': viewevent.mapurlTrue, \'disabled\': !viewevent.mapurlTrue}" ng-click="viewevent.openMap()" class="ui right icon button location"><i class="marker large icon"></i></button></div></div></div><div class="ui large form segment" id="datePairEdit"><div class="field" ng-class="{\'error\': viewevent.startsTimeError}"><label>Starts</label><div class="ui icon input" id="desktopStartsAt"><input autocomplete="off" class="date start" ng-model="viewevent.starts_on_date" placeholder="{{::viewevent.placeholder.starts}}" type="text" name="starts_on_date"> <i class="calendar icon"></i></div><input name="starts_on" autocomplete="off" ng-change="viewevent.checkDatesStarts()" ng-class="{\'fulldisplay\': viewevent.eventEdit.starts_on !== \'\' && viewevent.eventEdit.starts_on !== null}" ng-if="viewevent.showMobile" id="startsAtDate" class="border-bottom" placeholder="Starts" type="datetime-local" ng-model="viewevent.eventEdit.starts_on"> <input autocomplete="off" id="startsAtTime" class="time start" placeholder="{{::viewevent.placeholder.startsTime}}" type="text" ng-model="viewevent.starts_on_time" name="starts_on_time"></div><div class="field" ng-class="{\'error\': viewevent.endsTimeError}"><label>Ends</label><div class="ui icon input" id="desktopEndsAt"><input autocomplete="off" class="date end" ng-model="viewevent.ends_on_date" placeholder="{{::viewevent.placeholder.ends}}" type="text" name="ends_on_date"> <i class="calendar icon"></i></div><input name="ends_on" autocomplete="off" ng-change="viewevent.checkDatesEnds()" ng-class="{\'fulldisplay\': viewevent.eventEdit.ends_on !== \'\' && viewevent.eventEdit.ends_on !== null}" ng-if="viewevent.showMobile" id="endsAtDate" class="ui border-bottom" placeholder="Ends" type="datetime-local" ng-model="viewevent.eventEdit.ends_on"> <input autocomplete="off" id="endsAtTime" class="time end" placeholder="{{::viewevent.placeholder.endsTime}}" type="text" ng-model="viewevent.ends_on_time" name="ends_on_time"></div><div class="field"><label>Repeat</label> <input autocomplete="off" name="repeat" id="repeat" placeholder="{{::viewevent.placeholder.repeat}}" type="text" ng-model="viewevent.eventEdit.repeat"><div class="ui icon input" id="desktopRepeatUntil"><input autocomplete="off" class="simpledate" ng-model="viewevent.eventEdit.repeatUntil" placeholder="{{::viewevent.placeholder.repeatUntil}}" type="text"> <i class="calendar icon"></i></div></div></div><div class="ui large form segment icon-segment"><div class="field"><label>Costs</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> {{::viewevent.placeholder.costs}}</div></div></div><div class="ui large form segment icon-segment"><div class="field button"><label>Invitations</label><div class="fluid ui right labeled icon button" ng-click="viewevent.openInvitations()"><i class="fa-angle-right fa icon large"></i> {{::viewevent.placeholder.invitations}}</div></div></div><div class="ui large form segment icon-segment"><div class="field button" id="attachmentsDesc"><label>Attachments</label><div class="fluid ui right labeled icon button with-left-icon"><i class="fa-paperclip fa icon large left-icon"></i> <i class="fa-angle-right fa icon large"></i> {{::viewevent.placeholder.attachments}}</div></div><div class="ui divider" id="last-section"></div><div class="field"><label>Description</label> <textarea autocomplete="off" name="description" rows="4" class="border-bottom" placeholder="{{::viewevent.placeholder.description}}" ng-model="viewevent.eventEdit.description"></textarea></div></div></form></div><div class="ui small modal deletemodal" id="deleteEventModal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><p>Are you sure you want to delete this event?</p></div><div class="actions"><div class="ui negative basic icon labeled button"><i class="remove icon"></i> No</div><a class="ui positive right button icon labeled"><i class="checkmark icon"></i> Yes</a></div></div><script>\n    \'use strict\';\n    $(\'#deleteEventModal\')\n    .modal({\n        onDeny: function() {},\n        onApprove: function() {\n            angular.element($(\'#deleteEventButton\')).scope().viewevent.deleteEvent();\n        }\n    })\n    .modal(\'attach events\', \'#deleteEventButton\', \'show\')\n    .modal(\'setting\', \'allowMultiple\', true);\n</script><script>\n    \'use strict\';\n\n\n// initialize input widgets first\n$(\'#datePairEdit .time\').timepicker({\n    \'showDuration\': true,\n    \'timeFormat\': \'h:i A\',\n    \'scrollDefaultNow\': true\n});\n\n$(\'#datePairEdit .date\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n$(\'#datePairEdit .simpledate\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n\n// initialize datepair\n$(\'#datePairEdit\').datepair({\n    defaultTimeDelta: 3600000,\n});\n\n\n$(".ui.form").scroll(function () {\n  $("input[type=\'text\']:focus").blur();\n});\n\n\n</script>'),e.put("components/event/eventinvitations.tpl.html",'<div class="ui basic segment" id="event-invitations"><div class="ui active inverted dimmer" ng-if="viewevent.loadingInvitesSave"><div class="ui text loader">Please wait while invitations are being sent...</div></div><form class="ui form"><div class="ui header">Who can attend this event?</div><div class="fields"><div class="eight wide field invitations"><div class="field-section"><div class="radio-vertical"><input type="radio" ng-model="viewevent.invitationsOptions.attendingPref" value="myconnections"> <span class="label">Only my connections (default)</span></div><div class="radio-vertical"><input type="radio" ng-model="viewevent.invitationsOptions.attendingPref" value="public"> <span class="label">Public (all Persice users)</span></div><div class="radio-vertical"><input type="radio" ng-model="viewevent.invitationsOptions.attendingPref" value="private"> <span class="label">Private (only select users)</span></div></div></div><div class="eight wide field invitations"><div class="field-section"><div class="label">Max. attendees <span class="label number">10</span></div><div class="ui divider"></div><div class="checkbox-vertical"><input type="checkbox" ng-model="viewevent.invitationsOptions.guestInvite" value="private"> <span class="label">Guests can invite friends</span></div></div></div></div></form><br><div class="ui top attached tabular menu" id="invitationsTabsMenu"><a class="item active" data-tab="first">My Connections</a> <a class="item withicons" data-tab="second"><i class="check large circle icon"></i> Invite List <span class="ui circular label">{{viewevent.invitedPeople.length}}</span></a></div><div class="ui bottom attached tab segment active" data-tab="first" ng-class="{\'loading\': viewevent.loadingConnections}"><table class="ui very basic unstackable table invitations-people" ng-cloak=""><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder="" ng-model="viewevent.connectionFirstName"> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th><th class="desktopview"></th></tr></thead><tbody><tr ng-repeat="connection in viewevent.connections track by connection.friend_id" ng-class="{\'active\': connection.selected}" ng-click="viewevent.markSelected($index)"><td><h4 class="ui image header"><img ng-src="{{::connection.image}}" class="ui circular image"><div class="content">{{::connection.first_name}}, {{::connection.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::connection.tagline}}</div></td><td class="desktopview">{{::connection.common_goals_offers_interests}}</td><td class="desktopview">{{::connection.mutual_friends_count}}</td><td class="selected"><i ng-if="connection.selected" class="check fade icon big circle invite outline" ng-class="{\'green\': !connection.is_invited && connection.selected}"></i></td></tr></tbody></table></div><div class="ui bottom attached tab segment" data-tab="second"><table class="ui very basic unstackable table invitations-people" ng-cloak=""><thead><tr><th class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder=""> <i class="search large icon"></i></div></th><th class="desktopview"></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th><th>RSVP</th><th></th></tr></thead><tbody><tr ng-repeat="connection in viewevent.invitedPeople track by connection.friend_id"><td><h4 class="ui image header"><img ng-src="{{::connection.image}}" class="ui circular image"><div class="content">{{::connection.first_name}}, {{::connection.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::connection.tagline}}</div></td><td class="desktopview">{{::connection.common_goals_offers_interests}}</td><td class="desktopview">{{::connection.mutual_friends_count}}</td><td>{{::connection.rsvp | uppercase}}</td><td class="selected"><i ng-click="viewevent.removeInvite($index)" class="remove fade icon big circle outline red"></i></td></tr></tbody></table></div><br></div><script>\n\'use strict\';\n$(\'.menu .item\')\n    .tab();\n</script>'),e.put("components/event/eventview.tpl.html",'<div class="ui center aligned header" ng-show="viewevent.isHost === true && !viewevent.loadingEvent && !viewevent.eventNotFound">You are the host of this event.</div><div class="row" ng-show="viewevent.isHost === false && !viewevent.loadingEvent && !viewevent.eventNotFound"><div class="wide column"><div class="ui fluid secondary menu" id="event-going-menu"><div class="header item">GOING?</div><a class="item" ng-click="viewevent.changeRsvpStatus(\'yes\')" ng-class="{active: viewevent.eventRsvp.status === \'yes\'}">YES</a> <a class="item" ng-click="viewevent.changeRsvpStatus(\'no\')" ng-class="{active: viewevent.eventRsvp.status === \'no\'}">NO</a> <a class="item" ng-click="viewevent.changeRsvpStatus(\'maybe\')" ng-class="{active: viewevent.eventRsvp.status === \'maybe\'}">MAYBE</a></div></div></div><div class="ui negative message" ng-show="viewevent.eventNotFound && !viewevent.loadingEvent"><div class="header">Warning</div><p>This event doesn\'t exist anymore.</p></div><div class="ui basic segment" ng-class="{\'hidevisibility\': viewevent.eventNotFound}"><form class="ui form" ng-class="{\'loading\': viewevent.loadingEvent}"><div class="ui large form segment first editable" id="FirstSegment"><div class="field"><label class="specialpadding">Event Name</label><div class="eventcontent"><span id="eventName">{{viewevent.event.name}}</span></div></div><div class="ui divider" id="last-section"></div><div class="field" id="locationField"><label class="specialpadding">Location</label><div class="eventcontent" ng-class="{\'urlexists\': viewevent.mapurlTrue}"><i ng-click="viewevent.openMap()" class="marker large icon"></i> <span class="locationContent"><span ng-if="viewevent.event.location_name.trim() !== viewevent.event.city.trim()">{{viewevent.event.location_name}}</span> <span><br ng-if="viewevent.event.location_name.trim() !== viewevent.event.city.trim() && viewevent.event.location_name !== null && viewevent.event.location_name.trim() !== \'\' && viewevent.event.location_name.trim() !== viewevent.event.street.trim()"><span ng-if="viewevent.event.street !== null && viewevent.event.street.trim() !== \'\' && viewevent.event.location_name.trim() !== viewevent.event.street.trim()">{{viewevent.event.street}}<br></span> <span ng-if="viewevent.event.city !== null && viewevent.event.city.trim() !== \'\'">{{viewevent.event.city}} {{viewevent.event.zipcode}} {{viewevent.event.state}}</span></span></span></div></div></div><div class="ui large form segment" id="DatesSection" ng-if="viewevent.showMobile"><div class="field"><span>{{viewevent.firstrow}}</span></div><div class="ui divider" id="last-section"></div><div class="field"><span class="timeslot">{{viewevent.secondrow}}</span> <span class="repeats">repeats weekly</span><div class="cleardiv"></div></div><div class="ui divider" id="last-section"></div><div class="field"><span class="cost"><strong>Cost:</strong> $25 (in advance)</span> <span class="paid"><i class="fa fa-check icon"></i><strong>PAID</strong></span><div class="cleardiv"></div></div></div><div class="ui large form segment" id="DatesSection" ng-if="!viewevent.showMobile"><div class="field"><label class="specialpadding">Starts</label><div class="eventcontent"><span>{{viewevent.firstrow}}</span></div></div><div class="ui divider" id="last-section"></div><div class="field"><label class="specialpadding">Ends</label><div class="eventcontent"><span class="timeslot">{{viewevent.secondrow}}</span> <span class="repeats">repeats weekly</span><div class="cleardiv"></div></div></div><div class="ui divider" id="last-section"></div><div class="field"><label class="specialpadding">Cost</label><div class="eventcontent"><span class="cost">$25 (in advance)</span> <span class="paid"><i class="fa fa-check icon"></i><strong>PAID</strong></span><div class="cleardiv"></div></div></div></div><div class="ui large form segment" id="HostedSection" ng-if="!viewevent.showMobile"><div class="field"><label class="specialpadding">Hosted By</label><div class="eventcontent"><span>{{viewevent.event.hosted_by}}</span></div></div><div class="ui divider" id="last-section"></div><div class="field"><label class="specialpadding">Attending</label><div class="ui right labeled icon button widthFull" ng-click="viewevent.openAttendees();"><span class="total-people">{{viewevent.event.friend_attendees_count}} people total</span> <span class="connections-people">0 connections</span> <span class="remaining-spots">0 spots remaining</span><div class="cleardiv"></div><i class="fa-angle-right fa icon large"></i></div></div></div><div class="ui large form segment" id="HostedSection" ng-if="viewevent.showMobile"><div class="field">Host: <span>{{viewevent.event.hosted_by}}</span></div><div class="ui divider" id="last-section"></div><div class="field attendees-view" ng-click="viewevent.openAttendees();"><span class="label">Attendees:</span><div class="attendees-values"><span class="total-people">{{viewevent.event.friend_attendees_count}} people total</span> <span class="connections-people">0 connections</span> <span class="remaining-spots">0 spots remaining</span></div><i class="fa-angle-right fa icon large"></i></div></div><div class="ui large form segment icon-segment"><div class="field"><label class="specialpadding">Group Chat</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> 15 messages</div></div></div><div class="ui large form segment" id="eventDescription"><div class="field" ng-if="viewevent.showMobile"><span>Event Description:</span></div><div class="ui divider" id="last-section" ng-if="viewevent.showMobile"></div><div class="field"><label class="specialpadding">Description</label><div class="eventcontent"><span>{{viewevent.event.description}}</span></div></div></div></form></div>'),e.put("components/eventsfeed/eventsfeed.directive.html","<ng-include src=\"'components/eventsfeed/eventsfeed.tpl.html'\"></ng-include>"),e.put("components/eventsfeed/eventsfeed.tpl.html",'<div id="eventsfeed-list-body" class="basic ui segment" ng-class="{\'loading\': eventsfeed.loading}" when-scroll-ends="eventsfeed.loadMoreEvents()"><div class="ui basic segment notice" ng-if="eventsfeed.noEvents"><div class="ui info message"><p>You don\'t have any events.</p></div></div><div class="eventgroup" ng-repeat="eventcontent in eventsfeed.events track by $index"><div class="eventdate">{{eventcontent.date}}</div><a class="ui fluid card" ng-click="eventsfeed.gotoEvent(event.id)" ng-repeat="event in eventcontent.items track by $index"><div class="image"><img src="/static/img/placeholder-image.jpg"></div><div class="content"><div class="header">{{event.name}}</div><div class="meta"><span ng-if="event.location_name.trim() !== event.city.trim()">{{event.location_name}}</span> <span><br ng-if="event.location_name.trim() !== event.city.trim() && event.location_name !== null && event.location_name.trim() !== \'\' && event.location_name.trim() !== event.street.trim()"><span ng-if="event.street !== null && event.street.trim() !== \'\' && event.location_name.trim() !== event.street.trim()">{{event.street}}<br></span> <span ng-if="event.city !== null && event.city.trim() !== \'\'">{{event.city}} {{event.zipcode}} {{event.state}}</span></span><div class="description"><div class="ui mini statistics"><div class="statistic" data-tooltip="Match Score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{event.cumulative_match_score}}</div></div><div class="statistic" data-tooltip="Total Friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{event.friend_attendees_count}}</div></div></div></div></div><div class="extra content distance">{{event.distance[0]}} {{event.distance[1]}} away</div></div></a></div><three-bounce-spinner class="page-spinner-bar" ng-show="eventsfeed.loadingMore"></three-bounce-spinner></div>'),
e.put("components/filter/matchfeedFilter.directive.html",'<div id="FilterController" class="{{filter.class}}" ng-cloak=""><h4 class="ui header" ng-show="filter.class === \'desktopview\'">FILTERS</h4><div class="ui fitted divider" ng-show="filter.class === \'desktopview\'"></div><div id="{{filter.id}}" class="ui form"><form name="filterForm" id="filterForm"><div class="field"><label>Distance <span class="range">{{filter.distanceValue}} {{filter.distanceUnit}}</span></label><rzslider rz-slider-always-show-bar="true" rz-slider-hide-limit-labels="false" rz-slider-model="filter.distanceValue" rz-slider-floor="1" rz-slider-ceil="10000"></rzslider></div><div class="field"><label>Age <span class="range">{{filter.ageSlider.min}} &ndash; {{filter.ageSlider.max}}</span></label><rzslider rz-slider-hide-limit-labels="false" rz-slider-floor="filter.ageSlider.floor" rz-slider-ceil="filter.ageSlider.ceil" rz-slider-model="filter.ageSlider.min" rz-slider-high="filter.ageSlider.max"></rzslider></div><div class="field"><label class="">Show</label></div><div class="field field-checkbox"><uicheckbox value="m" change="filter.toggleGender(value, checked)" checked="{{filter.checkedmale}}" type="toggle" ng-model="filter.male">Men</uicheckbox></div><div class="field field-checkbox"><uicheckbox value="f" change="filter.toggleGender(value, checked)" checked="{{filter.checkedfemale}}" type="toggle" ng-model="filter.female">Women</uicheckbox></div><div class="field"><label class="">Order By</label></div><div class="field"><select class="persiceselect" ng-change="filter.saveFiltersDebounce()" ng-options="item.value as item.name for item in filter.orderByValues" ng-model="filter.orderBy"></select></div><div class="field keywords-label"><label class="">Keywords</label></div><div class="field" ng-show="filter.showFilterMessage"><label><div class="ui small negative message"><p>{{filter.filtermessage}}</p></div></label></div><div class="field"><div class="ui action input"><input ng-minlength="3" type="text" placeholder="Enter keyword" ng-enter="filter.addKeyword(filter.newKeyword)" ng-model="filter.newKeyword"> <button ng-click="filter.addKeyword(filter.newKeyword)" class="ui icon button"><i class="plus icon"></i></button></div></div><a ng-click="filter.removeKeyword($index)" href="" class="item" ng-repeat="keyword in filter.myKeywords track by $index"><div class="content"><div class="header"><i class="circle remove icon"></i> {{keyword}}</div></div></a><div class="ui divider"></div><a href="" class="button ui submit green" ng-class="{\'disabled\': !filter.changed}" ng-click="filter.refreshMatchFeed()" role="button">Update</a></form></div></div>'),e.put("components/filterEvents/filterEvents.template.html",'<div id="FilterController" class="{{filter.class}}" ng-cloak=""><h4 class="ui header" ng-show="filter.class === \'desktopview\'">FILTERS</h4><div class="ui fitted divider" ng-show="filter.class === \'desktopview\'"></div><div id="{{filter.id}}" class="ui form"><form name="filterForm" id="filterForm"><div class="field"><label>Distance <span class="range">{{filter.distanceValue}} {{filter.distanceUnit}}</span></label><rzslider rz-slider-always-show-bar="true" rz-slider-hide-limit-labels="false" rz-slider-model="filter.distanceValue" rz-slider-floor="1" rz-slider-ceil="10000"></rzslider></div><div class="field keywords-label"><label class="">Keywords</label></div><div class="field" ng-show="filter.showFilterMessage"><label><div class="ui small negative message"><p>{{filter.filtermessage}}</p></div></label></div><div class="field"><div class="ui action input"><input ng-minlength="3" type="text" placeholder="Enter keyword" ng-enter="filter.addKeyword(filter.newKeyword)" ng-model="filter.newKeyword"> <button ng-click="filter.addKeyword(filter.newKeyword)" class="ui icon button"><i class="plus icon"></i></button></div></div><a ng-click="filter.removeKeyword($index)" href="" class="item" ng-repeat="keyword in filter.myKeywords track by $index"><div class="content"><div class="header"><i class="circle remove icon"></i> {{keyword}}</div></div></a><div class="ui divider"></div><a href="" class="button ui submit green" ng-class="{\'disabled\': !filter.changed}" ng-click="filter.refreshEventsFeed()" role="button">Update</a></form></div></div>'),e.put("components/matchfeedprofile/matchfeedprofile.template.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><div ng-if="userprofile.total > 0"><three-bounce-spinner ng-show="userprofile.loadingFeed" class="ui inverted dimmer transition visible active"></three-bounce-spinner><div ng-show="!showDimmer"><div class="dimmable"><h2 class="ui dividing header" id="desktopmatchheader" ng-if="userprofile.showfullprofile">{{ userprofile.user.first_name }}, {{ userprofile.user.age }}<div class="action-header"><div ng-click="userprofile.cancelMatchDesktop()" class="ui circular icon negative button"><i class="remove icon"></i></div><div ng-click="userprofile.confirmMatchDesktop()" class="ui circular icon positive button"><i class="check icon"></i></div></div><div class="sub header">{{userprofile.user.distance[0]}} {{userprofile.user.distance[1]}}<ng-include src="\'components/profile/statistics-horizontal.tpl.html\'"></ng-include></div></h2><div class="ui basic segment" id="matchfeedheader-slider" ng-if="userprofile.showfullprofile"><ng-include src="\'components/profile/headerphotoslider.tpl.html\'"></ng-include></div><div class="header segment" id="matched-profile-header" ng-hide="userprofile.showfullprofile"><div class="ui basic segment"><div ng-click="userprofile.changeTopMenu()" ng-show="userprofile.photosSlider[0].cropped_photo === \'\'" class="ui circular middle aligned left floated small image img-bounding-box" style="background-image: url(\'{{userprofile.photosSlider[0].photo}}\');"></div><div ng-click="userprofile.changeTopMenu()" ng-show="userprofile.photosSlider[0].cropped_photo !== \'\'" class="ui circular middle aligned left floated small image img-bounding-box" style="background-image: url(\'{{userprofile.photosSlider[0].cropped_photo}}\');"></div><h2 ng-click="userprofile.changeTopMenu()" class="ui header">{{ userprofile.user.first_name }}, {{ userprofile.user.age }}<div class="sub header">{{userprofile.user.distance[0]}} {{userprofile.user.distance[1]}}</div></h2><ng-include src="\'components/profile/statistics.tpl.html\'"></ng-include></div></div><div class="body segment" id="matched-profile-body" ng-click="userprofile.changeTopMenu()"><div class="ui attached segment" ng-show="userprofile.showfullprofile" id="mobilematchheader"><h3 class="ui left floated header">{{ userprofile.user.first_name }}, {{ userprofile.user.age }}</h3><h5 class="ui right floated header">{{userprofile.user.distance[0]}} {{userprofile.user.distance[1]}}</h5><br><ng-include src="\'components/profile/statistics-horizontal.tpl.html\'"></ng-include></div><div class="ui attached segment"><ng-include src="\'components/profile/profilebody.tpl.html\'"></ng-include></div></div><div class="footer segment" id="matched-profile-footer" ng-hide="userprofile.showfullprofile || userprofile.total === 0"><div class="ui grid one column aligned center"><div class="row"><div class="column"><div class="ui labeled icon menu"><a href="" ng-click="userprofile.cancelMatch()" class="item" id="left_button"><i class="remove red circle icon"></i></a> <a href="" ng-click="userprofile.confirmMatch()" class="item" id="accept_button"><i class="check green circle icon"></i></a></div></div></div></div><br></div></div></div></div><div class="body segment" ng-show="userprofile.total === 0 && !userprofile.loadingFeed"><div class="ui info message"><div class="header">Sorry. Currently you don\'t have any matches.</div><p>Add more information to your profile. <a class="ui icon mini button blue" ui-sref="myprofile"><i class="angle double right icon"></i></a></p><p>Adjust your match filter to be less restrictive. <a class="ui icon mini button blue" id="showFilter" href=""><i class="angle double right icon"></i></a></p></div></div></div></div></div><page-dimmer ng-model="userprofile.showDimmer" show="true"><h1 class="ui header"><img src="/static/appFrontend/dist/assets/images/logo/app-logo-big.png" class="ui medium image centered" alt=""></h1><h2 class="ui header">Locating people with similar goals...</h2><fading-circle-spinner></fading-circle-spinner></page-dimmer><script>\n\'use strict\';\n\n$(\'.right.sidebar.matchfeedfilter\')\n    .sidebar(\'attach events\', \'#showFilter\', \'show\');\n$(\'#showFilter\')\n    .removeClass(\'disabled\');\n</script>'),e.put("components/modal/modalcreate.html",'<div class="ui modal small centeraligned" id="createEventsModal"><div class="header">Create Event <i class="close icon" ng-click="singleevent.closeEventModal()"></i></div><div class="content"><ng-include src="\'components/event/event.tpl.html\'"></ng-include></div><div class="actions"><div class="ui green labeled icon right button" ng-click="singleevent.saveEvent()">Create <i class="plus circle icon"></i></div></div></div>'),e.put("components/modal/modalview.html",'<div class="ui modal centeraligned" ng-class="viewevent.getActiveClass()" id="{{viewevent.modalId}}"><div class="header" ng-class="{\'leftalign\': viewevent.selection === \'invitations\' || viewevent.selection === \'attendees\'}">{{viewevent.header}} <i class="close icon" ng-click="viewevent.closeEventModal()"></i> <i ng-if="viewevent.selection === \'invitations\'" class="left chevron icon" ng-click="viewevent.closeInvitations()"></i> <i ng-if="viewevent.selection === \'attendees\'" class="left chevron icon" ng-click="viewevent.closeAttendees()"></i></div><div class="content"><div class="switch-content" ng-switch="" on="viewevent.selection"><div ng-switch-when="view"><ng-include src="\'components/event/eventview.tpl.html\'"></ng-include></div><div ng-switch-when="edit"><ng-include src="\'components/event/eventedit.tpl.html\'"></ng-include></div><div ng-switch-when="invitations"><ng-include src="\'components/event/eventinvitations.tpl.html\'"></ng-include></div><div ng-switch-when="attendees"><ng-include src="\'components/event/eventattendees.tpl.html\'"></ng-include></div></div></div><div class="actions"><div ng-if="viewevent.isHost && viewevent.selection === \'view\'" class="ui green labeled icon right button" ng-click="viewevent.editEvent()">Edit <i class="edit icon"></i></div><div ng-if="viewevent.selection === \'edit\'" class="ui green labeled icon right button" ng-click="viewevent.saveEvent()">Save <i class="save icon"></i></div><div id="deleteEventButton" ng-if="viewevent.selection === \'edit\'" class="ui red icon labeled left button" ng-click="viewevent.editEvent()">Delete <i class="remove icon"></i></div><div ng-if="viewevent.selection === \'invitations\'" class="ui green right labeled button" ng-class="{\'disabled\': viewevent.counterNewInvites === 0}" ng-click="viewevent.sendInvites()">Done</div></div></div>'),e.put("components/profile/headerphotoslider.tpl.html",'<div class="pagination-container"><div id="PhotoSlider" ng-if="userprofile.photosSlider.length > 0"><flex-slider slider-id="photoSlider" touch="true" slideshow="false" slide="item in userprofile.photosSlider | orderBy:\'order\' track by $index"><li><img ng-click="userprofile.nextImage()" ng-show="item.cropped_photo === \'\'" class="ui image" ng-src="{{item.photo}}"> <img ng-click="userprofile.nextImage()" ng-show="item.cropped_photo !== \'\'" class="ui image" ng-src="{{item.cropped_photo}}"></li></flex-slider></div></div>'),e.put("components/profile/profilebody.tpl.html",'<h4 class="ui header" ng-if="userprofile.user.goals.length > 0 || userprofile.type === \'loggedInUser\'">Goals</h4><div class="ui list" ng-if="userprofile.type === \'matchfeed\'"><div ng-hide="!userprofile.showfullprofile && $index > 2" class="item" ng-repeat="goal in userprofile.user.goals | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': goal.match === 1, \'empty smallicon\': goal.match === 0 }"></i><div class="content"><div class="description">{{ goal.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'friend\'"><div ng-hide="!userprofile.showfullprofile" class="item" ng-repeat="goal in userprofile.user.goals | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': goal.match === 1, \'empty smallicon\': goal.match === 0 }"></i><div class="content"><div class="description">{{ goal.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="goal in userprofile.user.goals track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ goal.subject }}</div></div></div><p ng-if="userprofile.user.goals.length === 0">No goals yet.</p></div><h4 class="ui header" ng-if="userprofile.user.offers.length > 0 || userprofile.type === \'loggedInUser\'">Offers</h4><div class="ui list" ng-if="userprofile.type === \'matchfeed\'"><div ng-hide="!userprofile.showfullprofile && $index > 2" class="item" ng-repeat="offer in userprofile.user.offers | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': offer.match === 1, \'empty smallicon\': offer.match === 0 }"></i><div class="content"><div class="description">{{ offer.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'friend\'"><div ng-hide="!userprofile.showfullprofile" class="item" ng-repeat="offer in userprofile.user.offers | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': offer.match === 1, \'empty smallicon\': offer.match === 0 }"></i><div class="content"><div class="description">{{ offer.value }}</div></div></div></div><div class="ui list" ng-show="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="offer in userprofile.user.offers track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ offer.subject }}</div></div></div><p ng-if="userprofile.user.offers.length === 0">No offers yet.</p></div><h4 class="ui header" ng-if="userprofile.user.about_me.length > 0 && userprofile.showfullprofile">About</h4><div class="ui list" ng-if="userprofile.user.about_me.length > 0 && userprofile.showfullprofile"><div class="item"><i class="empty icon"></i><div class="content"><div class="description"><span>{{userprofile.user.about_me}}</span></div></div></div></div><h4 class="ui header" ng-if="userprofile.user.interests.length > 0 || userprofile.type === \'loggedInUser\'">Activities &amp; Interests</h4><div class="ui list" ng-if="userprofile.type === \'matchfeed\'"><div class="item" ng-hide="!userprofile.showfullprofile && $index > 2" ng-repeat="interest in userprofile.user.interests | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': interest.match === 1, \'empty smallicon\': interest.match === 0 }"></i><div class="content"><div class="description">{{ interest.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'friend\'"><div class="item" ng-hide="!userprofile.showfullprofile" ng-repeat="interest in userprofile.user.interests | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': interest.match === 1, \'empty smallicon\': interest.match === 0 }"></i><div class="content"><div class="description">{{ interest.value }}</div></div></div></div><div class="ui list" ng-show="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="interest in userprofile.user.interests | limitTo:5 track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ interest.interest_subject }}</div></div></div><p ng-if="userprofile.user.interests.length === 0">No interests yet.</p></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.friends.length > 0" class="ui header">Mutual Friends</h4><div ng-if="userprofile.showfullprofile && userprofile.user.friends.length > 0" class="ui selection list"><a ui-sref="friendprofile({ userId: userprofile.friend.user_id })" class="item" ng-repeat="friend in userprofile.user.friends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></a></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.facebookfriends.length > 0" class="ui header">Mutual Facebook Friends ({{ userprofile.user.facebookfriends.length }})</h4><div ng-if="userprofile.showfullprofile && userprofile.user.facebookfriends.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.facebookfriends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></div></div><h4 ng-if="showfullprofile && userprofile.user.twitterfriends.length > 0" class="ui header">Mutual Twitter Friends ({{ userprofile.user.twitterfriends.length }})</h4><div ng-if="showfullprofile && userprofile.user.twitterfriends.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.twitterfriends track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="showfullprofile && userprofile.user.twitterfollowers.length > 0" class="ui header">Mutual Twitter Followers ({{ userprofile.user.twitterfollowers.length }})</h4><div ng-if="showfullprofile && userprofile.user.twitterfollowers.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.twitterfollowers track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="showfullprofile && userprofile.user.linkedinconnections.length > 0" class="ui header">Mutual LinkedIn Connections ({{ userprofile.user.linkedinconnections.length }})</h4><div ng-if="showfullprofile && userprofile.user.linkedinconnections.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.linkedinconnections track by $index"><img class="ui avatar image" ng-src="{{friend.pictureUrls.values[0]}}"><div class="content"><div class="header">{{ friend.firstName }}</div></div></div></div><h4 class="ui header" ng-if="userprofile.user.likes.length > 0 || userprofile.type === \'loggedInUser\'">Likes</h4><div class="ui list likes" ng-if="userprofile.type === \'matchfeed\'"><div class="item" ng-hide="!userprofile.showfullprofile && $index > 2" ng-repeat="like in userprofile.user.likes | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': like.match === 1, \'empty smallicon\': like.match === 0 }"></i><div class="content"><div class="description">{{ like.value }}</div></div></div></div><div class="ui list likes" ng-if="userprofile.type === \'friend\'"><div class="item" ng-hide="!userprofile.showfullprofile" ng-repeat="like in userprofile.user.likes | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': like.match === 1, \'empty smallicon\': like.match === 0 }"></i><div class="content"><div class="description">{{ like.value }}</div></div></div></div><div class="ui list likes" ng-show="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="like in userprofile.user.likes | limitTo:5 track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ like.name }}</div></div></div><p ng-if="userprofile.user.likes.length == 0">No likes yet.</p></div><h4 class="ui header socialprofileheader" ng-if="(userprofile.social.linkedin !== \'\' || userprofile.social.twitter !== \'\' || userprofile.social.facebook !== \'\') && userprofile.showfullprofile">Social Accounts</h4><br ng-if="userprofile.social.linkedin.length > 0"><a href="{{ userprofile.social.linkedin }}" target="_new" class="ui social icon fluid linkedin labeled button" ng-if="userprofile.social.linkedin.length > 0 && userprofile.showfullprofile"><i class="linkedin icon"></i> {{userprofile.user.first_name}} <i class="check circle icon right"></i></a><br ng-if="userprofile.social.twitter.length > 0"><a href="https://twitter.com/{{ userprofile.social.twitter }}" target="_new" class="ui social fluid icon twitter labeled button" ng-if="userprofile.social.twitter.length > 0 && userprofile.showfullprofile"><i class="twitter icon"></i> {{userprofile.social.twitter}} <i class="check circle icon right"></i></a><br ng-if="userprofile.social.facebook.length > 0"><a href="{{ userprofile.social.facebook }}" class="ui social icon facebook labeled fluid button" ng-if="userprofile.social.facebook.length > 0 && userprofile.showfullprofile"><i class="facebook icon"></i> {{userprofile.user.first_name}} <i class="lock icon right"></i></a>'),e.put("components/profile/statistics-horizontal.tpl.html",'<div class="ui mini horizontal statistics"><div class="statistic" tooltips="" tooltip-speed="fast" tooltip-title="Match score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{userprofile.totalmatchingcount}}</div></div><div class="statistic" tooltips="" tooltip-speed="fast" tooltip-title="Mutual friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{userprofile.totalfriendscount}}</div></div></div>'),e.put("components/profile/statistics.tpl.html",'<div class="ui mini statistics"><div class="statistic" tooltips="" tooltip-speed="fast" tooltip-title="Match score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{userprofile.totalmatchingcount}}</div></div><div class="statistic" tooltips="" tooltip-speed="fast" tooltip-title="Mutual friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{userprofile.totalfriendscount}}</div></div></div>'),e.put("components/userprofile/userprofile.template.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><div class="header segment with-menu" id="{{userprofile.header}}"><ng-include src="\'components/profile/headerphotoslider.tpl.html\'"></ng-include></div><div class="body segment" id="{{userprofile.body}}"><div class="ui top attached segment" id="userProfileName"><h3 class="ui left floated header">{{ userprofile.user.first_name }}<span ng-hide="userprofile.user.first_name === \'\'">,</span> {{ userprofile.user.age }}</h3><h5 id="editbutton" ng-if="userprofile.type === \'loggedInUser\'" class="ui right floated header"><a ui-sref="editmyprofile" class="ui tiny button blue">Edit</a></h5><h5 id="editbutton" ng-if="userprofile.type === \'friend\'" class="ui right floated header">{{ userprofile.user.distance[0] }} {{ userprofile.user.distance[1] }}</h5></div><div class="ui attached segment"><ng-include src="\'components/profile/profilebody.tpl.html\'"></ng-include></div></div></div></div></div>')}]);