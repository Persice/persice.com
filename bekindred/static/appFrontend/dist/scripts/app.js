"use strict";angular.module("persice",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","angular-spinkit","frontend.semantic.dimmer","frontend.semantic.modal.event.create","frontend.semantic.modal.event.view","truncate","ngDraggable","cgNotify","ngImgCrop","angularMoment","btford.socket-io","ngLodash","hj.gsapifyRouter","angular-flexslider","ngGeolocation","ezfb","frontend.ui.tooltips","frontend.ui.autocomplete","google.places","ngMask","rzModule","easypiechart"]).config(["$compileProvider","$stateProvider","$urlRouterProvider","APP_ID","$httpProvider","$resourceProvider","gsapifyRouterProvider","ezfbProvider",function(e,t,i,n,s,a,o,r){r.setInitParams({appId:n,version:"v2.3",status:!0,xfbml:!0}),s.defaults.headers.patch={"Content-Type":"application/json;charset=utf-8"},a.defaults.stripTrailingSlashes=!1,s.defaults.xsrfCookieName="csrftoken",s.defaults.xsrfHeaderName="X-CSRFToken",s.defaults.headers.post={"Content-Type":"application/json;charset=utf-8"},o.defaults={enter:"fadeIn",leave:"fadeOut"},o.transition("slideAbove",{duration:1,ease:"Quart.easeInOut",css:{y:"-100%"}}),o.transition("slideBelow",{duration:1,ease:"Quart.easeInOut",css:{y:"100%"}}),o.transition("slideLeft",{duration:1,ease:"Quint.easeInOut",css:{x:"-100%"}}),o.transition("slideRight",{duration:1,ease:"Quint.easeInOut",delay:.5,css:{x:"100%"}}),o.transition("fadeIn",{duration:.5,delay:.2,css:{opacity:0}}),o.transition("fadeOut",{duration:.2,css:{opacity:0}}),o.transition("scaleDown",{duration:.5,css:{scale:0,opacity:0}}),o.initialTransitionEnabled=!0,t.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl",data:{displayName:"persice"},resolve:{}}).state("settings",{url:"/settings",templateUrl:"app/settings/settings.html",controller:"SettingsController",controllerAs:"settings",data:{displayName:"Settings"},resolve:{}}).state("conversations",{url:"/conversation/:userId",data:{displayName:"Conversations"},resolve:{userId:["$stateParams",function(e){return e.userId}],UsersFactory:"UsersFactory",FRIEND:["UsersFactory","$stateParams",function(e,t){var i=t.userId;return e.get({userId:i,format:"json"}).$promise}],ConnectionsFactory:"ConnectionsFactory",Connection:["ConnectionsFactory","$stateParams",function(e,t){var i=t.userId;return e.query({friend:i,format:"json"}).$promise}]},templateUrl:"app/conversations/conversations.html",controller:"ConversationsCtrl"}).state("goalcreate",{url:"/create-goal",data:{displayName:"Create a goal"},templateUrl:"app/goalcreate/goalcreate.html",controller:"GoalCreateCtrl"}).state("finalstep",{url:"/final-step",data:{displayName:"Final Step"},resolve:{UsersFactory:"UsersFactory",User:["UsersFactory","USER_ID",function(e,t){var i=t;return e.get({userId:i,format:"json"}).$promise}]},templateUrl:"app/finalstep/finalstep.html",controller:"FinalStepController",controllerAs:"finalstep"}).state("selectinterests",{url:"/select-interests",data:{displayName:"What interests you?"},templateUrl:"app/interests/interests.html",controller:"InterestsController",controllerAs:"interest"}).state("offercreate",{url:"/create-offer",data:{displayName:"Post an offer"},templateUrl:"app/offercreate/offercreate.html",controller:"OfferCreateCtrl"}).state("matchfeed",{url:"/crowd",data:{displayName:"Crowd"},templateUrl:"app/matchfeed/matchfeed.html",controller:"MatchFeedController",controllerAs:"matchfeed"}).state("matchfeed2",{url:"/crowd2",data:{displayName:"Crowd"},templateUrl:"app/matchfeed/crowd.html",controller:"CrowdController",controllerAs:"crowd"}).state("bigmatchfeed",{url:"/big-crowd",data:{displayName:"Crowd"},templateUrl:"app/bigmatchfeed/bigmatchfeed.html",controller:"BigMatchFeedCtrl"}).state("myconnections",{url:"/my-connections",data:{displayName:"Connections"},templateUrl:"app/myconnections/myconnections.html",controller:"MyConnectionsController",controllerAs:"myconnections"}).state("friendprofile",{url:"/friend-profile/:userId",data:{displayName:"Connection"},resolve:{userId:["$stateParams",function(e){return e.userId}],ConnectionsFactory:"ConnectionsFactory",UsersFactory:"UsersFactory",UserProfile:["UsersFactory","$stateParams",function(e,t){return e.query({userId:t.userId,format:"json"}).$promise}],Connection:["ConnectionsFactory","$stateParams",function(e,t){var i=t.userId;return e.query({friend:i,format:"json"}).$promise}]},templateUrl:"app/friendprofile/friendprofile.html",controller:"FriendProfileController",controllerAs:"friendprofile"}).state("myprofile",{url:"/my-profile",data:{displayName:"Profile"},templateUrl:"app/myprofile/myprofile.html",controller:"MyProfileController",controllerAs:"myprofile"}).state("editmyprofile",{url:"/my-profile/edit",data:{displayName:"Edit profile"},templateUrl:"app/editmyprofile/editmyprofile.html",controller:"EditMyProfileCtrl"}).state("inbox",{url:"/messages",data:{displayName:"Messages"},templateUrl:"app/inbox/inbox.html",controller:"InboxController",controllerAs:"inbox"}).state("events",{"abstract":!0,url:"/events",templateUrl:"app/events/events_page.html",controller:"EventsPageController",controllerAs:"eventspage",resolve:{},data:{displayName:""}}).state("events.mynetwork",{url:"/my-network",template:"<ui-view/>"}).state("events.mynetwork.list",{url:"/list",template:'<events-feed type="events.mynetwork"></events-feed>',data:{eventsFeedType:"events.mynetwork"}}).state("events.mynetwork.map",{url:"/map",template:'<events-map type="events.mynetwork"></events-map>',data:{eventsFeedType:"events.mynetwork"}}).state("events.myevents",{url:"/my-events",template:"<ui-view/>"}).state("events.myevents.list",{url:"/list",template:'<events-feed type="events.myevents"></events-feed>',data:{eventsFeedType:"events.myevents"}}).state("events.myevents.map",{url:"/map",template:'<events-map type="events.mynetwork"></events-map>',data:{eventsFeedType:"events.myevents"}}).state("events.allevents",{url:"/all-events",template:"<ui-view/>"}).state("events.allevents.list",{url:"/list",template:'<events-feed type="events.allevents"></events-feed>',data:{eventsFeedType:"events.allevents"}}).state("events.allevents.map",{url:"/map",template:'<events-map type="events.mynetwork"></events-map>',data:{eventsFeedType:"events.allevents"}}).state("event",{url:"/event","abstract":!0,templateUrl:"app/events/event.html",controller:"EventPageController",controllerAs:"eventpage",resolve:{},data:{displayName:"Event Details"}}).state("event.create",{url:"/create",templateUrl:"app/events/event_create.html",controller:"EventCreateController",controllerAs:"singleevent",data:{displayName:"Event Details"}}).state("event.chat",{url:"/chat/:eventId",templateUrl:"app/events/event_chat.html",controller:"EventChatController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Event Chat"}}).state("event.edit",{url:"/edit/:eventId",templateUrl:"app/events/event_edit.html",controller:"EventEditController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Event Details"}}).state("event.invitations",{url:"/invitations/:eventId",templateUrl:"app/events/event_invitations.html",controller:"EventInvitationsController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Invitations"}}).state("event.attendees",{url:"/attendees/:eventId",templateUrl:"app/events/event_attendees.html",controller:"EventAttendeesController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Attendees"}}).state("event.details",{url:"/details/:eventId",templateUrl:"app/events/event_view.html",controller:"EventViewController",controllerAs:"viewevent",resolve:{eventId:["$stateParams",function(e){return e.eventId}]},data:{displayName:"Event Details"}}).state("search",{url:"/search",templateUrl:"app/search/search.html",controller:"SearchPageController",controllerAs:"search",resolve:{},data:{displayName:"Search Users and Events"}}),i.otherwise("/")}]).run(["$rootScope","$state","$stateParams","$timeout","ezfb",function(e,t,i,n,s){e.$state=t,e.isState=function(e){return t.includes(e)},e.$stateParams=i,e.$on("$stateChangeStart",function(e,t){$(".sidebar").sidebar("is visible")&&$(".sidebar").sidebar("hide")}),e.$on("$stateChangeSuccess",function(t,i,n,s,a){document.body.scrollTop=document.documentElement.scrollTop=0,e.previousState={name:s.name,params:a},"events.myevents.list"!==s.name&&"events.allevents.list"!==s.name&&"events.mynetwork.list"!==s.name&&"events.myevents.map"!==s.name&&"events.allevents.map"!==s.name&&"events.mynetwork.map"!==s.name||"event.details"!==i.name&&"event.create"!==i.name||(e.previousEventFeed=s.name)}),e.$on("$stateChangeError",function(e){})}]).value("noUiSliderConfig",{step:1}).directive("ngEnter",function(){return function(e,t,i){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(i.ngEnter)}),t.preventDefault())})}}).directive("updateTitle",["$rootScope","$timeout",function(e,t){return{link:function(i,n){var s=function(e,i,s,a,o){var r="persice";i.data&&i.data.displayName&&(r=i.data.displayName),t(function(){n.html(r)})};e.$on("$stateChangeSuccess",s)}}}]).directive("endRepeat",["$timeout",function(e){return{restrict:"A",link:function(t,i,n){t.$last===!0&&e(function(){t.$emit("ngRepeatFinished")})}}}]).directive("endRepeatPhotos",["$timeout",function(e){return{restrict:"A",link:function(t,i,n){t.$last===!0&&e(function(){t.$emit("ngRepeatFinishedPhotos")})}}}]).filter("getByProperty",function(){return function(e,t,i){for(var n=0,s=i.length;s>n;n++)if(i[n][e]===t)return i[n];return null}}).filter("lastMessage",function(){return function(e){return null===e?"No messages.":e}}).filter("getIndexByProperty",function(){return function(e,t,i){for(var n=0,s=i.length;s>n;n++)if(i[n][e]===t)return n;return null}}).filter("getByPropertyExcept",function(){return function(e,t,i,n,s){for(var a=0,o=s.length;o>a;a++)if(s[a][e]===t&&s[a][i]!==n)return s[a];return null}}).directive("modal",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{model:"=ngModel"},template:'<div class="ui dimmer modals page transition" style="position: absolute;" ng-class="{ \'active visible\': model }"><div class="ui long test modal transition scrolling" style="top: 150px;" ng-class="{ \'active visible\': model }" ng-transclude></div></div>',link:function(e,t,i){}}}).directive("ngChangeOnBlur",function(){return{restrict:"A",require:"ngModel",link:function(e,t,i,n){if("radio"!==i.type&&"checkbox"!==i.type){var s=i.ngChangeOnBlur,a=null;t.bind("focus",function(){e.$apply(function(){a=t.val()})}),t.bind("blur",function(){e.$apply(function(){var i=t.val();i!==a&&e.$eval(s)})})}}}}).factory("myIoSocket",["socketFactory",function(e){var t=io.connect("//"+window.location.hostname+":3000");return t=e({ioSocket:t}),t.forward("message"),t.forward("error"),t}]).directive("whenScrollEnds",function(){return{restrict:"A",link:function(e,t,i){var n=t.height(),s=100;t.scroll(function(){var a=t.prop("scrollHeight"),o=a-n;o-t.scrollTop()<=s&&e.$apply(i.whenScrollEnds)})}}}).directive("whenScrolled",["$timeout",function(e){return function(t,i,n){var s=i[0];i.bind("scroll",function(){if(s.scrollTop<=100){var i=s.scrollHeight;t.$apply(n.whenScrolled).then(function(){e(function(){s.scrollTop=s.scrollHeight-i})})}})}}]).directive("scrollBottomOn",["$timeout",function(e){return function(t,i,n){t.$watch(n.scrollBottomOn,function(t){t&&e(function(){i[0].scrollTop=i[0].scrollHeight})})}}]).directive("uicheckbox",function(){return{restrict:"E",replace:!0,transclude:!0,require:"ngModel",scope:{type:"@",value:"@",size:"@",checked:"@",change:"&",model:"=ngModel"},template:'<div class="{{checkbox_class}}"><input type="checkbox"><label ng-click="click_on_checkbox()" ng-transclude></label></div>',link:function(e,t,i){"standard"===e.type||void 0===e.type?(e.type="standard",e.checkbox_class="ui checkbox"):"slider"===e.type?(e.type="slider",e.checkbox_class="ui slider checkbox"):"toggle"===e.type?(e.type="toggle",e.checkbox_class="ui toggle checkbox"):(e.type="standard",e.checkbox_class="ui checkbox"),"large"===e.size?e.checkbox_class=e.checkbox_class+" large":"huge"===e.size&&(e.checkbox_class=e.checkbox_class+" huge"),"false"===e.checked||void 0===e.checked?e.checked=!1:(e.checked=!0,t.children()[0].setAttribute("checked","")),t.bind("click",function(){e.$apply(function(){e.checked===!0?(e.checked=!0,e.model=!1,t.children()[0].removeAttribute("checked")):(e.checked=!0,e.model=!0,t.children()[0].setAttribute("checked","true"))})}),e.$watch("model",function(i){void 0!==i&&(i===!0?(e.checked=!0,t.children()[0].setAttribute("checked","true"),e.change({value:e.value,checked:e.checked})):(e.checked=!1,t.children()[0].removeAttribute("checked"),e.change({value:e.value,checked:e.checked})))})}}}).directive("autoFocus",["$timeout",function(e){return{restrict:"AC",link:function(t,i){e(function(){i[0].focus()},0)}}}]).directive("compile",["$compile",function(e){return{restrict:"A",link:function(t,i,n){i.append(e(n.compile)(t))}}}]).filter("trustAsResourceUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]).filter("gender",function(){return function(e){var t="";return"f"===e&&(t="female"),"m"===e&&(t="male"),t}}).directive("animation",["$timeout",function(e){return{scope:{index:"@"},link:function(e,t,i){console.log(i.index);angular.element(t).css("margin");TweenMax.staggerFrom(t,2,{scale:.8,opacity:0,delay:.2,ease:Elastic.easeOut,force3D:!0},.9)}}}]),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"userprofile",bindToController:!0,scope:{id:"@id","class":"@class",header:"@header",body:"@body",person:"=person",type:"@type"},link:e,templateUrl:"components/userprofile/userprofile.template.html",restrict:"E"};return i}function t(e,t,i,n,s,a,o,r,l,d,c,u){function v(){$("#photoSlider").flexslider("next")}function m(){t.get({format:"json"},{userId:g.userId}).$promise.then(function(e){g.user.first_name=e.first_name,g.user.last_name=e.last_name,g.user.last_name=e.last_name,g.user.about_me=e.about_me,g.user.age=e.age,g.user.facebookId=e.facebook_id,null!==e.twitter_provider&&(g.social.twitter=e.twitter_username),null!==e.linkedin_provider&&(g.social.linkedin=e.linkedin_provider),null!==e.facebook_profile_url&&(g.social.facebook=e.facebook_profile_url),g.loadingUser=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);g.loadingUser=!1,c.error(i)})}function p(){"loggedInUser"===g.type&&g.getUserInfo(),"loggedInUser"===g.type&&(o.query({user_id:g.userId,format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.goals=e.objects),g.loadingGoals=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)}),r.query({user_id:g.userId,format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.offers=e.objects),g.loadingOffers=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)}),l.query({format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.likes=e.objects),g.loadingLikes=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)}),i.query({user_id:g.userId,format:"json"}).$promise.then(function(e){e.meta.total_count>0&&(g.user.interests=e.objects),g.loadingInterests=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)})),"friend"===g.type&&(n.get({user_id:g.userId,format:"json"}).$promise.then(function(e){g.user.first_name=e.objects[0].first_name,g.user.last_name=e.objects[0].last_name,g.user.last_name=e.objects[0].last_name,g.user.about_me=e.objects[0].about_me,g.user.age=e.objects[0].age,g.user.facebookId=e.objects[0].facebook_id,null!==e.objects[0].twitter_provider&&(g.social.twitter=e.objects[0].twitter_username),null!==e.objects[0].linkedin_provider&&(g.social.linkedin=e.objects[0].linkedin_provider),null!==e.objects[0].facebook_id&&(g.social.facebook="https://www.facebook.com/app_scoped_user_id/"+e.objects[0].facebook_id);var t=[];g.user.distance=e.objects[0].distance;var i=e.objects[0].goals[0];for(var n in i){var s={value:n,match:i[n]};t.push(s)}g.user.goals=t;var a=[],o=e.objects[0].offers[0];for(var n in o){var r={value:n,match:o[n]};a.push(r)}g.user.offers=a;var l=[],d=e.objects[0].interests[0];for(var n in d){var c={value:n,match:d[n]};l.push(c)}g.user.interests=l;var u=[],v=e.objects[0].likes[0];for(var n in v){var m={value:n,match:v[n]};u.push(m)}g.user.likes=u},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)}),a.query({format:"json",user_id:g.userId}).$promise.then(function(e){e.objects.length>0&&(g.user.friends=e.objects[0].mutual_bk_friends,g.user.facebookfriends=e.objects[0].mutual_fb_friends,g.user.linkedinconnections=e.objects[0].mutual_linkedin_connections,g.user.twitterfollowers=e.objects[0].mutual_twitter_followers,g.user.twitterfriends=e.objects[0].mutual_twitter_friends)},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)}))}function f(){d.query({format:"json",user_id:g.userId}).$promise.then(function(e){if(g.user.photos=e.objects,0===g.user.photos.length){var t={photo:g.userPhoto,cropped_photo:"",order:0,user:"/api/v1/auth/user/"+g.userId+"/"};d.save({},t,function(e){c.info(e),c.info("New photo saved."),g.user.photos.push({photo:g.userPhoto,cropped_photo:"",order:0}),g.photosSlider=g.user.photos},function(e){c.info(e)})}else g.photosSlider=g.user.photos},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);c.error(i)})}var g=this;g.userId=g.person.id,g.userPhoto=g.person.photo,g.getUser=p,g.getUserInfo=m,g.getPhotos=f,g.nextImage=v,g.showfullprofile=!0,g.social={twitter:"",linkedin:"",facebook:""},g.user={id:g.person.id,first_name:"",last_name:"",age:"",about_me:"",photos:[],goals:[],offers:[],likes:[],interests:[],friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[],distance:[]},g.photosSlider=[],g.getUser(),g.getPhotos()}angular.module("persice").directive("userProfile",e),t.$inject=["$scope","UsersFactory","InterestsFactory","ProfileFactory","MatchFeedFactory","MutualFriendsFactory","GoalsFactory","OffersFactory","LikesFactory","PhotosFactory","$log","lodash"]}(),function(){function e(e,t,i,n,s){function a(){function i(e){0===e.objects.length?(c.createSettings(d),c.settingsState=d):(c.settingId=e.objects[0].id,c.settingsState=e.objects[0])}function n(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),c.settingsState=d}return t.info("fetching settings"),e.query({format:"json"}).$promise.then(i,n)}function o(){return c.settingsState}function r(i){function n(e){c.settingsState=i}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("saving settings"),null!==c.settingId?e.update({settingId:c.settingId},i,n,s):void 0}function l(i){function n(e){t.info("new settings created"),c.settingId=e.id}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return t.info("creating settings"),e.save(i,n,s)}var d={distance_unit:"miles",user:"/api/v1/auth/user/"+s+"/"},c={settingsState:{distance_unit:"miles",user:"/api/v1/auth/user/"+s+"/"},settingId:null,getSettings:a,saveSettings:r,createSettings:l,getSettingState:o};return c}angular.module("persice").factory("SettingsRepository",e),e.$inject=["SettingsFactory","$log","$filter","$rootScope","USER_ID"]}(),angular.module("persice").factory("SettingsFactory",["$resource",function(e){return e("/api/v1/settings/:settingId/:param",{settingId:"@settingId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e){function t(t,i,n,s){i.bind("keydown",function(i){13===i.keyCode&&e.handleInput(t.query)}),t.resetQuery=function(){e.query="",t.query=""}}var i={scope:{id:"@id","class":"@class"},link:t,template:['<div class="ui searchpage huge left icon input">','<input type="text" ng-model="query" placeholder="Search">','<i ng-click="resetQuery()" class="circular search link icon"></i>',"</div>"].join(""),restrict:"E"};return i}angular.module("persice").directive("searchInput",e),e.$inject=["Search"]}(),function(){function e(e,t,i,n,s,a){function o(t){var i=s(t);return l.isLoading=!0,e({url:" ",params:{q:i,page:1},method:"GET",cache:!1})}function r(e){l.query=e}var l={results:[],query:"",error:"",isLoading:!1,search:o,handleInput:r};return l}angular.module("persice").factory("Search",e),e.$inject=["$http","$log","$q","$rootScope","$sanitize","$timeout"]}(),function(){function e(e,t,i,n,s,a){function o(){function t(e){var t=0;e.meta.total_count>0&&(t=e.objects[0].unread_counter),m.setTotalInbox(t)}function n(t){var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);e.error(n)}return i.query({format:"json",limit:1,offset:0}).$promise.then(t,n)}function r(){function t(e){var t=0;e.meta.total_count>0&&(t=e.objects[0].new_connection_counter),m.setTotalConnections(t)}function i(t){var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);e.error(n)}return n.query({format:"json",limit:1,offset:0}).$promise.then(t,i)}function l(e){m.totalInbox=e,m.total=m.totalInbox+m.totalConnections,s.$broadcast("refreshMessagesCounter"),s.$broadcast("refreshStateNotificationCircle")}function d(e){m.totalConnections=e,m.total=m.totalInbox+m.totalConnections,s.$broadcast("refreshConnectionsCounter"),s.$broadcast("refreshStateNotificationCircle")}function c(){return m.total}function u(){return m.totalInbox}function v(){return m.totalConnections}var m={total:0,totalInbox:0,totalConnections:0,getTotal:c,setTotalInbox:l,setTotalConnections:d,refreshTotalInbox:o,refreshTotalConnections:r,getTotalInbox:u,getTotalConnections:v};return m}angular.module("persice").factory("NotificationsRepository",e),e.$inject=["$log","$filter","InboxUnreadCounterFactory","NewConnectionsFactory","$rootScope","$q"]}(),function(){function e(){function e(e,t,i){}var i={controller:t,controllerAs:"notificationcircle",bindToController:!0,scope:{color:"@color"},link:e,template:'<mark class="notification {{notificationcircle.color}}"  ng-class="{\'hidden-notification\': notificationcircle.hideClass}"></mark>',restrict:"E",replace:!0};return i}function t(e,t,i){var n=this;n.hideClass=!0,n.counter=i.getTotal(),t.$on("displayNotificationCircle",function(e,t){n.hideClass=!1}),t.$on("hideNotificationCircle",function(e,t){n.hideClass=!0}),t.$on("refreshStateNotificationCircle",function(e,t){n.counter=i.getTotal(),n.hideClass=n.counter>0?!1:!0})}angular.module("persice").directive("notificationCircle",e),t.$inject=["$scope","$rootScope","NotificationsRepository"]}(),function(){function e(){function e(e,t,i,n){console.log("pero"),console.log(t),t.modal({onHide:function(){n.$setViewValue(!1)}}),e.$watch(function(){return n.$modelValue},function(e){t.modal("setting","transition","scale").modal("setting","closable",!1).modal(e?"show":"hide")})}var i={restrict:"E",replace:!0,transclude:!0,require:"ngModel",template:'<div class="ui modal" ng-transclude></div>',controller:t,controllerAs:"uimodal",bindToController:!0,link:e};return i}function t(e,t){}angular.module("frontend.semantic.modal",[]).directive("uiModal",e),t.$inject=["$scope","$log"]}(),function(){function e(e){function i(e,t,i,n){t.modal({onHide:function(){e.viewevent.show=!1,e.viewevent.selection="view",e.viewevent.eventNotFound=!1,e.viewevent.header="Event Details",e.viewevent.modalId="viewEventsModal"},onHidden:function(){e.viewevent.show=!1,e.viewevent.selection="view",e.viewevent.eventNotFound=!1,e.viewevent.header="Event Details",e.viewevent.modalId="viewEventsModal"}}),t.modal({onShow:function(){e.viewevent.selection="view",e.viewevent.eventNotFound=!1,e.viewevent.header="Event Details",e.viewevent.modalId="viewEventsModal",t.addClass("small")}}),e.viewevent.getActiveClass=function(){return"invitations"===e.viewevent.selection?"":"small"},e.$watch("viewevent.show",function(e){t.modal("setting","transition","scale").modal("setting","closable",!1).modal("setting","allowMultiple",!0).modal(e?"show":"hide")})}var n={restrict:"E",replace:!0,transclude:!1,scope:{show:"=show",eventid:"=eventid"},templateUrl:"components/modal/modalview.html",controller:t,controllerAs:"viewevent",bindToController:!0,link:i};return n}function t(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p,f,g,h,b,w,y,_){function k(){X.loadingEvent=!0,i.query({format:"json"},{eventId:eventId}).$promise.then(function(e){X.event=e,X.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;X.loadingEvent=!1})}function E(e){if(!X.connections[e].is_invited)if(X.connections[e].selected=!X.connections[e].selected,X.connections[e].selected)X.counterNewInvites++,X.selectedPeople.push(X.connections[e].friend_id);else{var t=h.findIndex(X.selectedPeople,X.connections[e].friend_id);X.selectedPeople.splice(t,1),X.counterNewInvites--}}function x(e){c["delete"]({memberId:X.invitedPeople[e].id},function(t){X.connectionFirstName="",X.getConnections(),X.invitedPeople.splice(e,1),X.counterNewInvites=0,X.invitedPeopleCount>0&&X.invitedPeopleCount--},function(e){a.info(e)})}function I(){if(X.selectedPeople.length>0){if(X.loadingInvitesSave)return;X.loadingInvitesSave=!0;for(var t=[],i=X.selectedPeople.length-1;i>=0;i--){var n={event:"/api/v1/event/"+X.event.id+"/",is_invited:!1,user:"/api/v1/auth/user/"+X.selectedPeople[i]+"/"};t.push(c.save({},n).$promise)}f.all(t).then(function(e){angular.forEach(e,function(e){var t=v("getIndexByProperty")("user",e.user,X.connections);null!==t&&(X.connections[t].member_id=e.id,X.connections[t].is_invited=!0,X.connections[t].rsvp="")})}).then(function(t){a.info("Sending invites finished."),X.counterNewInvites=0,X.loadingInvitesSave=!1,X.selectedPeople=[],X.invitedPeopleAlreadyLoaded=!1,X.invitedPeopleFirstName="",X.connectionFirstName="",X.getConnections(),X.getInvitedPeople(),d({messageTemplate:'<div class="notify-info-header">Success</div><p>All event invitations have been successfully sent.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),e.$emit("invitesSent")})}else d({messageTemplate:'<div class="notify-error-header">Warning</div><p>Please select connections to invite.</p>',classes:"notify-error",icon:"remove circle",duration:4e3})}function M(){X.friends=[],X.counterNewInvites=0,X.nextOffset=10,X.next=null,X.loadingConnections=!0,p.query({format:"json",first_name:X.connectionFirstName.toLowerCase(),limit:1e3,offset:0}).$promise.then(S,F)}function S(e){X.friends=e.objects,X.next=e.meta.next,X.connections=[];for(var t=X.friends.length-1;t>=0;t--){for(var i=null===X.friends[t].mutual_friends_count?0:X.friends[t].mutual_friends_count,n=null===X.friends[t].common_goals_offers_interests?0:X.friends[t].common_goals_offers_interests,s={first_name:X.friends[t].first_name,age:X.friends[t].age,common_goals_offers_interests:n,mutual_friends_count:i,tagline:X.friends[t].tagline,facebook_id:X.friends[t].facebook_id,friend_id:X.friends[t].friend_id,user:"/api/v1/auth/user/"+X.friends[t].friend_id+"/",is_invited:!1,member_id:null,rsvp:"",selected:!1,event:parseInt(X.event.id),image:"//graph.facebook.com/"+X.friends[t].facebook_id+"/picture?type=square"},a=X.friends[t].events.length-1;a>=0;a--)X.friends[t].events[a].event===s.event&&(s.is_invited=!0,s.rsvp=X.friends[t].events[a].rsvp,s.selected=!0,s.member_id=X.friends[t].events[a].id);h.includes(X.selectedPeople,s.friend_id)&&(s.selected=!0),X.connections.push(s)}X.counterNewInvites=X.selectedPeople.length,X.loadingConnections=!1}function F(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);a.error(i),X.loadingConnections=!1}function C(){function e(e){X.invitedPeopleLoading=!1,X.invitedPeopleAlreadyLoaded||(X.invitedPeopleCount=e.meta.total_count),X.invitedPeopleAlreadyLoaded=!0,0===e.objects.length?X.invitedPeople=[]:(X.invitedPeople=e.objects,X.invitedPeopleNext=e.meta.next)}function t(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);a.error(i),X.invitedPeopleLoading=!1}X.invitedPeopleLoading=!0,g.query({format:"json",limit:1e3,offset:0,event:parseInt(X.event.id),is_organizer:!1,user__first_name__icontains:X.invitedPeopleFirstName}).$promise.then(e,t)}function T(){X.selection="invitations",X.header="Invitations",X.invitedPeopleAlreadyLoaded=!1,X.counterNewInvites=0,X.invitedPeopleCount=0,X.invitedPeopleFirstName="",X.connectionFirstName="",X.selectedPeople=[],X.getConnections(),X.getInvitedPeople()}function P(){X.selection="edit",X.header="Event Details"}function A(e){function t(t){X.attendees[e].loading=!1,X.attendees[e].alreadyLoaded||(X.attendees[e].count=t.meta.total_count),X.attendees[e].alreadyLoaded=!0,0===t.objects.length?(X.attendees[e].data=[],X.attendees[e].noResults=!0):(X.attendees[e].data=t.objects,X.attendees[e].next=t.meta.next,X.attendees[e].noResults=!1)}function i(t){var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);a.error(n),X.attendees[e].noResults=!0,X.attendees[e].loading=!1}X.attendees[e].next=null,X.attendees[e].loading=!0,g.query({format:"json",limit:1e3,offset:0,rsvp:X.attendees[e].filters.rsvp,event:X.event.id,user__first_name__icontains:X.attendees[e].filters.firstName}).$promise.then(t,i)}function j(){X.selection="attendees",X.header="Attendees",X.getAttendees("yes"),X.getAttendees("no"),X.getAttendees("maybe")}function D(){X.attendees.yes.alreadyLoaded=!1,X.attendees.no.alreadyLoaded=!1,X.attendees.maybe.alreadyLoaded=!1,X.selection="view",X.header="Event Details"}function L(e){var i={event:"/api/v1/event/"+X.event.id+"/",rsvp:e,user:"/api/v1/auth/user/"+t+"/"};X.eventRsvp.status!==e&&(X.memberExists?(X.eventRsvp.status=e,c.update({memberId:X.memberId},i,function(i){for(var n=X.event.members.length-1;n>=0;n--)X.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(X.event.members[n].rsvp=e);X.getEvent()},function(e){})):(X.eventRsvp.status=e,c.save({},i,function(e){X.memberExists=!0,X.event.members.push(e),X.memberId=e.id},function(e){})))}function O(){a.info("openingmodal"),$("#deleteEventModal").modal("show")}function q(){X.loadingDelete||(X.showError=!1,X.loadingDelete=!0,i["delete"]({eventId:X.eventEdit.id},function(e){X.showError=!1,d({messageTemplate:'<div class="notify-info-header">Success</div><p>Event has been successfully deleted.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),X.loadingDelete=!1,s.$broadcast("refreshEventFeed"),X.closeEventModal()},function(e){X.loadingDelete=!1,X.errorMessage=[],X.showError=!0,e.data.event&&(X.errorMessage=["Event could not be deleted."])}))}function k(){X.selection="view",X.pok=0,X.loadingEvent=!0,i.query({format:"json"},{eventId:X.eventid}).$promise.then(function(e){if(X.eventNotFound=!1,X.event=e,X.eventLocation="",X.mapurlTrue=!1,X.mapurl="","0,0"!==X.event.location?(X.eventLocation=""!==X.event.full_address&&null!==X.event.full_address?X.event.full_address:X.event.street+" "+X.event.city+" "+X.event.zipcode+" "+X.event.state,X.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(X.eventLocation)+"/@"+X.event.location+",15z",X.mapurlTrue=!0):(X.mapurlTrue=!1,X.mapurl="",X.eventLocation=X.event.location_name),X.isHost=!1,X.eventRsvp={status:X.event.rsvp},X.memberExists=!1,X.memberId=null,X.event.members.length>0)for(var i=X.event.members.length-1;i>=0;i--)X.event.members[i].is_organizer===!0?X.event.members[i].user==="/api/v1/auth/user/"+t+"/"&&(X.isHost=!0):X.event.members[i].user==="/api/v1/auth/user/"+t+"/"&&(X.memberId=X.event.members[i].id,null!==X.event.members[i].rsvp&&(X.eventRsvp.status=X.event.members[i].rsvp),X.memberExists=!0);X.starts_on_date=r.utc(X.event.starts_on,r.ISO_8601).local().format("dddd, MMMM D, YYYY"),X.ends_on_date=r.utc(X.event.ends_on,r.ISO_8601).local().format("dddd, MMMM D, YYYY"),X.starts_on_time=r.utc(X.event.starts_on,r.ISO_8601).local().format("h:mm A"),X.ends_on_time=r.utc(X.event.ends_on,r.ISO_8601).local().format("h:mm A ")+r.tz(l.timezone).format("z"),X.ends_on_date!==X.starts_on_date?(X.firstrow=X.starts_on_date+" "+X.starts_on_time,X.secondrow=X.ends_on_date+" "+X.ends_on_time):(X.firstrow=X.starts_on_date,
X.secondrow=X.starts_on_time+" to "+X.ends_on_time),X.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;X.loadingEvent=!1,X.eventNotFound=!0})}function N(){X.loadingInvitesSave=!1,X.show=!1}function R(){""!==X.mapurl&&o.open(X.mapurl)}function U(){return X.startsTimeError=!1,X.endsTimeError=!1,r(X.eventEdit.starts_on).unix()<r().unix()?(X.showError=!0,X.errorMessage=["Please select a Starts Date that is not set in past."],void(X.startsTimeError=!0)):(X.showError=!1,X.errorMessage=[],X.startsTimeError=!1,r(X.eventEdit.ends_on).unix()<r().unix()?(X.showError=!0,X.errorMessage=["Please select an Ends Date that is not set in past."],void(X.endsTimeError=!0)):r(X.eventEdit.ends_on).unix()>r().unix()&&r(X.eventEdit.starts_on).unix()>r().unix()&&r(X.eventEdit.starts_on).unix()>r(X.eventEdit.ends_on).unix()?(X.showError=!0,X.errorMessage=["Ends Date must be greater or equal to Starts Date."],X.endsTimeError=!0,void(X.startsTimeError=!0)):(X.showError=!1,X.errorMessage=[],X.startsTimeError=!1,X.endsTimeError=!1,void 0))}function Y(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function H(){if(null!==X.eventLocation&&"object"==typeof X.eventLocation&&X.eventLocation.hasOwnProperty("address_components")&&X.eventLocation.hasOwnProperty("geometry")){var e=X.eventLocation.address_components;X.eventEdit.street=X.extractFromAddress(e,"route","long_name")+" "+X.extractFromAddress(e,"street_number","long_name"),X.eventEdit.zipcode=X.extractFromAddress(e,"postal_code","long_name"),""===X.eventEdit.zipcode&&(X.eventEdit.zipcode=null),X.eventEdit.location_name=X.eventLocation.name,X.eventEdit.full_address=X.eventLocation.formatted_address,X.eventEdit.state=X.extractFromAddress(e,"administrative_area_level_1","short_name"),X.eventEdit.country=X.extractFromAddress(e,"country","short_name"),X.eventEdit.state.length>3&&(X.eventEdit.state=X.eventEdit.country),X.eventEdit.city=X.extractFromAddress(e,"locality","long_name"),X.eventEdit.location=X.eventLocation.geometry.location.lat()+","+X.eventLocation.geometry.location.lng(),X.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(X.eventLocation.formatted_address)+"/@"+X.eventEdit.location+",15z",X.mapurlTrue=!0}else X.pok>2?(X.eventEdit.address=X.eventLocation,X.eventEdit.full_address="",X.eventEdit.location_name=X.eventLocation,X.eventEdit.location="0,0"):X.pok++}function z(e){var t=parseInt(e.substr(0,2));return-1!=e.indexOf("AM")&&12==t&&(e=e.replace("12","0")),-1!=e.indexOf("PM")&&12>t&&(e=e.replace(t,t+12)),e.replace(/(AM|PM)/,"")}function B(e){if(X[e+"_date"]&&X[e+"_time"]){{var t=X[e+"_date"].split("/"),i=[t[2],t[0],t[1]],n=z(X[e+"_time"]).split(":");6e4*(new Date).getTimezoneOffset()}i&&n&&(i[1]-=1,X.eventEdit[e]=r(i.concat(n)).toISOString())}}function G(){X.showError=!1,X.showSuccess=!1,X.errorMessage=[],X.endsTimeError=!1,X.startsTimeError=!1,X.eventEdit=angular.copy(X.event),X.starts_on_date=r.utc(X.event.starts_on,r.ISO_8601).local().format("MM/DD/YYYY"),X.ends_on_date=r.utc(X.event.ends_on,r.ISO_8601).local().format("MM/DD/YYYY"),X.starts_on_time=r.utc(X.event.starts_on,r.ISO_8601).local().format("h:mm A"),X.ends_on_time=r.utc(X.event.ends_on,r.ISO_8601).local().format("h:mm A"),X.modalId="createEventsModal",X.selection="edit"}function W(){X.loadingSave||(X.showError=!1,X.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},max_attendees:{identifier:"max_attendees",rules:[{type:"empty",prompt:"Please enter Max. attendees"},{type:"integer",prompt:"Please enter Max. attendees as numeric value"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]},starts_on_date:{identifier:"starts_on_date",rules:[{type:"empty",prompt:"Please enter Starts Date"}]},starts_on_time:{identifier:"starts_on_time",rules:[{type:"empty",prompt:"Please enter Starts Time"}]},ends_on_date:{identifier:"ends_on_date",rules:[{type:"empty",prompt:"Please enter Ends Date"}]},ends_on_time:{identifier:"ends_on_time",rules:[{type:"empty",prompt:"Please enter Ends Time"}]}}}),$(".ui.form").form("validate form"),""===X.eventEdit.description||""===X.eventEdit.max_attendees||""===X.eventEdit.ends_on||""===X.eventEdit.location||""===X.eventEdit.name||""===X.eventEdit.starts_on||""===X.eventEdit.repeat?((""===X.eventEdit.starts_on||null===X.eventEdit.starts_on)&&(X.startsTimeError=!0),(""===X.eventEdit.ends_on||null===X.eventEdit.ends_on)&&(X.endsTimeError=!0),X.showError=!0,X.errorMessage=["Please enter all required fields."]):(X.validateDates(),X.showSuccess=!1,X.showError||(X.loadingSave=!0,delete X.eventEdit.members,delete X.eventEdit.attendees,delete X.eventEdit.most_common_elements,i.update({eventId:X.eventEdit.id},X.eventEdit,function(e){X.showError=!1,X.modalId="viewEventsModal",X.selection="view",d({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),s.$broadcast("refreshEventFeed"),X.loadingSave=!1,X.getEvent()},function(e){X.errorMessage=[],X.showError=!0,e.data.event&&(X.errorMessage=e.data.event.error),X.loadingSave=!1}))))}function V(){X.selection="chat",s.eventChatModal=!0,X.header=y.trustAsHtml('Event Chat: <span class="eventNameChat">'+X.event.name+"</span>"),X.getMessages()}function K(){X.selection="view",X.header="Event Details",s.eventChatModal=!1}function J(){if(!X.sendingMessage)if(""===X.newmessage)X.sendingMessage=!1;else{X.sendingMessage=!0;var e={};e={sender:X.sender,event:"/api/v1/event/"+X.eventid+"/",body:X.newmessage},w.save({},e,function(t){X.noMessages=!1,e.left=!0,e.sender=t.sender,e.photo=ee,e.first_name=t.first_name;var i=v("amDateFormat")(t.sent_at,"dddd, MMMM D, YYYY h:mm a");e.sent_at=i,X.messages.unshift(e),X.newmessage="",a.info("New chat message sent."),X.sendingMessage=!1,m(function(){angular.element("#chat-conversation-content").filter(":not(:animated)").animate({scrollTop:0},1500)},100)},function(e){X.sendingMessage=!1,a.info(e)})}}function Q(){X.messages=[],X.loadingMessages=!0,X.status.loaded=!1,X.noMessages=!1,w.query({event:X.eventid,limit:20,offset:0}).$promise.then(function(e){var t=e.objects;X.nextChat=e.meta.next,0===t.length&&(X.noMessages=!0),X.status.loaded=!0;for(var i in t){var n=v("amDateFormat")(t[i].sent_at,"dddd, MMMM D, YYYY h:mm a");X.messages.push(t[i].sender===X.sender?{body:y.trustAsHtml(t[i].body),sender:t[i].sender,photo:"//graph.facebook.com/"+t[i].facebook_id+"/picture?type=square",first_name:t[i].first_name,sent_at:n,left:!0}:{body:y.trustAsHtml(t[i].body),sender:t[i].sender,photo:"//graph.facebook.com/"+t[i].facebook_id+"/picture?type=square",first_name:t[i].first_name,sent_at:n,left:!1})}X.loadingMessages=!1},function(e){X.loadingMessages=!1;var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);a.error(i)})}function Z(){var e=f.defer();return null===X.nextChat?(e.reject(),e.promise):(X.status.loading?e.reject():(X.status.loading=!0,m(function(){w.query({event:X.eventid,offset:X.nextOffsetChat,limit:10}).$promise.then(function(t){var i=t.objects;X.nextChat=t.meta.next,X.nextOffsetChat+=10;for(var n in i){var s=v("amDateFormat")(i[n].sent_at,"dddd, MMMM D, YYYY h:mm a");X.messages.push(i[n].sender===X.sender?{body:y.trustAsHtml(i[n].body),sender:i[n].sender,photo:"//graph.facebook.com/"+i[n].facebook_id+"/picture?type=square",first_name:i[n].first_name,sent_at:s,left:!0}:{body:y.trustAsHtml(i[n].body),sender:i[n].sender,photo:"//graph.facebook.com/"+i[n].facebook_id+"/picture?type=square",first_name:i[n].first_name,sent_at:s,left:!1})}X.status.loading=!1,X.status.loaded=!0,e.resolve()},function(t){e.reject(),X.status.loading=!1;var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);a.error(n)})},400)),e.promise)}var X=this;X.showMobile=!1,X.loadingSave=!1,X.closeEventModal=N,X.getEvent=k,X.openMap=R,X.deleteEvent=q,X.openModalDelete=O,X.event={},X.invitationsMode=!1,X.header="Event Details",X.showError=!1,X.showSuccess=!1,X.errorMessage=[],X.endsTimeError=!1,X.startsTimeError=!1,X.modalId="viewEventsModal",X.eventRsvp={status:""},X.changeRsvpStatus=L,X.extractFromAddress=Y,X.parseLocation=H,X.combineDateTime=B,X.validateDates=U,X.saveEvent=W,X.openInvitations=T,X.closeInvitations=P,X.openAttendees=j,X.closeAttendees=D,X.selection="view",X.editEvent=G,X.isHost=!1,X.loadingEvent=!1,X.placeholder={name:"",starts:"Date",startsTime:"Time",ends:"Date",endsTime:"Time",repeat:"",repeatUntil:"Until date",description:"",location:"",costs:"",invitations:"",attachments:"",max_attendees:""},X.$geolocation=u,u.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){X.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),X.autocompleteOptions={location:"0,0",radius:5e4},X.memberExists=!1,e.$watch(angular.bind(this,function(e){return X.show}),function(e){e&&X.getEvent()}),X.loadingInvitesSave=!1,X.counterNewInvites=0,X.markSelected=E,X.removeInvite=x,X.sendInvites=I,X.getConnections=M,X.getInvitedPeople=C,X.nextOffset=10,X.loadingConnections=!1,X.connectionFirstName="",X.invitedPeopleLoading=!1,X.invitedPeopleCount=0,X.invitedPeopleFirstName="",X.invitedPeopleNext=null,X.invitedPeopleAlreadyLoaded=!1,X.invitationsOptions={attendingPref:"private",guestInvite:!0},X.friends=[],X.connections=[],X.invitedPeople=[],X.selectedPeople=[],e.$on("sendInvites",function(){a.info("sendInvites Event"),X.sendInvites()}),X.getAttendees=A,X.attendees={yes:{data:[],alreadyLoaded:!1,filtered:[],filters:{firstName:"",rsvp:"yes",event:X.eventid},loading:!1,noResults:!1,nextOffset:10,next:null,count:0},no:{data:[],alreadyLoaded:!1,filtered:[],filters:{firstName:"",rsvp:"no",event:X.eventid},loading:!1,noResults:!1,nextOffset:10,next:null,count:0},maybe:{data:[],alreadyLoaded:!1,filtered:[],filters:{firstName:"",rsvp:"maybe",event:X.eventid},loading:!1,noResults:!1,nextOffset:10,next:null,count:0}},X.loadingDelete=!1,X.eventEdit={starts_on:"",ends_on:"",address:""},e.$watch(angular.bind(this,function(e){return X.starts_on_date}),function(e){null!==e&&(X.combineDateTime("starts_on"),X.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return X.starts_on_time}),function(e){null!==e&&(X.combineDateTime("starts_on"),X.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return X.ends_on_date}),function(e){null!==e&&(X.combineDateTime("starts_on"),X.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return X.ends_on_time}),function(e){null!==e&&(X.combineDateTime("starts_on"),X.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return X.eventLocation}),function(e){X.parseLocation()}),X.pok=0,X.openChat=V,X.closeChat=K,X.newmessage="",X.messages=[],X.noMessages=!1,X.loadingMessages=!1,X.loadingOlderMessages=!1,X.sendingMessage=!1,X.sender="/api/v1/auth/user/"+t+"/",X.currentEvent="/api/v1/event/"+X.eventid+"/";var ee="//graph.facebook.com/"+b+"/picture?type=square";X.status={loading:!1,loaded:!1},X.nextOffsetChat=20,X.nextChat=null,X.sendMessage=J,X.getMessages=Q,X.loadMoreChat=Z,s.$on("receivedEventChatMessage",function(e,t){var i=JSON.parse(t);if(i.sender!==X.sender&&i.event==="/api/v1/event/"+X.eventid+"/"&&s.eventChatModal){a.info("new event chat message via websocket");var n=v("amDateFormat")(i.sent_at,"dddd, MMMM D, YYYY h:mm a");X.receivedMessage={body:y.trustAsHtml(i.body),sender:i.sender,photo:"",sent_at:n,first_name:"",left:!1};var o=_(i.sender);o.get().$promise.then(function(e){X.receivedMessage.photo="//graph.facebook.com/"+e.facebook_id+"/picture?type=square",X.receivedMessage.first_name=e.first_name,X.messages.unshift(X.receivedMessage)}),m(function(){angular.element("#chat-conversation-content").filter(":not(:animated)").animate({scrollTop:0},1500)},100)}})}angular.module("frontend.semantic.modal.event.view",[]).directive("uiEventViewModal",e),e.$inject=["$log"],t.$inject=["$scope","USER_ID","EventsFactory","$state","$rootScope","$log","$window","moment","angularMomentConfig","notify","MembersFactory","$geolocation","$filter","$timeout","EventsConnections","$q","EventsAttendees","lodash","USER_FACEBOOK_ID","EventChatFactory","$sce","$resource"]}(),function(){function e(){function e(e,t,i,n){t.modal({onHide:function(){e.singleevent.show=!1,e.singleevent.resetForm()}}),e.$watch("singleevent.show",function(e){t.modal("setting","transition","scale").modal("setting","closable",!1).modal(e?"show":"hide")})}var i={restrict:"E",replace:!0,transclude:!1,scope:{show:"=show"},templateUrl:"components/modal/modalcreate.html",controller:t,controllerAs:"singleevent",bindToController:!0,link:e};return i}function t(e,t,i,n,s,a,o,r,l){function d(){b.show=!1}function c(){return b.startsTimeError=!1,b.endsTimeError=!1,r(b.event.starts_on).unix()<r().unix()?(b.showError=!0,b.errorMessage=["Please select a Starts Date that is not set in past."],void(b.startsTimeError=!0)):(b.showError=!1,b.errorMessage=[],b.startsTimeError=!1,r(b.event.ends_on).unix()<r().unix()?(b.showError=!0,b.errorMessage=["Please select an Ends Date that is not set in past."],void(b.endsTimeError=!0)):r(b.event.ends_on).unix()>r().unix()&&r(b.event.starts_on).unix()>r().unix()&&r(b.event.starts_on).unix()>r(b.event.ends_on).unix()?(b.showError=!0,b.errorMessage=["Ends Date must be greater or equal to Starts Date."],b.endsTimeError=!0,void(b.startsTimeError=!0)):(b.showError=!1,b.errorMessage=[],b.startsTimeError=!1,b.endsTimeError=!1,void 0))}function u(){b.loadingSave||(b.showError=!1,b.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]},max_attendees:{identifier:"max_attendees",rules:[{type:"empty",prompt:"Please enter Max. attendees"},{type:"integer",prompt:"Please enter Max. attendees as numeric value"}]},starts_on_date:{identifier:"starts_on_date",rules:[{type:"empty",prompt:"Please enter Starts Date"}]},starts_on_time:{identifier:"starts_on_time",rules:[{type:"empty",prompt:"Please enter Starts Time"}]},ends_on_date:{identifier:"ends_on_date",rules:[{type:"empty",prompt:"Please enter Ends Date"}]},ends_on_time:{identifier:"ends_on_time",rules:[{type:"empty",prompt:"Please enter Ends Time"}]}}}),$(".ui.form").form("validate form"),""===b.event.description||""===b.event.max_attendees||""===b.event.ends_on||""===b.event.location||""===b.event.name||""===b.event.starts_on||""===b.event.repeat?((""===b.event.starts_on||null===b.event.starts_on)&&(b.startsTimeError=!0),(""===b.event.ends_on||null===b.event.ends_on)&&(b.endsTimeError=!0),b.showError=!0,b.errorMessage=["Please enter all required fields."]):(b.validateDates(),b.showSuccess=!1,b.showError||(b.loadingSave=!0,i.save({},b.event,function(e){b.showError=!1,b.loadingSave=!1,s.$broadcast("closeModalCreateEvent"),b.resetForm()},function(e){b.loadingSave=!1,b.errorMessage=[],b.showError=!0,e.data.event&&(b.errorMessage=e.data.event.error)}))))}function v(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function m(){if(b.mapurl="",b.mapurlTrue=!1,null!==b.eventLocation&&"object"==typeof b.eventLocation&&b.eventLocation.hasOwnProperty("address_components")&&b.eventLocation.hasOwnProperty("geometry")){var e=b.eventLocation.address_components;b.event.street=b.extractFromAddress(e,"route","long_name")+" "+b.extractFromAddress(e,"street_number","long_name"),b.event.zipcode=b.extractFromAddress(e,"postal_code","long_name"),""===b.event.zipcode&&(b.event.zipcode=null),b.event.location_name=b.eventLocation.name,b.event.full_address=b.eventLocation.formatted_address,b.event.state=b.extractFromAddress(e,"administrative_area_level_1","short_name"),b.event.country=b.extractFromAddress(e,"country","short_name"),b.event.state.length>3&&(b.event.state=b.event.country),b.event.city=b.extractFromAddress(e,"locality","long_name"),b.event.location=b.eventLocation.geometry.location.lat()+","+b.eventLocation.geometry.location.lng(),b.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(b.eventLocation.formatted_address)+"/@"+b.event.location+",15z",b.mapurlTrue=!0}else b.event.address=b.eventLocation,b.event.full_address="",b.event.location_name=b.eventLocation,b.event.location="0,0"}function p(){""!==b.mapurl&&o.open(b.mapurl)}function f(){$(".ui.form").trigger("reset"),$(".ui.form .field.error").removeClass("error"),$(".ui.form.error").removeClass("error"),b.starts_on_date=null,b.starts_on_time=null,b.ends_on_date=null,b.ends_on_time=null,b.showError=!1,b.showSuccess=!1,b.errorMessage=[],b.mapurl="",b.mapurlTrue=!1,b.eventLocation="",b.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:"",max_attendees:""}}function g(e){var t=parseInt(e.substr(0,2));return-1!=e.indexOf("AM")&&12==t&&(e=e.replace("12","0")),-1!=e.indexOf("PM")&&12>t&&(e=e.replace(t,t+12)),e.replace(/(AM|PM)/,"")}function h(e){if(b[e+"_date"]&&b[e+"_time"]){{var t=b[e+"_date"].split("/"),i=[t[2],t[0],t[1]],n=g(b[e+"_time"]).split(":");6e4*(new Date).getTimezoneOffset()}i&&n&&(i[1]-=1,b.event[e]=r(i.concat(n)).utc().format("YYYY-MM-DDTHH:mm:ss"))}}var b=this;b.mapurl="",b.mapurlTrue=!1,b.eventLocation="",b.showMobile=!1,b.endsTimeError=!1,b.startsTimeError=!1,b.loadingSave=!1,b.placeholder={name:"",starts:"Date",startsTime:"Time",ends:"Date",endsTime:"Time",repeat:"",repeatUntil:"Until date",description:"",location:"",costs:"",invitations:"",attachments:"",max_attendees:""},b.$geolocation=l,l.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){b.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),b.autocompleteOptions={location:"0,0",radius:5e4},b.starts_on_date="",b.starts_on_time="",b.ends_on_date="",b.ends_on_time="",b.showError=!1,b.showSuccess=!1,b.errorMessage=[],b.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:"",max_attendees:""},b.saveEvent=u,b.openMap=p,b.resetForm=f,b.extractFromAddress=v,b.parseLocation=m,b.combineDateTime=h,b.closeEventModal=d,b.validateDates=c,s.$on("saveEvent",function(){b.saveEvent()}),e.$watch(angular.bind(this,function(e){return b.eventLocation}),function(e){b.parseLocation()}),e.$watch(angular.bind(this,function(e){return b.starts_on_date}),function(e){null!==e&&(b.combineDateTime("starts_on"),b.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return b.starts_on_time}),function(e){null!==e&&(b.combineDateTime("starts_on"),b.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return b.ends_on_date}),function(e){null!==e&&(b.combineDateTime("starts_on"),b.combineDateTime("ends_on"))}),e.$watch(angular.bind(this,function(e){return b.ends_on_time}),function(e){null!==e&&(b.combineDateTime("starts_on"),b.combineDateTime("ends_on"))})}angular.module("frontend.semantic.modal.event.create",[]).directive("uiEventCreateModal",e),t.$inject=["$scope","USER_ID","EventsFactory","$state","$rootScope","$log","$window","moment","$geolocation"]}(),function(){function e(){function e(e,t,i){}var i={controller:t,controllerAs:"messages",bindToController:!0,scope:{},link:e,template:'<div ng-class="{\'hiddencounter\': messages.hideClass}" class="ui label">{{messages.counter}}</div>',restrict:"E",replace:!0};return i}function t(e,t,i,n){function s(){a.counter=n.getTotalInbox(),a.hideClass=a.counter>0?!1:!0}var a=this;a.counter=0,a.hideClass=!0,a.refreshCounter=s,t.$on("refreshMessagesCounter",function(e,t){a.refreshCounter()}),a.refreshCounter()}angular.module("persice").directive("messagesCounter",e),t.$inject=["$scope","$rootScope","$log","NotificationsRepository"]}(),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"userprofile",bindToController:!0,scope:{id:"@id","class":"@class",header:"@header",body:"@body",person:"=person",type:"@type"},link:e,templateUrl:"components/matchfeedprofile/matchfeedprofile.template.html",restrict:"E"};return i}function t(e,t,i,n,s,a,o,r,l,d,c,u){function v(){k.totalfriendscount=0,k.totalmatchingcount=0,k.showDimmer=!0,k.showfullprofile=!1,n.hideTopMenu=!0,$("#filtersMenu").sidebar("hide"),k.user=[],k.total=0,k.social={twitter:"",linkedin:"",facebook:""},k.loadUser()}function m(){k.loadingFeed=!0,o.query({format:"json",filter:!0,offset:0,limit:1}).$promise.then(function(e){k.user=[],k.total=0;var t=e.objects;if(t.length>0){k.total=e.meta.total_count,k.user=e.objects[0],null!==k.user.twitter_provider&&(k.social.twitter=k.user.twitter_provider),null!==k.user.linkedin_provider&&(k.social.linkedin=k.user.linkedin_provider),null!==k.user.facebook_id&&(k.social.facebook="https://www.facebook.com/app_scoped_user_id/"+k.user.facebook_id);var i=[],s=k.user.goals[0];for(var a in s){var o={value:a,match:s[a]};i.push(o)}k.user.goals=i;var r=[],l=k.user.offers[0];for(var a in l){var d={value:a,match:l[a]};r.push(d)}k.user.offers=r;var c=[],u=k.user.interests[0];for(var a in u){var v={value:a,match:u[a]};c.push(v)}k.user.interests=c;var m=[],p=k.user.likes[0];for(var a in p){var f={value:a,match:p[a]};m.push(f)}k.user.likes=m,k.totalmatchingcount=k.user.score,k.getMutualFriends(),k.getPhotos()}else k.user=[],k.total=0;k.showDimmer=!1,n.hideTopMenu=!1,k.loadingFeed=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);d.error(i),k.user=[],k.showDimmer=!1,n.hideTopMenu=!1,k.loadingFeed=!1})}function p(){k.defaultUserPhoto="//graph.facebook.com/"+k.user.facebook_id+"/picture?type=large",l.query({format:"json",user_id:k.user.user_id}).$promise.then(function(e){if(k.user.photos=e.objects,k.user.photos.length>0)k.photosSlider=k.user.photos;else{var t={photo:k.defaultUserPhoto,order:0,user:"/api/v1/auth/user/"+k.user.user_id+"/"};l.save({},t,function(e){d.info(e),d.info("New photo saved."),k.user.photos.push(e),k.photosSlider=k.user.photos},function(e){d.info(e)})}k.photosSlider=i("orderBy")(k.photosSlider,"order",!1)})}function f(){r.query({format:"json",user_id:k.user.id}).$promise.then(function(e){e.objects.length>0&&(k.user.friends=e.objects[0].mutual_bk_friends,k.user.facebookfriends=e.objects[0].mutual_fb_friends,k.user.linkedinconnections=e.objects[0].mutual_linkedin_connections,k.user.twitterfollowers=e.objects[0].mutual_twitter_followers,k.user.twitterfriends=e.objects[0].mutual_twitter_friends,k.totalfriendscount+=e.objects[0].mutual_bk_friends_count,k.totalfriendscount+=e.objects[0].mutual_fb_friends_count,k.totalfriendscount+=e.objects[0].mutual_linkedin_connections_count,k.totalfriendscount+=e.objects[0].mutual_twitter_followers_count,k.totalfriendscount+=e.objects[0].mutual_twitter_friends_count)})}function g(){k.totalfriendscount=0,k.totalmatchingcount=0,k.showfullprofile=!1,n.hideTopMenu=!0,k.loadingFeed=!0,k.loadUser()}function h(){d.info("cancel match");var e={friend1:k.me,friend2:"/api/v1/auth/user/"+k.user.user_id+"/",status:-1};a.save(e,function(e){k.getNextMatch()},function(e){})}function b(){n.hideTopMenu=!1,k.showfullprofile=!1,k.cancelMatch()}function w(){n.hideTopMenu=!1,k.showfullprofile=!1,k.confirmMatch()}function y(){var e={friend1:k.me,friend2:"/api/v1/auth/user/"+k.user.user_id+"/",status:0};a.save(e,function(e){k.getNextMatch()},function(e){})}function _(){k.showfullprofile||(n.hideTopMenu=!0,k.showfullprofile=!0,$("#MatchMenu").sidebar("toggle"))}var k=this;k.social={twitter:"",linkedin:"",facebook:""},k.user=[],k.total=0,k.offset=0,k.previous=null,k.next=null,k.me="/api/v1/auth/user/"+s+"/",k.friendshipStatus=null,k.friendshipId=null,k.showfullprofile=!1,n.$on("cancelMatchEvent",function(){k.cancelMatch()}),n.$on("confirmMatchEvent",function(){k.confirmMatch()}),n.$on("refreshMatchFeed",function(){u.is("matchfeed")&&k.initloadMatches()}),k.nextImage=function(){$("#photoSlider").flexslider("next")},k.photosSlider=[],k.loadingFeed=!1,k.totalfriendscount=0,k.totalmatchingcount=0,k.initloadMatches=v,k.loadUser=m,k.getNextMatch=g,k.cancelMatch=h,k.cancelMatchDesktop=b,k.confirmMatch=y,k.confirmMatchDesktop=w,k.changeTopMenu=_,k.getMutualFriends=f,k.getPhotos=p,k.initloadMatches(),n.$on("showFullProfile",function(){k.showfullprofile=!1})}angular.module("persice").directive("matchfeedProfile",e),t.$inject=["$scope","$timeout","$filter","$rootScope","USER_ID","FriendsFactory","MatchFeedFactory","MutualFriendsFactory","PhotosFactory","$log","lodash","$state"]}(),function(){function e(e){function t(t,i,n,s){function a(n,s){var a,o,r=new google.maps.Map(i[0],{zoom:15,center:new google.maps.LatLng(s.latitude,s.longitude),mapTypeId:google.maps.MapTypeId.ROADMAP}),d=new google.maps.InfoWindow,c=[];for(o=0;o<n.length;o++)a=new google.maps.Marker({id:n[o].id,position:new google.maps.LatLng(n[o].latitude,n[o].longitude),map:r,title:n[o].title,animation:google.maps.Animation.DROP,icon:n[o].icon}),c.push(a),google.maps.event.addListener(a,"click",function(i,s){return function(){if(null!==n[s].id){var a='<a href="" ng-click="eventsmap.gotoEvent('+n[s].id+')">'+n[s].title+"</a>",o=e(a)(t);d.setContent(o[0])}else d.setContent(n[s].title);d.open(r,i)}}(a,o));var u=l(s,4,c),v=new google.maps.LatLngBounds;for(o=0;o<u.length;o++)v.extend(u[o].getPosition());r.fitBounds(v),r.setZoom(r.getZoom()-1),r.getZoom()>15&&r.setZoom(15)}function o(e){var t,n,s=new google.maps.Map(i[0],{zoom:5,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP}),a=new google.maps.InfoWindow,o=[];for(n=0;n<e.length;n++)t=new google.maps.Marker({position:new google.maps.LatLng(e[n].latitude,e[n].longitude),map:s,title:e[n].title,animation:google.maps.Animation.DROP,icon:e[n].icon}),o.push(t),google.maps.event.addListener(t,"click",function(t,i){return function(){a.setContent(e[i].title),a.open(s,t)}}(t,n));var r=new google.maps.LatLngBounds;for(n=0;n<o.length;n++)r.extend(o[n].getPosition());s.fitBounds(r)}function r(e,t){return e.distance-t.distance}function l(e,t,i){for(var n=[],s=new google.maps.LatLng(e.latitude,e.longitude),a=0;a<i.length;a++)i[a].distance=google.maps.geometry.spherical.computeDistanceBetween(s,i[a].getPosition()),n.push(i[a]);return n.sort(r),n.splice(0,t)}t.$on("drawMap",function(e,t){a(t.locations,t.center)}),t.$on("drawMapWithoutCenter",function(e,t){o(t)})}var i={restrict:"E",link:t,replace:!0,template:"<div></div>"};return i}angular.module("persice").directive("mapCanvas",e),e.$inject=["$compile"]}(),angular.module("google.places",[]).factory("googlePlacesApi",["$window",function(e){if(!e.google)throw"Global `google` var missing. Did you forget to include the places API script?";return e.google}]).directive("googlePlacesAutocomplete",["$parse","$compile","$timeout","$document","googlePlacesApi",function(e,t,i,n,s){return{restrict:"A",require:"^ngModel",scope:{model:"=ngModel",options:"=?",forceSelection:"=?",attach:"=?",customPlaces:"=?",refreshLocation:"&refreshLocation"},controller:["$scope",function(e){}],link:function(e,i,a,o){function r(){i.bind("keydown",c),i.bind("blur",u),i.bind("submit",u),e.$watch("selected",v)}function l(){{var i,s=angular.element('<div class="gplacesautocomplete" g-places-autocomplete-drawer></div>');angular.element(n[0].body)}s.attr({input:"input",query:"query",predictions:"predictions",active:"active",selected:"selected"}),i=t(s)(e),$("#"+e.attach).append(i),e.$on("$destroy",function(){i.remove()})}function d(){o.$parsers.push(m),o.$formatters.push(p),o.$render=f}function c(t){0!==e.predictions.length&&-1!==_(I,t.which)&&(t.preventDefault(),t.which===x.down?(e.active=(e.active+1)%e.predictions.length,e.$digest()):t.which===x.up?(e.active=(e.active?e.active:e.predictions.length)-1,e.$digest()):13===t.which||9===t.which?(e.forceSelection&&(e.active=-1===e.active?0:e.active),e.$apply(function(){e.selected=e.active,-1===e.selected&&g()})):27===t.which&&(t.stopPropagation(),g(),e.$digest()))}function u(t){if(0!==e.predictions.length)e.forceSelection&&(e.selected=-1===e.selected?0:e.selected),e.$digest(),e.$apply(function(){-1===e.selected&&g()});else if(e.forceSelection){var i=e.$root.$$phase,n=function(){e.model=""};"$apply"===i||"$digest"===i?n():e.$apply(n)}}function v(){var t;t=e.predictions[e.selected],t&&(t.is_custom?(e.model=t.place,e.$emit("g-places-autocomplete:select",t.place)):S.getDetails({placeId:t.place_id},function(t,i){i===s.maps.places.PlacesServiceStatus.OK&&e.$apply(function(){e.model=t,e.$emit("g-places-autocomplete:select",t),e.refreshLocation()})}),g())}function m(t){var i;return t&&w(t)?(e.query=t,i=angular.extend({input:t},e.options),M.getPlacePredictions(i,function(t,i){e.$apply(function(){var n;g(),e.customPlaces&&(n=h(e.query),e.predictions.push.apply(e.predictions,n)),i===s.maps.places.PlacesServiceStatus.OK&&e.predictions.push.apply(e.predictions,t),e.predictions.length>5&&(e.predictions.length=5)})}),t):t}function p(e){var t="";return w(e)?t=e:y(e)&&(t=e.formatted_address),t}function f(){return i.val(o.$viewValue)}function g(){e.active=-1,e.selected=-1,e.predictions=[]}function h(t){var i,n,s,a=[];for(s=0;s<e.customPlaces.length;s++)i=e.customPlaces[s],n=b(t,i),n.matched_substrings.length>0&&a.push({is_custom:!0,custom_prediction_label:i.custom_prediction_label||"(Custom Non-Google Result)",description:i.formatted_address,place:i,matched_substrings:n.matched_substrings,terms:n.terms});return a}function b(e,t){var i,n,s,a=e+"",o=[],r=[];for(n=t.formatted_address.split(","),s=0;s<n.length;s++)i=n[s].trim(),a.length>0&&(i.length>=a.length?(k(i,a)&&r.push({length:a.length,offset:s}),a=""):k(a,i)?(r.push({length:i.length,offset:s}),a=a.replace(i,"").trim()):a=""),o.push({value:i,offset:t.formatted_address.indexOf(i)});return{matched_substrings:r,terms:o}}function w(e){return"[object String]"===Object.prototype.toString.call(e)}function y(e){return"[object Object]"===Object.prototype.toString.call(e)}function _(e,t){var i,n;if(null===e)return-1;for(n=e.length,i=0;n>i;i++)if(e[i]===t)return i;return-1}function k(e,t){return 0===E(e).lastIndexOf(E(t),0)}function E(e){return null===e?"":e.toLowerCase()}var x={tab:9,enter:13,esc:27,up:38,down:40},I=[x.tab,x.enter,x.esc,x.up,x.down],M=new s.maps.places.AutocompleteService,S=new s.maps.places.PlacesService(i[0]);!function(){e.query="",e.predictions=[],e.input=i,e.options=e.options||{},l(),r(),d()}()}}}]).directive("gPlacesAutocompleteDrawer",["$window","$document",function(e,t){var i=['<div class="pac-container" ng-if="isOpen()" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">','  <div class="pac-item" g-places-autocomplete-prediction index="$index" prediction="prediction" query="query"','       ng-repeat="prediction in predictions track by $index" ng-class="{\'pac-item-selected\': isActive($index) }"','       ng-mouseenter="selectActive($index)" ng-click="selectPrediction($index)" role="option" id="{{prediction.id}}">',"  </div>","</div>"];return{restrict:"A",scope:{input:"=",query:"=",predictions:"=",active:"=",selected:"="},template:i.join(""),link:function(i,n){function s(i){var n=i[0],s=n.getBoundingClientRect(),a=t[0].documentElement,o=t[0].body,r=e.pageYOffset||a.scrollTop||o.scrollTop,l=e.pageXOffset||a.scrollLeft||o.scrollLeft;return{width:s.width,height:s.height,top:s.top+s.height+r,left:s.left+l}}n.bind("mousedown",function(e){e.preventDefault()}),i.isOpen=function(){return i.predictions.length>0},i.isActive=function(e){return i.active===e},i.selectActive=function(e){
i.active=e},i.selectPrediction=function(e){i.selected=e},i.$watch("predictions",function(){i.position=s(i.input)},!0)}}}]).directive("gPlacesAutocompletePrediction",[function(){var e=['<span class="pac-icon pac-icon-marker"></span>','<span class="pac-item-query" ng-bind-html="prediction | highlightMatched"></span>','<span ng-repeat="term in prediction.terms | unmatchedTermsOnly:prediction">{{term.value | trailingComma:!$last}}&nbsp;</span>','<span class="custom-prediction-label" ng-if="prediction.is_custom">&nbsp;{{prediction.custom_prediction_label}}</span>'];return{restrict:"A",scope:{index:"=",prediction:"=",query:"="},template:e.join("")}}]).filter("highlightMatched",["$sce",function(e){return function(t){var i,n="",s="";return t.matched_substrings.length>0&&t.terms.length>0&&(i=t.matched_substrings[0],n=t.terms[0].value.substr(i.offset,i.length),s=t.terms[0].value.substr(i.offset+i.length)),e.trustAsHtml('<span class="pac-matched">'+n+"</span>"+s)}}]).filter("unmatchedTermsOnly",[function(){return function(e,t){var i,n,s=[];for(i=0;i<e.length;i++)n=e[i],t.matched_substrings.length>0&&n.offset>t.matched_substrings[0].length&&s.push(n);return s}}]).filter("trailingComma",[function(){return function(e,t){return t?e+",":e}}]),function(){function e(e,t,i,n,s,a){function o(){function i(e){0===e.objects.length?(u.filtersCreated||(u.filtersCreated=!0,u.createFilters(c)),u.filterState=c,s.resolve(c)):(u.filterId=e.objects[0].id,u.filterState=e.objects[0],s.resolve(e.objects[0]))}function n(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),u.filterState=c,s.reject(n)}var s=a.defer();return e.query({format:"json"},i,n),s.promise}function r(){return u.filterState}function l(i){function n(e){o.resolve(),u.filterState=i}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),o.reject()}if(null!==u.filterId){var o=a.defer();return e.update({filterId:u.filterId},i,n,s),o.promise}}function d(i){function n(e){u.filterId=e.id,u.filtersCreated=!0}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return e.save(i,n,s)}var c={distance:1e4,keyword:"",order_criteria:"date",user:"/api/v1/auth/user/"+s+"/"},u={filterState:null,filterId:null,filtersCreated:!1,getFilters:o,saveFilters:l,createFilters:d,getFilterState:r};return u}angular.module("persice").factory("EventsFilterRepository",e),e.$inject=["EventsFiltersFactory","$log","$filter","$rootScope","USER_ID","$q"]}(),angular.module("persice").factory("EventsFiltersFactory",["$resource",function(e){return e("/api/v1/events/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e){function i(e,t,i,n){}var n={controller:t,controllerAs:"filter",bindToController:!0,scope:{id:"@id","class":"@class"},link:i,templateUrl:"components/filterEvents/filterEvents.template.html",restrict:"E"};return n}function t(e,t,i,n,s,a,o,r,l,d,c){function u(){h.changed=!0}function v(){h.saveFilters()}function m(){h.changed=!1,o.getFilters().then(function(t){h.currentFilters=t,h.distanceValue=h.currentFilters.distance,h.orderBy=h.currentFilters.order_criteria,h.distanceUnit=i.distance_unit,""!==h.currentFilters.keyword&&void 0!==h.currentFilters.keyword?h.myKeywords=h.currentFilters.keyword.split(","):h.myKeywords.splice(0,h.myKeywords.length),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender"),h.changed=!1},function(e){})}function p(){h.newFilters={distance:h.distanceValue,order_criteria:h.orderBy,keyword:0===h.myKeywords.length?"":h.myKeywords.join(),user:"/api/v1/auth/user/"+r+"/"},o.saveFilters(h.newFilters).then(function(e){h.changed=!1,i.$emit("refreshEventFeed")},function(e){}),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender")}function f(e){h.myKeywords.splice(e,1),h.hasChanges()}function g(e){if(h.filtermessage="",""===e||void 0===e)h.filtermessage="Keyword must have at least 3 letters",h.showFilterMessage=!0;else if(h.myKeywords.length<5){h.existing=!1;for(var t=h.myKeywords.length-1;t>=0;t--)h.myKeywords[t]===e&&(h.existing=!0);h.existing===!1?(h.myKeywords.push(e),h.hasChanges(),h.newKeyword="",h.showFilterMessage=!1):(h.filtermessage="Keyword already exists",h.showFilterMessage=!0)}else h.filtermessage="You cannot add more than 5 keywords",h.showFilterMessage=!0}var h=this;h.changed=!1,t(function(){h.changed=!1},1e3),h.saveFilters=p,h.getFilters=m,h.removeKeyword=f,h.addKeyword=g,h.refreshEventsFeed=v,h.hasChanges=u,h.orderByValues=[{name:"Match score",value:"match_score"},{name:"Distance",value:"distance"},{name:"Date",value:"date"}],h.orderBy="date",h.distanceValue=1e4,h.distanceUnit="miles",h.filtermessage="",h.currentFilters=null,h.showFilterMessage=!1,h.myKeywords=[],e.$watch(angular.bind(this,function(e){return h.distanceValue}),function(e){h.hasChanges()}),h.getFilters()}angular.module("persice").directive("eventsFilter",e),e.$inject=["$rootScope"],t.$inject=["$scope","$timeout","$rootScope","$window","SettingsRepository","EventsFiltersFactory","EventsFilterRepository","USER_ID","lodash","$log","$q"]}(),function(){function e(e,t,i,n,s,a){function o(){function i(e){0===e.objects.length?(u.filtersCreated||(u.filtersCreated=!0,u.createFilters(c)),u.filterState=c,s.resolve(c)):(u.filterId=e.objects[0].id,u.filterState=e.objects[0],s.resolve(e.objects[0]))}function n(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),u.filterState=c,s.reject(n)}var s=a.defer();return e.query({format:"json"},i,n),s.promise}function r(){return u.filterState}function l(i){function n(e){o.resolve(),u.filterState=i}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),o.reject()}if(null!==u.filterId){var o=a.defer();return e.update({filterId:u.filterId},i,n,s),o.promise}}function d(i){function n(e){u.filterId=e.id,u.filtersCreated=!0}function s(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n)}return e.save(i,n,s)}var c={distance:1e4,gender:"m,f",min_age:25,max_age:60,keyword:"",distance_unit:"miles",order_criteria:"match_score",user:"/api/v1/auth/user/"+s+"/"},u={filterState:null,filterId:null,filtersCreated:!1,getFilters:o,saveFilters:l,createFilters:d,getFilterState:r};return u}angular.module("persice").factory("FilterRepository",e),e.$inject=["FiltersFactory","$log","$filter","$rootScope","USER_ID","$q"]}(),angular.module("persice").factory("FiltersFactory",["$resource",function(e){return e("/api/v1/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e){function i(e,t,i,n){}var n={controller:t,controllerAs:"filter",bindToController:!0,scope:{id:"@id","class":"@class"},link:i,templateUrl:"components/filter/matchfeedFilter.directive.html",restrict:"E"};return n}function t(e,t,i,n,s,a,o,r,l,d){function c(){h.changed=!0}function u(){h.saveFilters()}function v(){h.changed=!1,o.getFilters().then(function(t){h.currentFilters=t,h.distanceValue=h.currentFilters.distance,h.distanceUnit=h.currentFilters.distance_unit,h.ageSlider.min=h.currentFilters.min_age,h.ageSlider.max=h.currentFilters.max_age,h.orderBy=h.currentFilters.order_criteria,""!==h.currentFilters.keyword&&void 0!==h.currentFilters.keyword?h.myKeywords=h.currentFilters.keyword.split(","):h.myKeywords.splice(0,h.myKeywords.length),""===h.currentFilters.gender&&(h.male=!1,h.female=!1),"m,f"===h.currentFilters.gender&&(h.male=!0,h.female=!0),"m"===h.currentFilters.gender&&(h.male=!0,h.female=!1),"f"===h.currentFilters.gender&&(h.male=!1,h.female=!0),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender"),h.changed=!1},function(e){})}function m(e,t){if(t===!0)h.gendersArr.push(e);else{var i=h.gendersArr.indexOf(e);h.gendersArr.splice(i,1)}h.gendersArr.sort().reverse(),h.genders=h.gendersArr.join(","),h.hasChanges()}function p(){h.newFilters={distance:h.distanceValue,gender:h.genders,order_criteria:h.orderBy,min_age:h.ageSlider.min,max_age:h.ageSlider.max,keyword:0===h.myKeywords.length?"":h.myKeywords.join(),user:"/api/v1/auth/user/"+r+"/"},o.saveFilters(h.newFilters).then(function(e){h.changed=!1,i.$emit("refreshMatchFeed")},function(e){}),e.$broadcast("reCalcViewDimensions"),e.$broadcast("rzSliderForceRender")}function f(e){h.myKeywords.splice(e,1),h.hasChanges()}function g(e){if(h.filtermessage="",""===e||void 0===e)h.filtermessage="Keyword must have at least 3 letters",h.showFilterMessage=!0;else if(h.myKeywords.length<5){h.existing=!1;for(var t=h.myKeywords.length-1;t>=0;t--)h.myKeywords[t]===e&&(h.existing=!0);h.existing===!1?(h.myKeywords.push(e),h.hasChanges(),h.newKeyword="",h.showFilterMessage=!1):(h.filtermessage="Keyword already exists",h.showFilterMessage=!0)}else h.filtermessage="You cannot add more than 5 keywords",h.showFilterMessage=!0}var h=this;h.changed=!1,t(function(){h.changed=!1},1e3),h.toggleGender=m,h.saveFilters=p,h.getFilters=v,h.removeKeyword=f,h.addKeyword=g,h.refreshMatchFeed=u,h.hasChanges=c,h.orderByValues=[{name:"Match score",value:"match_score"},{name:"Distance",value:"distance"},{name:"Mutual friends",value:"mutual_friends"}],h.orderBy="match_score",h.distanceValue=1e4,h.distanceUnit="miles",h.male=!1,h.female=!1,h.checkedmale=!1,h.checkedfemale=!1,h.genders="",h.filtermessage="",h.currentFilters=null,h.showFilterMessage=!1,h.ageValues=[25,60],h.ageSlider={min:25,max:60,ceil:115,floor:18},e.$watch(angular.bind(this,function(e){return h.distanceValue}),function(e){h.hasChanges()}),e.$watch(angular.bind(this,function(e){return h.ageSlider.min}),function(e){h.hasChanges()}),e.$watch(angular.bind(this,function(e){return h.ageSlider.max}),function(e){h.hasChanges()}),h.myKeywords=[],h.gendersArr=[],h.getFilters()}angular.module("persice").directive("matchfeedFilter",e),e.$inject=["$rootScope"],t.$inject=["$scope","$timeout","$rootScope","$window","SettingsRepository","FiltersFactory","FilterRepository","USER_ID","lodash","$log"]}(),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"eventsmap",bindToController:!0,link:e,transclude:!0,templateUrl:"components/eventsmap/eventsmap.tpl.html",restrict:"E"};return i}function t(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p,f){function g(t){w.loadingLocation=!0,w.locationError=!1,f.query({format:"json"}).$promise.then(function(t){if(w.loadingLocation=!1,t.meta.total_count>0){var i=t.objects[0].position.split(",");w.currentLocation={latitude:i[0],longitude:i[1]},w.eventMarkers.push({id:null,title:"Your current location",latitude:parseFloat(w.currentLocation.latitude),longitude:parseFloat(w.currentLocation.longitude),icon:{path:google.maps.SymbolPath.CIRCLE,scale:10,strokeWeight:5,fillColor:"#0099FF",fillOpacity:1,strokeColor:"#FFFFFF"}});var t={locations:w.eventMarkers,center:w.currentLocation};e.$broadcast("drawMap",t)}else e.$broadcast("drawMapWithoutCenter",w.eventMarkers)},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);r.error(i)})}function h(){w.nextOffset=100,w.next=null,w.loading=!0,w.noEvents=!1,v.is("events.mynetwork.map")&&(w.EventsFeed=o("/api/v1/feed/events/friends/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),v.is("events.allevents.map")&&(w.EventsFeed=o("/api/v1/feed/events/all/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),v.is("events.myevents.map")&&(w.EventsFeed=o("/api/v1/feed/events/my/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),w.eventMarkers=[],w.EventsFeed.query({format:"json",limit:100,offset:0,filter:!0}).$promise.then(function(e){var t=e.objects;w.events=[],w.next=e.meta.next,0===e.objects.length&&(w.noEvents=!0);for(var i in t){var n=t[i].location.split(",");w.eventMarkers.push({id:t[i].id,title:t[i].name,latitude:parseFloat(n[0]),longitude:parseFloat(n[1])})}g(w.eventMarkers),w.loading=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);r.error(i),w.noEvents=!0,w.loading=!1})}function b(e){var t=angular.element(p);t.width()>767?i.$broadcast("openViewEventModal",e):v.go("event.details",{eventId:e})}var w=this;w.eventMarkers=[],w.loading=!1,w.loadingLocation=!1,w.noEvents=!1,w.pok=!1,w.noResults=!1,w.noEvents=!1,w.loading=!1,w.loadingMore=!1,w.nextOffset=100,w.next=null,w.locationError=!1,w.getEvents=h,w.gotoEvent=b,w.events=[],w.getEvents(),i.$on("refreshEventFeed",function(e,t){$(".right.sidebar.eventsfeedfilter").sidebar("hide"),v.current.name.indexOf("map")>-1&&w.getEvents()})}angular.module("persice").directive("eventsMap",e),t.$inject=["$scope","USER_ID","$rootScope","FeedEventsFriendsFactory","FeedEventsAllFactory","FeedEventsMyFactory","$resource","$log","$timeout","$q","$http","$filter","$state","moment","$window","LocationFactory"]}(),function(){function e(){function e(e,t,i,n){}var i={controller:t,controllerAs:"eventsfeed",bindToController:!0,scope:{type:"@type"},link:e,templateUrl:"components/eventsfeed/eventsfeed.directive.html",restrict:"E"};return i}function t(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p){function f(){b.nextOffset=10,b.next=null,b.loading=!0,b.noEvents=!1,"events.mynetwork"===b.type&&(b.EventsFeed=o("/api/v1/feed/events/friends/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),"events.allevents"===b.type&&(b.EventsFeed=o("/api/v1/feed/events/all/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),"events.myevents"===b.type&&(b.EventsFeed=o("/api/v1/feed/events/my/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})),b.EventsFeed.query({format:"json",limit:10,offset:0,filter:!0}).$promise.then(function(e){var t=e.objects;b.events=[],b.next=e.meta.next,0===e.objects.length&&(b.noEvents=!0);for(var i in t){var n=u("amDateFormat")(t[i].starts_on,"dddd, MMMM Do YYYY");b.events.push({id:t[i].id,name:t[i].name,street:t[i].street,city:t[i].city,state:t[i].state,zipcode:t[i].zipcode,description:t[i].description,location:t[i].location,starts_on:t[i].starts_on,ends_on:t[i].ends_on,full_address:t[i].full_address,location_name:t[i].location_name,country:t[i].country,repeat:t[i].repeat,friend_attendees_count:t[i].friend_attendees_count,cumulative_match_score:t[i].cumulative_match_score,distance:t[i].distance,date:n})}b.loading=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);r.error(i),b.noEvents=!0,b.loading=!1})}function g(){var e=d.defer();return null===b.next?(e.reject(),e.promise):(b.loadingMore?e.reject():(b.loadingMore=!0,b.EventsFeed.query({format:"json",limit:10,offset:b.nextOffset}).$promise.then(function(t){var i=t.objects;b.nextOffset+=10,b.next=t.meta.next;for(var n in i){var s=u("amDateFormat")(i[n].starts_on,"dddd, MMMM Do YYYY");b.events.push({id:i[n].id,name:i[n].name,street:i[n].street,city:i[n].city,state:i[n].state,zipcode:i[n].zipcode,description:i[n].description,location:i[n].location,full_address:i[n].full_address,location_name:i[n].location_name,country:i[n].country,starts_on:i[n].starts_on,ends_on:i[n].ends_on,repeat:i[n].repeat,friend_attendees_count:i[n].friend_attendees_count,cumulative_match_score:i[n].cumulative_match_score,distance:i[n].distance,date:s})}b.loadingMore=!1,e.resolve()},function(t){e.reject();var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);r.error(n),b.loadingMore=!1,e.reject()})),e.promise)}function h(e){var t=angular.element(p);t.width()>767?i.$broadcast("openViewEventModal",e):v.go("event.details",{eventId:e})}var b=this;b.noEvents=!1,b.pok=!1,b.noResults=!1,b.noEvents=!1,b.loading=!1,b.loadingMore=!1,b.nextOffset=10,b.next=null,b.getEvents=f,b.loadMoreEvents=g,b.gotoEvent=h,b.events=[],b.getEvents(),i.$on("refreshEventFeed",function(e,t){$(".right.sidebar.eventsfeedfilter").sidebar("hide"),r.info(v.current.name),b.type+".list"===v.current.name&&b.getEvents()})}angular.module("persice").directive("eventsFeed",e),t.$inject=["$scope","USER_ID","$rootScope","FeedEventsFriendsFactory","FeedEventsAllFactory","FeedEventsMyFactory","$resource","$log","$timeout","$q","$http","$filter","$state","moment","$window"]}(),angular.module("frontend.semantic.dropdown",[]).controller("DropDownController",["$scope",function(e){e.items=[],this.add_item=function(t){return e.items.push(t),e.items},this.remove_item=function(t){var i=e.items.indexOf(t);-1!==i&&e.items.splice(i,1)},this.update_title=function(t){for(var i in e.items)e.items[i].title=t}}]).directive("dropdown",function(){return{restrict:"E",replace:!0,transclude:!0,controller:"DropDownController",scope:{title:"@",open:"@",model:"=ngModel"},template:'<div class="{{ dropdown_class }}"><div class="default text">{{ title }}</div><i class="dropdown icon"></i><div class="{{ menu_class }}"  ng-transclude></div></div>',link:function(e,t,i,n){e.dropdown_class="ui selection dropdown",e.menu_class="menu transition hidden",e.original_title=e.title,"true"===e.open?(e.is_open=!0,e.dropdown_class=e.dropdown_class+" active visible",e.menu_class=e.menu_class+" visible"):e.is_open=!1,n.add_item(e),e.$watch("title",function(t,i){void 0!==t&&t!==i&&t!==e.original_title&&(e.model=t)}),e.$watch("model",function(t){e.model=t,n.update_title(t||e.original_title)}),t.bind("click",function(){e.is_open===!1?e.$apply(function(){e.dropdown_class="ui selection dropdown active visible",e.menu_class="menu transition visible"}):(e.title!==e.original_title&&(e.model=e.title),e.$apply(function(){e.dropdown_class="ui selection dropdown",e.menu_class="menu transition hidden"})),e.is_open=!e.is_open})}}}).directive("dropdownGroup",function(){return{restrict:"AE",replace:!0,transclude:!0,require:"^dropdown",scope:{title:"=title"},template:'<div class="item" ng-transclude >{{ item_title }}</div>',link:function(e,t,i,n){e.item_title=void 0===e.title?t.children()[0].innerHTML:e.title,t.bind("click",function(){n.update_title(e.item_title)})}}}),angular.module("frontend.semantic.dimmer",[]).directive("pageDimmer",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{show:"=?",model:"=ngModel"},template:'<div class="{{dimmer_class}}" ng-click="click_on_dimmer()"><div class="content"><div class="center" ng-transclude></div></div></div>',link:function(e,t,i,n){1==e.show?e.dimmer_class="ui page inverted active dimmer":(e.show=!1,e.dimmer_class="ui page inverted disable dimmer"),e.click_on_dimmer=function(){e.model=!0,e.show=!0,e.dimmer_class="ui page inverted active dimmer"},e.$watch("model",function(t){return 0==t||void 0==t?(e.show=!1,void(e.dimmer_class="ui page inverted disable dimmer")):void(e.dimmer_class="ui page inverted active dimmer")})}}}),function(){function e(){function e(e,t,i){}var i={controller:t,controllerAs:"connections",bindToController:!0,scope:{},link:e,template:'<div ng-class="{\'hiddencounter\': connections.hideClass}" class="ui label">{{connections.counter}}</div>',restrict:"E",replace:!0};return i}function t(e,t,i){function n(){s.counter=0,s.counter=i.getTotalConnections(),s.hideClass=s.counter>0?!1:!0}var s=this;s.counter=0,s.hideClass=!0,s.refreshCounter=n,t.$on("refreshConnectionsCounter",function(e,t){s.refreshCounter()}),s.refreshCounter()}angular.module("persice").directive("connectionsCounter",e),t.$inject=["$scope","$rootScope","NotificationsRepository"]}(),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(window,function(e){e.module("frontend.ui.autocomplete",[]).directive("autocompleteUi",["$q","$parse","$http","$sce","$timeout","$templateCache",function(e,t,i,n,s,a){var o=40,r=39,l=38,d=37,c=27,u=13,v=9,m=3,p=524288,f=500,g=200,h="autocomplete-required",b="Searching...",w="No results found",y="/autocomplete-alt/index.html";return a.put(y,'<div class="autocomplete-holder ui left icon input" ng-class="{\'autocomplete-dropdown-visible\': showDropdown, \'loading\': searching}">  <input id="{{id}}_value" name={{inputName}} ng-class="{\'autocomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"/> <i class="icon circular search" ng-show="!searching"></i>   <div id="{{id}}_dropdown" class="autocomplete-dropdown" ng-show="showDropdown">    <div class="autocomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>    <div class="autocomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'autocomplete-selected-row\': $index == currentIndex}">      <div ng-if="imageField" class="autocomplete-image-holder">        <img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="autocomplete-image"/>        <div ng-if="!result.image && result.image != \'\'" class="autocomplete-image-default"></div>      </div>      <div class="autocomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>      <div class="autocomplete-title" ng-if="!matchClass">{{ result.title }}</div>      <div ng-if="matchClass && result.description && result.description != \'\'" class="autocomplete-description" ng-bind-html="result.description"></div>      <div ng-if="!matchClass && result.description && result.description != \'\'" class="autocomplete-description">{{result.description}}</div>    </div>  </div></div>'),{restrict:"EA",require:"^?form",scope:{selectedObject:"=",disableInput:"=",initialValue:"=",localData:"=",remoteUrlRequestFormatter:"=",remoteUrlRequestWithCredentials:"@",remoteUrlResponseFormatter:"=",remoteUrlErrorCallback:"=",remoteApiHandler:"=",id:"@",type:"@",placeholder:"@",remoteUrl:"@",remoteUrlDataField:"@",titleField:"@",descriptionField:"@",imageField:"@",inputClass:"@",pause:"@",searchFields:"@",minlength:"@",matchClass:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"@",fieldRequiredClass:"@",inputChanged:"=",autoMatch:"@",focusOut:"&",focusIn:"&",inputName:"@"},templateUrl:function(e,t){return t.templateUrl||y},link:function(t,a,y,_){function k(e){de=null,t.hideResults(e),document.body.removeEventListener("click",k)}function E(e){return e.which?e.which:e.keyCode}function x(e){"function"==typeof t.selectedObject?t.selectedObject(e):t.selectedObject=e,C(e?!0:!1)}function $(e){return function(i){return t[e]?t[e](i):i}}function I(e){x({originalObject:e}),t.clearSelected&&(t.searchStr=null),B()}function M(e){return t.titleField.split(",").map(function(t){return S(e,t)}).join(" ")}function S(e,t){var i,n;if(t){i=t.split("."),n=e;for(var s=0;s<i.length;s++)n=n[i[s]]}else n=e;return n}function F(e,i){var s,a,o;return o=new RegExp(i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),e?(a=e.match(o),s=a?e.replace(o,'<span class="'+t.matchClass+'">'+a[0]+"</span>"):e,n.trustAsHtml(s)):void 0}function C(e){t.notEmpty=e,ae=t.searchStr,t.fieldRequired&&_&&_.$setValidity(se,e)}function T(e){var i=E(e);if(i!==d&&i!==r)if(i===l||i===u)e.preventDefault();else if(i===o)e.preventDefault(),!t.showDropdown&&t.searchStr&&t.searchStr.length>=ie&&(G(),t.searching=!0,K(t.searchStr));else if(i===c)B(),t.$apply(function(){te.val(t.searchStr)});else{if(0===ie&&!t.searchStr)return;t.searchStr&&""!==t.searchStr?t.searchStr.length>=ie&&(G(),ne&&s.cancel(ne),t.searching=!0,ne=s(function(){K(t.searchStr)},t.pause)):t.showDropdown=!1,ae&&ae!==t.searchStr&&!t.clearSelected&&t.$apply(function(){x()})}}function P(e){!t.overrideSuggestions||t.selectedObject&&t.selectedObject.originalObject===t.searchStr||(e&&e.preventDefault(),I(t.searchStr))}function A(e){var t=getComputedStyle(e);return e.offsetHeight+parseInt(t.marginTop,10)+parseInt(t.marginBottom,10)}function j(){return re.getBoundingClientRect().top+parseInt(getComputedStyle(re).maxHeight,10)}function D(){return a[0].querySelectorAll(".autocomplete-row")[t.currentIndex]}function L(){return D().getBoundingClientRect().top-(re.getBoundingClientRect().top+parseInt(getComputedStyle(re).paddingTop,10))}function O(e){re.scrollTop=re.scrollTop+e}function q(){var e=t.results[t.currentIndex];te.val(t.matchClass?M(e.originalObject):e.title)}function N(e){var i=E(e),n=null,s=null;i===u&&t.results?(t.currentIndex>=0&&t.currentIndex<t.results.length?(e.preventDefault(),t.selectResult(t.results[t.currentIndex])):(P(e),B()),t.$apply()):i===o&&t.results?(e.preventDefault(),t.currentIndex+1<t.results.length&&t.showDropdown&&(t.$apply(function(){t.currentIndex++,q()}),le&&(n=D(),j()<n.getBoundingClientRect().bottom&&O(A(n))))):i===l&&t.results?(e.preventDefault(),t.currentIndex>=1?(t.$apply(function(){t.currentIndex--,q()}),le&&(s=L(),0>s&&O(s-1))):0===t.currentIndex&&t.$apply(function(){t.currentIndex=-1,te.val(t.searchStr)})):i===v&&(t.results&&t.results.length>0&&t.showDropdown?-1===t.currentIndex&&t.overrideSuggestions?P():(-1===t.currentIndex&&(t.currentIndex=0),t.selectResult(t.results[t.currentIndex]),t.$digest()):t.searchStr&&t.searchStr.length>0&&P())}function R(e){return function(i,n,s,a){n||s||a||(i=i.data),t.searching=!1,J(S(X(i),t.remoteUrlDataField),e)}}function U(e,i,n,s){i||n||s||(i=e.status),0!==i&&(t.remoteUrlErrorCallback?t.remoteUrlErrorCallback(e,i,n,s):console&&console.error&&console.error("http error"))}function Y(){oe&&oe.resolve()}function H(n){var s={},a=t.remoteUrl+encodeURIComponent(n);t.remoteUrlRequestFormatter&&(s={params:t.remoteUrlRequestFormatter(n)},a=t.remoteUrl),t.remoteUrlRequestWithCredentials&&(s.withCredentials=!0),Y(),oe=e.defer(),s.timeout=oe.promise,i.get(a,s).success(R(n)).error(U)}function z(i){Y(),oe=e.defer(),t.remoteApiHandler(i,oe.promise).then(R(i))["catch"](U)}function B(){t.showDropdown=!1,t.results=[],re&&(re.scrollTop=0)}function G(){t.showDropdown=!0,t.currentIndex=-1,t.results=[]}function W(e){var i,n,s,a,o=t.searchFields.split(","),r=[];for(i=0;i<t.localData.length;i++){for(n=!1,s=0;s<o.length;s++)a=S(t.localData[i],o[s])||"",n=n||a.toLowerCase().indexOf(e.toLowerCase())>=0;n&&(r[r.length]=t.localData[i])}t.searching=!1,J(r,e)}function V(e,i,n){if(n)for(var s in i)if(i[s].toLowerCase()===n.toLowerCase())return void t.selectResult(e)}function K(e){!e||e.length<ie||(t.localData?t.$apply(function(){W(e)}):t.remoteApiHandler?z(e):H(e))}function J(e,i){var n,s,a,o,r,l;if(e&&e.length>0)for(t.results=[],n=0;n<e.length;n++)t.titleField&&""!==t.titleField&&(o=r=M(e[n])),s="",t.descriptionField&&(s=l=S(e[n],t.descriptionField)),a="",t.imageField&&(a=S(e[n],t.imageField)),t.matchClass&&(r=F(o,i),l=F(s,i)),t.results[t.results.length]={title:r,description:l,image:a,originalObject:e[n]},t.autoMatch&&V(t.results[t.results.length-1],{title:o,desc:s||""},t.searchStr);else t.results=[]}function Q(){t.localData?J(t.localData,""):t.remoteApiHandler?z(""):H("")}var Z,X,ee,te=a.find("input"),ie=m,ne=null,se=h,ae=null,oe=null,re=a[0].querySelector(".autocomplete-dropdown"),le=!1,de=null;a.on("mousedown",function(e){e.target.id?(de=e.target.id,de===t.id+"_dropdown"&&document.body.addEventListener("click",k)):de=e.target.className}),t.currentIndex=null,t.searching=!1,ee=t.$watch("initialValue",function(e,i){e&&(ee(),"object"==typeof e?(t.searchStr=M(e),x({originalObject:e})):"string"==typeof e&&e.length>0?t.searchStr=e:console&&console.error&&console.error("Tried to set initial value of autocomplete to",e,"which is an invalid value"),C(!0))}),t.$on("autocomplete-alt:clearInput",function(e,i){i&&i!==t.id||(t.searchStr=null,x(),C(!1),B())}),t.onFocusHandler=function(){t.focusIn&&t.focusIn(),0!==ie||t.searchStr&&0!==t.searchStr.length||(t.showDropdown=!0,Q())},t.hideResults=function(e){de&&(de===t.id+"_dropdown"||de.indexOf("autocomplete")>=0)?de=null:(Z=s(function(){B(),t.$apply(function(){t.searchStr&&t.searchStr.length>0&&te.val(t.searchStr)})},g),Y(),t.focusOut&&t.focusOut(),t.overrideSuggestions&&t.searchStr&&t.searchStr.length>0&&-1===t.currentIndex&&P())},t.resetHideResults=function(){Z&&s.cancel(Z)},t.hoverRow=function(e){t.currentIndex=e},t.selectResult=function(e){t.matchClass&&(e.title=M(e.originalObject),e.description=S(e.originalObject,t.descriptionField)),t.searchStr=t.clearSelected?null:e.title,x(e),B()},t.inputChangeHandler=function(e){return e.length<ie?B():0===e.length&&0===ie&&(t.searching=!1,Q()),t.inputChanged&&(e=t.inputChanged(e)),e},t.fieldRequiredClass&&""!==t.fieldRequiredClass&&(se=t.fieldRequiredClass),t.minlength&&""!==t.minlength&&(ie=parseInt(t.minlength,10)),t.pause||(t.pause=f),t.clearSelected||(t.clearSelected=!1),t.overrideSuggestions||(t.overrideSuggestions=!1),t.fieldRequired&&_&&C(t.initialValue?!0:!1),t.inputType=y.type?y.type:"text",t.textSearching=y.textSearching?y.textSearching:b,t.textNoResults=y.textNoResults?y.textNoResults:w,t.maxlength=y.maxlength?y.maxlength:p,te.on("keydown",N),te.on("keyup",T),X=$("remoteUrlResponseFormatter"),t.$on("$destroy",function(){C(!0)}),s(function(){var e=getComputedStyle(re);le=e.maxHeight&&"auto"===e.overflowY})}}}])}),/**!
 * easy-pie-chart
 * Lightweight plugin to render simple, animated and retina optimized pie charts
 *
 * @license
 * @author Robert Fleischmann <rendro87@gmail.com> (http://robert-fleischmann.de)
 * @version 2.1.7
 **/
function(e,t){"function"==typeof define&&define.amd?define(["angular"],function(e){return t(e)}):"object"==typeof exports?module.exports=t(require("angular")):t(angular)}(this,function(e){!function(e){return e.module("easypiechart",[]).directive("easypiechart",[function(){return{restrict:"AE",require:"?ngModel",scope:{percent:"=",options:"="},link:function(t,n,s){t.percent=t.percent||0;var a={barColor:"#ef1e25",trackColor:"#f9f9f9",scaleColor:"#dfe0e0",scaleLength:5,lineCap:"round",lineWidth:3,size:110,rotate:0,animate:{duration:1e3,enabled:!0}};t.options=e.extend(a,t.options);var o=new i(n[0],a);t.$watch("percent",function(e,t){o.update(e)})}}}])}(e);var t=function(e,t){var i,n=document.createElement("canvas");e.appendChild(n),"object"==typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(n);var s=n.getContext("2d");n.width=n.height=t.size;var a=1;window.devicePixelRatio>1&&(a=window.devicePixelRatio,n.style.width=n.style.height=[t.size,"px"].join(""),n.width=n.height=t.size*a,s.scale(a,a)),s.translate(t.size/2,t.size/2),s.rotate((-0.5+t.rotate/180)*Math.PI);var o=(t.size-t.lineWidth)/2;t.scaleColor&&t.scaleLength&&(o-=t.scaleLength+2),Date.now=Date.now||function(){return+new Date};var r=function(e,t,i){i=Math.min(Math.max(-1,i||0),1);var n=0>=i?!0:!1;s.beginPath(),s.arc(0,0,o-5,0,2*Math.PI*i,n),s.fillStyle="#FFF",s.fill(),s.strokeStyle=e,s.lineWidth=t,s.stroke(),s.beginPath(),s.arc(0,0,o-2,0,2*Math.PI*100,n),s.strokeStyle="#FFF",s.lineWidth=2,s.stroke()},l=function(){var e,i;s.lineWidth=1,s.fillStyle=t.scaleColor,s.save();for(var n=24;n>0;--n)n%6===0?(i=t.scaleLength,e=0):(i=.6*t.scaleLength,e=t.scaleLength-i),s.fillRect(-t.size/2+e,0,i,1),s.rotate(Math.PI/12);s.restore()},d=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),c=function(){t.scaleColor&&l(),t.trackColor&&r(t.trackColor,t.trackWidth||t.lineWidth,1)};this.getCanvas=function(){return n},this.getCtx=function(){return s},this.clear=function(){s.clearRect(t.size/-2,t.size/-2,t.size,t.size)},this.draw=function(e){t.scaleColor||t.trackColor?s.getImageData&&s.putImageData?i?s.putImageData(i,0,0):(c(),i=s.getImageData(0,0,t.size*a,t.size*a)):(this.clear(),c()):this.clear(),s.lineCap=t.lineCap;var n;n="function"==typeof t.barColor?t.barColor(e):t.barColor,r(n,t.lineWidth,e/100)}.bind(this),this.animate=function(e,i){var n=Date.now();t.onStart(e,i);var s=function(){var a=Math.min(Date.now()-n,t.animate.duration),o=t.easing(this,a,e,i-e,t.animate.duration);this.draw(o),t.onStep(e,i,o),a>=t.animate.duration?t.onStop(e,i):d(s)}.bind(this);d(s)}.bind(this)},i=function(e,i){var n={barColor:"#ef1e25",trackColor:"#f9f9f9",scaleColor:"#dfe0e0",scaleLength:5,lineCap:"round",lineWidth:3,trackWidth:void 0,size:110,rotate:0,animate:{duration:1e3,enabled:!0},easing:function(e,t,i,n,s){return t/=s/2,1>t?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},onStart:function(e,t){},onStep:function(e,t,i){},onStop:function(e,t){}};if("undefined"!=typeof t)n.renderer=t;else{if("undefined"==typeof SVGRenderer)throw new Error("Please load either the SVG- or the CanvasRenderer");n.renderer=SVGRenderer}var s={},a=0,o=function(){this.el=e,this.options=s;for(var t in n)n.hasOwnProperty(t)&&(s[t]=i&&"undefined"!=typeof i[t]?i[t]:n[t],"function"==typeof s[t]&&(s[t]=s[t].bind(this)));s.easing="string"==typeof s.easing&&"undefined"!=typeof jQuery&&jQuery.isFunction(jQuery.easing[s.easing])?jQuery.easing[s.easing]:n.easing,"number"==typeof s.animate&&(s.animate={duration:s.animate,enabled:!0}),"boolean"!=typeof s.animate||s.animate||(s.animate={duration:1e3,enabled:s.animate}),this.renderer=new s.renderer(e,s),this.renderer.draw(a),e.dataset&&e.dataset.percent?this.update(parseFloat(e.dataset.percent)):e.getAttribute&&e.getAttribute("data-percent")&&this.update(parseFloat(e.getAttribute("data-percent")))}.bind(this);this.update=function(e){return e=parseFloat(e),s.animate.enabled?this.renderer.animate(a,e):this.renderer.draw(e),a=e,this}.bind(this),this.disableAnimation=function(){return s.animate.enabled=!1,this},this.enableAnimation=function(){return s.animate.enabled=!0,this},o()}}),function(e){e.module("frontend.ui.tooltips",[]).directive("tooltips",["$window","$compile","$timeout",function(t,i,n){var s=8,a=9,o=10,r="_720kb-tooltip-";return{restrict:"A",scope:{},link:function(l,d,c){var u,v,m,p,f,g,h,b,w=!1,y=e.element(d[0]),_=e.element(t.document.getElementsByTagName("body")[0]),k=c.tooltipTimeout||0,E=c.tooltipTitle||c.title||"",x=c.tooltipContent||"",$=c.tooltipShowTrigger||"mouseover",I=c.tooltipHideTrigger||"mouseleave",M=c.tooltipSide||"top",S=M,F=c.tooltipSize||"medium",C="undefined"!=typeof c.tooltipTry&&null!==c.tooltipTry?l.$eval(c.tooltipTry):!0,T=c.tooltipClass||"",P=(c.tooltipSpeed||"medium").toLowerCase(),A="undefined"!=typeof c.tooltipLazy&&null!==c.tooltipLazy?l.$eval(c.tooltipLazy):!0,j='<div class="_720kb-tooltip '+r+F+'"><div class="'+r+'title"> '+E+"</div>"+x+' <span class="'+r+'caret"></span></div>';l.parseSpeed=function(){switch(P){case"fast":P=100;break;case"medium":P=450;break;case"slow":P=800;break;default:P=Number(P)}},u=i(j)(l),u.addClass(T),_.append(u),l.isTooltipEmpty=function(){return E||x?void 0:!0},l.initTooltip=function(e){l.isTooltipEmpty()||(f=y[0].offsetHeight,g=y[0].offsetWidth,h=l.getRootOffsetTop(y[0],0),b=l.getRootOffsetLeft(y[0],0),v=u[0].offsetHeight,m=u[0].offsetWidth,l.parseSpeed(),l.tooltipPositioning(e))},l.getRootOffsetTop=function(e,t){return null===e.offsetParent?t+e.offsetTop:l.getRootOffsetTop(e.offsetParent,t+e.offsetTop)},l.getRootOffsetLeft=function(e,t){return null===e.offsetParent?t+e.offsetLeft:l.getRootOffsetLeft(e.offsetParent,t+e.offsetLeft)},y.bind($,function(){A&&w||(w=!0,l.initTooltip(S)),C&&l.tooltipTryPosition(),l.showTooltip()}),y.bind(I,function(){l.hideTooltip()}),l.showTooltip=function(){u.addClass(r+"open"),u.css("transition","opacity "+P+"ms linear"),k>0&&n(function(){l.hideTooltip()},k)},l.hideTooltip=function(){u.css("transition","opacity "+P),u.removeClass(r+"open")},l.removePosition=function(){u.removeClass(r+"left").removeClass(r+"right").removeClass(r+"top").removeClass(r+"bottom ")},l.tooltipPositioning=function(e){l.removePosition();var t,i;"small"===F?p=s:"medium"===F?p=a:"large"===F&&(p=o),"left"===e&&(t=h+f/2-v/2,i=b-(m+p),u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"left")),"right"===e&&(t=h+f/2-v/2,i=b+g+p,u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"right")),"top"===e&&(t=h-p-v,i=b+g/2-m/2,u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"top")),"bottom"===e&&(t=h+f+p,i=b+g/2-m/2,u.css("top",t+"px"),u.css("left",i+"px"),u.addClass(r+"bottom"))},l.tooltipTryPosition=function(){var e=u[0].offsetHeight,i=u[0].offsetWidth,n=u[0].offsetTop,s=u[0].offsetLeft,a=t.outerWidth,o=t.outerHeight,r=a-(i+s),d=o-(e+n),c=y[0].offsetHeight,v=y[0].offsetWidth,m=y[0].offsetLeft,p=y[0].offsetTop,f=a-(m+v),g=o-(c+p),h={left:s,top:n,bottom:d,right:r},b={left:m,right:f,top:p,bottom:g},w=Object.keys(b).reduce(function(e,t){return b[e]>b[t]?e:t}),_=Object.keys(h).reduce(function(e,t){return h[e]<h[t]?e:t});h[_]<5&&(S=w,l.initTooltip(w))},e.element(t).bind("resize",function(){l.hideTooltip(),l.initTooltip(M)})}}}])}(angular),function(){function e(e,t,i,n,s,a,o,r){function l(){v.changed=!1,t.getFilters().then(function(t){v.distanceUnit=t.distance_unit,e.distance_unit=t.distance_unit,v.filterId=t.id,v.changed=!1},function(e){})}function d(e){v.distanceUnit=e}function c(){r({method:"POST",url:"/accounts/deactivate/",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),o.location.href="/accounts/logout",o.location.assign()}function u(){v.loadingSave=!0,t.saveFilters({distance_unit:v.distanceUnit,user:"/api/v1/auth/user/"+i+"/"}).then(function(t){v.changed=!1,v.loadingSave=!1,e.distance_unit=v.distanceUnit},function(e){v.changed=!1})}var v=this;v.changed=!1,v.setUnit=d,v.getDistanceUnit=l,v.saveSettings=u,v.deleteUser=c,v.loadingSave=!1,v.distanceUnit="miles",a(function(){v.changed=!1},1e3),n.$watch(angular.bind(this,function(e){return v.distanceUnit}),function(e){v.changed=!0}),v.getDistanceUnit()}angular.module("persice").controller("SettingsController",e),e.$inject=["$rootScope","FilterRepository","USER_ID","$scope","$log","$timeout","$window","$http"]}(),function(){function e(e,t,i){}angular.module("persice").controller("SearchPageController",e),e.$inject=["$scope","$log","$state"]}(),angular.module("persice").controller("OfferCreateCtrl",["$scope","$http","$rootScope","APP_ID","$state","$log","OffersFactory","SubjectsFactory","USER_ID","$filter",function(e,t,i,n,s,a,o,r,l,d){e.subject="",e.resourceUri=null,e.messageShow=!1,e.message="",e.userUri="/api/v1/auth/user/"+l+"/",e.inputChanged=function(t){e.subject=t},e.selectResult=function(t){void 0!==t?(e.subject=t.originalObject.description,e.resourceUri=t.originalObject.resource_uri):e.resourceUri=null},e.saveOffer=function(){var r={offer_subject:e.subject,user:e.userUri};o.save({},r,function(e){var o="https://graph.facebook.com/v2.3/"+n+"/activities?access_token="+i.fbAuth.accessToken,r=Math.round(+new Date/1e3),l={event:"CUSTOM_APP_EVENTS",application_tracking_enabled:1,advertiser_tracking_enabled:0,custom_events:[{_eventName:"Onboarding flow user created offer",_appVersion:"0.0.1",_logTime:r,fb_content_type:"Onboarding flow"}]};t.post(o,l).success(function(e,t,i,n){a.info("FB activity post success")}).error(function(e,t,i,n){a.error("FB activity post failure")}),s.go("finalstep")},function(t){e.resourceUri=null,e.messageShow=!0,e.message=t.data.offer?t.data.offer.error[0]:"There was an error when trying to save your offer."})},e.createOffer=function(){return e.messageShow=!1,e.message="",""===e.subject?(e.message="Entering your offer is required to continue.",e.messageShow=!0,!1):e.subject.length>300?(e.message="Offer cannot have more than 300 characters.",e.messageShow=!0,!1):void e.saveOffer()}}]),function(){function e(e,t,i,n){var s=this;s.user={id:t,photo:i}}angular.module("persice").controller("MyProfileController",e),e.$inject=["$scope","USER_ID","USER_PHOTO","$log"]}(),function(){function e(e,t,i,n,s,a,o,r,l,d,c,u){function v(){g.q="",g.getFriends()}function m(){g.nextOffset=10,g.next=null,g.loading=!0,s.query({format:"json",first_name:g.q,limit:10,offset:0}).$promise.then(function(e){if(g.friends=e.objects,g.next=e.meta.next,0===g.friends.length)g.pok?g.noResults=!0:(g.noConnections=!0,g.pok=!0);else{g.pok=!0,g.noResults=!1,g.noConnections=!1;for(var t in g.friends)g.friends[t].totalFriends=0,g.friends[t].totalFriends+=g.friends[t].mutual_bk_friends_count,g.friends[t].totalFriends+=g.friends[t].mutual_fb_friends_count,g.friends[t].totalFriends+=g.friends[t].mutual_linkedin_connections_count,g.friends[t].totalFriends+=g.friends[t].mutual_twitter_friends_count,g.friends[t].totalFriends+=g.friends[t].mutual_twitter_followers_count}g.loading=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);a.error(i),g.noConnections=!0,g.loading=!1})}function p(){var e=r.defer();return null===g.next?(e.reject(),e.promise):(g.loadingMore?e.reject():(g.loadingMore=!0,s.query({format:"json",limit:10,first_name:g.q,offset:g.nextOffset}).$promise.then(function(t){var i=t.objects;g.next=t.meta.next,g.nextOffset+=10;for(var n in i)i[n].totalFriends=0,i[n].totalFriends+=i[n].mutual_bk_friends_count,i[n].totalFriends+=i[n].mutual_fb_friends_count,i[n].totalFriends+=i[n].mutual_linkedin_connections_count,i[n].totalFriends+=i[n].mutual_twitter_friends_count,i[n].totalFriends+=i[n].mutual_twitter_followers_count,g.friends.push(i[n]);g.loadingMore=!1,e.resolve()},function(t){e.reject();var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);a.error(n),g.loadingMore=!1})),e.promise)}function f(e){null===g.friends[e].updated_at?l.get("/api/v1/new_connections/updated_at/?format=json&friend_id="+g.friends[e].friend_id).success(function(t,i,n,s){u.refreshTotalConnections(),c.go("friendprofile",{userId:g.friends[e].friend_id})}).error(function(t,i,n,s){c.go("friendprofile",{userId:g.friends[e].friend_id})}):c.go("friendprofile",{userId:g.friends[e].friend_id})}var g=this;g.friends=[],g.q="",g.noConnections=!1,g.pok=!1,g.noResults=!1,g.loading=!1,g.loadingMore=!1,g.nextOffset=10,g.next=null,g.getFriends=m,g.loadMoreFriends=p,g.gotoConnection=f,g.reset=v,g.getFriends()}angular.module("persice").controller("MyConnectionsController",e),e.$inject=["$scope","FriendsFactory","USER_ID","$resource","ConnectionsFactory","$log","$timeout","$q","$http","$filter","$state","NotificationsRepository"]}(),angular.module("persice").factory("MatchFeedFactory",["$resource",function(e){return e("/api/v1/matchfeed/:matchId/:param",{matchId:"@matchId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),function(){function e(e,t,i){}angular.module("persice").controller("MatchFeedController",e),e.$inject=["$scope","$log","$timeout"]}(),function(){function e(e,t,i,n,s,a,o){function r(){d.nextOffset=12,d.next=null,d.loading=!0,d.noResults=!1,s.query({format:"json",limit:12,offset:0,filter:!0}).$promise.then(function(e){var t=e.objects;if(d.people=[],d.next=e.meta.next,0===e.objects.length)d.noResults=!0;else for(var i in t)d.people.push(t[i]);d.loading=!1},function(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);t.error(n),d.noResults=!0,d.loading=!1})}function l(){var e=n.defer();return null===d.next?(e.reject(),e.promise):(d.loadingMore?e.reject():(d.loadingMore=!0,s.query({format:"json",limit:6,offset:d.nextOffset}).$promise.then(function(t){var i=t.objects;d.nextOffset+=6,d.next=t.meta.next;for(var n in i)d.people.push(i[n]);d.loadingMore=!1,e.resolve()},function(i){e.reject();var n=(i.data,i.status),s=(i.header,i.config,"Error "+n);t.error(s),d.loadingMore=!1,e.reject()})),e.promise)}var d=this;d.people=[],d.options={animate:{duration:1500,enabled:!0},size:70,barColor:"#FA8072",scaleColor:!1,lineWidth:3,lineCap:"circle",rotate:180,trackColor:"#C0C0C0"},d.loading=!1,d.loadingMore=!1,d.noResults=!1,d.nextOffset=12,d.next=null,d.getCrowd=r,d.loadMore=l,d.getCrowd(),a.$on("refreshMatchFeed",function(){o.is("matchfeed2")&&d.getCrowd()})}angular.module("persice").controller("CrowdController",e),e.$inject=["$scope","$log","$timeout","$q","MatchFeedFactory","$rootScope","$state"]}(),angular.module("persice").controller("MainCtrl",["$scope",function(e){e.greetingMessage="Welcome to"}]),function(){function e(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p,f){function g(){if(_.counter>0){var e="https://graph.facebook.com/v2.3/"+n+"/activities?access_token="+t.fbAuth.accessToken,s=Math.round(+new Date/1e3),r={event:"CUSTOM_APP_EVENTS",application_tracking_enabled:1,advertiser_tracking_enabled:0,custom_events:[{_eventName:"Onboarding flow user created interests",_appVersion:"0.0.1",_logTime:s,fb_content_type:"Onboarding flow"}]};i.post(e,r).success(function(e,t,i,n){a.info("FB activity post success")}).error(function(e,t,i,n){a.error("FB activity post failure")}),u.go("goalcreate")}else o({messageTemplate:'<div class="notify-info-header">Warning</div><p>To continue please select at least one interest.</p>',scope:p,classes:"notify-info",icon:"warning circle",duration:4e3})}function h(){_.searchQuery="",_.getAllInterests(),_.noResults=!1}function b(){_.userInterests=[],k.width()>400&&(_.limit=400),_.nextOffset=100,_.next=null,_.noResults=!1,_.loadingInterests=!0,_.allInterests.splice(0,_.allInterests.length),e.query({user_id:r,format:"json",limit:200,offset:0}).$promise.then(function(e){_.counter=e.meta.total_count,e.objects.length>0&&(_.userInterests=e.objects),s.query({format:"json",limit:_.limit,description__icontains:_.searchQuery,offset:0}).$promise.then(function(e){_.next=e.meta.next;var t=e.objects;if(t.length>0)for(var i=t.length-1;i>=0;i--){t[i].active=!1,t[i].interest_resource=null;for(var n=_.userInterests.length-1;n>=0;n--)t[i].resource_uri===_.userInterests[n].interest&&(t[i].interest_resource=_.userInterests[n].resource_uri,t[i].active=!0);_.allInterests.push(t[i])}else _.allInterests.splice(0,_.allInterests.length),_.noResults=!0;_.loadingInterests=!1},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);a.error(i),_.loadingInterests=!1})},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);a.error(i),_.loadingInterests=!1})}function w(){var t=v.defer();return _.loadingMore?t.reject():null!==_.next?(_.loadingMore=!0,d(function(){e.query({user_id:r,format:"json",limit:200,offset:0}).$promise.then(function(e){_.counter=e.meta.total_count,e.objects.length>0&&(_.userInterests=e.objects),s.query({format:"json",description__icontains:_.searchQuery,offset:_.nextOffset,limit:30}).$promise.then(function(e){var i=e.objects;_.next=e.meta.next,_.nextOffset+=30,e.objects.length>0&&(i=e.objects);for(var n=i.length-1;n>=0;n--){i[n].active=!1,i[n].interest_resource=null;for(var s=_.userInterests.length-1;s>=0;s--)i[n].resource_uri===_.userInterests[s].interest&&(i[n].interest_resource=_.userInterests[s].resource_id,i[n].active=!0);_.allInterests.push(i[n])}_.loadingMore=!1,t.resolve()},function(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);a.error(n),_.loadingMore=!1,t.reject()})},function(e){var i=(e.data,e.status),n=(e.header,e.config,"Error "+i);a.error(n),t.reject()})},400)):t.reject(),t.promise}function y(t){var i=_.allInterests[t];if(i)if(i.active){var n=c(i.interest_resource);i.loading=!0,n["delete"]().$promise.then(function(e){i.active=!1,i.interest_resource=null,_.counter--,i.loading=!1},function(e){var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);a.error(n),i.loading=!1,i.error=!0})}else if(_.counter>=10)o({messageTemplate:'<div class="notify-info-header">Warning</div><p>Please select up to 10 interests.</p>',scope:p,classes:"notify-info",icon:"warning circle"});else{var s={interest_subject:i.description,user:_.userUri};i.loading=!0,e.save({},s,function(e){i.loading=!1,i.error=!1,i.interest_resource=e.resource_uri,i.active=!0,_.counter++},function(e){i.errorMessage=e.data.interest.error[0],o({messageTemplate:'<div class="notify-info-header">Error</div><p>'+i.errorMessage+"</p>",scope:p,classes:"notify-info",icon:"warning circle"}),i.loading=!1,i.error=!0})}}var _=this;_.useInterest=y,_.getAllInterests=b,_.nextStep=g,_.searchQuery="",_.userUri="/api/v1/auth/user/"+r+"/",_.next=null,_.nextOffset=100,_.loadingMore=!1,_.noResults=!1,_.reset=h,_.loadMoreInterests=w,_.allInterests=[],_.counter=0,_.loadingInterests=!1,_.userInterests=[];var k=angular.element(f);_.limit=100,_.getAllInterests()}angular.module("persice").controller("InterestsController",e),e.$inject=["InterestsFactory","$rootScope","$http","APP_ID","InterestSubjectFactory","$log","notify","USER_ID","$filter","$timeout","$resource","$state","$q","lodash","$scope","$window"]}(),function(){function e(e,t,i,n,s,a){function o(){function t(e){v.inboxMessages.splice(0,v.inboxMessages.length),v.next=e.meta.next,v.total=e.meta.total,v.nextOffset=10;var t=e.objects,i=0;for(var s in t)null===t[s].read_at&&null!==t[s].last_message_body&&i++,v.inboxMessages.push({firstName:t[s].first_name,friendId:t[s].friend_id,facebookId:t[s].facebook_id,sentAt:n("amDateFormat")(t[s].sent_at,"h:mm a"),readAt:t[s].read_at,id:t[s].id,body:t[s].last_message_body});v.unreadMessagesCounter=i}function s(e){v.inboxMessages.splice(0,v.inboxMessages.length);var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);i.error(n)}return i.info("fetching inbox"),e.query({format:"json",limit:v.limit,offset:0}).$promise.then(t,s)}function r(){return v.unreadMessagesCounter}function l(){return v.inboxMessages}function d(e){v.next=e.meta.next,v.nextOffset+=v.pageSize;var t=e.objects,i=0;for(var s in t)null===t[s].read_at&&null!==t[s].last_message_body&&i++,v.inboxMessages.push({firstName:t[s].first_name,friendId:t[s].friend_id,facebookId:t[s].facebook_id,sentAt:n("amDateFormat")(t[s].sent_at,"h:mm a"),readAt:t[s].read_at,id:t[s].id,body:t[s].last_message_body});v.unreadMessagesCounter+=i,v.loadingMore=!1,deferred.resolve()}function c(e){var t=(e.data,e.status),n=(e.header,e.config,"Error "+t);i.error(n),v.loadingMore=!1,deferred.reject()}function u(){console.log("loading more messages in inbox");var t=a.defer();return null===v.next?(t.reject(),t.promise):(v.loadingMore?t.reject():(v.loadingMore=!0,e.query({format:"json",limit:10,offset:v.nextOffset}).$promise.then(d,c)),t.promise)}var v={getInboxMessages:o,getUnreadMessagesCounter:r,getAllMessages:l,loadMore:u,unreadMessagesCounter:0,inboxMessages:[],limit:10,offset:0,nextOffset:10,next:null,total:0,pageSize:10,loadingMore:!1};return v}angular.module("persice").factory("InboxRepository",e),e.$inject=["InboxFactory","NotificationsRepository","$log","$filter","$rootScope","$q"]}(),function(){function e(e,t,i,n,s){function a(){function e(e){l.loadingMessages=!1,l.loadInbox()}function t(e){l.loadingMessages=!1}l.loadingMessages=!0,n.getInboxMessages().then(e,t)}function o(){l.allMessages=n.getAllMessages()}function r(){function e(e){l.loadingMore=!1}function t(e){l.loadingMore=!1}l.loadingMore=!0,n.loadMore().then(e,t)}var l=this;l.allMessages=[],l.loadInbox=o,l.loadMore=r,l.refresh=a,l.loadingMessages=!1,l.loadingMore=!1,l.q="",l.refresh()}angular.module("persice").controller("InboxController",e),e.$inject=["$scope","$rootScope","$log","InboxRepository","$q"]}(),angular.module("persice").controller("GoalCreateCtrl",["$scope","$http","$rootScope","APP_ID","$state","$log","GoalsFactory","SubjectsFactory","USER_ID",function(e,t,i,n,s,a,o,r,l){e.subject="",e.resourceUri=null,e.messageShow=!1,e.message="",e.userUri="/api/v1/auth/user/"+l+"/",e.inputChanged=function(t){e.subject=t},e.selectResult=function(t){void 0!==t?(e.subject=t.originalObject.description,e.resourceUri=t.originalObject.resource_uri):e.resourceUri=null},e.saveGoal=function(){var r={goal_subject:e.subject,user:e.userUri};o.save({},r,function(e){var o="https://graph.facebook.com/v2.3/"+n+"/activities?access_token="+i.fbAuth.accessToken,r=Math.round(+new Date/1e3),l={event:"CUSTOM_APP_EVENTS",application_tracking_enabled:1,advertiser_tracking_enabled:0,custom_events:[{_eventName:"Onboarding flow user created goal",_appVersion:"0.0.1",_logTime:r,fb_content_type:"Onboarding flow"}]};t.post(o,l).success(function(e,t,i,n){a.info("FB activity post success")}).error(function(e,t,i,n){a.error("FB activity post failure")}),s.go("offercreate")},function(t){e.resourceUri=null,e.messageShow=!0,e.message=t.data.goal?t.data.goal.error[0]:"There was an error when trying to save your goal."})},e.createGoal=function(){return e.messageShow=!1,e.message="",""===e.subject?(e.message="Entering your goal is required to continue.",e.messageShow=!0,!1):e.subject.length>300?(e.message="Goal cannot have more than 300 characters.",e.messageShow=!0,!1):void e.saveGoal()}}]),function(){function e(e,t,i,n,s,a,o){function r(){o.update({friendId:l.friendshipId},{status:-1},function(e){InboxRepository.getInboxMessages(),a.go("myconnections")},function(e){})}var l=this;s.info(n),l.userInfo={id:t,first_name:n.first_name,photo:"//graph.facebook.com/"+n.facebook_id+"/picture?type=large"},l.middleActive=!0,l.friendshipId=i.objects[0].id,l.unFriend=r}angular.module("persice").controller("FriendProfileController",e),e.$inject=["$scope","userId","Connection","UserProfile","$log","$state","FriendsFactory"]}(),function(){function e(e,t,i,n){function s(e){var t=400,i=300,n=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,r=a/2-t/2+n,l=o/2-i/2+s,d="height="+i+",width="+t+",left="+r+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",c="/social/associate/"+e+"/?next=/goals/close_login_popup",u=window.open(c,"Connecting...",d);window.focus&&u.focus()}function a(){o.loading=!0,i.get({format:"json"},{userId:t}).$promise.then(function(e){null!==e.linkedin_provider&&(o.linkedin=e.linkedin_provider),null!==e.twitter_provider&&(o.twitter=e.twitter_username),o.firstName=e.first_name,o.loading=!1})}var o=this;o.loading=!1,o.link=s,o.refreshUser=a,o.twitter="",o.linkedin="",o.firstName=n.first_name,null!==n.linkedin_provider&&(o.linkedin=n.linkedin_provider),null!==n.twitter_provider&&(o.twitter=n.twitter_username)}e.$inject=["$log","USER_ID","UsersFactory","User"],angular.module("persice").controller("FinalStepController",e)}(),function(){function e(e,t,i,n,s,a,o,r,l,d){function c(){n.go("event.attendees",{eventId:s})}function u(){n.go("event.edit",{eventId:s})}function v(){n.go("event.chat",{eventId:s})}function m(e){var i={event:"/api/v1/event/"+g.event.id+"/",rsvp:e,user:"/api/v1/auth/user/"+t+"/"};g.eventRsvp.status!==e&&(g.memberExists?(g.eventRsvp.status=e,d.update({memberId:g.memberId},i,function(i){for(var n=g.event.members.length-1;n>=0;n--)g.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(g.event.members[n].rsvp=e);g.getEvent()},function(e){})):(g.eventRsvp.status=e,d.save({},i,function(e){g.memberExists=!0,g.event.members.push(e),g.memberId=e.id},function(e){})))}function p(){g.loadingEvent=!0,i.query({format:"json"},{eventId:s}).$promise.then(function(i){if(g.eventNotFound=!1,g.event=i,g.eventLocation="",g.mapurlTrue=!1,g.mapurl="","0,0"!==g.event.location?(g.eventLocation=""!==g.event.full_address&&null!==g.event.full_address?g.event.full_address:g.event.street+" "+g.event.city+" "+g.event.zipcode+" "+g.event.state,g.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(g.eventLocation)+"/@"+g.event.location+",15z",g.mapurlTrue=!0):(g.mapurlTrue=!1,g.mapurl="",g.eventLocation=g.event.location_name),g.starts_on_date=moment.utc(g.event.starts_on,moment.ISO_8601).local().format("dddd, MMMM D, YYYY"),g.ends_on_date=moment.utc(g.event.ends_on,moment.ISO_8601).local().format("dddd, MMMM D, YYYY"),g.starts_on_time=moment.utc(g.event.starts_on,moment.ISO_8601).local().format("h:mm A"),g.ends_on_time=moment.utc(g.event.ends_on,moment.ISO_8601).local().format("h:mm A ")+moment.tz(l.timezone).format("z"),g.ends_on_date!==g.starts_on_date?(g.firstrow=g.starts_on_date+" "+g.starts_on_time,g.secondrow=g.ends_on_date+" "+g.ends_on_time):(g.firstrow=g.starts_on_date,g.secondrow=g.starts_on_time+" to "+g.ends_on_time),g.isHost=!1,e.eventpage.isHost.option=!1,e.eventpage.eventId=g.event.id,g.eventRsvp={status:g.event.rsvp},g.memberExists=!1,g.memberId=null,g.event.members.length>0)for(var n=g.event.members.length-1;n>=0;n--)g.event.members[n].is_organizer===!0?g.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(g.isHost=!0,e.eventpage.isHost.option=!0):g.event.members[n].user==="/api/v1/auth/user/"+t+"/"&&(g.memberId=g.event.members[n].id,null!==g.event.members[n].rsvp&&(g.eventRsvp.status=g.event.members[n].rsvp),g.memberExists=!0);g.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;g.loadingEvent=!1,g.eventNotFound=!0})}function f(){""!==g.mapurl&&r.open(g.mapurl)}var g=this;g.showMobile=!0,g.mapurl="",g.mapurlTrue=!1,g.event={},g.eventNotFound=!1,g.editEvent=u,g.openChat=v,g.eventLocation="",e.eventpage.header="Event Details",g.placeholder={name:"Event Name",starts:"Starts",ends:"Ends",repeat:"Repeat",location:"Location",description:"Description",costs:"Costs",invitations:"Invitations",attachments:"Attachments"},g.eventRsvp={status:""},g.changeRsvpStatus=m,g.openMap=f,g.getEvent=p,g.openAttendees=c,e.$on("goBackEvents",function(){n.go(void 0!==a.previousEventFeed?a.previousEventFeed:"events.myevents.list")}),g.isHost=null,g.getEvent()}angular.module("persice").controller("EventViewController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","eventId","$rootScope","$log","$window","angularMomentConfig","MembersFactory"]}(),function(){function e(e,t,i,n,s){function a(){n.is("events.myevents.list")&&n.go("events.myevents.map"),n.is("events.mynetwork.list")&&n.go("events.mynetwork.map"),n.is("events.allevents.list")&&n.go("events.allevents.map")}function o(){n.is("events.myevents.map")&&n.go("events.myevents.list"),n.is("events.mynetwork.map")&&n.go("events.mynetwork.list"),n.is("events.allevents.map")&&n.go("events.allevents.list")}function r(){u.showModal=!0}function l(){u.showModal=!1}function d(){u.showViewModal=!0}function c(){u.showViewModal=!1}var u=this;$(".ui.dimmer.modals").remove(),u.viewEvent=null,u.showModal=!1,u.showViewModal=!1,u.showEventModal=r,u.closeEventModal=l,u.showEventViewModal=d,u.closeEventViewModal=c,u.viewMap=a,u.viewList=o,t.$on("closeModalCreateEvent",function(e,i){u.closeEventModal(),n.is("events.myevents")?t.$broadcast("refreshEventFeed"):n.go("events.myevents.list")}),t.$broadcast("refreshEventsFilters"),t.$on("openViewEventModal",function(e,t){u.viewEvent=t,u.showEventViewModal()}),e.$watch(angular.bind(this,function(e){return u.showViewModal}),function(e){e||(t.eventChatModal=!1)})}angular.module("persice").controller("EventsPageController",e),e.$inject=["$scope","$rootScope","$log","$state","$timeout"]}(),function(){function e(e,t,i,n){function s(){"event.edit"===n.current.name&&e.$broadcast("saveChangedEvent"),"event.create"===n.current.name&&e.$broadcast("saveEvent"),"event.details"===n.current.name&&n.go("event.edit",{eventId:o.eventId}),"event.invitations"===n.current.name&&e.$broadcast("sendInvites")}function a(){e.$broadcast("goBackEvents")}var o=this;o.eventId=null,o.loadingSave=!1,o.isHost={option:!1},o.header="Event Details",$(".ui.dimmer.modals").remove(),o.makeactionEvent=s,o.gotoPreviousState=a}angular.module("persice").controller("EventPageController",e),e.$inject=["$scope","$rootScope","$log","$state"]}(),function(){function e(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p){function f(){E.loadingEvent=!0,i.query({format:"json"},{eventId:d}).$promise.then(function(e){E.event=e,E.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;E.loadingEvent=!1})}function g(e){if(!E.connections[e].is_invited)if(E.connections[e].selected=!E.connections[e].selected,E.connections[e].selected)E.counterNewInvites++,E.selectedPeople.push(E.connections[e].friend_id);else{var t=p.findIndex(E.selectedPeople,E.connections[e].friend_id);E.selectedPeople.splice(t,1),E.counterNewInvites--}}function h(e){s["delete"]({memberId:E.invitedPeople[e].id},function(t){E.connectionFirstName="",E.getConnections(),E.invitedPeople.splice(e,1),E.counterNewInvites=0,E.invitedPeopleCount>0&&E.invitedPeopleCount--},function(e){u.info(e)})}function b(){if(E.selectedPeople.length>0){if(E.loadingInvitesSave)return;E.loadingInvitesSave=!0;for(var t=[],i=E.selectedPeople.length-1;i>=0;i--){var n={event:"/api/v1/event/"+d+"/",is_invited:!1,user:"/api/v1/auth/user/"+E.selectedPeople[i]+"/"};t.push(s.save({},n).$promise)}a.all(t).then(function(e){angular.forEach(e,function(e){var t=v("getIndexByProperty")("user",e.user,E.connections);null!==t&&(E.connections[t].member_id=e.id,E.connections[t].is_invited=!0,E.connections[t].rsvp="")})}).then(function(t){u.info("Sending invites finished."),E.counterNewInvites=0,E.loadingInvitesSave=!1,E.selectedPeople=[],E.invitedPeopleAlreadyLoaded=!1,E.invitedPeopleFirstName="",E.connectionFirstName="",E.getConnections(),E.getInvitedPeople(),m({messageTemplate:'<div class="notify-info-header">Success</div><p>All event invitations have been successfully sent.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),e.$emit("invitesSent")})}else m({messageTemplate:'<div class="notify-error-header">Warning</div><p>Please select connections to invite.</p>',classes:"notify-error",icon:"remove circle",duration:4e3})}function w(){E.friends=[],E.counterNewInvites=0,E.nextOffset=10,E.next=null,E.loadingConnections=!0,o.query({format:"json",first_name:E.connectionFirstName.toLowerCase(),limit:1e3,offset:0}).$promise.then(y,_)}function y(e){E.friends=e.objects,
E.next=e.meta.next,E.connections=[];for(var t=E.friends.length-1;t>=0;t--){for(var i=null===E.friends[t].mutual_friends_count?0:E.friends[t].mutual_friends_count,n=null===E.friends[t].common_goals_offers_interests?0:E.friends[t].common_goals_offers_interests,s={first_name:E.friends[t].first_name,age:E.friends[t].age,common_goals_offers_interests:n,mutual_friends_count:i,tagline:E.friends[t].tagline,facebook_id:E.friends[t].facebook_id,friend_id:E.friends[t].friend_id,user:"/api/v1/auth/user/"+E.friends[t].friend_id+"/",is_invited:!1,member_id:null,rsvp:"",selected:!1,event:parseInt(d),image:"//graph.facebook.com/"+E.friends[t].facebook_id+"/picture?type=square"},a=E.friends[t].events.length-1;a>=0;a--)E.friends[t].events[a].event===s.event&&(s.is_invited=!0,s.rsvp=E.friends[t].events[a].rsvp,s.selected=!0,s.member_id=E.friends[t].events[a].id);p.includes(E.selectedPeople,s.friend_id)&&(s.selected=!0),E.connections.push(s)}E.counterNewInvites=E.selectedPeople.length,E.loadingConnections=!1}function _(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);u.error(i),E.loadingConnections=!1}function k(){function e(e){E.invitedPeopleLoading=!1,E.invitedPeopleAlreadyLoaded||(E.invitedPeopleCount=e.meta.total_count),E.invitedPeopleAlreadyLoaded=!0,0===e.objects.length?E.invitedPeople=[]:(E.invitedPeople=e.objects,E.invitedPeopleNext=e.meta.next)}function t(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);u.error(i),E.invitedPeopleLoading=!1}E.invitedPeopleLoading=!0,n.query({format:"json",limit:1e3,offset:0,event:d,is_organizer:!1,user__first_name__icontains:E.invitedPeopleFirstName}).$promise.then(e,t)}var E=this;E.loadingInvitesSave=!1,E.counterNewInvites=0,E.markSelected=g,E.removeInvite=h,E.sendInvites=b,E.getConnections=w,E.getInvitedPeople=k,E.getEvent=f,E.nextOffset=10,E.loadingConnections=!1,E.connectionFirstName="",E.invitedPeopleLoading=!1,E.invitedPeopleCount=0,E.invitedPeopleFirstName="",E.invitedPeopleNext=null,E.invitedPeopleAlreadyLoaded=!1,E.invitationsOptions={attendingPref:"private",guestInvite:!0},e.eventpage.header="Invitations",e.$on("goBackEvents",function(){r.go("event.edit",{eventId:d})}),E.loadingEvent=!1,E.event={},E.friends=[],E.connections=[],E.invitedPeople=[],E.selectedPeople=[],E.getConnections(),E.getEvent(),E.getInvitedPeople(),e.$on("sendInvites",function(){u.info("sendInvites Event"),E.sendInvites()})}e.$inject=["$scope","USER_ID","EventsFactory","EventsAttendees","MembersFactory","$q","EventsConnections","$state","$timeout","eventId","$rootScope","$log","$filter","notify","lodash"],angular.module("persice").controller("EventInvitationsController",e)}(),function(){function e(e,t,i,n,s,a,o,r,l,d,c,u){function v(){n.go("event.invitations",{eventId:k.eventEdit.id})}function m(){k.loadingDelete||(k.showError=!1,k.loadingDelete=!0,i["delete"]({eventId:k.eventEdit.id},function(e){k.loadingDelete=!1,k.showError=!1,c({messageTemplate:'<div class="notify-info-header">Success</div><p>Event has been successfully deleted.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),n.go(void 0!==a.previousEventFeed?a.previousEventFeed:"events.myevents.list")},function(e){k.loadingDelete=!1,k.errorMessage=[],k.showError=!0,e.data.event&&(k.errorMessage=["Event could not be deleted."])}))}function p(){k.pok=0,k.loadingEvent=!0,i.query({format:"json"},{eventId:s}).$promise.then(function(i){if(k.eventEdit=i,k.eventLocation="",k.mapurlTrue=!1,k.mapurl="","0,0"!==k.eventEdit.location?(k.eventLocation=""!==k.eventEdit.full_address&&null!==k.eventEdit.full_address?k.eventEdit.full_address:k.eventEdit.street+" "+k.eventEdit.city+" "+k.eventEdit.zipcode+" "+k.eventEdit.state,k.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(k.eventLocation)+"/@"+k.eventEdit.location+",15z",k.mapurlTrue=!0):(k.mapurlTrue=!1,k.mapurl="",k.eventLocation=k.eventEdit.location_name),k.eventEdit.starts_on=l.utc(k.eventEdit.starts_on,l.ISO_8601).local().toDate(),k.eventEdit.ends_on=l.utc(k.eventEdit.ends_on,l.ISO_8601).local().toDate(),k.isHost=!1,e.eventpage.isHost.option=!1,k.eventEdit.members.length>0)for(var n=k.eventEdit.members.length-1;n>=0;n--)k.eventEdit.members[n].is_organizer===!0&&k.eventEdit.members[n].user==="/api/v1/auth/user/"+t+"/"&&(k.isHost=!0,e.eventpage.isHost.option=!0);k.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;k.loadingEvent=!1})}function f(){return""===k.eventEdit.ends_on||null===k.eventEdit.ends_on?void(k.eventEdit.ends_on=l(k.eventEdit.starts_on).add(1,"hour").toDate()):void(l(k.eventEdit.ends_on)>=l(k.eventEdit.starts_on)&&(k.eventEdit.ends_on=l(k.eventEdit.starts_on).add(1,"hour").toDate()))}function g(){return""===k.eventEdit.starts_on||null===k.eventEdit.starts_on?void(k.eventEdit.starts_on=l(k.eventEdit.ends_on).subtract(1,"hour").toDate()):void 0}function h(){return k.startsTimeError=!1,k.endsTimeError=!1,l(k.eventEdit.starts_on).unix()<l().unix()?(k.showError=!0,k.errorMessage=["Please select a Starts Date that is not set in past."],void(k.startsTimeError=!0)):(k.showError=!1,k.errorMessage=[],k.startsTimeError=!1,l(k.eventEdit.ends_on).unix()<l().unix()?(k.showError=!0,k.errorMessage=["Please select an Ends Date that is not set in past."],void(k.endsTimeError=!0)):l(k.eventEdit.ends_on).unix()>l().unix()&&l(k.eventEdit.starts_on).unix()>l().unix()&&l(k.eventEdit.starts_on).unix()>l(k.eventEdit.ends_on).unix()?(k.showError=!0,k.errorMessage=["Ends Date must be greater or equal to Starts Date."],k.endsTimeError=!0,void(k.startsTimeError=!0)):(k.showError=!1,k.errorMessage=[],k.startsTimeError=!1,k.endsTimeError=!1,void 0))}function b(){k.loadingSave||(k.showError=!1,k.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},max_attendees:{identifier:"max_attendees",rules:[{type:"empty",prompt:"Please enter Max. attendees"},{type:"integer",prompt:"Please enter Max. attendees as numeric value"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]}}}),$(".ui.form").form("validate form"),""===k.eventEdit.description||""===k.eventEdit.max_attendees||""===k.eventEdit.ends_on||null===k.eventEdit.ends_on||null===k.eventEdit.starts_on||""===k.eventEdit.location||""===k.eventEdit.name||""===k.eventEdit.starts_on||""===k.eventEdit.repeat?(k.showError=!0,(""===k.eventEdit.starts_on||null===k.eventEdit.starts_on)&&(k.startsTimeError=!0),(""===k.eventEdit.ends_on||null===k.eventEdit.ends_on)&&(k.endsTimeError=!0),k.errorMessage=["Please enter all required fields."]):(k.showError=!1,k.validateDates(),k.showSuccess=!1,k.showError||(e.eventpage.loadingSave=!0,delete k.eventEdit.members,delete k.eventEdit.attendees,delete k.eventEdit.most_common_elements,k.loadingSave=!0,i.update({eventId:k.eventEdit.id},k.eventEdit,function(t){k.showError=!1,k.loadingSave=!1,c({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),e.eventpage.loadingSave=!1,n.go("event.details",{eventId:k.eventEdit.id})},function(t){k.loadingSave=!1,k.errorMessage=[],k.showError=!0,e.eventpage.loadingSave=!1,t.data.event&&(k.errorMessage=t.data.event.error)}))))}function w(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function y(){if(null!==k.eventLocation&&"object"==typeof k.eventLocation&&k.eventLocation.hasOwnProperty("address_components")&&k.eventLocation.hasOwnProperty("geometry")){var e=k.eventLocation.address_components;k.eventEdit.street=k.extractFromAddress(e,"route","long_name")+" "+k.extractFromAddress(e,"street_number","long_name"),k.eventEdit.zipcode=k.extractFromAddress(e,"postal_code","long_name"),""===k.eventEdit.zipcode&&(k.eventEdit.zipcode=null),k.eventEdit.location_name=k.eventLocation.name,k.eventEdit.full_address=k.eventLocation.formatted_address,k.eventEdit.state=k.extractFromAddress(e,"administrative_area_level_1","short_name"),k.eventEdit.country=k.extractFromAddress(e,"country","short_name"),k.eventEdit.city=k.extractFromAddress(e,"locality","long_name"),k.eventEdit.state.length>3&&(k.eventEdit.state=k.eventEdit.country),k.eventEdit.location=k.eventLocation.geometry.location.lat()+","+k.eventLocation.geometry.location.lng(),k.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(k.eventLocation.formatted_address)+"/@"+k.eventEdit.location+",15z",k.mapurlTrue=!0}else{if(!(k.pok>2))return void k.pok++;k.eventEdit.full_address="",k.eventEdit.location_name=k.eventLocation,k.eventEdit.location="0,0",k.eventEdit.address=k.eventLocation}}function _(){""!==k.mapurl&&r.open(k.mapurl)}var k=this;k.showError=!1,k.showMobile=!0,k.showSuccess=!1,k.loadingSave=!1,k.loadingDelete=!1,e.eventpage.loadingSave=!1,k.errorMessage=[],k.mapurl="",k.mapurlTrue=!1,k.endsTimeError=!1,k.startsTimeError=!1,k.eventEdit={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:"",max_attendees:""},k.eventLocation="",e.eventpage.header="Event Details",k.placeholder={name:"Event Name",starts:"Starts",ends:"Ends",repeat:"Repeat",location:"Location",description:"Description",costs:"Costs",invitations:"Invitations",attachments:"Attachments",max_attendees:"Max. attendees"},k.$geolocation=u,u.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){k.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),k.autocompleteOptions={location:"0,0",radius:5e4},k.saveEvent=b,k.deleteEvent=m,k.openMap=_,k.extractFromAddress=w,k.parseLocation=y,k.validateDates=h,k.getEvent=p,k.openInvitations=v,k.getEvent(),e.$on("saveChangedEvent",function(){k.saveEvent()}),e.$on("goBackEvents",function(){n.go("event.details",{eventId:k.eventEdit.id})}),k.checkDatesStarts=f,k.checkDatesEnds=g,e.$watch(angular.bind(this,function(e){return k.eventLocation}),function(e){k.parseLocation()}),k.pok=0}angular.module("persice").controller("EventEditController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","eventId","$rootScope","$log","$window","moment","angularMomentConfig","notify","$geolocation"]}(),function(){function e(e,t,i,n,s,a,o,r,l){function d(){return""===h.event.ends_on||null===h.event.ends_on?void(h.event.ends_on=r(h.event.starts_on).add(1,"hour").toDate()):void(r(h.event.ends_on)>=r(h.event.starts_on)&&(h.event.ends_on=r(h.event.starts_on).add(1,"hour").toDate()))}function c(){return""===h.event.starts_on||null===h.event.starts_on?void(h.event.starts_on=r(h.event.ends_on).subtract(1,"hour").toDate()):void 0}function u(){return h.startsTimeError=!1,h.endsTimeError=!1,r(h.event.starts_on).unix()<r().unix()?(h.showError=!0,h.errorMessage=["Please select a Starts Date that is not set in past."],void(h.startsTimeError=!0)):(h.showError=!1,h.errorMessage=[],h.startsTimeError=!1,r(h.event.ends_on).unix()<r().unix()?(h.showError=!0,h.errorMessage=["Please select an Ends Date that is not set in past."],void(h.endsTimeError=!0)):r(h.event.ends_on).unix()>r().unix()&&r(h.event.starts_on).unix()>r().unix()&&r(h.event.starts_on).unix()>r(h.event.ends_on).unix()?(h.showError=!0,h.errorMessage=["Ends Date must be greater or equal to Starts Date."],h.endsTimeError=!0,void(h.startsTimeError=!0)):(h.showError=!1,h.errorMessage=[],h.startsTimeError=!1,h.endsTimeError=!1,void 0))}function v(){h.loadingSave||(h.showError=!1,h.showSuccess=!1,$(".ui.form").form({fields:{name:{identifier:"name",rules:[{type:"empty",prompt:"Please enter Event name"}]},location:{identifier:"location",rules:[{type:"empty",prompt:"Please enter Location"}]},max_attendees:{identifier:"max_attendees",rules:[{type:"empty",prompt:"Please enter Max. attendees"},{type:"integer",prompt:"Please enter Max. attendees as numeric value"}]},repeat:{identifier:"repeat",rules:[{type:"empty",prompt:"Please enter Repeat"}]},description:{identifier:"description",rules:[{type:"empty",prompt:"Please enter Description"}]},starts_on_date:{identifier:"starts_on_date",rules:[{type:"empty",prompt:"Please enter Starts Date"}]},starts_on_time:{identifier:"starts_on_time",rules:[{type:"empty",prompt:"Please enter Starts Time"}]},ends_on_date:{identifier:"ends_on_date",rules:[{type:"empty",prompt:"Please enter Ends Date"}]},ends_on_time:{identifier:"ends_on_time",rules:[{type:"empty",prompt:"Please enter Ends Time"}]}}}),$(".ui.form").form("validate form"),""===h.event.description||""===h.event.max_attendees||""===h.event.ends_on||null===h.event.ends_on||null===h.event.starts_on||""===h.event.location||""===h.event.name||""===h.event.starts_on||""===h.event.repeat?(h.showError=!0,(""===h.event.starts_on||null===h.event.starts_on)&&(h.startsTimeError=!0),(""===h.event.ends_on||null===h.event.ends_on)&&(h.endsTimeError=!0),h.errorMessage=["Please enter all required fields."]):(h.showError=!1,h.validateDates(),h.showSuccess=!1,h.showError||(h.loadingSave=!0,i.save({},h.event,function(e){h.loadingSave=!1,h.showError=!1,n.go("events.myevents.list")},function(e){h.loadingSave=!1,h.errorMessage=[],h.showError=!0,e.data.event&&(h.errorMessage=e.data.event.error)}))))}function m(e,t,i){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].types.length;s++)if(e[n].types[s]===t)return e[n][i];return""}function p(){if(h.mapurl="",h.mapurlTrue=!1,null!==h.eventLocation&&"object"==typeof h.eventLocation&&h.eventLocation.hasOwnProperty("address_components")&&h.eventLocation.hasOwnProperty("geometry")){var e=h.eventLocation.address_components;h.event.street=h.extractFromAddress(e,"route","long_name")+" "+h.extractFromAddress(e,"street_number","long_name"),h.event.zipcode=h.extractFromAddress(e,"postal_code","long_name"),""===h.event.zipcode&&(h.event.zipcode=null),h.event.location_name=h.eventLocation.name,h.event.full_address=h.eventLocation.formatted_address,h.event.state=h.extractFromAddress(e,"administrative_area_level_1","short_name"),h.event.country=h.extractFromAddress(e,"country","short_name"),h.event.city=h.extractFromAddress(e,"locality","long_name"),h.event.state.length>3&&(h.event.state=h.event.country),h.event.location=h.eventLocation.geometry.location.lat()+","+h.eventLocation.geometry.location.lng(),h.mapurl="https://www.google.com/maps/search/"+encodeURIComponent(h.eventLocation.formatted_address)+"/@"+h.event.location+",15z",h.mapurlTrue=!0}else h.event.address=h.eventLocation,h.event.full_address="",h.event.location_name=h.eventLocation,h.event.location="0,0"}function f(){""!==h.mapurl&&o.open(h.mapurl)}function g(){h.showError=!1,h.showSuccess=!1,h.errorMessage=[],h.mapurl="",h.mapurlTrue=!1,h.eventLocation="",h.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:"",max_attendees:""}}var h=this;h.showError=!1,h.showMobile=!0,h.showSuccess=!1,h.errorMessage=[],h.mapurl="",h.mapurlTrue=!1,h.endsTimeError=!1,h.startsTimeError=!1,h.loadingSave=!1,h.$geolocation=l,l.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:2}).then(function(e){h.autocompleteOptions={location:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),radius:5e4}}),h.autocompleteOptions={location:"0,0",radius:5e4},h.event={user:"/api/v1/auth/user/"+t+"/",description:"",ends_on:"",location:"",name:"",repeat:"",starts_on:"",street:"",city:"",zipcode:null,state:"",full_address:"",location_name:"",country:"",max_attendees:""},h.eventLocation="",h.placeholder={name:"Event Name",starts:"Starts",ends:"Ends",repeat:"Repeat",location:"Location",description:"Description",costs:"Costs",invitations:"Invitations",attachments:"Attachments",max_attendees:"Max. attendees"},h.saveEvent=v,h.openMap=f,h.resetForm=g,h.extractFromAddress=m,h.parseLocation=p,h.validateDates=u,e.$on("saveEvent",function(){h.saveEvent()}),e.$on("goBackEvents",function(){n.go(void 0!==s.previousEventFeed?s.previousEventFeed:"events.myevents.list")}),h.checkDatesStarts=d,h.checkDatesEnds=c,e.$watch(angular.bind(this,function(e){return h.eventLocation}),function(e){h.parseLocation()})}angular.module("persice").controller("EventCreateController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","$rootScope","$log","$window","moment","$geolocation"]}(),function(){function e(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p){function f(){if(!b.sendingMessage)if(""===b.newmessage)b.sendingMessage=!1;else{b.sendingMessage=!0;var e={};e={sender:b.sender,event:b.event,body:b.newmessage},s.save({},e,function(t){b.noMessages=!1,e.left=!0,e.sender=t.sender,e.photo=w,e.first_name=t.first_name;var i=u("amDateFormat")(t.sent_at,"dddd, MMMM D, YYYY h:mm a");e.sent_at=i,b.messages.unshift(e),b.newmessage="",r.info("New chat message sent."),b.sendingMessage=!1,m(function(){angular.element("#chat-conversation-content").filter(":not(:animated)").animate({scrollTop:0},1500)},100)},function(e){b.sendingMessage=!1,r.info(e)})}}function g(){b.messages=[],b.noMessages=!1,b.loadingMessages=!0,b.status.loaded=!1,s.query({event:i,limit:20,offset:0}).$promise.then(function(e){var t=e.objects;b.next=e.meta.next,b.status.loaded=!0,0===t.length&&(b.noMessages=!0);for(var i in t){var n=u("amDateFormat")(t[i].sent_at,"dddd, MMMM D, YYYY h:mm a");b.messages.push(t[i].sender===b.sender?{body:v.trustAsHtml(t[i].body),sender:t[i].sender,photo:"//graph.facebook.com/"+t[i].facebook_id+"/picture?type=square",first_name:t[i].first_name,sent_at:n,left:!0}:{body:v.trustAsHtml(t[i].body),sender:t[i].sender,photo:"//graph.facebook.com/"+t[i].facebook_id+"/picture?type=square",first_name:t[i].first_name,sent_at:n,left:!1})}b.loadingMessages=!1},function(e){b.loadingMessages=!1;var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);r.error(i)})}function h(){var e=d.defer();return null===b.next?(e.reject(),e.promise):(b.status.loading?e.reject():(b.status.loading=!0,m(function(){s.query({event:i,offset:b.nextOffset,limit:10}).$promise.then(function(t){var i=t.objects;b.next=t.meta.next,b.nextOffset+=10;for(var n in i){var s=u("amDateFormat")(i[n].sent_at,"dddd, MMMM D, YYYY h:mm a");b.messages.push(i[n].sender===b.sender?{body:v.trustAsHtml(i[n].body),sender:i[n].sender,photo:"//graph.facebook.com/"+i[n].facebook_id+"/picture?type=square",first_name:i[n].first_name,sent_at:s,left:!0}:{body:v.trustAsHtml(i[n].body),sender:i[n].sender,photo:"//graph.facebook.com/"+i[n].facebook_id+"/picture?type=square",first_name:i[n].first_name,sent_at:s,left:!1})}b.status.loading=!1,b.status.loaded=!0,e.resolve()},function(t){e.reject(),b.status.loading=!1;var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);r.error(n)})},400)),e.promise)}var b=this;b.newmessage="",b.messages=[],b.noMessages=!1,b.loadingMessages=!1,b.loadingOlderMessages=!1,b.sendingMessage=!1,b.sender="/api/v1/auth/user/"+t+"/",b.event="/api/v1/event/"+i+"/";var w="//graph.facebook.com/"+n+"/picture?type=square";b.status={loading:!1,loaded:!1},b.nextOffset=20,b.next=null,b.sendMessage=f,b.getMessages=g,b.loadMoreChat=h,e.eventpage.header="Event Chat",e.$on("goBackEvents",function(){a.go("event.details",{eventId:i})}),b.getMessages(),o.$on("receivedEventChatMessage",function(e,t){var i=JSON.parse(t);if(i.sender!==b.sender&&b.event===i.event&&a.is("event.chat")){r.info("new event chat message via websocket");var n=u("amDateFormat")(i.sent_at,"dddd, MMMM D, YYYY h:mm a");b.receivedMessage={body:v.trustAsHtml(i.body),sender:i.sender,photo:"",sent_at:n,first_name:"",left:!1};var s=p(i.sender);s.get().$promise.then(function(e){b.receivedMessage.photo="//graph.facebook.com/"+e.facebook_id+"/picture?type=square",b.receivedMessage.first_name=e.first_name,b.messages.unshift(b.receivedMessage)}),m(function(){angular.element("#chat-conversation-content").filter(":not(:animated)").animate({scrollTop:0},1500)},100)}})}angular.module("persice").controller("EventChatController",e),e.$inject=["$scope","USER_ID","eventId","USER_FACEBOOK_ID","EventChatFactory","$state","$rootScope","$log","$window","$q","moment","$filter","$sce","$timeout","$resource"]}(),function(){function e(e,t,i,n,s,a,o,r,l){function d(){u.loadingEvent=!0,i.query({format:"json"},{eventId:s}).$promise.then(function(e){u.event=e,u.loadingEvent=!1},function(e){e.data,e.status,e.header,e.config;u.loadingEvent=!1})}function c(e){function t(t){u.attendees[e].loading=!1,u.attendees[e].alreadyLoaded||(u.attendees[e].count=t.meta.total_count),u.attendees[e].alreadyLoaded=!0,0===t.objects.length?(u.attendees[e].data=[],u.attendees[e].noResults=!0):(u.attendees[e].data=t.objects,u.attendees[e].next=t.meta.next,u.attendees[e].noResults=!1)}function i(t){var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);o.error(n),u.attendees[e].noResults=!0,u.attendees[e].loading=!1}u.attendees[e].next=null,u.attendees[e].loading=!0,l.query({format:"json",limit:1e3,offset:0,rsvp:u.attendees[e].filters.rsvp,event:u.attendees[e].filters.event,user__first_name__icontains:u.attendees[e].filters.firstName}).$promise.then(t,i)}var u=this;u.getAttendees=c,u.getEvent=d,u.loadingEvent=!1,u.event={},u.attendees={yes:{data:[],alreadyLoaded:!1,filtered:[],filters:{firstName:"",rsvp:"yes",event:s},loading:!1,noResults:!1,nextOffset:10,next:null,count:0},no:{data:[],alreadyLoaded:!1,filtered:[],filters:{firstName:"",rsvp:"no",event:s},loading:!1,noResults:!1,nextOffset:10,next:null,count:0},maybe:{data:[],alreadyLoaded:!1,filtered:[],filters:{firstName:"",rsvp:"maybe",event:s},loading:!1,noResults:!1,nextOffset:10,next:null,count:0}},e.eventpage.header="Attendees",e.$on("goBackEvents",function(){n.go("event.details",{eventId:s})}),u.getEvent(),u.getAttendees("yes"),u.getAttendees("no"),u.getAttendees("maybe")}angular.module("persice").controller("EventAttendeesController",e),e.$inject=["$scope","USER_ID","EventsFactory","$state","eventId","$rootScope","$log","$window","EventsAttendees"]}(),angular.module("persice").controller("EditMyProfileCtrl",["$scope","$timeout","USER_ID","$q","$state","UsersFactory","GoalsFactory","LikesFactory","SubjectsFactory","OffersFactory","InterestsFactory","PhotosFactory","$log","$filter","$cookies","$http","FB_TOKEN","$location","$anchorScroll","$window","$resource","notify",function(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p,f,g,h,b,w,y,_){e.social={twitter:"",linkedin:""},e.userUri="/api/v1/auth/user/"+i+"/",e.user={id:i,firstName:"",lastName:"",age:"",about_me:"",photos:[{id:0,order:0,photo:"",cropped_photo:""},{id:0,order:1,photo:"",cropped_photo:""},{id:0,order:2,photo:"",cropped_photo:""},{id:0,order:3,photo:"",cropped_photo:""},{id:0,order:4,photo:"",cropped_photo:""},{id:0,order:5,photo:"",cropped_photo:""}],goals:[],offers:[],likes:[],interests:[],mutual:{friends:[],facebookfriends:[],twitterfriends:[],twitterfollowers:[],linkedinconnections:[]}},e.loadingUser=!1,e.loadingGoals=!1,e.loadingOffers=!1,e.loadingLikes=!1,e.loadingInterests=!1,e.getUser=function(){e.loadingUser=!0,e.loadingGoals=!0,e.loadingOffers=!0,e.loadingLikes=!0,e.loadingInterests=!0,o.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.goals=t.objects),e.loadingGoals=!1}),d.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.offers=t.objects),e.loadingOffers=!1}),r.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.likes=t.objects),e.loadingLikes=!1}),c.query({user_id:i,format:"json"}).$promise.then(function(t){t.meta.total_count>0&&(e.user.interests=t.objects),e.loadingInterests=!1}),a.get({format:"json"},{userId:i}).$promise.then(function(t){e.user.firstName=t.first_name,e.user.lastName=t.last_name,e.user.about_me=t.about_me,e.user.age=t.age,e.user.facebookId=t.facebook_id,e.user.facebookProfile=t.facebook_profile_url,null!==t.twitter_provider&&(e.social.twitter=t.twitter_username),null!==t.linkedin_provider&&(e.social.linkedin=t.linkedin_provider),e.loadingUser=!1})},e.getUser(),e.link=function(e){var t=350,i=250,n=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,r=a/2-t/2+n,l=o/2-i/2+s,d="height="+i+",width="+t+",left="+r+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",c="/social/associate/"+e+"/?next=/goals/close_login_popup",u=window.open(c,"Connecting...",d);window.focus&&u.focus()},e.unlink=function(e){var t=350,i=250,n=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,r=a/2-t/2+n,l=o/2-i/2+s,d="height="+i+",width="+t+",left="+r+",top="+l+",resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=yes,directories=no,status=yes",c="/social/disconnect/"+e+"/",u=window.open(c,"Disconnecting...",d);window.focus&&u.focus()},e.refreshUser=function(){a.get({format:"json"},{userId:i}).$promise.then(function(t){e.social.twitter=null===t.twitter_provider?"":t.twitter_username,e.social.linkedin=null===t.linkedin_provider?"":t.linkedin_provider})},e.loadingAbout=!1,e.saveAbout=function(){e.loadingAbout=!0,a.update({userId:i},{about_me:e.user.about_me},function(t){e.loadingAbout=!1},function(e){v.info(e)})},e.apiPhotos=[],e.facebookPhotos=[],e.onDropComplete=function(t,i,n){var s=e.user.photos[t],a=e.user.photos.indexOf(i);e.user.photos[t]=i,e.user.photos[t].order=t,e.user.photos[a]=s,e.user.photos[a].order=a,0!==e.user.photos[t].id&&u.update({photoId:e.user.photos[t].id},{order:e.user.photos[t].order},function(e){},function(e){v.info(e)}),0!==e.user.photos[a].id&&u.update({photoId:e.user.photos[a].id},{order:e.user.photos[a].order},function(e){},function(e){v.info(e)})},e.getPhotos=function(){u.query({format:"json"}).$promise.then(function(t){e.apiPhotos=t.objects;for(var i in e.apiPhotos)for(var n in e.user.photos)e.user.photos[n].order===e.apiPhotos[i].order&&(e.user.photos[n].id=e.apiPhotos[i].id,e.user.photos[n].photo=e.apiPhotos[i].photo,e.user.photos[n].cropped_photo=e.apiPhotos[i].cropped_photo)})},e.getPhotos(),e.currentAlbum="",e.getFBPhotos=function(t,i){e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.hideAlbums=!0,e.currentAlbum=i,e.photosLoading=!0,f.get("https://graph.facebook.com/"+t+"?fields=photos{id,height,width,source}&access_token="+g).success(function(t,i,n,s){e.photosLoading=!1,e.facebookPhotos=t.photos.data}).error(function(t,i,n,s){e.photosLoading=!1})},e.backToAlbums=function(){e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.currentAlbum="",e.hideAlbums=!e.hideAlbums,e.getFBAlbums()},e.facebookAlbums=[],e.hideAlbums=!1,e.getFBAlbums=function(){e.showModal=!0,e.albumsLoading=!0,f.get("https://graph.facebook.com/me/albums?fields=picture,name&access_token="+g).success(function(t,i,n,s){e.facebookAlbums=t.data,e.albumsLoading=!1}).error(function(t,i,n,s){e.albumsLoading=!1})},e.deletePhoto=function(){var t=e.userPhotoDeleteIndex;u["delete"]({photoId:e.user.photos[t].id},function(i){e.user.photos[t].photo="",e.user.photos[t].cropped_photo="",e.user.photos[t].id=0},function(e){v.info(e)})},e.closeModal=function(){e.showModal=!1,e.showPhotos=!0,e.myImage=null,e.photoIndex=null,t(function(){h.hash("my-profile-header-edit"),b()},600)},e.showModal=!1,e.albumsLoading=!1,e.photosLoading=!1,e.showPhotos=!0,e.myImage=null,e.photoIndex=null,e.myCroppedImage=null,e.showCrop=function(t){e.photoIndex=t,e.myImage=e.facebookPhotos[t].source,e.showPhotos=!1},e.myCroppedImage="",e.createPhoto=function(t){var n=e.photoIndex,s=e.facebookPhotos[n],a={cropped_photo:t,photo:s.source,order:e.newPhotoIndex,user:"/api/v1/auth/user/"+i+"/"};u.save({},a,function(t){var i=e.newPhotoIndex;e.user.photos[i].photo=t.photo,e.user.photos[i].cropped_photo=t.cropped_photo,e.user.photos[i].id=t.id,e.closeModal()},function(e){})},e.$on("ngRepeatFinishedPhotos",function(){$("#deletePhotoModal").modal("attach events",".delete_photo","show")}),e.$on("ngRepeatFinished",function(){$(".ui.search.goals").search({apiSettings:{url:"api/v1/subject/?format=json&description__icontains={query}",onResponse:function(e){var t={results:[]};return $.each(e.objects,function(e,i){t.results.push({title:i.description})}),t}},minCharacters:3,searchDelay:300,searchFields:["title"],type:"standard",cache:!1,error:{noResults:"No existing goal found. Create new goal &raquo;"},onSelect:function(t,i){var n=$(this).attr("rel");void 0!==t&&(e.user.goals[n].subject=t.title)}}),$(".ui.search.offers").search({apiSettings:{url:"api/v1/subject/?format=json&description__icontains={query}",onResponse:function(e){var t={results:[]};return $.each(e.objects,function(e,i){t.results.push({title:i.description})}),t}},minCharacters:3,searchDelay:400,searchFields:["title"],type:"standard",error:{noResults:"No existing offer found. Create new offer &raquo;"},cache:!1,onSelect:function(t,i){var n=$(this).attr("rel");void 0!==t&&(e.user.offers[n].subject=t.title)}}),$(".ui.search.interests").search({apiSettings:{url:"api/v1/interest_subject/?format=json&description__icontains={query}",onResponse:function(e){var t={results:[]};return $.each(e.objects,function(e,i){t.results.push({title:i.description})}),t}},searchFields:["title"],minCharacters:3,searchDelay:400,type:"standard",error:{noResults:"No existing interest found. Create new interest &raquo;"},cache:!1,onSelect:function(t,i){var n=$(this).attr("rel");void 0!==t&&(e.user.interests[n].interest_subject=t.title)}})}),e.goalNeedSaving=function(t){e.user.goals[t].changed=!0},e.createNewGoal=function(){var t={id:0,subject:"",user:e.userUri,changed:!0};e.user.goals.push(t)},e.removeGoal=function(t){var i=y(e.user.goals[t].resource_uri);0===e.user.goals[t].id?e.user.goals.splice(t,1):i["delete"]().$promise.then(function(i){e.user.goals.splice(t,1)})},e.saveCurrentGoal=function(t){var i=n.defer();if(e.user.goals[t].errorMessage="",e.user.goals[t].error=!1,e.user.goals[t].subject.length>300)return e.user.goals[t].error=!0,e.user.goals[t].errorMessage="Goal cannot have more than 300 characters.",i.reject(),i.promise;if(""===e.user.goals[t].subject)e.user.goals[t].error=!0,e.user.goals[t].errorMessage="Entering your goal is required.",i.reject();else if(0===e.user.goals[t].id){var s={goal_subject:e.user.goals[t].subject,user:e.userUri};e.user.goals[t].loading=!0,e.user.goals[t].error=!1,o.save({},s,function(n){e.user.goals[t].loading=!1,e.user.goals[t].error=!1,e.user.goals[t].id=n.id,e.user.goals[t].goal=n.goal,e.user.goals[t].goal_subject=n.goal_subject,e.user.goals[t].resource_uri=n.resource_uri,e.user.goals[t].user=n.user,e.user.goals[t].changed=!1,i.resolve()},function(n){e.user.goals[t].errorMessage=n.data.goal.error[0],e.user.goals[t].loading=!1,e.user.goals[t].error=!0,i.reject()})}else e.user.goals[t].error=!1,e.user.goals[t].loading=!0,o.update({goalId:e.user.goals[t].id},{goal_subject:e.user.goals[t].subject},function(n){e.user.goals[t].loading=!1,e.user.goals[t].error=!1,e.user.goals[t].goal=n.goal,e.user.goals[t].goal_subject=n.goal_subject,e.user.goals[t].resource_uri=n.resource_uri,e.user.goals[t].changed=!1,i.resolve()},function(n){e.user.goals[t].errorMessage=n.data.goal?n.data.goal.error[0]:"There was an error when trying to save this field.",e.user.goals[t].loading=!1,e.user.goals[t].error=!0,i.reject()});return i.promise},e.offerNeedSaving=function(t){e.user.offers[t].changed=!0},e.createNewOffer=function(){var t={id:0,subject:"",
user:e.userUri,changed:!0};e.user.offers.push(t)},e.removeOffer=function(t){var i=y(e.user.offers[t].resource_uri);0===e.user.offers[t].id?e.user.offers.splice(t,1):i["delete"]().$promise.then(function(i){e.user.offers.splice(t,1)})},e.saveCurrentOffer=function(t){var i=n.defer();if(e.user.offers[t].errorMessage="",e.user.offers[t].error=!1,e.user.offers[t].subject.length>300)return e.user.offers[t].error=!0,e.user.offers[t].errorMessage="Offer cannot have more than 300 characters.",i.reject(),i.promise;if(""===e.user.offers[t].subject)e.user.offers[t].error=!0,e.user.offers[t].errorMessage="Entering your offer is required.",i.reject();else if(0===e.user.offers[t].id){var s={offer_subject:e.user.offers[t].subject,user:e.userUri};e.user.offers[t].loading=!0,e.user.offers[t].error=!1,d.save({},s,function(n){e.user.offers[t].loading=!1,e.user.offers[t].error=!1,e.user.offers[t].id=n.id,e.user.offers[t].offer=n.offer,e.user.offers[t].offer_subject=n.offer_subject,e.user.offers[t].resource_uri=n.resource_uri,e.user.offers[t].user=n.user,e.user.offers[t].changed=!1,i.resolve()},function(n){e.user.offers[t].errorMessage=n.data.offer.error[0],e.user.offers[t].loading=!1,e.user.offers[t].error=!0,i.reject()})}else e.user.offers[t].error=!1,e.user.offers[t].loading=!0,d.update({offerId:e.user.offers[t].id},{offer_subject:e.user.offers[t].subject},function(n){e.user.offers[t].loading=!1,e.user.offers[t].error=!1,e.user.offers[t].offer=n.offer,e.user.offers[t].offer_subject=n.offer_subject,e.user.offers[t].resource_uri=n.resource_uri,e.user.offers[t].changed=!1,i.resolve()},function(n){e.user.offers[t].errorMessage=n.data.offer?n.data.offer.error[0]:"There was an error when trying to save this field.",e.user.offers[t].loading=!1,e.user.offers[t].error=!0,i.reject()});return i.promise},e.interestNeedSaving=function(t){e.user.interests[t].changed=!0},e.createNewInterest=function(){var t={id:0,interest_subject:"",interest:null,user:e.userUri,changed:!0};e.user.interests.push(t)},e.removeInterest=function(t){var i=y(e.user.interests[t].resource_uri);0===e.user.interests[t].id?e.user.interests.splice(t,1):i["delete"]().$promise.then(function(i){e.user.interests.splice(t,1)})},e.saveCurrentInterest=function(t){var i=n.defer();if(e.user.interests[t].errorMessage="",e.user.interests[t].error=!1,e.user.interests[t].interest_subject.length>100)return e.user.interests[t].error=!0,e.user.interests[t].errorMessage="Interest cannot have more than 100 characters.",i.reject(),i.promise;if(""===e.user.interests[t].interest_subject)e.user.interests[t].error=!0,e.user.interests[t].errorMessage="Entering your interest is required.",i.reject();else if(0===e.user.interests[t].id){var s={interest_subject:e.user.interests[t].interest_subject,user:e.userUri};e.user.interests[t].loading=!0,e.user.interests[t].error=!1,c.save({},s,function(n){e.user.interests[t].loading=!1,e.user.interests[t].error=!1,e.user.interests[t].id=n.id,e.user.interests[t].interest=n.interest,e.user.interests[t].interest_subject=n.interest_subject,e.user.interests[t].resource_uri=n.resource_uri,e.user.interests[t].user=n.user,e.user.interests[t].changed=!1,i.resolve()},function(n){e.user.interests[t].errorMessage=n.data.interest.error[0],e.user.interests[t].loading=!1,e.user.interests[t].error=!0,i.reject()})}else e.user.interests[t].error=!1,e.user.interests[t].loading=!0,c.update({interestId:e.user.interests[t].id},{interest_subject:e.user.interests[t].interest_subject},function(n){e.user.interests[t].loading=!1,e.user.interests[t].error=!1,e.user.interests[t].interest=n.interest,e.user.interests[t].interest_subject=n.interest_subject,e.user.interests[t].resource_uri=n.resource_uri,e.user.interests[t].changed=!1,i.resolve()},function(n){e.user.interests[t].errorMessage=n.data.interest?n.data.interest.error[0]:"There was an error when trying to save this field.",e.user.interests[t].loading=!1,e.user.interests[t].error=!0,i.reject()});return i.promise},e.savingAllChanges=!1,e.startSavingChanges=function(){var t=e.saveChanges();e.savingAllChanges=!0,t.then(function(t){v.info("Success saving"),e.savingAllChanges=!1,_({messageTemplate:'<div class="notify-info-header">Success</div><p>All changes have been saved.</p>',classes:"notify-info",icon:"check circle",duration:4e3}),s.go("myprofile")},function(t){v.info("Failed"),e.savingAllChanges=!1,_({messageTemplate:'<div class="notify-error-header">Could not save your profile changes.</div><p>There were some errors. Please see them below.</p>',scope:e,classes:"notify-error",icon:"warning circle",duration:4e3})},function(e){})},e.saveChanges=function(){var t=n.defer(),i=0;for(var s in e.user.goals)e.user.goals[s].changed&&i++;for(var s in e.user.offers)e.user.offers[s].changed&&i++;for(var s in e.user.interests)e.user.interests[s].changed&&i++;if(i>0){for(var s in e.user.goals)e.user.goals[s].changed&&e.saveCurrentGoal(s).then(function(e){i--,0===i&&t.resolve()},function(e){t.reject()},function(e){});for(var s in e.user.offers)e.user.offers[s].changed&&e.saveCurrentOffer(s).then(function(e){i--,0===i&&t.resolve()},function(e){t.reject()},function(e){});for(var s in e.user.interests)e.user.interests[s].changed&&e.saveCurrentInterest(s).then(function(e){i--,0===i&&t.resolve()},function(e){t.reject()},function(e){})}else t.resolve();return t.promise}}]),angular.module("persice").controller("BigMatchFeedCtrl",function(){}),angular.module("persice").controller("ConversationsCtrl",["$rootScope","notify","$resource","$window","$state","NotificationsRepository","InboxRepository","myIoSocket","Connection","$q","$http","$scope","USER_ID","$log","$timeout","FRIEND","MessagesFactory","$filter","FriendsFactory","$sce",function(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p,f,g,h,b,w){u.leftActive=!0,u.messages=[],u.friendshipId=l.objects[0].id,u.friendImage="//graph.facebook.com/"+l.objects[0].facebook_id+"/picture?type=square",t.closeAll(),u.status={loading:!1,loaded:!1},u.q="",u.newmessage="",u.nextOffset=20,u.next=null,u.friend=f,u.recipient="/api/v1/auth/user/"+u.friend.id+"/",u.sender="/api/v1/auth/user/"+v+"/",u.loadingMessages=!1,u.loadingOlderMessages=!1,u.sendingMessage=!1,u.scrollConversations=function(){p(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},1500)},100)},u.loadMore=function(){var e=d.defer();return null===u.next?(e.reject(),e.promise):(u.status.loading?e.reject():(u.status.loading=!0,p(function(){g.query({user_id:u.friend.id,offset:u.nextOffset,limit:10}).$promise.then(function(t){var i=t.objects;u.next=t.meta.next,h("orderBy")(i,"sent_at",!0),u.nextOffset+=10;for(var n in i){var s=h("amDateFormat")(i[n].sent_at,"dddd, MMMM D, YYYY"),a=h("amDateFormat")(i[n].sent_at,"L"),o=h("getIndexByProperty")("date",s,u.messages);null===o&&(u.messages.push({date:s,realDate:a,contents:[]}),o=u.messages.length-1),u.messages[o].contents.push(i[n].sender===u.sender?{body:w.trustAsHtml(i[n].body),sender:i[n].sender,recipient:i[n].recipient,date:a,sent_at:i[n].sent_at,left:!0}:{body:w.trustAsHtml(i[n].body),sender:i[n].sender,recipient:i[n].recipient,date:a,sent_at:i[n].sent_at,left:!1}),u.messages[o].contents=h("orderBy")(u.messages[o].contents,"sent_at",!0)}u.messages=h("orderBy")(u.messages,"realDate"),u.status.loading=!1,u.status.loaded=!0,e.resolve()},function(t){e.reject(),u.status.loading=!1;var i=(t.data,t.status),n=(t.header,t.config,"Error "+i);m.error(n)})},400)),e.promise)},u.getMessages=function(){u.messages=[],u.loadingMessages=!0,u.status.loaded=!1,g.query({user_id:u.friend.id,limit:20,offset:0}).$promise.then(function(e){var t=e.objects;u.next=e.meta.next,h("orderBy")(t,"sent_at",!0),u.status.loaded=!0;for(var i in t){var n=h("amDateFormat")(t[i].sent_at,"dddd, MMMM D, YYYY"),s=h("amDateFormat")(t[i].sent_at,"L"),r=h("getIndexByProperty")("date",n,u.messages);null===r&&(u.messages.push({date:n,realDate:s,contents:[]}),r=u.messages.length-1),u.messages[r].contents.push(t[i].sender===u.sender?{body:w.trustAsHtml(t[i].body),sender:t[i].sender,recipient:t[i].recipient,date:s,sent_at:t[i].sent_at,left:!0}:{body:w.trustAsHtml(t[i].body),sender:t[i].sender,recipient:t[i].recipient,date:s,sent_at:t[i].sent_at,left:!1}),u.messages[r].contents=h("orderBy")(u.messages[r].contents,"sent_at",!0)}u.messages=h("orderBy")(u.messages,"realDate"),u.messages.length>0&&(p(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},0)},100),c.get("/api/v1/inbox/reat_at/?sender_id="+u.friend.id).success(function(e,t,i,n){o.getInboxMessages(),a.refreshTotalInbox()}).error(function(e,t,i,n){})),u.loadingMessages=!1},function(e){u.loadingMessages=!1;var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);m.error(i)})},u.getMessages(),u.sendNewMessage=function(){if(""===u.newmessage)u.sendingMessage=!1;else{u.sendingMessage=!0;var e={};e={sender:u.sender,recipient:u.recipient,body:u.newmessage},g.save({},e,function(t){e.left=!0,e.sent_at=t.sent_at,e.sender=t.sender,e.recipient=t.recipient;var i=h("amDateFormat")(e.sent_at,"L"),n=h("amDateFormat")(e.sent_at,"dddd, MMMM D, YYYY"),s=h("getIndexByProperty")("date",n,u.messages);e.date=i,null===s&&(u.messages.push({date:n,realDate:i,contents:[]}),s=u.messages.length-1),u.messages[s].contents.push(e),u.newmessage="",m.info("New message saved."),u.sendingMessage=!1,u.scrollConversations()},function(e){u.sendingMessage=!1,m.info(e)})}},e.$on("receivedMessage",function(t,i){var n=JSON.parse(i);if(n.sender===u.recipient){m.info("new message");var s=h("amDateFormat")(n.sent_at,"dddd, MMMM D, YYYY"),r=h("amDateFormat")(n.sent_at,"L"),l=h("getIndexByProperty")("date",s,u.messages);null===l&&(u.messages.push({date:s,realDate:r,contents:[]}),l=u.messages.length-1),u.messages[l].contents.push({body:w.trustAsHtml(n.body),sender:n.sender,recipient:n.recipient,date:r,sent_at:n.sent_at,left:!1}),e.notifications.push({body:w.trustAsHtml(n.body),sender:n.sender,recipient:n.recipient,date:r,sent_at:n.sent_at}),u.messages[l].contents=h("orderBy")(u.messages[l].contents,"sent_at",!0),u.messages=h("orderBy")(u.messages,"realDate"),c.get("/api/v1/inbox/reat_at/?sender_id="+u.friend.id).success(function(e,t,i,n){o.getInboxMessages(),a.refreshTotalInbox()}).error(function(e,t,i,n){}),p(function(){var e=angular.element(".conversation-content")[0].scrollHeight;angular.element(".conversation-content").filter(":not(:animated)").animate({scrollTop:e},1500)},100),p(function(){angular.element("#desktop-conversation-content").filter(":not(:animated)").animate({scrollTop:0},1500)},100)}else o.getInboxMessages(),a.refreshTotalInbox()}),u.unFriend=function(){b.update({friendId:u.friendshipId},{status:-1},function(e){o.getInboxMessages(),s.go("myconnections")},function(e){})}}]),angular.module("persice").factory("GoalsFactory",["$resource",function(e){return e("/api/v1/goal/:goalId/:param",{goalId:"@goalId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("NewConnectionsFactory",["$resource",function(e){return e("/api/v1/new_connections/counter/:newConnectionId/:param",{goalId:"@newConnectionId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("LikesFactory",["$resource",function(e){return e("/api/v1/likes/:likeId/:param",{likeId:"@likeId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("ProfileFactory",["$resource",function(e){return e("/api/v1/profile/:profileId/:param",{profileId:"@profileId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("LocationFactory",["$resource",function(e){return e("/api/v1/location/:locationId/:param",{locationId:"@locationId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("ConnectionsFactory",["$resource",function(e){return e("/api/v1/connections/:connectionId/:param",{connectionId:"@connectionId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FriendsFactory",["$resource",function(e){return e("/api/v1/friends/:friendId/:param",{friendId:"@friendId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MutualFriendsFactory",["$resource",function(e){return e("/api/v1/mutual/friends/:friendId/:param",{friendId:"@friendId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("SubjectsFactory",["$resource",function(e){return e("/api/v1/subject/:subjectId/:param",{subjectId:"@subjectId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("OffersFactory",["$resource",function(e){return e("/api/v1/offer/:offerId/:param",{offerId:"@offerId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InterestsFactory",["$resource",function(e){return e("/api/v1/interest/:interestId/:param",{interestId:"@interestId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InterestSubjectFactory",["$resource",function(e){return e("/api/v1/interest_subject/:interestId/:param",{interestId:"@interestId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("UsersFactory",["$resource",function(e){return e("/api/v1/auth/user/:userId/:param",{userId:"@userId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MessagesFactory",["$resource",function(e){return e("/api/v1/messages/:messageId/:param",{messageId:"@messageId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InboxFactory",["$resource",function(e){return e("/api/v1/inbox/last/:inboxId/:param",{inboxId:"@inboxId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FiltersFactory",["$resource",function(e){return e("/api/v1/filter/state/:filterId/:param",{filterId:"@filterId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("PhotosFactory",["$resource",function(e){return e("/api/v1/photo/:photoId/:param",{photoId:"@photoId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("InboxUnreadCounterFactory",["$resource",function(e){return e("/api/v1/inbox/unread_counter/:unreadId/:param",{unreadId:"@unreadId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("EventsFactory",["$resource",function(e){return e("/api/v1/event/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("MembersFactory",["$resource",function(e){return e("/api/v1/member/:memberId/:param",{memberId:"@memberId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PUT"},"delete":{method:"DELETE"}})}]).factory("FeedEventsFriendsFactory",["$resource",function(e){return e("/api/v1/feed/events/friends/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FeedEventsMyFactory",["$resource",function(e){return e("/api/v1/feed/events/my/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("FeedEventsAllFactory",["$resource",function(e){return e("/api/v1/feed/events/all/:eventId/:param",{eventId:"@eventId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]).factory("EventsConnections",["$resource",function(e){return e("/api/v1/events/connections/:connectionId/:param",{connectionId:"@connectionId"},{query:{method:"GET",isArray:!1,cache:!1}})}]).factory("EventsAttendees",["$resource",function(e){return e("/api/v1/attendees/:attendeeId/:param",{attendeeId:"@attendeeId"},{query:{method:"GET",isArray:!1,cache:!1}})}]).factory("EventChatFactory",["$resource",function(e){return e("/api/v1/chat/:chatId/:param",{chatId:"@chatId"},{query:{method:"GET",isArray:!1,cache:!1},save:{method:"POST"},update:{method:"PATCH"},"delete":{method:"DELETE"}})}]),angular.module("persice").controller("AppCtrl",["$rootScope","APP_ID","USER_PHOTO_SMALL","NotificationsRepository","FilterRepository","$http","LocationFactory","$geolocation","ezfb","$scope","USER_ID","USER_FIRSTNAME","USER_PHOTO","$timeout","$state","$window","myIoSocket","$filter","$log","notify","$resource","$cookies","InboxRepository","moment","angularMomentConfig",function(e,t,i,n,s,a,o,r,l,d,c,u,v,m,p,f,g,h,b,w,y,_,k,E,x){e.hideTopMenu=!1,e.distance_unit="miles",e.eventChatModal=!1,s.getFilters().then(function(t){e.distance_unit=t.distance_unit},function(e){}),d.checkLogin=function(){l.getLoginStatus().then(function(t){e.fbAuth=t.authResponse,l.api("/me",function(t){e.apiMe=t})})},d.checkLogin(),n.refreshTotalInbox(),n.refreshTotalConnections(),d.$geolocation=r,r.getCurrentPosition({enableHighAccuracy:!0,timeout:6e4,maximumAge:75e3}).then(function(e){d.location=e,d.saveLocation(d.location.coords)}),d.saveLocation=function(e){o.query({format:"json"}).$promise.then(function(t){var i={user:"/api/v1/auth/user/"+c+"/",position:e.latitude+","+e.longitude,speed:e.speed,heading:e.heading,altitude:e.altitude,altitude_accuracy:e.altitudeAccuracy};t.meta.total_count>0?(d.serverLocation=t.objects[0],o.update({locationId:d.serverLocation.id},i,function(e){},function(e){b.error(e)})):o.save({},i,function(e){},function(e){b.error(e)})},function(e){var t=(e.data,e.status),i=(e.header,e.config,"Error "+t);b.error(i)})},e.userImg=i,e.userName=u,_.userid=c,e.viewEventsFeedMap=function(){p.is("events.myevents.list")&&p.go("events.myevents.map"),p.is("events.mynetwork.list")&&p.go("events.mynetwork.map"),p.is("events.allevents.list")&&p.go("events.allevents.map")},e.goBack=function(){e.hideTopMenu=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("showFullProfile")},d.cancelMatch=function(){$(".dimmable").dimmer("hide"),e.hideTopMenu=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("cancelMatchEvent")},d.confirmMatch=function(){$(".dimmable").dimmer("hide"),e.hideTopMenu=!1,$(".horizontal.top.sidebar").sidebar("hide"),e.$broadcast("confirmMatchEvent")},e.$on("triggerRefreshMatchfeed",function(){e.showfullprofile=!1,e.hideTopMenu=!0,d.refreshMatchFeed()}),d.refreshMatchFeed=function(){$(".dimmable").dimmer("hide"),e.$broadcast("refreshMatchFeed")},k.getInboxMessages(),e.notifications=[],e.messages=[],d.$on("socket:message",function(t,i){var s=JSON.parse(i);if(s.type==="event_deleted."+c){var a=JSON.parse(s.message),o=E.utc(a.event_start_date).local().format("dddd, MMMM D, YYYY H:mm A ");o+=E.tz(x.timezone).format("z");var r="The event "+a.event_name+" on "+o+" has been cancelled by "+a.event_organizer_name+", the event host. <br>We apologize for any inconvenience. (This is an automated message.)",l=h("amDateFormat")(Date.now(),"h:mm a"),u='<div class="notify-info-header">Event is cancelled <br>'+l+" </div><p>"+r+"</p>";w({messageTemplate:u,scope:d,classes:"notify-info",icon:"calendar",duration:8e3})}if(s.type==="connection."+c){var v=JSON.parse(i),m=JSON.parse(v.message),l=h("amDateFormat")(Date.now(),"h:mm a"),f="/api/v1/auth/user/"+c+"/";if(f===m.friend1)var g=y(m.friend2);if(f===m.friend2)var g=y(m.friend1);g.get().$promise.then(function(e){n.refreshTotalConnections();var t='<div class="notify-info-header"><a ui-sref="myconnections">New connection<br>'+l+' </a></div><p><a ui-sref="myconnections">You and '+e.first_name+" are now friends.</a></p>";w({messageTemplate:t,scope:d,classes:"notify-info",icon:"user",duration:4e3})})}if(s.type==="message."+c)if(e.isState("conversations"))e.$broadcast("receivedMessage",s.message);else{k.getInboxMessages(),n.refreshTotalInbox();var s=JSON.parse(i),_=JSON.parse(s.message),$=h("words")(_.body,10),l=h("amDateFormat")(_.sent_at,"h:mm a"),I=y(_.sender);I.get().$promise.then(function(e){d.gotoConversation=function(){p.go("conversations",{userId:e.id})};var t='<div class="notify-info-header"><a href="" ng-click="gotoConversation()">Received new message from '+e.first_name+"<br>"+l+' </a></div><p><a href="" ng-click="gotoConversation()">'+$+"</a></p>";w({messageTemplate:t,scope:d,classes:"notify-info",icon:"wechat",duration:4e3})})}if(s.type==="chat_message."+c)if(b.info(e.eventChatModal),e.isState("event.chat")||e.eventChatModal)e.$broadcast("receivedEventChatMessage",s.message);else{var s=JSON.parse(i),_=JSON.parse(s.message),$=h("words")(_.body,10),l=h("amDateFormat")(_.sent_at,"h:mm a"),I=y(_.sender);I.get().$promise.then(function(e){d.gotoEventChatMessage=function(){p.go("event.chat",{eventId:_.event_id})};var t='<div class="notify-info-header"><a href="" ng-click="gotoEventChatMessage()">Received new event chat message from '+e.first_name+"<br>"+l+' </a></div><p><a href="" ng-click="gotoEventChatMessage">'+$+"</a></p>";w({messageTemplate:t,scope:d,classes:"notify-info",icon:"wechat",duration:4e3})})}})}]),angular.module("persice").run(["$templateCache",function(e){e.put("app/bigmatchfeed/bigmatchfeed.html",'<div style="float: right;"><div class="ui text main menu"><div class="text item" style="margin-right: 0px;">15 Results &nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;Sort By</div><div class="ui pointing dropdown link item" style="padding-left: 0px;margin-left: 0px;"><span class="text">Most Relevant</span> <i class="dropdown icon"></i><div class="menu"><div class="header">Categories</div><div class="item"><i class="dropdown icon"></i> <span class="text">Clothing</span><div class="menu"><div class="header">Mens</div><div class="item">Shirts</div><div class="item">Pants</div><div class="item">Jeans</div><div class="item">Shoes</div><div class="divider"></div><div class="header">Womens</div><div class="item">Dresses</div><div class="item">Shoes</div><div class="item">Bags</div></div></div><div class="item">Home Goods</div><div class="item">Bedroom</div><div class="divider"></div><div class="header">Order</div><div class="item">Status</div><div class="item">Cancellations</div></div></div></div></div><div class="ui grid"><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">John Stevens</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">I am a 55 year old doctor and I’m supposed to give a presentation at a local university in 3 weeks, but I don’t know how to use PowerPoint. I need someone to show me how to use the software, and to help cre- ate the content of my slides (i.e. copy, images, video).</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div><div class="row"><div class="column"><div class="ui fluid card matchedperson"><div class="content heading"><div class="ui tiny image"><img src="http://lorempixel.com/200/200"></div><div class="header-container"><div class="header">Daniel Louise</div><div class="meta">5 miles away</div></div><div class="description-container"><div class="description">Hi. I just moved to New York City from France and I’m looking to meet new friends and colleagues. I work in finance, but I’d like to join a tech startup. I like to travel and I’m an avid snowboarder. My parents own a winery, so I’m also quite familiar with French wine.</div></div><div class="extra"><div class="ui right floated bottom">7 hours ago</div></div></div><div class="content middle"><div class="ui equal width grid"><div class="row"><div class="column"><div>2 Matched Goals</div></div><div class="five wide column">Jacques wants to meet new people.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to meet new people.</div></div><div class="row"><div class="column"><div></div></div><div class="five wide column">Jacques is wiling to help people learn French.</div><div class="column wide center aligned"><i class="exchange icon"></i></div><div class="five wide column">You want to learn French.</div></div></div></div><div class="ui divider fitted inverted"></div><div class="content bottom"><div class="ui equal width grid"><div class="row"><div class="column"><br><br><div>9 things in common</div></div><div class="three wide column"><div>4 people</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Adam Smith</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">David Ricardo</div><div class="description">Facebook</div></div></div></div></div><div class="three wide column"><div>2 Likes &amp; Interests</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Burgundy Wine</div><div class="description">Facebook</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Motorcycles</div><div class="description">Pinterest</div></div></div></div></div><div class="three wide column"><div>3 places</div><div class="ui link items"><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Le Petit MAisonk</div><div class="description">Nice, France</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">The Meatball Shop</div><div class="description">New York, NY</div></div></div><div class="item"><div class="ui avatar-tiny image"><img src="http://lorempixel.com/50/50"></div><div class="content"><div class="header">Sydney Opera House</div><div class="description">Sydney, Australia</div></div></div></div></div></div></div></div><div class="extra content">Interested?&nbsp;&nbsp;&nbsp; <i class="check icon"></i>Yes&nbsp;&nbsp;&nbsp; <i class="cancel icon"></i>No&nbsp;&nbsp;&nbsp; <i class="star icon"></i>Maybe Later&nbsp;&nbsp;&nbsp;<div class="ui right floated"><i class="flag icon"></i> Flag</div></div></div></div></div></div><script>\n\'use strict\';\n\n$(\'.ui.dropdown\')\n    .dropdown();\n</script>'),
e.put("app/conversations/conversations.html",'<div id="mycontroller"><div class="ui fixed borderless menu" id="headermenu"><a class="icon item" ui-sref="inbox"><i class="left chevron icon"></i></a><h3 class="ui center aligned header">{{friend.first_name}}</h3></div><div class="ui fixed menu" id="submenu"><div class="3 fluid large ui buttons"><a ui-sref="conversations({ userId: friend.id })" ng-class="{\'active\': leftActive}" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friend.id })" class="ui button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div></div><div id="desktop-conversation-header" class="ui dividing header large"><div class="content">Conversation with <a ui-sref="friendprofile({ userId: friend.id })">{{friend.first_name}}</a></div></div><div id="desktop-conversation-reply"><div class="ui form"><div class="field"><label></label> <textarea ng-enter="sendNewMessage()" placeholder="Add your message here." ng-model="newmessage"></textarea></div><div ng-click="sendNewMessage()" ng-class="{\'loading\': sendingMessage}" class="ui submit green button">Send Message</div></div></div><div id="desktop-conversation-content" class="basic ui segment" ng-class="{\'loading\': loadingMessages}" when-scroll-ends="loadMore()"><h3 class="ui center aligned header" ng-if="messages.length === 0">There are no any messages</h3><div class="repeat-animation" ng-repeat="message in messages | orderBy:\'-realDate\' track by $index"><div ng-style="" class="repeat-animation quote" ng-class="{\'left\': msg.left, \'right\': !msg.left, \'lastMessage\': $last}" ng-repeat="msg in message.contents | orderBy:\'-sent_at\' track by $index"><img class="round-avatar" ng-src="{{ msg.left && userImg || !msg.left && friendImage}}"><div class="speech-bubble"><blockquote ng-bind-html="msg.body"></blockquote></div><span class="time-ago">{{message.date}} {{msg.sent_at | amDateFormat:\'h:mm a\'}}</span></div></div><three-bounce-spinner class="page-spinner-bar" ng-show="status.loading"></three-bounce-spinner></div><div id="mobile-conversation-content" class="conversation-content basic ui segment" ng-class="{\'loading\': loadingMessages}" when-scrolled="loadMore()" scroll-bottom-on="status.loaded"><three-bounce-spinner class="page-spinner-bar" ng-show="status.loading"></three-bounce-spinner><div class="repeat-animation" ng-repeat="message in messages track by $index"><h6>{{message.date}}</h6><div ng-style="" class="repeat-animation" ng-class="{\'bubbledLeft\': msg.left, \'bubbledRight\': !msg.left, \'lastMessage\': $last}" ng-repeat="msg in message.contents | orderBy:\'sent_at\' track by $index"><p ng-bind-html="msg.body"></p><span class="conversation-time">{{msg.sent_at | amDateFormat:\'h:mm a\'}}</span></div></div></div><div id="mobile-no-messages" class="conversation-content ui segment" ng-if="messages.length === 0"><h3>There are no any messages</h3></div><div id="mobile-conversation-reply" class="message-reply"><div class="ui fluid action input"><input ng-enter="sendNewMessage()" type="text" placeholder="" ng-model="newmessage"><div ng-click="sendNewMessage()" class="ui button" ng-class="{\'loading\': sendingMessage}">Send</div></div></div><script>\n    \'use strict\';\n\n    $(\'.ui.dropdown\')\n        .dropdown({\n            onShow: function() {\n\n\n                var scope = angular.element($("#submenu")).scope();\n                scope.$apply(function() {\n                    scope.leftActive = false;\n                });\n            },\n            onHide: function() {\n\n                var scope = angular.element($("#submenu")).scope();\n                setTimeout(function() {\n                    scope.$apply(function() {\n                        scope.leftActive = true;\n                    });\n                }, 100);\n            }\n        });\n\n    $(\'.basic.delete.modal\')\n        .modal({\n            onDeny: function() {\n                console.log(\'cancel\');\n            },\n            onApprove: function() {\n                console.log(\'deleting user\');\n\n                angular.element(document.getElementById(\'mycontroller\')).scope().unFriend();\n\n            }\n        })\n        .modal(\'attach events\', \'.deleteconnection\', \'show\');\n    </script><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want remove this connection?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div></div>'),e.put("app/editmyprofile/editmyprofile.html",'<div class="ui fixed borderless menu center" id="edittopmenu"><div class="main container"><div class="left menu"><a class="ui item" ui-sref="myprofile" ng-hide="showModal">Cancel</a></div><div class="header item">Edit Profile</div><div class="right menu"><a class="ui item" ng-click="startSavingChanges()" ng-hide="showModal" ng-class="{\'loading\': savingAllChanges}">Save</a></div></div></div><div class="segment" id="my-profile-header-edit" ng-hide="showModal || editInterest"><div class="ui segment"><div id="tiles" ng-cloak=""><div class="ui image tile" ng-class="{\'left floated medium tile-big\': $index === 0, \'left floated small tile-small\': $index === 1 || $index === 2 || $index === 4 || $index === 5, \'small tile-small\': $index === 3 }" ng-repeat="photo in user.photos track by $index" end-repeat-photos="" ng-drop="true" ng-drop-success="onDropComplete($index, $data,$event)"><a href="" ng-click="$parent.userPhotoDelete = photo; $parent.userPhotoDeleteIndex = $index;" class="ui right corner delete_photo label" ng-show="photo.photo !== \'\'"><i class="close icon"></i></a><div class="tile-content" ng-show="photo.photo === \'\'"><div class="content"><div class="center"><a href="" ng-click="$parent.newPhotoIndex = $index; getFBAlbums();" class="ui compact icon button add_photo"><i class="circle add icon"></i> Add Photo</a></div></div></div><div style="background-image: url(\'{{photo.photo}}\')" ng-if="photo.cropped_photo === \'\'" ng-drag="true" ng-drag-data="photo" class="img-bounding-box"></div><div style="background-image: url(\'{{photo.cropped_photo}}\')" ng-if="photo.cropped_photo !== \'\'" ng-drag="true" ng-drag-data="photo" class="img-bounding-box"></div></div></div></div></div><div class="body segment edit" id="my-profile-body" ng-hide="showModal || editInterest"><div class="ui attached segment" id="my-profile-title"><h3 class="ui left floated header">{{ user.firstName }}<span ng-hide="user.firstName === \'\'">,</span> {{ user.age }}</h3></div><div class="ui attached segment" ng-class="{loading: loadingGoals || loadingOffers || loadingUser || loadingLikes || loadingInterests }"><h4 class="ui header">Goals</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="goal in user.goals track by $index"><div class="content"><div class="description"><div class="ui fluid search goals" rel="{{$index}}" ng-class="{\'loading\': goal.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': goal.error}"><div class="ui removebutton icon circular button" ng-click="removeGoal($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="goal.subject" ng-change="goalNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="goal.error">{{goal.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewGoal()"><i class="plus icon"></i> Create new Goal</div><h4 class="ui header">Offers</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="offer in user.offers track by $index"><div class="content"><div class="description"><div class="ui fluid search offers" rel="{{$index}}" ng-class="{\'loading\': offer.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': offer.error}"><div class="ui removebutton icon circular button" ng-click="removeOffer($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="offer.subject" ng-change="offerNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="offer.error">{{offer.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewOffer()"><i class="plus icon"></i> Create new Offer</div><h4 class="ui header">About</h4><form class="ui form" ng-class="{loading: loadingAbout}"><div class="field"><label></label> <textarea rows="3" ng-model="user.about_me" ng-blur="saveAbout()"></textarea></div></form><h4 class="ui header">Activities &amp; Interests</h4><div class="ui large list"><div class="item" end-repeat="" ng-repeat="interest in user.interests track by $index"><div class="content"><div class="description"><div class="ui fluid search interests" rel="{{$index}}" ng-class="{\'loading\': interest.loading }"><div class="ui fluid leftright action input" ng-class="{\'error\': interest.error}"><div class="ui removebutton icon circular button" ng-click="removeInterest($index)"><i class="remove icon"></i></div><input type="text" class="prompt" ng-model="interest.interest_subject" ng-change="interestNeedSaving($index)"></div><div class="results"></div></div><div class="ui red pointing fluid label visible transition" ng-if="interest.error">{{interest.errorMessage}}</div></div></div></div></div><div class="ui fluid labeled blue button" ng-click="createNewInterest()"><i class="plus icon"></i> Create new Interest</div><h4 class="ui header">Likes</h4><div class="ui list likes"><div class="item" ng-repeat="like in user.likes | limitTo:5 track by $index"><div class="content"><div class="description">{{ like.name }}</div></div></div></div></div><div class="ui attached segment" id="socialaccounts"><h4 class="ui header">Social Accounts</h4><br><a ng-click="link(\'linkedin\')" class="ui icon linkedin labeled fluid button notconnected" ng-if="social.linkedin.length === 0"><i class="linkedin icon"></i> Connect</a><div class="ui fluid buttons socialbuttons" ng-if="social.linkedin.length > 0"><a href="{{ social.linkedin }}" target="_new" class="ui social icon twitter labeled button"><i class="linkedin icon"></i> {{user.firstName}} <i class="check circle icon right"></i></a> <a ng-click="unlink(\'linkedin\')" class="ui right icon circular button disconnect"><i class="remove icon"></i></a></div><br><br ng-if="social.linkedin.length > 0"><a ng-click="link(\'twitter\')" class="ui icon twitter labeled fluid button notconnected" ng-if="social.twitter.length === 0"><i class="twitter icon"></i> Connect</a><div class="ui fluid buttons socialbuttons" ng-if="social.twitter.length > 0"><a href="https://twitter.com/{{ social.twitter }}" target="_new" class="ui social icon twitter labeled button"><i class="twitter icon"></i> {{social.twitter}} <i class="check circle icon right"></i></a> <a ng-click="unlink(\'twitter\')" class="ui right icon circular button disconnect"><i class="remove icon"></i></a></div><br ng-if="social.twitter.length > 0"><br><a href="{{ user.facebookProfile }}" target="_new" class="ui social icon facebook labeled fluid button" ng-if="user.facebookProfile !== \'\'"><i class="facebook icon"></i> {{user.firstName}} <i class="lock icon right"></i></a></div></div><div class="ui basic modal" id="deletePhotoModal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content" ng-cloak=""><img ng-src="{{userPhotoDelete.photo}}" class="ui image small" alt=""><div class="description"><p>Are you sure you want to delete your photo?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui negative basic inverted button"><i class="remove icon"></i> No</div><div ng-click="deletePhoto()" class="ui positive basic inverted button"><i class="checkmark icon"></i> Yes</div></div></div></div><div class="body basic segment edit" id="my-profile-photos" ng-if="showModal" ng-cloak=""><div class="ui attached segment" ng-class="{loading: albumsLoading}"><div class="ui dividing header"><span ng-show="currentAlbum != \'\' && showPhotos">Choose Photo</span> <span ng-show="currentAlbum == \'\'">Choose Facebook Album</span> <span ng-show="currentAlbum != \'\' && !showPhotos">Crop Photo</span></div><div class="ui selection list" ng-hide="hideAlbums"><div class="item" ng-click="getFBPhotos(fbAlbum.id, fbAlbum.name)" ng-repeat="fbAlbum in facebookAlbums track by $index"><img class="ui tiny image" ng-src="{{fbAlbum.picture.data.url}}"><div class="content"><div class="header">{{fbAlbum.name}}</div></div></div></div><div ng-show="hideAlbums" class="ui basic segment" ng-class="{loading: photosLoading}"><button class="ui labeled fluid button backButton" ng-click="backToAlbums()"><i class="angle left big icon"></i>Back to Albums</button><h3 ng-show="showPhotos" class="ui header">{{currentAlbum}}</h3><div class="ui selection list" ng-show="showPhotos"><div ng-click="showCrop($index)" class="item button ok" ng-repeat="fbPhoto in facebookPhotos track by $index"><img class="ui small image" ng-src="{{fbPhoto.source}}"><div class="content"><div class="header"></div></div></div></div><div ng-hide="showPhotos"><div class="ui vertically divided centered relaxed grid"><div class="sixteen wide column"><div class="cropArea"><img-crop image="myImage" result-image="myCroppedImage" area-type="square"></img-crop></div></div><div class="center aligned one column row"><div class="sixteen wide column"><div class="ui segment basic center aligned"><button class="ui button" ng-click="closeModal()">Cancel</button> <button class="ui primary button" ng-click="createPhoto(myCroppedImage)">Save Photo</button></div></div></div></div></div></div></div></div><script type="text/javascript">\n\'use strict\';\n\nfunction refreshConnect() {\n    console.log(\'calling refresh connect22\');\n    var scope = angular.element(document.getElementById("socialaccounts")).scope();\n    scope.refreshUser();\n\n\n}\n</script>'),e.put("app/events/event.html",'<div class="ui fixed borderless menu center" id="edittopmenu"><div class="left menu"><a class="ui item" ng-click="eventpage.gotoPreviousState();"><i class="left chevron icon"></i></a></div><div class="header item">{{eventpage.header}}</div><div class="right menu"><a class="ui item" ng-click="eventpage.makeactionEvent();"><span ng-show="isState(\'event.create\') || (isState(\'event.edit\') && eventpage.isHost.option)">Save<div ng-if="eventpage.loadingSave" class="ui active mini inline loader"></div></span> <span ng-show="isState(\'event.details\') && eventpage.isHost.option">Edit</span> <span ng-show="isState(\'event.invitations\')">Done</span></a></div></div><div ui-view=""></div>'),e.put("app/events/event_attendees.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventattendees.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_chat.html","<ng-include src=\"'components/event/eventchat.tpl.html'\"></ng-include>"),e.put("app/events/event_create.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/event.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_edit.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventedit.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_invitations.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventinvitations.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/event_view.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><ng-include src="\'components/event/eventview.tpl.html\'"></ng-include></div></div></div>'),e.put("app/events/events_page.html",'<div class="ui grid"><div class="row"><div class="wide column"><div class="ui fluid secondary menu center-aligned" id="eventsMobileNav"><a class="item" ui-sref="events.myevents.list" ng-class="{\'active\': isState(\'events.myevents\')}">MY EVENTS</a> <a class="item" ui-sref="events.mynetwork.list" ng-class="{\'active\': isState(\'events.mynetwork\')}">MY NETWORK</a> <a class="item" ui-sref="events.allevents.list" ng-class="{\'active\': isState(\'events.allevents\')}">ALL EVENTS</a></div><div class="ui secondary pointing menu" id="eventsDesktopNav"><a class="item" ui-sref="events.myevents.list" ng-class="{\'active\': isState(\'events.myevents\')}">MY EVENTS</a> <a class="item" ui-sref="events.mynetwork.list" ng-class="{\'active\': isState(\'events.mynetwork\')}">MY NETWORK</a> <a class="item" ui-sref="events.allevents.list" ng-class="{\'active\': isState(\'events.allevents\')}">ALL EVENTS</a><div class="right menu"><a class="ui button small labeled green icon" ng-click="eventspage.showEventModal()"><i class="fa fa-plus-circle icon"></i> Create</a></div></div><div class="ui secondary pointing menu" id="eventsDesktopSubNav"><div class="item"></div><div class="right menu"><a class="item icon" ng-click="eventspage.viewList()" ng-class="{\'active\': isState(\'events.myevents.list\') || isState(\'events.mynetwork.list\') || isState(\'events.allevents.list\')}"><i class="fa large fa-list icon"></i></a> <a class="item icon"><i class="fa large fa-calendar icon"></i></a> <a class="item" ng-click="eventspage.viewMap()" ng-class="{\'active\': isState(\'events.myevents.map\') || isState(\'events.mynetwork.map\') || isState(\'events.allevents.map\')}"><i class="fa large fa-map-marker icon"></i></a></div></div></div></div></div><div ui-view=""></div><ui-event-create-modal show="eventspage.showModal"></ui-event-create-modal><ui-event-view-modal show="eventspage.showViewModal" eventid="eventspage.viewEvent"></ui-event-view-modal>'),e.put("app/finalstep/finalstep.html",'<div id="finalstep"><div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">4</i></span> Final Step</div><div class="right menu"><div class="ui item" id="nextButton"><a ui-sref="matchfeed" class="ui button small green"><span ng-if="finalstep.twitter === \'\' && finalstep.linkedin === \'\'">Skip</span><span ng-if="finalstep.twitter !== \'\' || finalstep.linkedin !== \'\'">Next</span> &raquo;</a></div></div></div><div class="ui grid fullheight"><div class="row"><div class="wide column"><div class="body segment"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">4</i></span><div class="content">Final Step</div><a ui-sref="matchfeed" id="nextButtonDesktop" class="ui button small green"><span ng-if="finalstep.twitter === \'\' && finalstep.linkedin === \'\'">Skip</span><span ng-if="finalstep.twitter !== \'\' || finalstep.linkedin !== \'\'">Next</span> &raquo;</a></h2><h2 class="ui center aligned header withborder"><hr>Connect your LinkedIn and<br>Twitter accounts<hr></h2><div class="ui basic segment"><div class="ui center aligned grid"><div class="row"><div class="column"><div class="ui segment basic center alligend"><p>This will improve your match results within the persice community.</p><p><i class="icon lock"></i> persice will never share your information or post on your behalf.</p></div></div></div><div class="row"><div class="column"><div class="ui segment basic center alligend" ng-class="{\'loading\': finalstep.loading}"><a class="ui linkedin big button" ng-click="finalstep.link(\'linkedin\')" ng-show="finalstep.linkedin === \'\'"><i class="linkedin icon"></i> Connect</a> <a href="{{ finalstep.linkedin }}" target="_new" class="ui social icon linkedin big labeled button" ng-show="finalstep.linkedin !== \'\'"><i class="linkedin icon"></i> {{finalstep.firstName}} <i class="check circle icon right"></i></a><br><br><a class="ui twitter big button" ng-click="finalstep.link(\'twitter\')" ng-show="finalstep.twitter === \'\'"><i class="twitter icon"></i> Connect</a> <a href="https://twitter.com/{{ finalstep.twitter }}" target="_new" class="ui social icon twitter labeled big button" ng-show="finalstep.twitter !== \'\'"><i class="twitter icon"></i> {{finalstep.twitter}} <i class="check circle icon right"></i></a></div></div></div></div></div></div></div></div></div><script type="text/javascript">\n    \'use strict\';\n\n    function refreshConnect() {\n        angular.element($(\'#finalstep\')).scope().finalstep.refreshUser();\n    }\n    </script></div>'),e.put("app/friendprofile/friendprofile.html",'<div id="connectionPage" ng-cloak=""><div class="ui fixed borderless menu" id="headermenu"><a class="icon item" ui-sref="myconnections"><i class="left chevron icon"></i></a><h3 class="ui center aligned header">{{ friendprofile.userInfo.first_name }}</h3></div><div class="ui fixed menu friendsubmenu" id="submenu"><div class="3 fluid large ui buttons"><a ui-sref="conversations({ userId: friendprofile.userInfo.id })" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friendprofile.userInfo.id })" ng-class="{\'active\': friendprofile.middleActive}" class="ui button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div></div><div class="3 fluid large ui buttons friendsubmenu" id="desktopsubmenu"><a ui-sref="conversations({ userId: friendprofile.userInfo.id })" class="ui leftalign button"><i class="fa fa-comment-o icon"></i></a> <a ui-sref="friendprofile({ userId: friendprofile.userInfo.id })" ng-class="{\'active\': friendprofile.middleActive}" class="ui middle button"><i class="fa fa-user icon"></i></a> <a class="ui button rightalign dropdown"><i class="fa fa-ellipsis-h icon"></i><div class="menu" id="friendmenu"><div class="item">Get Introduced</div><div class="item">Add to Group</div><div class="item">Arrange Meetup</div><div class="item">Flag as Inappropriate</div><div class="item deleteconnection">Remove Connection</div></div></a></div><user-profile person="friendprofile.userInfo" type="friend" header="friendprofileheader" body="matched-profile-body"></user-profile></div><script>\n    \'use strict\';\n    $(\'.ui.dropdown\')\n    .dropdown({\n        onShow:  function(){\n            var scope = angular.element($(".friendsubmenu")).scope();\n            scope.$apply(function(){\n                scope.friendprofile.middleActive = false;\n            });\n        },\n        onHide: function(){\n            var scope = angular.element($(".friendsubmenu")).scope();\n            setTimeout(function() {\n                scope.$apply(function(){\n                    scope.friendprofile.middleActive = true;\n                });\n            }, 100);\n        }\n    })\n    ;\n\n</script><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want remove this connection?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div><script>\n  \'use strict\';\n  $(\'.basic.delete.modal\')\n  .modal({\n    onDeny    : function(){\n      console.log(\'cancel\');\n  },\n  onApprove : function() {\n      console.log(\'deleting user\');\n      angular.element(document.getElementById(\'connectionPage\')).scope().friendprofile.unFriend();\n  }\n})\n  .modal(\'attach events\', \'.deleteconnection\', \'show\');\n\n\n</script>'),e.put("app/goalcreate/goalcreate.html",'<div class="ui fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">2</i></span> Create a goal</div><div class="right menu"><div class="ui item" id="nextButton"><div ng-click="createGoal()" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></div></div></div><div class="ui grid fullheight"><div class="row"><div class="wide column"><div class="body segment"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">2</i></span><div class="content">Create a goal</div><div ng-click="createGoal()" id="nextButtonDesktop" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></h2><h2 class="ui center aligned header withborder">My goal is to...<hr></h2><div class="ui attached warning message" id="warningmessage" ng-show="messageShow"><div class="header">Warning</div><p>{{message}}</p></div><div class="ui basic segment"><div class="ui center aligned grid"><div class="row"><div class="search-wrapper"><div field-required="false" autocomplete-ui="" input-class="ui input fluid" text-no-results="No existing goal found. Create new goal &raquo;" minlength="3" input-changed="inputChanged" match-class="highlight" selected-object="selectResult" description-field="description[3]" title-field="description" remote-url="/api/v1/subject/?format=json&description__icontains=" remote-url-data-field="objects" type="text" input-name="description" id="id_description" placeholder="enter your goal here"></div></div></div></div></div><div class="ui secondary segment" id="instructions" ng-hide="subject !== \'\'"><h4>This should be something you want other people to help you with.</h4><br><h4>For example:</h4><p><ul class="unstyled"><li>&quot;Learn to play tennis&quot;</li><li>&quot;Find a running partner&quot;</li><li>&quot;Hire a cat sitter&quot;</li><li>&quot;Move my sofa upstairs&quot;</li></ul></p></div></div></div></div></div>'),e.put("app/inbox/inbox.html",'<div id="search-header"><div class="ui left icon input"><input type="text" ng-model="inbox.q" name="q" placeholder="Search"> <i class="circular search icon"></i></div></div><div id="inbox-body" class="basic ui segment" ng-class="{\'loading\': inbox.loadingMessages}" when-scroll-ends="inbox.loadMore()"><div class="ui selection divided list"><a ng-class="{\'unread\': message.readAt === null}" ui-sref="conversations({ userId: message.friendId })" class="item repeat-animation" ng-if="message.body !== null" ng-repeat="message in inbox.allMessages | filter:{firstName: inbox.q} track by message.id"><div class="ui circular tiny image img-bounding-box" ng-style="{\'background-image\': \'url(//graph.facebook.com/{{ message.facebookId }}/picture?type=large)\'}"></div><span class="message-time">{{message.sentAt}}</span><div class="content"><div class="header">{{message.firstName}}</div><div class="description">{{message.body | words: 8}}</div></div></a></div><three-bounce-spinner class="page-spinner-bar" ng-show="inbox.loadingMore"></three-bounce-spinner></div>'),e.put("app/interests/interests.html",'<div class="ui top fixed borderless menu center" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">1</i></span> What interests you?</div><div class="right menu"><div class="ui item" id="nextButton"><div ng-click="interest.nextStep()" ng-class="{\'disabled\': interest.counter === 0}" class="ui button green">Next &raquo;</div></div></div></div><div id="interests-header"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">1</i></span><div class="content">What interests you?</div><div ng-click="interest.nextStep()" id="nextButtonDesktopInterests" ng-class="{\'disabled\': interest.counter === 0}" class="ui small button green">Next &raquo;</div></h2><div class="ui left icon input"><input type="text" ng-model="interest.searchQuery" ng-change="interest.getAllInterests()" ng-model-options="{debounce:300}" placeholder="Search"> <i class="circular search icon"></i></div></div><div id="interests" class="basic ui segment" ng-class="{\'loading\': interest.loadingInterests}" when-scroll-ends="interest.loadMoreInterests()"><div ng-click="interest.useInterest($index)" class="ui button toggle compact repeat-animation" ng-repeat="inter in interest.allInterests track by $index" ng-class="{\'active\': inter.active, \'loading\': interest.inter.loading}">{{inter.description}}</div><div class="ui info message" ng-show="interest.noResults && !interest.loadingInterests"><p>No interests found.</p><p>Try with another search term or <a href="" ng-click="interest.reset()">reset your search</a>.</p></div><three-bounce-spinner class="page-spinner-bar" ng-show="interest.loadingMore"></three-bounce-spinner></div>'),e.put("app/main/main.html",'<div class="ui center aligned grid fullheight" id="homepage"><div class="row"><div class="wide column"><div class="ui huge header aligned center">{{greetingMessage}} Persice</div></div></div><div class="row"><div class="wide column"><div class="ui small header" id="main-info">Persice connects people with similar goals<br>and interests.</div><br><p><a ui-sref="selectinterests" class="ui green button huge">Start</a></p></div></div></div>'),e.put("app/matchfeed/crowd.html",'<div class="ui three doubling stackable cards link" id="crowdList" ng-cloak=""><div class="ui inverted dimmer" ng-class="{\'active\': crowd.loading}"><div class="ui large text loader">Loading</div></div><div class="card" ng-repeat="person in crowd.people track by person.id"><div class="content"><div class="center aligned header">{{::person.first_name}} {{::person.last_name}}</div><div class="meta center info aligned">{{::person.gender|gender}} / AGE {{::person.age}} / {{::person.distance[0]}} {{::person.distance[1]}}</div><div class="profile-photo" style="background-image: url(\'//graph.facebook.com/{{::person.facebook_id}}/picture?type=large\'); background-size: cover;background-repeat: no-repeat; background-position: 50% 50%;"></div><div easypiechart="" class="crowd-matchscore" options="crowd.options" percent="person.score"><span class="value" ng-bind="person.score"></span> <span class="label">match</span></div><div class="meta center keywords-title aligned">TOP 3 KEYWORDS</div><div class="description center keywords aligned"><div class="ui list"><div class="item">dance</div><div class="item">nightlife</div><div class="item">Oranges</div></div></div></div></div></div>'),e.put("app/matchfeed/matchfeed.html",'<matchfeed-profile type="matchfeed"></matchfeed-profile>'),e.put("app/myconnections/myconnections.html",'<div id="search-header"><div class="ui left icon input"><input type="text" ng-model="myconnections.q" ng-change="myconnections.getFriends()" placeholder="Search" ng-model-options="{debounce:300}"> <i class="circular search icon"></i></div></div><div id="friends-list-body" class="basic ui segment" ng-class="{\'loading\': myconnections.loading}" when-scroll-ends="myconnections.loadMoreFriends()"><div class="ui basic segment notice" ng-if="myconnections.noConnections"><div class="ui info message"><p>You don\'t have any connections. Go to your Match Feed to find people with similar goals and interests.</p><p><a class="ui icon button blue" ui-sref="matchfeed">Match Feed</a></p></div></div><div class="ui divided selection list"><div class="ui info message" ng-show="myconnections.noResults && !myconnections.loading && !myconnections.noConnections"><p>No connections found.</p><p>Try with another search term or <a href="" ng-click="myconnections.reset()">reset your search</a>.</p></div><div ng-click="myconnections.gotoConnection($index)" ng-class="{\'unread\': friend.updated_at === null}" class="item repeat-animation" ng-repeat="friend in myconnections.friends track by $index"><div class="ui circular tiny image img-bounding-box" ng-style="{\'background-image\': \'url(//graph.facebook.com/{{ friend.facebook_id }}/picture?type=large)\'}"></div><div class="content"><div class="header">{{friend.first_name}}</div><div class="description"><div class="ui mini statistics"><div class="statistic" data-tooltip="Match Score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{friend.common_goals_offers_interests}}</div></div><div class="statistic" data-tooltip="Mutual friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{friend.totalFriends}}</div></div></div></div></div></div></div><three-bounce-spinner class="page-spinner-bar" ng-show="myconnections.loadingMore"></three-bounce-spinner></div>'),
e.put("app/myprofile/myprofile.html",'<user-profile person="myprofile.user" type="loggedInUser" header="my-profile-header" body="matched-profile-body"></user-profile>'),e.put("app/offercreate/offercreate.html",'<div class="ui top menu fixed borderless" id="mainheadermenu"><div class="header item"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">3</i></span> Post an offer</div><div class="right menu"><div class="ui item" id="nextButton"><div ng-click="createOffer()" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></div></div></div><div class="ui grid fullheight"><div class="row"><div class="wide column"><div class="body segment"><h2 class="ui header dividing center aligned desktopview"><span class="fa-stack"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-stack-1x fa-inverse">3</i></span><div class="content">Post an offer</div><div ng-click="createOffer()" id="nextButtonDesktop" ng-class="{\'disabled\': subject === \'\'}" class="ui button green small">Next &raquo;</div></h2><h2 class="ui center aligned header withborder">I can help people...<hr></h2><div class="ui attached warning message" id="warningmessage" ng-show="messageShow"><div class="header">Warning</div><p>{{message}}</p></div><div class="ui basic segment"><div class="ui form"><div class="ui center aligned grid"><div class="row"><div class="search-wrapper"><div field-required="false" autocomplete-ui="" minlength="3" input-class="ui input" text-no-results="No existing offer found. Create new offer &raquo;" input-changed="inputChanged" match-class="highlight" selected-object="selectResult" description-field="description[3]" title-field="description" remote-url="/api/v1/subject/?format=json&description__icontains=" remote-url-data-field="objects" type="text" input-name="description" id="id_description" placeholder="enter your offer here"></div></div></div></div></div></div><div class="ui secondary segment" id="instructions" ng-hide="subject !== \'\'"><h4>This should be something you\'re willing to help other people achieve.</h4><br><h4>For example:</h4><p><ul class="unstyled"><li>&quot;Learn to play the banjo&quot;</li><li>&quot;Find a great restaurant&quot;</li><li>&quot;Take care of their pets&quot;</li><li>&quot;Move their 500 lb sofa&quot;</li></ul></p></div></div></div></div></div>'),e.put("app/search/search.html",'<search-input></search-input><div class="ui raised segments"><h3 class="ui top block attached header search-header">Users</h3><div class="ui attached segment search-results-container"><div class="ui middle aligned very relaxed divided link list search-results"><a class="item"><img class="ui avatar image" src="http://lorempixel.com/300/300"><div class="middle aligned content"><div class="header">Daniel Louise, 86 match</div><div class="description">Female / Age 25 / 2 Miles / 2 Mutual Friends</div></div></a> <a class="item"><img class="ui avatar image" src="http://lorempixel.com/300/300"><div class="middle aligned content"><div class="header">Stevie Feliciano, 86 match</div><div class="description">Female / Age 25 / 2 Miles / 2 Mutual Friends</div></div></a> <a class="item"><img class="ui avatar image" src="http://lorempixel.com/300/300"><div class="middle aligned content"><div class="header">Elliot Fu, 86 match</div><div class="description">Female / Age 25 / 2 Miles / 2 Mutual Friends</div></div></a></div></div><div class="ui attached center aligned segment"><a class="show-all-link" href=""><span>show all</span> (32)</a></div><h3 class="ui attached block header search-header">Events</h3><div class="ui attached segment search-results-container"><div class="ui middle aligned very relaxed divided link list search-results"><a class="item"><img class="ui avatar image" src="http://lorempixel.com/300/300"><div class="middle aligned content"><div class="header">Event 1</div><div class="description">Portland Or / Tue 33 Jul</div></div></a> <a class="item"><img class="ui avatar image" src="http://lorempixel.com/300/300"><div class="middle aligned content"><div class="header">Event 2</div><div class="description">Portland Or / Tue 33 Jul</div></div></a> <a class="item"><img class="ui avatar image" src="http://lorempixel.com/300/300"><div class="middle aligned content"><div class="header">Event 3</div><div class="description">Portland Or / Tue 33 Jul</div></div></a></div></div><div class="ui attached center aligned segment"><a class="show-all-link" href=""><span>show all</span> (32)</a></div></div>'),e.put("app/settings/settings.html",'<div class="ui grid fullheight" id="settingsPage"><div class="row"><div class="wide column"><div class="ui basic segment"><h4 class="ui header dividing">Settings</h4><form class="ui form"><div class="inline fields"><label for="fruit">Distance units:</label><div class="field"><div class="customradio"><input type="radio" ng-model="settings.distanceUnit" value="miles"> <label ng-click="settings.setUnit(\'miles\')">miles</label></div></div><div class="field"><div class="customradio"><input type="radio" ng-model="settings.distanceUnit" value="km"> <label ng-click="settings.setUnit(\'km\')">km</label></div></div></div><div class="ui divider"></div><div ng-click="settings.saveSettings()" class="ui green button" ng-class="{\'disabled\': !settings.changed, \'loading\': settings.loadingSave}">Save</div></form></div><br><br><div class="ui basic segment"><h4 class="ui header dividing">Manage Account</h4><a class="ui icon labeled button" ui-sref-ignore="" href="accounts/logout"><i class="sign out icon"></i> Sign out</a></div><br><br><br><br><br><br><div class="ui basic segment"><h4 class="ui header dividing"></h4><div class="ui deleteitem red icon labeled button" id="deleteAccountButton"><i class="remove circle icon"></i> Delete Account</div></div></div></div></div><div class="ui basic delete modal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><div class="description"><p>Are you sure you want to delete your account?</p></div></div><div class="actions"><div class="two fluid ui inverted buttons"><div class="ui red negative basic inverted button"><i class="remove icon"></i> No</div><a class="ui green basic inverted button ok"><i class="checkmark icon"></i> Yes</a></div></div></div><script>\n\'use strict\';\n$(\'.basic.delete.modal\')\n    .modal({\n        onDeny: function() {},\n        onApprove: function() {\n            angular.element($(\'#settingsPage\')).scope().settings.deleteUser();\n        }\n    })\n    .modal(\'attach events\', \'.deleteitem\', \'show\');\n</script>'),e.put("components/event/event.tpl.html",'<div class="ui basic segment"><form class="ui form"><div class="ui positive message" ng-show="singleevent.showSuccess"><div class="header">New event was successfully created.</div></div><div class="ui negative message" ng-show="singleevent.showError"><div class="header">Warning</div><p ng-repeat="errormsg in singleevent.errorMessage track by $index">{{errormsg}}</p></div><div class="ui large form segment first" id="FirstSegment"><div class="field"><label>Event Name</label> <input autocomplete="off" class="border-bottom" ng-model="singleevent.event.name" placeholder="{{::singleevent.placeholder.name}}" type="text" name="name"></div><div class="field"><label>Location</label><div class="ui action input" id="locationInput"><input autocomplete="off" name="location" attach="\'locationInput\'" google-places-autocomplete="" options="singleevent.autocompleteOptions" placeholder="{{::singleevent.placeholder.location}}" ng-model="singleevent.eventLocation" type="text"> <button ng-class="{\'active\': singleevent.mapurlTrue, \'disabled\': !singleevent.mapurlTrue}" ng-click="singleevent.openMap()" class="ui right icon button location"><i class="marker large icon"></i></button></div></div></div><div class="ui large form segment" id="datePair"><div class="field" ng-class="{\'error\': singleevent.startsTimeError}"><label>Starts</label><div class="ui icon input" id="desktopStartsAt"><input autocomplete="off" class="date start" ng-model="singleevent.starts_on_date" placeholder="{{::singleevent.placeholder.starts}}" type="text" name="starts_on_date"> <i class="calendar icon"></i></div><input name="starts_on" autocomplete="off" ng-change="singleevent.checkDatesStarts()" ng-class="{\'fulldisplay\': singleevent.event.starts_on !== \'\' && singleevent.event.starts_on !== null}" ng-if="singleevent.showMobile" id="startsAtDate" class="border-bottom" placeholder="Starts" step="7200" type="datetime-local" ng-model="singleevent.event.starts_on"> <input autocomplete="off" id="startsAtTime" class="time start" placeholder="{{::singleevent.placeholder.startsTime}}" type="text" ng-model="singleevent.starts_on_time" name="starts_on_time"></div><div class="field" ng-class="{\'error\': singleevent.endsTimeError}"><label>Ends</label><div class="ui icon input" id="desktopEndsAt"><input autocomplete="off" class="date end" ng-model="singleevent.ends_on_date" placeholder="{{::singleevent.placeholder.ends}}" type="text" name="ends_on_date"> <i class="calendar icon"></i></div><input name="ends_on" autocomplete="off" ng-change="singleevent.checkDatesEnds()" ng-class="{\'fulldisplay\': singleevent.event.ends_on !== \'\' && singleevent.event.ends_on !== null}" ng-if="singleevent.showMobile" id="endsAtDate" class="ui border-bottom" placeholder="Ends" step="7200" type="datetime-local" ng-model="singleevent.event.ends_on"> <input autocomplete="off" id="endsAtTime" class="time end" placeholder="{{::singleevent.placeholder.endsTime}}" type="text" ng-model="singleevent.ends_on_time" name="ends_on_time"></div><div class="field"><label>Repeat</label> <input autocomplete="off" name="repeat" id="repeat" placeholder="{{::singleevent.placeholder.repeat}}" type="text" ng-model="singleevent.event.repeat"><div class="ui icon input" id="desktopRepeatUntil"><input autocomplete="off" class="simpledate" ng-model="singleevent.event.repeatUntil" placeholder="{{::singleevent.placeholder.repeatUntil}}" type="text"> <i class="calendar icon"></i></div></div></div><div class="ui large form segment"><div class="field"><label>Max. attendees</label> <input autocomplete="off" ng-model="singleevent.event.max_attendees" placeholder="{{::singleevent.placeholder.max_attendees}}" type="text" name="max_attendees"></div></div><div class="ui large form segment icon-segment"><div class="field button"><label>Costs</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> {{::singleevent.placeholder.costs}}</div></div></div><div class="ui large form segment icon-segment"><div class="field button"><label>Invitations</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> {{::singleevent.placeholder.invitations}}</div></div></div><div class="ui large form segment icon-segment"><div class="field" id="attachmentsDesc"><label>Attachments</label><div class="fluid ui right labeled icon button with-left-icon"><i class="fa-paperclip fa icon large left-icon"></i> <i class="fa-angle-right fa icon large"></i> {{::singleevent.placeholder.attachments}}</div></div><div class="ui divider" id="last-section"></div><div class="field"><label>Description</label> <textarea autocomplete="off" name="description" rows="4" class="border-bottom" placeholder="{{::singleevent.placeholder.description}}" ng-model="singleevent.event.description"></textarea></div></div></form></div><script>\n\'use strict\';\n\n\n// initialize input widgets first\n$(\'#datePair .time\').timepicker({\n    \'showDuration\': true,\n    \'timeFormat\': \'h:i A\',\n    \'scrollDefaultNow\': true\n});\n\n$(\'#datePair .date\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n$(\'#datePair .simpledate\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n\n// initialize datepair\n$(\'#datePair\').datepair({\n    defaultTimeDelta: 3600000,\n});\n</script>'),e.put("components/event/eventattendees.tpl.html",'<div class="ui basic segment" id="event-attendees"><form class="ui form" ng-class="{\'loading\': viewevent.loadingEvent}"><div class="fields"><div class="eight wide field attendees"><div class="field-section"><div class="label">Open to: <span class="label number">Public (all Persice users)</span></div><div class="ui divider"></div><div class="label">Guest can invite friends <span class="label number">YES</span></div></div></div><div class="eight wide field attendees"><div class="field-section"><div class="label">Max. attendees <span class="label number">{{::viewevent.event.max_attendees}}</span></div><div class="ui divider"></div><div class="label">Spots remaining <span class="label number">{{::viewevent.event.spots_remaining}}</span></div></div></div></div></form><br><div class="ui header">Attending:</div><div class="ui top attached tabular menu" id="attendeesTabsMenu"><a class="item active withicons" data-tab="first">Yes <span class="ui circular label">{{viewevent.attendees[\'yes\'].count}}</span></a> <a class="item withicons" data-tab="second">Maybe <span class="ui circular label">{{viewevent.attendees[\'maybe\'].count}}</span></a> <a class="item withicons" data-tab="third">No <span class="ui circular label">{{viewevent.attendees[\'no\'].count}}</span></a></div><div class="ui bottom attached tab segment active" data-tab="first"><div class="ui segment basic" ng-class="{\'loading\': viewevent.attendees[\'yes\'].loading}"><table class="ui very basic unstackable table attendees-people"><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder="" ng-change="viewevent.getAttendees(\'yes\')" ng-model-options="{ debounce: 500 }" ng-model="viewevent.attendees[\'yes\'].filters.firstName"> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th></tr></thead><tbody><tr ng-repeat="attendee in viewevent.attendees[\'yes\'].data track by attendee.id"><td><h4 class="ui image header"><img ng-src="//graph.facebook.com/{{::attendee.facebook_id}}/picture?type=square" class="ui circular image"><div class="content">{{::attendee.first_name}}, {{::attendee.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::attendee.tagline}}</div></td><td class="desktopview">{{::attendee.cumulative_match_score}}&nbsp;</td><td class="desktopview">{{::attendee.total_mutual_friends}}&nbsp;</td></tr></tbody></table><div class="ui message" ng-show="viewevent.attendees[\'yes\'].noResults"><div class="header">No attendees found.</div></div></div></div><div class="ui bottom attached tab segment" data-tab="second"><div class="ui segment basic" ng-class="{\'loading\': viewevent.attendees[\'maybe\'].loading}"><table class="ui very basic unstackable table attendees-people"><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder="" ng-change="viewevent.getAttendees(\'maybe\')" ng-model-options="{ debounce: 500 }" ng-model="viewevent.attendees[\'maybe\'].filters.firstName"> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th></tr></thead><tbody><tr ng-repeat="attendee in viewevent.attendees[\'maybe\'].data track by attendee.id"><td><h4 class="ui image header"><img ng-src="//graph.facebook.com/{{::attendee.facebook_id}}/picture?type=square" class="ui circular image"><div class="content">{{::attendee.first_name}}, {{::attendee.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::attendee.tagline}}</div></td><td class="desktopview">{{::attendee.cumulative_match_score}&nbsp;</td><td class="desktopview">{{::attendee.total_mutual_friends}}&nbsp;</td></tr></tbody></table><div class="ui message" ng-show="viewevent.attendees[\'maybe\'].noResults"><div class="header">No attendees found.</div></div></div></div><div class="ui bottom attached tab segment" data-tab="third"><div class="ui segment basic" ng-class="{\'loading\': viewevent.attendees[\'no\'].loading}"><table class="ui very basic unstackable table attendees-people"><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder="" ng-change="viewevent.getAttendees(\'no\')" ng-model-options="{ debounce: 500 }" ng-model="viewevent.attendees[\'no\'].filters.firstName"> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th></tr></thead><tbody><tr ng-repeat="attendee in viewevent.attendees[\'no\'].data track by attendee.id"><td><h4 class="ui image header"><img ng-src="//graph.facebook.com/{{::attendee.facebook_id}}/picture?type=square" class="ui circular image"><div class="content">{{::attendee.first_name}}, {{::attendee.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::attendee.tagline}}</div></td><td class="desktopview">{{::attendee.cumulative_match_score}}&nbsp;</td><td class="desktopview">{{::attendee.total_mutual_friends}}&nbsp;</td></tr></tbody></table><div class="ui message" ng-show="viewevent.attendees[\'no\'].noResults"><div class="header">No attendees found.</div></div></div></div><br></div><script>\n\'use strict\';\n$(\'.menu .item\')\n    .tab();\n</script>'),e.put("components/event/eventchat.tpl.html",'<div id="chat-conversation-container"><div id="chat-conversation-reply"><div class="ui form"><div class="field"><label></label> <textarea ng-enter="viewevent.sendMessage()" placeholder="Add your message here." ng-model="viewevent.newmessage"></textarea></div><div ng-click="viewevent.sendMessage()" ng-class="{\'loading\': viewevent.sendingMessage}" class="ui submit green button">Post Message</div></div></div><div id="chat-conversation-content" class="basic ui segment" ng-class="{\'loading\': viewevent.loadingMessages}" when-scroll-ends="viewevent.loadMoreChat()"><h3 class="ui center aligned header" ng-if="viewevent.noMessages">There are no any messages</h3><div><div ng-style="" class="repeat-animation quote chat-conversation-message" ng-class="{\'left\': msg.left, \'right\': !msg.left, \'lastMessage\': $last}" ng-repeat="msg in viewevent.messages track by $index"><img class="round-avatar" ng-src="{{ msg.left && msg.photo || !msg.left && msg.photo}}"> <span class="avatar-name">{{msg.first_name}}</span><div class="speech-bubble"><blockquote ng-bind-html="msg.body"></blockquote></div><span class="time-ago">{{msg.sent_at}}</span></div></div><three-bounce-spinner class="page-spinner-bar" ng-show="viewevent.status.loading"></three-bounce-spinner></div></div>'),e.put("components/event/eventedit.tpl.html",'<div class="ui basic segment" id="eventEditPage"><form class="ui form" ng-class="{\'loading\': viewevent.loadingEvent}"><div class="ui positive message" ng-show="viewevent.showSuccess"><div class="header">New event was successfully created.</div></div><div class="ui negative message" ng-show="viewevent.showError"><div class="header">Warning</div><p ng-repeat="errormsg in viewevent.errorMessage track by $index">{{errormsg}}</p></div><div class="ui large form segment first" id="FirstSegment"><div class="field"><label>Event Name</label> <input autocomplete="off" class="border-bottom" ng-model="viewevent.eventEdit.name" placeholder="{{::viewevent.placeholder.name}}" type="text" name="name"></div><div class="field"><label>Location</label><div class="ui action input" id="locationInput2"><input autocomplete="off" name="location" attach="\'locationInput2\'" google-places-autocomplete="" options="viewevent.autocompleteOptions" placeholder="{{::viewevent.placeholder.location}}" ng-model="viewevent.eventLocation" type="text"> <button ng-class="{\'active\': viewevent.mapurlTrue, \'disabled\': !viewevent.mapurlTrue}" ng-click="viewevent.openMap()" class="ui right icon button location"><i class="marker large icon"></i></button></div></div></div><div class="ui large form segment" id="datePairEdit"><div class="field" ng-class="{\'error\': viewevent.startsTimeError}"><label>Starts</label><div class="ui icon input" id="desktopStartsAt"><input autocomplete="off" class="date start" ng-model="viewevent.starts_on_date" placeholder="{{::viewevent.placeholder.starts}}" type="text" name="starts_on_date"> <i class="calendar icon"></i></div><input name="starts_on" autocomplete="off" ng-change="viewevent.checkDatesStarts()" ng-class="{\'fulldisplay\': viewevent.eventEdit.starts_on !== \'\' && viewevent.eventEdit.starts_on !== null}" ng-if="viewevent.showMobile" id="startsAtDate" class="border-bottom" placeholder="Starts" type="datetime-local" ng-model="viewevent.eventEdit.starts_on"> <input autocomplete="off" id="startsAtTime" class="time start" placeholder="{{::viewevent.placeholder.startsTime}}" type="text" ng-model="viewevent.starts_on_time" name="starts_on_time"></div><div class="field" ng-class="{\'error\': viewevent.endsTimeError}"><label>Ends</label><div class="ui icon input" id="desktopEndsAt"><input autocomplete="off" class="date end" ng-model="viewevent.ends_on_date" placeholder="{{::viewevent.placeholder.ends}}" type="text" name="ends_on_date"> <i class="calendar icon"></i></div><input name="ends_on" autocomplete="off" ng-change="viewevent.checkDatesEnds()" ng-class="{\'fulldisplay\': viewevent.eventEdit.ends_on !== \'\' && viewevent.eventEdit.ends_on !== null}" ng-if="viewevent.showMobile" id="endsAtDate" class="ui border-bottom" placeholder="Ends" type="datetime-local" ng-model="viewevent.eventEdit.ends_on"> <input autocomplete="off" id="endsAtTime" class="time end" placeholder="{{::viewevent.placeholder.endsTime}}" type="text" ng-model="viewevent.ends_on_time" name="ends_on_time"></div><div class="field"><label>Repeat</label> <input autocomplete="off" name="repeat" id="repeat" placeholder="{{::viewevent.placeholder.repeat}}" type="text" ng-model="viewevent.eventEdit.repeat"><div class="ui icon input" id="desktopRepeatUntil"><input autocomplete="off" class="simpledate" ng-model="viewevent.eventEdit.repeatUntil" placeholder="{{::viewevent.placeholder.repeatUntil}}" type="text"> <i class="calendar icon"></i></div></div></div><div class="ui large form segment"><div class="field"><label>Max. attendees</label> <input autocomplete="off" ng-model="viewevent.eventEdit.max_attendees" placeholder="{{::viewevent.placeholder.max_attendees}}" type="text" name="max_attendees"></div></div><div class="ui large form segment icon-segment"><div class="field"><label>Costs</label><div class="fluid ui right labeled icon button"><i class="fa-angle-right fa icon large"></i> {{::viewevent.placeholder.costs}}</div></div></div><div class="ui large form segment icon-segment"><div class="field button"><label>Invitations</label><div class="fluid ui right labeled icon button" ng-click="viewevent.openInvitations()"><i class="fa-angle-right fa icon large"></i> {{::viewevent.placeholder.invitations}}</div></div></div><div class="ui large form segment icon-segment"><div class="field button" id="attachmentsDesc"><label>Attachments</label><div class="fluid ui right labeled icon button with-left-icon"><i class="fa-paperclip fa icon large left-icon"></i> <i class="fa-angle-right fa icon large"></i> {{::viewevent.placeholder.attachments}}</div></div><div class="ui divider" id="last-section"></div><div class="field"><label>Description</label> <textarea autocomplete="off" name="description" rows="4" class="border-bottom" placeholder="{{::viewevent.placeholder.description}}" ng-model="viewevent.eventEdit.description"></textarea></div></div><div id="deleteEventButton" ng-class="{\'loading\': viewevent.loadingDelete, \'disabled\': viewevent.loadingDelete}" ng-show="isState(\'event.edit\')" class="ui red icon labeled left button">Delete <i class="remove icon"></i></div><div ng-class="{\'loading\': viewevent.loadingSave, \'disabled\': viewevent.loadingSave}" ng-if="isState(\'event.edit\')" class="ui green labeled icon right button desktopview" ng-click="viewevent.saveEvent()">Save <i class="save icon"></i></div></form></div><div class="ui small modal deletemodal" id="deleteEventModal"><i class="close icon"></i><div class="header">Please Confirm</div><div class="content"><p>Are you sure you want to delete this event?</p></div><div class="actions"><div class="ui negative basic icon labeled button"><i class="remove icon"></i> No</div><a class="ui positive right button icon labeled"><i class="checkmark icon"></i> Yes</a></div></div><script>\n\'use strict\';\n$(\'#deleteEventModal\')\n    .modal({\n        onDeny: function() {},\n        onApprove: function() {\n            angular.element($(\'#eventEditPage\')).scope().viewevent.deleteEvent();\n        }\n    })\n    .modal(\'attach events\', \'#deleteEventButton\', \'show\')\n    .modal(\'setting\', \'allowMultiple\', true);\n</script><script>\n\'use strict\';\n\n\n// initialize input widgets first\n$(\'#datePairEdit .time\').timepicker({\n    \'showDuration\': true,\n    \'timeFormat\': \'h:i A\',\n    \'scrollDefaultNow\': true\n});\n\n$(\'#datePairEdit .date\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n$(\'#datePairEdit .simpledate\').datepicker({\n    \'format\': \'mm/dd/yyyy\',\n    \'autoclose\': true,\n    \'startDate\': moment().format(\'MM/DD/YYYY\'),\n    \'todayHighlight\': true,\n});\n\n\n// initialize datepair\n$(\'#datePairEdit\').datepair({\n    defaultTimeDelta: 3600000,\n});\n\n\n$(".ui.form").scroll(function() {\n    $("input[type=\'text\']:focus").blur();\n});\n</script>'),e.put("components/event/eventinvitations.tpl.html",'<div class="ui basic segment" id="event-invitations"><form class="ui form" ng-class="{\'loading\': viewevent.loadingEvent}"><div class="ui header">Who can attend this event?</div><div class="fields"><div class="eight wide field invitations"><div class="field-section"><div class="radio-vertical"><input type="radio" ng-model="viewevent.invitationsOptions.attendingPref" value="myconnections"> <span class="label">Only my connections (default)</span></div><div class="radio-vertical"><input type="radio" ng-model="viewevent.invitationsOptions.attendingPref" value="public"> <span class="label">Public (all Persice users)</span></div><div class="radio-vertical"><input type="radio" ng-model="viewevent.invitationsOptions.attendingPref" value="private"> <span class="label">Private (only select users)</span></div></div></div><div class="eight wide field invitations"><div class="field-section"><div class="label">Max. attendees <span class="label number">{{viewevent.event.max_attendees}}&nbsp;</span></div><div class="ui divider"></div><div class="checkbox-vertical"><input type="checkbox" ng-model="viewevent.invitationsOptions.guestInvite" value="private"> <span class="label">Guests can invite friends</span></div></div></div></div></form><br><div class="ui basic segment"><div class="ui active inverted dimmer" ng-if="viewevent.loadingInvitesSave"><div class="ui text loader">Please wait while invitations are being sent...</div></div><div class="ui top attached tabular menu" id="invitationsTabsMenu"><a class="item active" data-tab="first">My Connections</a> <a class="item withicons" data-tab="second"><i class="check large circle icon"></i> Invite List <span class="ui circular label">{{viewevent.invitedPeopleCount}}</span></a></div><div class="ui bottom attached tab segment active" data-tab="first"><div class="ui segment basic" ng-class="{\'loading\': viewevent.loadingConnections}"><table class="ui very basic unstackable table invitations-people" ng-cloak=""><thead><tr><th colspan="2" class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder="" ng-model="viewevent.connectionFirstName" ng-change="viewevent.getConnections()" ng-model-options="{ debounce: 500 }"> <i class="search large icon"></i></div></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th><th class="desktopview"></th></tr></thead><tbody><tr ng-repeat="connection in viewevent.connections track by connection.friend_id" ng-class="{\'active\': connection.selected}" ng-click="viewevent.markSelected($index)"><td><h4 class="ui image header"><img ng-src="{{::connection.image}}" class="ui circular image"><div class="content">{{::connection.first_name}}, {{::connection.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::connection.tagline}}</div></td><td class="desktopview">{{::connection.common_goals_offers_interests}}&nbsp;</td><td class="desktopview">{{::connection.mutual_friends_count}}&nbsp;</td><td class="selected"><i ng-if="connection.selected" class="check fade icon big circle invite outline" ng-class="{\'green\': !connection.is_invited && connection.selected}"></i></td></tr></tbody></table></div></div><div class="ui bottom attached tab segment" data-tab="second"><div class="ui segment basic" ng-class="{\'loading\': viewevent.invitedPeopleLoading}"><table class="ui very basic unstackable table invitations-people" ng-cloak=""><thead><tr><th class="search-header-container"><div class="ui transparent left icon input searchbox"><input type="text" placeholder="" ng-model="viewevent.invitedPeopleFirstName" ng-change="viewevent.getInvitedPeople()" ng-model-options="{ debounce: 500 }"> <i class="search large icon"></i></div></th><th class="desktopview"></th><th class="desktopview"><i class="intersecticon icon"></i></th><th class="desktopview"><i class="empty user large usericon icon"></i></th><th>RSVP</th><th></th></tr></thead><tbody><tr ng-repeat="attendee in viewevent.invitedPeople track by attendee.id"><td><h4 class="ui image header"><img ng-src="//graph.facebook.com/{{::attendee.facebook_id}}/picture?type=square" class="ui circular image"><div class="content">{{::attendee.first_name}}, {{::attendee.age}}</div></h4></td><td class="desktopview"><div class="tagline">{{::attendee.tagline}}</div></td><td class="desktopview">{{::attendee.common_goals_offers_interests}}&nbsp;</td><td class="desktopview">{{::attendee.mutual_friends_count}}&nbsp;</td><td>{{::attendee.rsvp | uppercase}}</td><td class="selected"><i ng-click="viewevent.removeInvite($index)" class="remove fade icon big circle outline red"></i></td></tr></tbody></table></div></div></div><br></div><script>\n\'use strict\';\n$(\'.menu .item\')\n    .tab();\n</script>'),e.put("components/event/eventview.tpl.html",'<div class="ui center aligned header" ng-show="viewevent.isHost === true && !viewevent.loadingEvent && !viewevent.eventNotFound">You are the host of this event.</div><div class="row" ng-show="viewevent.isHost === false && !viewevent.eventNotFound"><div class="wide column"><div class="ui fluid secondary menu" id="event-going-menu"><div class="header item">GOING?</div><a class="item" ng-click="viewevent.changeRsvpStatus(\'yes\')" ng-class="{active: viewevent.eventRsvp.status === \'yes\'}">YES</a> <a class="item" ng-click="viewevent.changeRsvpStatus(\'no\')" ng-class="{active: viewevent.eventRsvp.status === \'no\'}">NO</a> <a class="item" ng-click="viewevent.changeRsvpStatus(\'maybe\')" ng-class="{active: viewevent.eventRsvp.status === \'maybe\'}">MAYBE</a></div></div></div><div class="ui negative message" ng-show="viewevent.eventNotFound && !viewevent.loadingEvent"><div class="header">Warning</div><p>This event doesn\'t exist anymore.</p></div><div class="ui basic segment" ng-class="{\'hidevisibility\': viewevent.eventNotFound}"><form class="ui form" style="min-height: 530px;" ng-class="{\'loading\': viewevent.loadingEvent}"><div class="ui large form segment first editable" id="FirstSegment"><div class="field"><label class="specialpadding">Event Name</label><div class="eventcontent"><span id="eventName">{{viewevent.event.name}}</span></div></div><div class="ui divider" id="last-section"></div><div class="field" id="locationField"><label class="specialpadding">Location</label><div class="eventcontent" ng-class="{\'urlexists\': viewevent.mapurlTrue}"><i ng-click="viewevent.openMap()" class="marker large icon"></i> <span class="locationContent"><span ng-if="viewevent.event.location_name.trim() !== viewevent.event.city.trim()">{{viewevent.event.location_name}}</span> <span><br ng-if="viewevent.event.location_name.trim() !== viewevent.event.city.trim() && viewevent.event.location_name !== null && viewevent.event.location_name.trim() !== \'\' && viewevent.event.location_name.trim() !== viewevent.event.street.trim()"><span ng-if="viewevent.event.street !== null && viewevent.event.street.trim() !== \'\' && viewevent.event.location_name.trim() !== viewevent.event.street.trim()">{{viewevent.event.street}}<br></span> <span ng-if="viewevent.event.city !== null && viewevent.event.city.trim() !== \'\'">{{viewevent.event.city}} {{viewevent.event.zipcode}} {{viewevent.event.state}}</span></span></span></div></div></div><div class="ui large form segment" id="DatesSection" ng-if="viewevent.showMobile"><div class="field"><span>{{viewevent.firstrow}}</span></div><div class="ui divider" id="last-section"></div><div class="field"><span class="timeslot">{{viewevent.secondrow}}</span> <span class="repeats">repeats weekly</span><div class="cleardiv"></div></div><div class="ui divider" id="last-section"></div><div class="field"><span class="cost"><strong>Cost:</strong> $25 (in advance)</span> <span class="paid"><i class="fa fa-check icon"></i><strong>PAID</strong></span><div class="cleardiv"></div></div></div><div class="ui large form segment" id="DatesSection" ng-if="!viewevent.showMobile"><div class="field"><label class="specialpadding">Starts</label><div class="eventcontent"><span>{{viewevent.firstrow}}</span></div></div><div class="ui divider" id="last-section"></div><div class="field"><label class="specialpadding">Ends</label><div class="eventcontent"><span class="timeslot">{{viewevent.secondrow}}</span> <span class="repeats">repeats weekly</span><div class="cleardiv"></div></div></div><div class="ui divider" id="last-section"></div><div class="field"><label class="specialpadding">Cost</label><div class="eventcontent"><span class="cost">$25 (in advance)</span> <span class="paid"><i class="fa fa-check icon"></i><strong>PAID</strong></span><div class="cleardiv"></div></div></div></div><div class="ui large form segment" id="HostedSection" ng-if="!viewevent.showMobile"><div class="field"><label class="specialpadding">Hosted By</label><div class="eventcontent"><span>{{viewevent.event.hosted_by}}</span></div></div><div class="ui divider" id="last-section"></div><div class="field"><label class="specialpadding">Attending</label><div class="ui right labeled icon button widthFull" ng-click="viewevent.openAttendees();"><span class="total-people">{{viewevent.event.total_attendees}} people total</span> <span class="connections-people">{{viewevent.event.friend_attendees_count}} connections</span> <span class="remaining-spots">{{viewevent.event.spots_remaining}} spots remaining</span><div class="cleardiv"></div><i class="fa-angle-right fa icon large"></i></div></div><div class="field"><label class="specialpadding">Max. attendees</label><div class="eventcontent"><span>{{viewevent.event.max_attendees}}&nbsp;</span></div></div></div><div class="ui large form segment" id="HostedSection" ng-if="viewevent.showMobile"><div class="field">Host: <span>{{viewevent.event.hosted_by}}</span></div><div class="ui divider" id="last-section"></div><div class="field attendees-view" ng-click="viewevent.openAttendees();"><span class="label">Attendees:</span><div class="attendees-values"><span class="total-people">{{viewevent.event.total_attendees}} people total</span> <span class="connections-people">{{viewevent.event.friend_attendees_count}} connections</span> <span class="remaining-spots">{{viewevent.event.spots_remaining}} spots remaining</span></div><i class="fa-angle-right fa icon large"></i></div><div class="ui divider" id="last-section"></div><div class="field">Max. attendees: <span>{{viewevent.event.max_attendees}}&nbsp;</span></div></div><div class="ui large form segment icon-segment"><div class="field"><label class="specialpadding">Group Chat</label><div class="fluid ui right labeled icon button" ng-click="viewevent.openChat()"><i class="fa-angle-right fa icon large"></i> 0 messages</div></div></div><div class="ui large form segment" id="eventDescription"><div class="field" ng-if="viewevent.showMobile"><span>Event Description:</span></div><div class="ui divider" id="last-section" ng-if="viewevent.showMobile"></div><div class="field"><label class="specialpadding">Description</label><div class="eventcontent"><span>{{viewevent.event.description}}</span></div></div></div><div ng-if="isState(\'event.details\')" class="ui green labeled icon right button desktopview" ng-click="viewevent.editEvent()">Edit <i class="edit icon"></i></div></form></div>'),
e.put("components/eventsfeed/eventsfeed.directive.html","<ng-include src=\"'components/eventsfeed/eventsfeed.tpl.html'\"></ng-include>"),e.put("components/eventsfeed/eventsfeed.tpl.html",'<div id="eventsfeed-list-body" class="basic ui segment" ng-class="{\'loading\': eventsfeed.loading}" when-scroll-ends="eventsfeed.loadMoreEvents()"><div class="ui basic segment notice" ng-if="eventsfeed.noEvents"><div class="ui info message"><p>You don\'t have any events.</p></div></div><div class="eventgroup repeat-animation" ng-repeat="event in eventsfeed.events track by $index"><div class="eventdate">{{event.date}}</div><a class="ui fluid card" ng-click="eventsfeed.gotoEvent(event.id)"><div class="image"><img src="/static/img/placeholder-image.jpg"></div><div class="content"><div class="header">{{event.name}}</div><div class="meta"><span ng-if="event.location_name.trim() !== event.city.trim()">{{event.location_name}}</span> <span><br ng-if="event.location_name.trim() !== event.city.trim() && event.location_name !== null && event.location_name.trim() !== \'\' && event.location_name.trim() !== event.street.trim()"><span ng-if="event.street !== null && event.street.trim() !== \'\' && event.location_name.trim() !== event.street.trim()">{{event.street}}<br></span> <span ng-if="event.city !== null && event.city.trim() !== \'\'">{{event.city}} {{event.zipcode}} {{event.state}}</span></span><div class="description"><div class="ui mini statistics"><div class="statistic" data-tooltip="Match Score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{event.cumulative_match_score}}</div></div><div class="statistic" data-tooltip="Total Friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{event.friend_attendees_count}}</div></div></div></div></div><div class="extra content distance">{{event.distance[0]}} {{event.distance[1]}} away</div></div></a></div><three-bounce-spinner class="page-spinner-bar" ng-show="eventsfeed.loadingMore"></three-bounce-spinner></div>'),e.put("components/eventsmap/eventsmap.tpl.html",'<div class="ui segment basic" style="height: 100%; position: relative;" ng-class="{\'loading\': eventsmap.loadingLocation || eventsmap.loading}"><div class="ui warning message" ng-show="eventsmap.locationError"><i class="close icon"></i><div class="content"><div class="header">Your location cannot be determined</div><p>Please allow necessary permissions so we can find your location and show it on a map.</p></div></div><map-canvas id="map" style="width: 100%; height: 400px;"></map-canvas></div><script type="text/javascript">\n$(\'.message .close\')\n    .on(\'click\', function() {\n        $(this)\n            .closest(\'.message\')\n            .transition(\'fade\');\n    });\n</script>'),e.put("components/filter/matchfeedFilter.directive.html",'<div id="FilterController" class="{{filter.class}}" ng-cloak=""><h4 class="ui header" ng-show="filter.class === \'desktopview\'">FILTERS</h4><div class="ui fitted divider" ng-show="filter.class === \'desktopview\'"></div><div id="{{filter.id}}" class="ui form"><form name="filterForm" id="filterForm"><div class="field"><label>Distance <span class="range">{{filter.distanceValue}} {{filter.distanceUnit}}</span></label><rzslider rz-slider-always-show-bar="true" rz-slider-hide-limit-labels="false" rz-slider-model="filter.distanceValue" rz-slider-floor="1" rz-slider-ceil="10000"></rzslider></div><div class="field"><label>Age <span class="range">{{filter.ageSlider.min}} &ndash; {{filter.ageSlider.max}}</span></label><rzslider rz-slider-hide-limit-labels="false" rz-slider-floor="filter.ageSlider.floor" rz-slider-ceil="filter.ageSlider.ceil" rz-slider-model="filter.ageSlider.min" rz-slider-high="filter.ageSlider.max"></rzslider></div><div class="field"><label class="">Show</label></div><div class="field field-checkbox"><uicheckbox value="m" change="filter.toggleGender(value, checked)" checked="{{filter.checkedmale}}" type="toggle" ng-model="filter.male">Men</uicheckbox></div><div class="field field-checkbox"><uicheckbox value="f" change="filter.toggleGender(value, checked)" checked="{{filter.checkedfemale}}" type="toggle" ng-model="filter.female">Women</uicheckbox></div><div class="field"><label class="">Order By</label></div><div class="field"><select class="persiceselect" ng-change="filter.hasChanges()" ng-options="item.value as item.name for item in filter.orderByValues" ng-model="filter.orderBy"></select></div><div class="field keywords-label"><label class="">Keywords</label></div><div class="field" ng-show="filter.showFilterMessage"><label><div class="ui small negative message"><p>{{filter.filtermessage}}</p></div></label></div><div class="field"><div class="ui action input"><input ng-minlength="3" type="text" placeholder="Enter keyword" ng-enter="filter.addKeyword(filter.newKeyword)" ng-model="filter.newKeyword"> <button ng-click="filter.addKeyword(filter.newKeyword)" class="ui icon button"><i class="plus icon"></i></button></div></div><a ng-click="filter.removeKeyword($index)" href="" class="item" ng-repeat="keyword in filter.myKeywords track by $index"><div class="content"><div class="header"><i class="circle remove icon"></i> {{keyword}}</div></div></a><div class="ui divider"></div><a href="" class="button ui submit green" ng-class="{\'disabled\': !filter.changed}" ng-click="filter.refreshMatchFeed()" role="button">Update</a></form></div></div>'),e.put("components/filterEvents/filterEvents.template.html",'<div id="FilterController" class="{{filter.class}}" ng-cloak=""><h4 class="ui header" ng-show="filter.class === \'desktopview\'">FILTERS</h4><div class="ui fitted divider" ng-show="filter.class === \'desktopview\'"></div><div id="{{filter.id}}" class="ui form"><form name="filterForm" id="filterForm"><div class="field"><label>Distance <span class="range">{{filter.distanceValue}} {{filter.distanceUnit}}</span></label><rzslider rz-slider-always-show-bar="true" rz-slider-hide-limit-labels="false" rz-slider-model="filter.distanceValue" rz-slider-floor="1" rz-slider-ceil="10000"></rzslider></div><div class="field"><label class="">Order By</label></div><div class="field"><select class="persiceselect" ng-change="filter.hasChanges()" ng-options="item.value as item.name for item in filter.orderByValues" ng-model="filter.orderBy"></select></div><div class="field keywords-label"><label class="">Keywords</label></div><div class="field" ng-show="filter.showFilterMessage"><label><div class="ui small negative message"><p>{{filter.filtermessage}}</p></div></label></div><div class="field"><div class="ui action input"><input ng-minlength="3" type="text" placeholder="Enter keyword" ng-enter="filter.addKeyword(filter.newKeyword)" ng-model="filter.newKeyword"> <button ng-click="filter.addKeyword(filter.newKeyword)" class="ui icon button"><i class="plus icon"></i></button></div></div><a ng-click="filter.removeKeyword($index)" href="" class="item" ng-repeat="keyword in filter.myKeywords track by $index"><div class="content"><div class="header"><i class="circle remove icon"></i> {{keyword}}</div></div></a><div class="ui divider"></div><a href="" class="button ui submit green" ng-class="{\'disabled\': !filter.changed}" ng-click="filter.refreshEventsFeed()" role="button">Update</a></form></div></div>'),e.put("components/matchfeedprofile/matchfeedprofile.template.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><div ng-if="userprofile.total > 0"><three-bounce-spinner ng-show="userprofile.loadingFeed" class="ui inverted dimmer transition visible active"></three-bounce-spinner><div ng-show="!showDimmer"><div class="dimmable"><h2 class="ui dividing header" id="desktopmatchheader" ng-if="userprofile.showfullprofile">{{ userprofile.user.first_name }}, {{ userprofile.user.age }}<div class="action-header"><div ng-click="userprofile.cancelMatchDesktop()" class="ui circular icon negative button"><i class="remove icon"></i></div><div ng-click="userprofile.confirmMatchDesktop()" class="ui circular icon positive button"><i class="check icon"></i></div></div><div class="sub header">{{userprofile.user.distance[0]}} {{userprofile.user.distance[1]}}<ng-include src="\'components/profile/statistics-horizontal.tpl.html\'"></ng-include></div></h2><div class="ui basic segment" id="matchfeedheader-slider" ng-if="userprofile.showfullprofile"><ng-include src="\'components/profile/headerphotoslider.tpl.html\'"></ng-include></div><div class="header segment" id="matched-profile-header" ng-hide="userprofile.showfullprofile"><div class="ui basic segment"><div ng-click="userprofile.changeTopMenu()" ng-show="userprofile.photosSlider[0].cropped_photo === \'\'" class="ui circular middle aligned left floated small image img-bounding-box" style="background-image: url(\'{{userprofile.photosSlider[0].photo}}\');"></div><div ng-click="userprofile.changeTopMenu()" ng-show="userprofile.photosSlider[0].cropped_photo !== \'\'" class="ui circular middle aligned left floated small image img-bounding-box" style="background-image: url(\'{{userprofile.photosSlider[0].cropped_photo}}\');"></div><h2 ng-click="userprofile.changeTopMenu()" class="ui header">{{ userprofile.user.first_name }}, {{ userprofile.user.age }}<div class="sub header">{{userprofile.user.distance[0]}} {{userprofile.user.distance[1]}}</div></h2><ng-include src="\'components/profile/statistics.tpl.html\'"></ng-include></div></div><div class="body segment" id="matched-profile-body" ng-click="userprofile.changeTopMenu()"><div class="ui attached segment" ng-show="userprofile.showfullprofile" id="mobilematchheader"><h3 class="ui left floated header">{{ userprofile.user.first_name }}, {{ userprofile.user.age }}</h3><h5 class="ui right floated header">{{userprofile.user.distance[0]}} {{userprofile.user.distance[1]}}</h5><br><ng-include src="\'components/profile/statistics-horizontal.tpl.html\'"></ng-include></div><div class="ui attached segment"><ng-include src="\'components/profile/profilebody.tpl.html\'"></ng-include></div></div><div class="footer segment" id="matched-profile-footer" ng-hide="userprofile.showfullprofile || userprofile.total === 0"><div class="ui grid one column aligned center"><div class="row"><div class="column"><div class="ui labeled icon menu"><a href="" ng-click="userprofile.cancelMatch()" class="item" id="left_button"><i class="remove red circle icon"></i></a> <a href="" ng-click="userprofile.confirmMatch()" class="item" id="accept_button"><i class="check green circle icon"></i></a></div></div></div></div><br></div></div></div></div><div class="body segment" ng-show="userprofile.total === 0 && !userprofile.loadingFeed"><div class="ui info message"><div class="header">Sorry. Currently you don\'t have any matches.</div><p>Add more information to your profile. <a class="ui icon mini button blue" ui-sref="myprofile"><i class="angle double right icon"></i></a></p><p>Adjust your match filter to be less restrictive. <a class="ui icon mini button blue" id="showFilter" href=""><i class="angle double right icon"></i></a></p></div></div></div></div></div><page-dimmer ng-model="userprofile.showDimmer" show="true"><h1 class="ui header"><img src="/static/appFrontend/dist/assets/images/logo/app-logo-big.png" class="ui medium image centered" alt=""></h1><h2 class="ui header">Locating people with similar goals...</h2><fading-circle-spinner></fading-circle-spinner></page-dimmer><script>\n\'use strict\';\n\n$(\'.right.sidebar.matchfeedfilter\')\n    .sidebar(\'attach events\', \'#showFilter\', \'show\');\n$(\'#showFilter\')\n    .removeClass(\'disabled\');\n</script>'),e.put("components/modal/modalcreate.html",'<div class="ui modal small centeraligned" id="createEventsModal"><div class="header">Create Event <i class="close icon" ng-click="singleevent.closeEventModal()"></i></div><div class="content"><ng-include src="\'components/event/event.tpl.html\'"></ng-include></div><div class="actions"><div class="ui green labeled icon right button" ng-class="{\'loading\': singleevent.loadingSave, \'disabled\': singleevent.loadingSave}" ng-click="singleevent.saveEvent()">Create <i class="plus circle icon"></i></div></div></div>'),e.put("components/modal/modalview.html",'<div class="ui modal centeraligned" ng-class="viewevent.getActiveClass()" id="{{viewevent.modalId}}"><div class="header" ng-class="{\'leftalign\': viewevent.selection === \'invitations\' || viewevent.selection === \'attendees\' || viewevent.selection === \'chat\'}"><span ng-bind-html="viewevent.header"></span> <i class="close icon" ng-click="viewevent.closeEventModal()"></i> <i ng-if="viewevent.selection === \'invitations\'" class="left chevron icon" ng-click="viewevent.closeInvitations()"></i> <i ng-if="viewevent.selection === \'attendees\'" class="left chevron icon" ng-click="viewevent.closeAttendees()"></i> <i ng-if="viewevent.selection === \'chat\'" class="left chevron icon" ng-click="viewevent.closeChat()"></i></div><div class="content"><div class="switch-content" ng-switch="" on="viewevent.selection"><div ng-switch-when="view"><ng-include src="\'components/event/eventview.tpl.html\'"></ng-include></div><div ng-switch-when="edit"><ng-include src="\'components/event/eventedit.tpl.html\'"></ng-include></div><div ng-switch-when="invitations"><ng-include src="\'components/event/eventinvitations.tpl.html\'"></ng-include></div><div ng-switch-when="attendees"><ng-include src="\'components/event/eventattendees.tpl.html\'"></ng-include></div><div ng-switch-when="chat"><ng-include src="\'components/event/eventchat.tpl.html\'"></ng-include></div></div></div><div class="actions"><div ng-if="viewevent.isHost && viewevent.selection === \'view\'" class="ui green labeled icon right button" ng-click="viewevent.editEvent()">Edit <i class="edit icon"></i></div><div ng-class="{\'loading\': viewevent.loadingSave, \'disabled\': viewevent.loadingSave}" ng-if="viewevent.selection === \'edit\'" class="ui green labeled icon right button" ng-click="viewevent.saveEvent()">Save <i class="save icon"></i></div><div id="deleteEventButton" ng-class="{\'loading\': viewevent.loadingDelete, \'disabled\': viewevent.loadingDelete}" ng-if="viewevent.selection === \'edit\'" class="ui red icon labeled left button" ng-click="viewevent.openModalDelete()">Delete <i class="remove icon"></i></div><div ng-if="viewevent.selection === \'invitations\'" class="ui green right labeled button" ng-class="{\'disabled\': viewevent.counterNewInvites === 0}" ng-click="viewevent.sendInvites()">Done</div></div></div>'),e.put("components/profile/headerphotoslider.tpl.html",'<div class="pagination-container"><div id="PhotoSlider" ng-if="userprofile.photosSlider.length > 0"><flex-slider slider-id="photoSlider" touch="true" slideshow="false" slide="item in userprofile.photosSlider | orderBy:\'order\' track by $index"><li><img ng-click="userprofile.nextImage()" ng-show="item.cropped_photo === \'\'" class="ui image" ng-src="{{item.photo}}"> <img ng-click="userprofile.nextImage()" ng-show="item.cropped_photo !== \'\'" class="ui image" ng-src="{{item.cropped_photo}}"></li></flex-slider></div></div>'),e.put("components/profile/profilebody.tpl.html",'<h4 class="ui header" ng-if="userprofile.user.goals.length > 0 || userprofile.type === \'loggedInUser\'">Goals</h4><div class="ui list" ng-if="userprofile.type === \'matchfeed\'"><div ng-hide="!userprofile.showfullprofile && $index > 2" class="item" ng-repeat="goal in userprofile.user.goals | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': goal.match === 1, \'empty smallicon\': goal.match === 0 }"></i><div class="content"><div class="description">{{ goal.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'friend\'"><div ng-hide="!userprofile.showfullprofile" class="item" ng-repeat="goal in userprofile.user.goals | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': goal.match === 1, \'empty smallicon\': goal.match === 0 }"></i><div class="content"><div class="description">{{ goal.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="goal in userprofile.user.goals track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ goal.subject }}</div></div></div><p ng-if="userprofile.user.goals.length === 0">No goals yet.</p></div><h4 class="ui header" ng-if="userprofile.user.offers.length > 0 || userprofile.type === \'loggedInUser\'">Offers</h4><div class="ui list" ng-if="userprofile.type === \'matchfeed\'"><div ng-hide="!userprofile.showfullprofile && $index > 2" class="item" ng-repeat="offer in userprofile.user.offers | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': offer.match === 1, \'empty smallicon\': offer.match === 0 }"></i><div class="content"><div class="description">{{ offer.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'friend\'"><div ng-hide="!userprofile.showfullprofile" class="item" ng-repeat="offer in userprofile.user.offers | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': offer.match === 1, \'empty smallicon\': offer.match === 0 }"></i><div class="content"><div class="description">{{ offer.value }}</div></div></div></div><div class="ui list" ng-show="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="offer in userprofile.user.offers track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ offer.subject }}</div></div></div><p ng-if="userprofile.user.offers.length === 0">No offers yet.</p></div><h4 class="ui header" ng-if="userprofile.user.about_me.length > 0 && userprofile.showfullprofile">About</h4><div class="ui list" ng-if="userprofile.user.about_me.length > 0 && userprofile.showfullprofile"><div class="item"><i class="empty icon"></i><div class="content"><div class="description"><span>{{userprofile.user.about_me}}</span></div></div></div></div><h4 class="ui header" ng-if="userprofile.user.interests.length > 0 || userprofile.type === \'loggedInUser\'">Activities &amp; Interests</h4><div class="ui list" ng-if="userprofile.type === \'matchfeed\'"><div class="item" ng-hide="!userprofile.showfullprofile && $index > 2" ng-repeat="interest in userprofile.user.interests | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': interest.match === 1, \'empty smallicon\': interest.match === 0 }"></i><div class="content"><div class="description">{{ interest.value }}</div></div></div></div><div class="ui list" ng-if="userprofile.type === \'friend\'"><div class="item" ng-hide="!userprofile.showfullprofile" ng-repeat="interest in userprofile.user.interests | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': interest.match === 1, \'empty smallicon\': interest.match === 0 }"></i><div class="content"><div class="description">{{ interest.value }}</div></div></div></div><div class="ui list" ng-show="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="interest in userprofile.user.interests | limitTo:5 track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ interest.interest_subject }}</div></div></div><p ng-if="userprofile.user.interests.length === 0">No interests yet.</p></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.friends.length > 0" class="ui header">Mutual Friends</h4><div ng-if="userprofile.showfullprofile && userprofile.user.friends.length > 0" class="ui selection list"><a ui-sref="friendprofile({ userId: userprofile.friend.user_id })" class="item" ng-repeat="friend in userprofile.user.friends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></a></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.facebookfriends.length > 0" class="ui header">Mutual Facebook Friends ({{ userprofile.user.facebookfriends.length }})</h4><div ng-if="userprofile.showfullprofile && userprofile.user.facebookfriends.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.facebookfriends track by $index"><img class="ui avatar image" ng-src="http://graph.facebook.com/{{ friend.facebook_id }}/picture"><div class="content"><div class="header">{{ friend.first_name }}</div></div></div></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.twitterfriends.length > 0" class="ui header">Mutual Twitter Friends ({{ userprofile.user.twitterfriends.length }})</h4><div ng-if="userprofile.showfullprofile && userprofile.user.twitterfriends.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.twitterfriends track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.twitterfollowers.length > 0" class="ui header">Mutual Twitter Followers ({{ userprofile.user.twitterfollowers.length }})</h4><div ng-if="userprofile.showfullprofile && userprofile.user.twitterfollowers.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.twitterfollowers track by $index"><img class="ui avatar image" ng-src="{{friend.profile_image_url}}"><div class="content"><div class="header">{{ friend.name }}</div></div></div></div><h4 ng-if="userprofile.showfullprofile && userprofile.user.linkedinconnections.length > 0" class="ui header">Mutual LinkedIn Connections ({{ userprofile.user.linkedinconnections.length }})</h4><div ng-if="userprofile.showfullprofile && userprofile.user.linkedinconnections.length > 0" class="ui selection list"><div class="item" ng-repeat="friend in userprofile.user.linkedinconnections track by $index"><img class="ui avatar image" ng-src="{{friend.pictureUrls.values[0]}}"><div class="content"><div class="header">{{ friend.firstName }}</div></div></div></div><h4 class="ui header" ng-if="userprofile.user.likes.length > 0 || userprofile.type === \'loggedInUser\'">Likes</h4><div class="ui list likes" ng-if="userprofile.type === \'matchfeed\'"><div class="item" ng-hide="!userprofile.showfullprofile && $index > 2" ng-repeat="like in userprofile.user.likes | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': like.match === 1, \'empty smallicon\': like.match === 0 }"></i><div class="content"><div class="description">{{ like.value }}</div></div></div></div><div class="ui list likes" ng-if="userprofile.type === \'friend\'"><div class="item" ng-hide="!userprofile.showfullprofile" ng-repeat="like in userprofile.user.likes | orderBy:[\'-match\'] track by $index"><i class="icon" ng-class="{\'stop smallicon\': like.match === 1, \'empty smallicon\': like.match === 0 }"></i><div class="content"><div class="description">{{ like.value }}</div></div></div></div><div class="ui list likes" ng-show="userprofile.type === \'loggedInUser\'"><div class="item" ng-repeat="like in userprofile.user.likes | limitTo:5 track by $index"><i class="icon empty"></i><div class="content"><div class="description">{{ like.name }}</div></div></div><p ng-if="userprofile.user.likes.length == 0">No likes yet.</p></div><h4 class="ui header socialprofileheader" ng-if="(userprofile.social.linkedin !== \'\' || userprofile.social.twitter !== \'\' || userprofile.social.facebook !== \'\') && userprofile.showfullprofile">Social Accounts</h4><br ng-if="userprofile.social.linkedin.length > 0"><a href="{{ userprofile.social.linkedin }}" target="_new" class="ui social icon fluid linkedin labeled button" ng-if="userprofile.social.linkedin.length > 0 && userprofile.showfullprofile"><i class="linkedin icon"></i> {{userprofile.user.first_name}} <i class="check circle icon right"></i></a><br ng-if="userprofile.social.twitter.length > 0"><a href="https://twitter.com/{{ userprofile.social.twitter }}" target="_new" class="ui social fluid icon twitter labeled button" ng-if="userprofile.social.twitter.length > 0 && userprofile.showfullprofile"><i class="twitter icon"></i> {{userprofile.social.twitter}} <i class="check circle icon right"></i></a><br ng-if="userprofile.social.facebook.length > 0"><a href="{{ userprofile.social.facebook }}" class="ui social icon facebook labeled fluid button" ng-if="userprofile.social.facebook.length > 0 && userprofile.showfullprofile"><i class="facebook icon"></i> {{userprofile.user.first_name}} <i class="lock icon right"></i></a>'),e.put("components/profile/statistics-horizontal.tpl.html",'<div class="ui mini horizontal statistics"><div class="statistic" data-tooltip="Match score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{userprofile.totalmatchingcount}}</div></div><div class="statistic" data-tooltip="Mutual friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{userprofile.totalfriendscount}}</div></div></div>'),e.put("components/profile/statistics.tpl.html",'<div class="ui mini statistics"><div class="statistic" data-tooltip="Match score"><div class="value"><i class="intersecticon icon"></i></div><div class="label">{{userprofile.totalmatchingcount}}</div></div><div class="statistic" data-tooltip="Mutual friends"><div class="value"><i class="empty user usericon icon"></i></div><div class="label">{{userprofile.totalfriendscount}}</div></div></div>'),e.put("components/userprofile/userprofile.template.html",'<div class="ui grid" ng-cloak=""><div class="row"><div class="wide column"><div class="header segment with-menu" id="{{userprofile.header}}"><ng-include src="\'components/profile/headerphotoslider.tpl.html\'"></ng-include></div><div class="body segment" id="{{userprofile.body}}"><div class="ui top attached segment" id="userProfileName"><h3 class="ui left floated header">{{ userprofile.user.first_name }}<span ng-hide="userprofile.user.first_name === \'\'">,</span> {{ userprofile.user.age }}</h3><h5 id="editbutton" ng-if="userprofile.type === \'loggedInUser\'" class="ui right floated header"><a ui-sref="editmyprofile" class="ui tiny button blue">Edit</a></h5><h5 id="editbutton" ng-if="userprofile.type === \'friend\'" class="ui right floated header">{{ userprofile.user.distance[0] }} {{ userprofile.user.distance[1] }}</h5></div><div class="ui attached segment"><ng-include src="\'components/profile/profilebody.tpl.html\'"></ng-include></div></div></div></div></div>')}]);